Re:VIEW 4.1のリリースノートです。

オプション記法がどうにも拡張できない/定まらないのに起因するのですが、

画像でTeX向けに
```
//image[ID][caption][width=34mm]
```
のようにしていると、HTMLにしたときもwidth=34mmが渡ってしまい、よろしくない結果になります。

[]内だけで複数のビルダ向けのオプションを付けるのは現状難しい(できなくはないかもしれないけどその後パーサで必死になる)ので、tableの//tsize同様に`//imageoption[|builder|〜]`的なビルダ固有オプション指示命令が必要かなと思っています。
2020年2月を予定

Issues
- [ ] #1397 review-jlreqでのjlreqtrimmarkssetupの利用
- [ ] #1393 IDにスペースほかビルダにまずいものをエラーか警告にする。まずはIndexBuilder待ち
- [ ] #1320 キャプションの上・下の設定
- [x] #1163 cls,styにバージョン追加 #1413 
- [x] #1414 後方互換性処理でエラー #1415 
- [x] #1416 review-jlreq+lualatexでエラー #1417 
- [ ] #1421 ビルダごとの画像オプション →ドキュメントに書く？記法ちょっと考える？
- [x] #1423 セル区切りの任意指定 
- [x] #1432 tt/codeを見出しで使いmedia=ebookだとエラー

PR
- [ ] #1384 IndexBuilder WIPで実装待ち
- [ ] #1361 issue #1320の対応。いちおうできているけど汚い？
- [x] #1412 Dockerfile更新
- [x] #1413 バージョン情報追加
- [x] #1415 issue #1414の修正
- [x] #1417 #1416 review-jlreq+LuaLaTeXでのエラーを修正
- [x] #1424 RuboCop 0.77.0対応
- [x] #1425 config.yml.sampleに奥付の連絡先および順序についてのコメントを追加
- [x] #1427 IDGXMLBuilder: 表IDの引き渡しのやり方を修正
- [x] #1428 IDGXMLMakerに-yオプションを追加し、特定ファイルのみをビルドできるように
- [x] #1429 IDGXMLMakerのフィルタプログラムがエラーになったときにクラッシュするのを修正
- [x] #1423 add table_split_regexp parameter
- [x] #1422 needs one more compile when makeindex is true
- [x] #1426 update rstbuilder.rb by @turky 
- [x] #1430 fix ERB.new arguments
- [x] #1431 use GitHub Actions
- [x] #1434 #1432 の対応。ひとまずrevertする
- [x] #1435 #1432 の正式な対応。#1434は不要になる。
- [x] #1433 PDFを実際に作ってみて確認するようにする
#1395, #1396 に関連、当座困らないけれどもいずれ対処したいこととして。

review-jsbookのものとはだいぶアプローチが違ってくるので、トンボ幅の設定も一緒にといったことはやらないほうがよいかも。

TeXシステムでは空白ファイル名はいろいろなトラブルになる(ほかのビルダではHTML含めて問題ない)。

image_image, indepimage, imgtable, icon でIDに空白がある場合はエラーにしておくのが安全そう。

がんばればエスケープしてうんぬん、もできるかもしれないが、競合したときの処理など手間が多い。
`ReVIEW::Book::Index.parse`を全面的に置き換えるものです。
インデックス専用のbuilderを作って何とかする作戦です。
#1320 のcaption_positionの実装です。

refactoring-headerブランチから継承しているので、前の実装よりはかなり読みやすくはなかったかと思います。

副作用として、topbuilderのimageはこれまで上キャプションでしたが、ほかのビルダ合わせで下キャプションに変わります。

line-break-transformの説明に沿って、実装コードを作ってみました。

- 「abc <改行> あいう」とした場合に日本語文章だとスペースが入らないほうが期待になると思うのですが、仕様に従うとスペースになります（Firefoxでも確認）。今コメントアウトしてある「ともかく前か後ろかがF,W,Hならスペースなしにする」だと日本語で普通期待される結果になるのですが、何か副作用はありそうですかね…。
- 先頭か末尾にインラインタグが入ると、現状の構文木作らないRe:VIEWの実装だと対処が厳しそうです。エスケープやビルダごとのコンパイル済み文字列の行を相手にしないといけなくなってしまいます。いまのところこれが最大のネックです。

図・表・リスト（は各種）・式 にはキャプションが付きますが、内容に対して上か下かの指定ができないのが少々不便で、現状ではreview-extで無理矢理切り替えている状態です。

locale.ymlにはそぐわないので、config.ymlで設定することになりますが、どういうパラメータがよいのかという点で悩んでいます。

縦書きになると上・下じゃないので、before after みたいな名前がいいのかも？
技術書典を見てると、わりとそういうニーズがあるのかなと思っています。
どういうパラメータが必要なのかはちょっと検討が必要。

あと、ブロックタグで済むのか（表現的に箇条書きや図表禁止になるがよいか？）とか。
