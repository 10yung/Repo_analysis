Hi

I am having an issue where I have my Spotify account set to NOT allow explicit content. However, when I connect to the Raspotify it allows explicit content to be played.

Is there any way I can set this setting  via the librespot config?

Thanks in advance and awesome project - I use it to control music at an ice-rink

Cheers,
Jim
Hi,
I experience issues, that my raspotify gets a timeout with Spotify regularly.
Therefore I want to upgrade raspotify including all dependant packages to the recent version before digging deeper.
But I cannot find a guide how to upgrade raspotify without breaking or overwriting the existeing configfile etc.
Any suggestion?
Regards, Wolfram
My Spotify password, like all my other passwords, is randomly generated by a password manager. It happened to contain special characters that, because of the lack of quoting of the OPTIONS variable, got interpreted by the shell, causing it to not be understood by librespot.

This fixes that issue by introducing a new USERNAME and PASSWORD field in the config, which are quoted, to ensure special characters in the username and password do not break anything.
switching to [librespot-java](https://github.com/librespot-org/librespot-java) might eliminate some reliability issues & give us a more fully-featured client
Hi guys,
Been running raspotify for 2 years on two different setups (Raspbian and OSMC) and really struggled with the "music randomly stops, could be after 20 seconds, 2 songs, could be after 1 hour".

When it happens there's usually nothing in the logs - even with verbose logging, the logs just go:

```
Nov 20 10:27:42 officepi librespot[21836]: TRACE:librespot_audio::fetch: chunk 100 / 103 complete
Nov 20 10:27:42 officepi librespot[21836]: TRACE:librespot_audio::fetch: requesting chunk 101
Nov 20 10:27:43 officepi librespot[21836]: TRACE:librespot_audio::fetch: chunk 101 / 103 complete
Nov 20 10:27:43 officepi librespot[21836]: TRACE:librespot_audio::fetch: requesting chunk 102
Nov 20 10:27:43 officepi librespot[21836]: TRACE:librespot_audio::fetch: chunk 102 / 103 complete
Nov 20 10:27:43 officepi librespot[21836]: DEBUG:librespot_audio::fetch: File 96e6fe448652629359c13496af3121320d846eaa complete
[music randomly stops, client disconnects, nothing further in logs]
[$sudo service raspotify restart]
Nov 20 10:28:01 officepi systemd[1]: Stopping Raspotify...
Nov 20 10:28:01 officepi systemd[1]: Stopped Raspotify.
Nov 20 10:28:01 officepi systemd[1]: Starting Raspotify...
Nov 20 10:28:01 officepi systemd[1]: Started Raspotify.
```

_(Sometimes it also happens whilst the track is still loading; as in the requesting chunks process isn't finished yet)_ 

It seems to be related to running librespot through raspotify (sorry guys :/ ). I'm afraid my "fix" is literally to manually launch run librespot in a screen session:

Running in a screen session I've had music playing continuously for 2 days, no disconnections.

I'm now using the following script to start/restart/stop librespot:

```#!/bin/bash

launch_librespot () {

  screen -dmS librespot `which librespot` \
  --name osmc \
  --bitrate 320 \
  --initial-volume 50 \
  --enable-volume-normalisation \
  --disable-audio-cache \
  --verbose \
  --backend alsa 
  # Make sure the last argument does NOT have a trailing backslash (\)

  # Other options args (for ref)
  # --username [USERNAME] \
  # --password [PASSWORD] \
  # --device plughw:0 \
  # --onevent /var/local/www/commandw/spotevent.sh \

  echo "librespot started"

}

if [[ "$1" == "start" ]]; then

  if [[ -z `screen -ls | grep librespot` ]]; then
    launch_librespot
  else
    echo "librespot is already running"
  fi
  exit 1

elif [[ "$1" == "restart" ]]; then

  if [[ -z `screen -ls | grep librespot` ]]; then
    echo "librespot not running"
  else
    echo "restarting librespot"
    kill -9 `screen -ls librespot | grep librespot | cut -d "." -f 1`
    screen -wipe | 1>/dev/null
  fi

  launch_librespot
  exit 1

elif [[ "$1" == "stop" ]]; then
  if [[ -z `screen -ls | grep librespot` ]]; then
    echo "librespot not running"
  else
    echo "stopping librespot"
    kill -9 `screen -ls librespot | grep librespot | cut -d "." -f 1`
    screen -wipe | 1>/dev/null
  fi
  exit 1

else
  echo "function: ./librespot [start|restart|stop]"
fi
```

I'd prefer to use raspotify as a proper system service so I'm sharing this more as an indication to help find the issue - aka launching librespot some other way.

**NOTE: THIS DOES -NOT- SOLVE LIBRESPOT CRASHING IF THE CONNECTION DIES
That crash however DOES have a log entry and CAN be watched/restarted with a cronjob - haven't gotten round to that yet but will build that in later.**
Raspberry Pi model 1 B.
Normally I’ve used a usb Wi-Fi module for my pin to connect my pin to my Wi-Fi, Raspotify has worked just fine after setting up. But when I switch to Ethernet instead of the Wi-Fi module, I can’t get audio from the device using Raspotify. Any other sounds come through just fine however.
I appreciate this has already been raised in other issues (speciifcally #40) but I've not been able to get anywhere with existing solutions.

Pi is connected to an SMSL AD18 USB DAC/amplifier. Sound works fine when using the browser. 

Onboard audio has been disabled using:
`blacklist snd_bcm2835`
under `/etc/modprobe.d/alsa-blacklist.conf`

Output of `aplay -l` is:

`**** List of PLAYBACK Hardware Devices ****
card 1: AMP [SMSL AD18 AMP], device 0: USB Audio [USB Audio]
  Subdevices: 1/1
  Subdevice #0: subdevice #207 `

I have tried with `--device hw:1,0` in  `/etc/default/raspotify` and with it removed.

`--device hw:1,0` is included under the service config file ( /lib/systemd/system/raspotify.service)

However, when I try to play via Raspotify, I get the following when using `sudo systemctl status raspotify`
```

raspotify.service - Raspotify
   Loaded: loaded (/lib/systemd/system/raspotify.service; enabled; vendor preset: enabled)
   Active: active (running) since Sat 2019-11-30 13:17:18 GMT; 14min ago
  Process: 1155 ExecStartPre=/bin/mkdir -m 0755 -p /var/cache/raspotify (code=exited, status=0/SUCCESS)
  Process: 1156 ExecStartPre=/bin/chown raspotify:raspotify /var/cache/raspotify (code=exited, status=0/SUCCESS)
 Main PID: 1157 (librespot)
    Tasks: 3 (limit: 2200)
   Memory: 7.0M
   CGroup: /system.slice/raspotify.service
           └─1157 /usr/bin/librespot --name raspotify (raspberrypi) --backend alsa --bitrate 160 --device hw:1,0 --disable-audio-cache --enable-volume

Nov 30 13:31:59 raspberrypi librespot[1157]: ERROR:librespot_playback::audio_backend::alsa: Alsa error PCM open ALSA function 'snd_pcm_hw_params_set_f
Nov 30 13:31:59 raspberrypi librespot[1157]: ERROR:librespot_playback::player: Could not start audio: Alsa error: PCM open failed
Nov 30 13:32:00 raspberrypi librespot[1157]: INFO:librespot_playback::player: Loading track "Dreams - 2004 Remaster" with Spotify URI "spotify URI "spotify:track:0
Nov 30 13:32:00 raspberrypi librespot[1157]: INFO:librespot_playback::player: Track "Dreams - 2004 Remaster" loaded
Nov 30 13:32:00 raspberrypi librespot[1157]: ERROR:librespot_playback::audio_backend::alsa: Alsa error PCM open ALSA function 'snd_pcm_hw_params_set_f
Nov 30 13:32:00 raspberrypi librespot[1157]: ERROR:librespot_playback::player: Could not start audio: Alsa error: PCM open failed
Nov 30 13:32:00 raspberrypi librespot[1157]: ERROR:librespot_playback::audio_backend::alsa: Alsa error PCM open ALSA function 'snd_pcm_hw_params_set_f
Nov 30 13:32:00 raspberrypi librespot[1157]: ERROR:librespot_playback::player: Could not start audio: Alsa error: PCM open failed
Nov 30 13:32:05 raspberrypi librespot[1157]: ERROR:librespot_playback::audio_backend::alsa: Alsa error PCM open ALSA function 'snd_pcm_hw_params_set_f
Nov 30 13:32:05 raspberrypi librespot[1157]: ERROR:librespot_playback::player: Could not start audio: Alsa error: PCM open failed
```

I guess "snd_pcm_hw_params_set_f" is being clipped (this text is copied directly from the terminal in the pi) but I've no idea what it's clipping, so can't make sense of the error. Any help would be greatly appreciated.

Sorry to ask but i cant find the right answer. 
I would like to know if its the e-mail or username or the username in spotify's account (like this 6vnmkn6r8i2ulo4wpy3bmgvhm). 
Do we have to uncomment line or not?
Thanks a lot
Hi,
In the troubleshooting section, there was a method to disable the pwr mgmt:
```
snd_soc_core.conf in /etc/modprobe.d with this line in:
options snd_soc_core pmdown_time -1

``
dmesg showed this error after reboot
snd_soc_core: `' invalid for parameter `pmdown_time'

I believe the correct file needs an equal sign!
options snd_soc_core pmdown_time =-1

I noticed that librespot creates a lot of log output. In one case it logged so many warnings about not being able to play a song until my raspberry pi's disk was full and died.
This change will cause it to only log errors by default instead of everything. The level can be configured via the config file.