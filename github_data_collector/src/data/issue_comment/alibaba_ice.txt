Here's the **Weekly Digest** for [*alibaba/ice*](https://github.com/alibaba/ice):

 - - - 
# ISSUES
Last week 10 issues were created.
Of these, 4 issues have been closed and 6 issues are still open.
## OPEN ISSUES
:green_heart: #3028 [在 Windows 下终端功能不可用](https://github.com/alibaba/ice/issues/3028), by [alvinhui](https://github.com/alvinhui)
:green_heart: #3027 [docs: add icestark/1.3.*](https://github.com/alibaba/ice/pull/3027), by [daysai](https://github.com/daysai)
:green_heart: #3026 [[RFC] SSR 方案](https://github.com/alibaba/ice/issues/3026), by [imsobear](https://github.com/imsobear)
:green_heart: #3024 [更新页面时不能删除物料块](https://github.com/alibaba/ice/issues/3024), by [JackeBluthH](https://github.com/JackeBluthH)
:green_heart: #3023 [检测到依赖未安装正在尝试自动执行依赖安装中](https://github.com/alibaba/ice/issues/3023), by [ElliottNing](https://github.com/ElliottNing)
:green_heart: #3019 [调试控制台功能不可用](https://github.com/alibaba/ice/issues/3019), by [alvinhui](https://github.com/alvinhui)
## CLOSED ISSUES
:heart: #3025 [icestark子应用调试问题](https://github.com/alibaba/ice/issues/3025), by [blitheinsz](https://github.com/blitheinsz)
:heart: #3022 [编辑器中添加 ESLint 和 TSLint 的警告或错误提醒](https://github.com/alibaba/ice/issues/3022), by [alvinhui](https://github.com/alvinhui)
:heart: #3021 [Windows 下全屏操作与预期不符](https://github.com/alibaba/ice/issues/3021), by [alvinhui](https://github.com/alvinhui)
:heart: #3020 [Update about.md](https://github.com/alibaba/ice/pull/3020), by [FeengQi](https://github.com/FeengQi)
## NOISY ISSUE
:speaker: #3020 [Update about.md](https://github.com/alibaba/ice/pull/3020), by [FeengQi](https://github.com/FeengQi)
It received 3 comments.

 - - - 
# PULL REQUESTS
Last week, 2 pull requests were created, updated or merged.
## UPDATED PULL REQUEST
Last week, 1 pull request was updated.
:yellow_heart: #3027 [docs: add icestark/1.3.*](https://github.com/alibaba/ice/pull/3027), by [daysai](https://github.com/daysai)
## MERGED PULL REQUEST
Last week, 1 pull request was merged.
:purple_heart: #3006 [docs: iceworks 补充进阶说明](https://github.com/alibaba/ice/pull/3006), by [alvinhui](https://github.com/alvinhui)

 - - - 
# COMMITS
Last week there was 1 commit.
:hammer_and_wrench: [docs: iceworks docs  * feat: 补充高级说明  * docs: 企业级中后台领域  * docs: typo  * docs: typo  * chore: 优化表达  * chore: typo  * feat: add advanced for iceworks 4.x  * chore: update picture  * feat: 补充源代码管理  * docs: 添加集成终端  * docs: add user interface  * docs: add user interface  * chore: unified NOUN  * docs: add explorer  * docs: 区分「工作台」和「编辑器」  * chore: typo  * chore: typo  * chore: add user interface to about](https://github.com/alibaba/ice/commit/b7a7af3c17bd090f1440c94ab5968648739723b1) by [alvinhui](https://github.com/alvinhui)

 - - - 
# CONTRIBUTORS
Last week there was 1 contributor.
:bust_in_silhouette: [alvinhui](https://github.com/alvinhui)

 - - - 
# STARGAZERS
Last week there were 42 stagazers.
:star: [michaelliuyang](https://github.com/michaelliuyang)
:star: [youzhimin](https://github.com/youzhimin)
:star: [HarrylXue](https://github.com/HarrylXue)
:star: [chengjiaming1991](https://github.com/chengjiaming1991)
:star: [Dragon-Rider](https://github.com/Dragon-Rider)
:star: [sanyuesiyuewuyue](https://github.com/sanyuesiyuewuyue)
:star: [VSirrr](https://github.com/VSirrr)
:star: [zhuxiyu](https://github.com/zhuxiyu)
:star: [lijingrong](https://github.com/lijingrong)
:star: [ylwzld](https://github.com/ylwzld)
:star: [effortComeOn](https://github.com/effortComeOn)
:star: [sophiehui99](https://github.com/sophiehui99)
:star: [xiaosongfu](https://github.com/xiaosongfu)
:star: [gujiniCY](https://github.com/gujiniCY)
:star: [Catelemmon](https://github.com/Catelemmon)
:star: [fandean](https://github.com/fandean)
:star: [yulishuta](https://github.com/yulishuta)
:star: [jiniechen](https://github.com/jiniechen)
:star: [minicx](https://github.com/minicx)
:star: [yeyaolong](https://github.com/yeyaolong)
:star: [Felix-YuJing](https://github.com/Felix-YuJing)
:star: [yinyuncan](https://github.com/yinyuncan)
:star: [BrownCN023](https://github.com/BrownCN023)
:star: [toeii](https://github.com/toeii)
:star: [Silencesk](https://github.com/Silencesk)
:star: [libratears](https://github.com/libratears)
:star: [yuanlee520310](https://github.com/yuanlee520310)
:star: [BuggMaker](https://github.com/BuggMaker)
:star: [majian159](https://github.com/majian159)
:star: [cxyn](https://github.com/cxyn)
:star: [zhangyang7](https://github.com/zhangyang7)
:star: [QdouHuiQwaiLai](https://github.com/QdouHuiQwaiLai)
:star: [kuangch](https://github.com/kuangch)
:star: [gamelaster](https://github.com/gamelaster)
:star: [cjywoo](https://github.com/cjywoo)
:star: [usherwong](https://github.com/usherwong)
:star: [willemsestan](https://github.com/willemsestan)
:star: [sovegetables](https://github.com/sovegetables)
:star: [tianhewulei](https://github.com/tianhewulei)
:star: [xuzhen97](https://github.com/xuzhen97)
:star: [RogerLiNing](https://github.com/RogerLiNing)
:star: [erolyapici](https://github.com/erolyapici)
You all are the stars! :star2:

 - - - 
# RELEASES
Last week there were no releases.

 - - - 

That's all for last week, please <kbd>:eyes: **Watch**</kbd> and <kbd>:star: **Star**</kbd> the repository [*alibaba/ice*](https://github.com/alibaba/ice) to receive next weekly updates. :smiley:

*You can also [view all Weekly Digests by clicking here](https://github.com/alibaba/ice/issues?q=is:open+is:issue+label:weekly-digest).* 

> Your [**Weekly Digest**](https://github.com/apps/weekly-digest) bot. :calendar:

## 问题描述

打开工作台，点击终端，显示功能不可用：

![image](https://user-images.githubusercontent.com/4392234/72587332-da7b9600-392f-11ea-9b6e-42a5d77127fb.png)

添加 1.* 核心更新的文档说明
## 背景

对 SEO 要求比较高的场景需要 SSR 能力

## 方案分析

目前整体有两种思路的方案：页面级和应用级

### 路由级方案

#### 路由级组件写法

路由级组件的写法增加 `getInitialProps`，`src/Pages/Home/index.jsx`：

```jsx
import React from 'react';

const PageComponent = (pageProps) => {
  const {  data } = pageProps;
  return (
    <>
      {data.a} 
   </>
  );
}

PageComponent.getInitialProps = async () => {
  // 同构代码，获取页面初始数据
  const initData = request();
  return { data: initData };
};

export default PageComponent;
```

#### 路由级组件渲染

需要被框架劫持掉，前端渲染 PageComponent 的地方需要包装一层：

- 判断是否有 window.__INIT_DATA[path] 
- 有则直接渲染并将数据传给组件
- 无则需要构造一个 useEffect 调用 `PageComponent.getInitialProps()` 并传入 PageComponent
- 参考代码：https://github.com/alibaba/rax/blob/master/packages/rax-app/src/runApp.js#L30

#### 应用级写法与渲染

- 支持 `getInitialProps`
- 同时渲染时判断 `window.__INIT_DATA` 是否存在决定要不要调用

#### 框架支持

- 劫持 PageComponent 渲染
- 劫持 App 渲染

#### 工程支持

- 生成去除路由包裹的 AppContainer（框架要保证）
- 通过 AppContainer + PageComponent 生成每个路由的 server 入口
- 注册新的 webpack 任务将这些入口进行打包构建

优缺点：

- SSR 效果更佳，支持页面&应用级获取数据
- 构建出的文件比较多
- 技术复杂度略高，依赖框架约束能力

### 应用级方案

整个应用构建出一个 `build/index.server.js`，

应用入口代码改造 `src/App.jsx` : 

```jsx
// 改造自原先的 src/router.jsx
import React from 'react';
import { Router } from '@ice/router';
import routes from '@/config/routes';
import LanguageProvider from '@/components/LocaleProvider';
import { getLocale } from '@/utils/locale';

const locale = getLocale();

const App = (appProps) => {
  // routerType：服务端渲染用 static，客户端按需使用 hash/browser
  // pathname：static 时生效，用于确定服务端渲染哪个页面
  // data：应用初始数据，业务需要将初始数据通过 Context 或者全局 Store 传递下去
  const { routerType, pathname, data } = appProps;

  return (
    <LanguageProvider locale={locale}>
      <Router type={routerType} pathname={pathname} routes={routerConfig} />,
    </LanguageProvider>
  );
}

App.getInitialProps = async () => {
  // 同构代码，获取应用初始数据
  const initData = request();
  return { data: initData };
};

export default App;
```

client entry `src/index.jsx` 改造:

```jsx
import React from 'react';
import ReactDOM from 'react-dom';
import './global.scss';
import App from './App';

// TODO: getInitialProps 是 async 
const data = window.__INITIAL_DATA__ || await App.getInitialProps();

ReactDOM.render(
  <App data={data} routerType="hash" />,
 mountNode
);
```

server entry `.tmp/server.js`，有工具自动生成：

```jsx
import { renderToString } from 'react-dom-server';
import App from './App';

export default function({ pathname }) {
  const data = await App.getInitialProps();

  const markup = ReactDOM.renderToString(
    <App data={data} routerType="static" pathname={pathname} />,
    {}
  );

  // TODO: 生成完整的 html，将 markup 以及 window.__INITIAL_DATA__ 的 script 标签混入 build/index.html
  return htmlContent;
}
```

server 端代码：

```js
app.get('/*', async (ctx) => {
  const bundlePath = download('http://xxx/index.server.js');
  const render = require(bundlePath);
  const htmlContent = render({
    req: ctx.req,
    pathname: ''
  });

  res.send(htmlContent);
});
```

优缺点：只能应用级获取初始数据，服务端渲染出来的结果不太好，页面级要支持的话成本很高，可以考虑回到上面的方案

## 结论

倾向于方案一，用方案一带来的问题：

- 原先的脚手架模式无法支持，需要迁移到正在做的研发框架上
- 研发框架设计上有一些要求：剥离去除 Router 的 App、劫持 App 的渲染、劫持 Page 的渲染
- 是否要支持 Document 需要讨论下，next.js 和 rax 都有支持，但感觉作用不是特别大



<!--
## 基本规范

- 避免直接给一个错误场景，尽量做一些简单的跟踪分析，然后描述清楚问题
- 组件问题请打开下面的链接书写重现 demo 并描述清楚重现路径
  - @alifd/next(1.x): https://codepen.io/sobear/pen/NeJmOG?editors=0011
  - @icedesign/base(0.x): https://codepen.io/sobear/pen/zybQYj?editors=0011
- `@alifd/next` 的组件问题请在[这里](https://fusion.design/feedback)提交 issue，其他组件问题请在本仓库提交 issue
- 构建问题请提供 `package.json` 以及 `.webpackrc.js` 的内容
- 工具问题（Iceworks/ice-scripts/ice-devtools）请提供实际安装的版本号、系统环境、Node.js 版本
-->

## 问题描述
创建一个项目后进入页面更新模态框，添加一些物料。新添加的物料上有一个删除图标，点击后不能删除。修改名称有同样的问题

**浏览器信息**：Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36

<!-- 可以输入具体的步骤，区块信息，或者截图，能帮助我们更快的解决您的问题 -->

## 错误信息
删除和修改都不成功

## 问题定位
SelectedBlock组件使用了index属性，该属性可能与SortableElement有冲突，不能正确传递到回调函数中，导致点击删除图标时使用的index值为undefined
涉及文件：packages\iceworks-client\src\pages\Project\components\PagePanel\BuildPageModal.js

<!-- Iceworks：运行日志面板错误信息，错误截图，或者【帮助>切换开发者工具】日志，以及【帮助>查看运行日志】log.log 文件 -->
<!-- 项目预览：chrome console 面板错误信息 -->

<!--
## 基本规范

- 避免直接给一个错误场景，尽量做一些简单的跟踪分析，然后描述清楚问题
- 组件问题请打开下面的链接书写重现 demo 并描述清楚重现路径
  - @alifd/next(1.x): https://codepen.io/sobear/pen/NeJmOG?editors=0011
  - @icedesign/base(0.x): https://codepen.io/sobear/pen/zybQYj?editors=0011
- `@alifd/next` 的组件问题请在[这里](https://fusion.design/feedback)提交 issue，其他组件问题请在本仓库提交 issue
- 构建问题请提供 `package.json` 以及 `.webpackrc.js` 的内容
- 工具问题（Iceworks/ice-scripts/ice-devtools）请提供实际安装的版本号、系统环境、Node.js 版本
-->

## 问题描述

<!-- 可以输入具体的步骤，区块信息，或者截图，能帮助我们更快的解决您的问题 -->

## 错误信息

<!-- Iceworks：运行日志面板错误信息，错误截图，或者【帮助>切换开发者工具】日志，以及【帮助>查看运行日志】log.log 文件 -->
<!-- 项目预览：chrome console 面板错误信息 -->

## 问题描述

如下所示，面板上显示了调试控制台，但是不知道该功能如何使用。

![image](https://user-images.githubusercontent.com/4392234/72218765-96784200-3579-11ea-91b4-f0ec4a61f7bf.png)

## 问题描述

点击导航栏上的启动按钮，终端上报错：

![image](https://user-images.githubusercontent.com/4392234/72129733-4bf89900-33b2-11ea-9347-2357f01fcd8b.png)

![image](https://user-images.githubusercontent.com/4392234/72129411-13a48b00-33b1-11ea-93c4-c752d5d5cc94.png)

## 问题描述

如下图所示

![image](https://user-images.githubusercontent.com/4392234/72129321-c58f8780-33b0-11ea-9676-e33d56c3ea21.png)

在setWebpackLoaders.js 文件中发现只需要把文件改成这样就能实现

![image](https://user-images.githubusercontent.com/22415092/72124345-5cebdf00-339f-11ea-8455-b91e84fba60f.png)
之前的代码是这样的如下图
![image](https://user-images.githubusercontent.com/22415092/72124449-c370fd00-339f-11ea-9c2c-cf3a30f6e39d.png)

请问下这样的话如何解决