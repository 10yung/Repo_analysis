Hi,

I have a server with multifactor enabled, only for some users. I have a backup user which does not have multifactor enabled and I'm trying to get phpseclib to connect to my server with that user. I use a private key with no password to connect. This is my code:


```
       $priv_key = '<home-folder>/.ssh/id_rsa.pem';

        $port = $server->getSshport() !== 0 ? $server->getSshport() : <port>;

        $output->writeln('Test connection for ' . $server->getName() . '(' . $server->getIpAddress() . ') on port ' . $port);

        $ssh = new SSH2($server->getIpAddress(), $port);

        $key = new RSA();
        $key->loadKey(file_get_contents($priv_key));
        try {

            if ($ssh->login($user, $key)) {
                echo 'Connected to ' . $user . '@' . $host . PHP_EOL;
            } else {
                echo 'Could not connect ' . $user . '@' . $host;
            }
            echo $ssh->getLog() . PHP_EOL;
        } catch (ContextErrorException $exception) {
            echo $ssh->getLog() . PHP_EOL;
            echo 'ERROR: ' . $exception->getMessage() . PHP_EOL;
        }
```

And this is the log output

```
00000000  53:53:48:2d:32:2e:30:2d:4f:70:65:6e:53:53:48:5f  SSH-2.0-OpenSSH_
00000010  37:2e:34:0d:0a                                   7.4..

->
00000000  53:53:48:2d:32:2e:30:2d:70:68:70:73:65:63:6c:69  SSH-2.0-phpsecli
00000010  62:5f:32:2e:30:20:28:6f:70:65:6e:73:73:6c:2c:20  b_2.0 (openssl, 
00000020  67:6d:70:29:0d:0a                                gmp)..

-> NET_SSH2_MSG_KEXINIT (since last: 0.1043, network: 0s)
00000000  d8:52:f1:b3:9f:49:65:ed:f9:2b:4e:9d:ae:8d:2d:67  .R...Ie..+N...-g
00000010  00:00:00:7e:64:69:66:66:69:65:2d:68:65:6c:6c:6d  ...~diffie-hellm
00000020  61:6e:2d:67:72:6f:75:70:2d:65:78:63:68:61:6e:67  an-group-exchang
00000030  65:2d:73:68:61:32:35:36:2c:64:69:66:66:69:65:2d  e-sha256,diffie-
00000040  68:65:6c:6c:6d:61:6e:2d:67:72:6f:75:70:2d:65:78  hellman-group-ex
00000050  63:68:61:6e:67:65:2d:73:68:61:31:2c:64:69:66:66  change-sha1,diff
00000060  69:65:2d:68:65:6c:6c:6d:61:6e:2d:67:72:6f:75:70  ie-hellman-group
00000070  31:34:2d:73:68:61:31:2c:64:69:66:66:69:65:2d:68  14-sha1,diffie-h
00000080  65:6c:6c:6d:61:6e:2d:67:72:6f:75:70:31:2d:73:68  ellman-group1-sh
00000090  61:31:00:00:00:29:72:73:61:2d:73:68:61:32:2d:32  a1...)rsa-sha2-2
000000a0  35:36:2c:72:73:61:2d:73:68:61:32:2d:35:31:32:2c  56,rsa-sha2-512,
000000b0  73:73:68:2d:72:73:61:2c:73:73:68:2d:64:73:73:00  ssh-rsa,ssh-dss.
000000c0  00:00:ff:61:65:73:31:32:38:2d:63:74:72:2c:61:65  ...aes128-ctr,ae
000000d0  73:31:39:32:2d:63:74:72:2c:61:65:73:32:35:36:2d  s192-ctr,aes256-
000000e0  63:74:72:2c:61:65:73:31:32:38:2d:63:62:63:2c:61  ctr,aes128-cbc,a
000000f0  65:73:31:39:32:2d:63:62:63:2c:61:65:73:32:35:36  es192-cbc,aes256
00000100  2d:63:62:63:2c:62:6c:6f:77:66:69:73:68:2d:63:74  -cbc,blowfish-ct
00000110  72:2c:62:6c:6f:77:66:69:73:68:2d:63:62:63:2c:33  r,blowfish-cbc,3
00000120  64:65:73:2d:63:74:72:2c:33:64:65:73:2d:63:62:63  des-ctr,3des-cbc
00000130  2c:61:72:63:66:6f:75:72:32:35:36:2c:61:72:63:66  ,arcfour256,arcf
00000140  6f:75:72:32:35:36:2c:61:72:63:66:6f:75:72:31:32  our256,arcfour12
00000150  38:2c:61:72:63:66:6f:75:72:31:32:38:2c:74:77:6f  8,arcfour128,two
00000160  66:69:73:68:31:32:38:2d:63:74:72:2c:74:77:6f:66  fish128-ctr,twof
00000170  69:73:68:31:39:32:2d:63:74:72:2c:74:77:6f:66:69  ish192-ctr,twofi
00000180  73:68:32:35:36:2d:63:74:72:2c:74:77:6f:66:69:73  sh256-ctr,twofis
00000190  68:31:32:38:2d:63:62:63:2c:74:77:6f:66:69:73:68  h128-cbc,twofish
000001a0  31:39:32:2d:63:62:63:2c:74:77:6f:66:69:73:68:32  192-cbc,twofish2
000001b0  35:36:2d:63:62:63:2c:74:77:6f:66:69:73:68:2d:63  56-cbc,twofish-c
000001c0  62:63:00:00:00:ff:61:65:73:31:32:38:2d:63:74:72  bc....aes128-ctr
000001d0  2c:61:65:73:31:39:32:2d:63:74:72:2c:61:65:73:32  ,aes192-ctr,aes2
000001e0  35:36:2d:63:74:72:2c:61:65:73:31:32:38:2d:63:62  56-ctr,aes128-cb
000001f0  63:2c:61:65:73:31:39:32:2d:63:62:63:2c:61:65:73  c,aes192-cbc,aes
00000200  32:35:36:2d:63:62:63:2c:62:6c:6f:77:66:69:73:68  256-cbc,blowfish
00000210  2d:63:74:72:2c:62:6c:6f:77:66:69:73:68:2d:63:62  -ctr,blowfish-cb
00000220  63:2c:33:64:65:73:2d:63:74:72:2c:33:64:65:73:2d  c,3des-ctr,3des-
00000230  63:62:63:2c:61:72:63:66:6f:75:72:32:35:36:2c:61  cbc,arcfour256,a
00000240  72:63:66:6f:75:72:32:35:36:2c:61:72:63:66:6f:75  rcfour256,arcfou
00000250  72:31:32:38:2c:61:72:63:66:6f:75:72:31:32:38:2c  r128,arcfour128,
00000260  74:77:6f:66:69:73:68:31:32:38:2d:63:74:72:2c:74  twofish128-ctr,t
00000270  77:6f:66:69:73:68:31:39:32:2d:63:74:72:2c:74:77  wofish192-ctr,tw
00000280  6f:66:69:73:68:32:35:36:2d:63:74:72:2c:74:77:6f  ofish256-ctr,two
00000290  66:69:73:68:31:32:38:2d:63:62:63:2c:74:77:6f:66  fish128-cbc,twof
000002a0  69:73:68:31:39:32:2d:63:62:63:2c:74:77:6f:66:69  ish192-cbc,twofi
000002b0  73:68:32:35:36:2d:63:62:63:2c:74:77:6f:66:69:73  sh256-cbc,twofis
000002c0  68:2d:63:62:63:00:00:00:39:68:6d:61:63:2d:73:68  h-cbc...9hmac-sh
000002d0  61:32:2d:32:35:36:2c:68:6d:61:63:2d:73:68:61:31  a2-256,hmac-sha1
000002e0  2d:39:36:2c:68:6d:61:63:2d:73:68:61:31:2c:68:6d  -96,hmac-sha1,hm
000002f0  61:63:2d:6d:64:35:2d:39:36:2c:68:6d:61:63:2d:6d  ac-md5-96,hmac-m
00000300  64:35:00:00:00:39:68:6d:61:63:2d:73:68:61:32:2d  d5...9hmac-sha2-
00000310  32:35:36:2c:68:6d:61:63:2d:73:68:61:31:2d:39:36  256,hmac-sha1-96
00000320  2c:68:6d:61:63:2d:73:68:61:31:2c:68:6d:61:63:2d  ,hmac-sha1,hmac-
00000330  6d:64:35:2d:39:36:2c:68:6d:61:63:2d:6d:64:35:00  md5-96,hmac-md5.
00000340  00:00:04:6e:6f:6e:65:00:00:00:04:6e:6f:6e:65:00  ...none....none.
00000350  00:00:00:00:00:00:00:00:00:00:00:00              ............

<- NET_SSH2_MSG_KEXINIT (since last: 0.013, network: 0.0129s)
00000000  e9:5f:2a:87:7b:8d:d3:f8:54:10:fe:d5:18:89:90:7e  ._*.{...T......~
00000010  00:00:01:40:63:75:72:76:65:32:35:35:31:39:2d:73  ...@curve25519-s
00000020  68:61:32:35:36:2c:63:75:72:76:65:32:35:35:31:39  ha256,curve25519
00000030  2d:73:68:61:32:35:36:40:6c:69:62:73:73:68:2e:6f  -sha256@libssh.o
00000040  72:67:2c:65:63:64:68:2d:73:68:61:32:2d:6e:69:73  rg,ecdh-sha2-nis
00000050  74:70:32:35:36:2c:65:63:64:68:2d:73:68:61:32:2d  tp256,ecdh-sha2-
00000060  6e:69:73:74:70:33:38:34:2c:65:63:64:68:2d:73:68  nistp384,ecdh-sh
00000070  61:32:2d:6e:69:73:74:70:35:32:31:2c:64:69:66:66  a2-nistp521,diff
00000080  69:65:2d:68:65:6c:6c:6d:61:6e:2d:67:72:6f:75:70  ie-hellman-group
00000090  2d:65:78:63:68:61:6e:67:65:2d:73:68:61:32:35:36  -exchange-sha256
000000a0  2c:64:69:66:66:69:65:2d:68:65:6c:6c:6d:61:6e:2d  ,diffie-hellman-
000000b0  67:72:6f:75:70:31:36:2d:73:68:61:35:31:32:2c:64  group16-sha512,d
000000c0  69:66:66:69:65:2d:68:65:6c:6c:6d:61:6e:2d:67:72  iffie-hellman-gr
000000d0  6f:75:70:31:38:2d:73:68:61:35:31:32:2c:64:69:66  oup18-sha512,dif
000000e0  66:69:65:2d:68:65:6c:6c:6d:61:6e:2d:67:72:6f:75  fie-hellman-grou
000000f0  70:2d:65:78:63:68:61:6e:67:65:2d:73:68:61:31:2c  p-exchange-sha1,
00000100  64:69:66:66:69:65:2d:68:65:6c:6c:6d:61:6e:2d:67  diffie-hellman-g
00000110  72:6f:75:70:31:34:2d:73:68:61:32:35:36:2c:64:69  roup14-sha256,di
00000120  66:66:69:65:2d:68:65:6c:6c:6d:61:6e:2d:67:72:6f  ffie-hellman-gro
00000130  75:70:31:34:2d:73:68:61:31:2c:64:69:66:66:69:65  up14-sha1,diffie
00000140  2d:68:65:6c:6c:6d:61:6e:2d:67:72:6f:75:70:31:2d  -hellman-group1-
00000150  73:68:61:31:00:00:00:41:73:73:68:2d:72:73:61:2c  sha1...Assh-rsa,
00000160  72:73:61:2d:73:68:61:32:2d:35:31:32:2c:72:73:61  rsa-sha2-512,rsa
00000170  2d:73:68:61:32:2d:32:35:36:2c:65:63:64:73:61:2d  -sha2-256,ecdsa-
00000180  73:68:61:32:2d:6e:69:73:74:70:32:35:36:2c:73:73  sha2-nistp256,ss
00000190  68:2d:65:64:32:35:35:31:39:00:00:00:af:63:68:61  h-ed25519....cha
000001a0  63:68:61:32:30:2d:70:6f:6c:79:31:33:30:35:40:6f  cha20-poly1305@o
000001b0  70:65:6e:73:73:68:2e:63:6f:6d:2c:61:65:73:31:32  penssh.com,aes12
000001c0  38:2d:63:74:72:2c:61:65:73:31:39:32:2d:63:74:72  8-ctr,aes192-ctr
000001d0  2c:61:65:73:32:35:36:2d:63:74:72:2c:61:65:73:31  ,aes256-ctr,aes1
000001e0  32:38:2d:67:63:6d:40:6f:70:65:6e:73:73:68:2e:63  28-gcm@openssh.c
000001f0  6f:6d:2c:61:65:73:32:35:36:2d:67:63:6d:40:6f:70  om,aes256-gcm@op
00000200  65:6e:73:73:68:2e:63:6f:6d:2c:61:65:73:31:32:38  enssh.com,aes128
00000210  2d:63:62:63:2c:61:65:73:31:39:32:2d:63:62:63:2c  -cbc,aes192-cbc,
00000220  61:65:73:32:35:36:2d:63:62:63:2c:62:6c:6f:77:66  aes256-cbc,blowf
00000230  69:73:68:2d:63:62:63:2c:63:61:73:74:31:32:38:2d  ish-cbc,cast128-
00000240  63:62:63:2c:33:64:65:73:2d:63:62:63:00:00:00:af  cbc,3des-cbc....
00000250  63:68:61:63:68:61:32:30:2d:70:6f:6c:79:31:33:30  chacha20-poly130
00000260  35:40:6f:70:65:6e:73:73:68:2e:63:6f:6d:2c:61:65  5@openssh.com,ae
00000270  73:31:32:38:2d:63:74:72:2c:61:65:73:31:39:32:2d  s128-ctr,aes192-
00000280  63:74:72:2c:61:65:73:32:35:36:2d:63:74:72:2c:61  ctr,aes256-ctr,a
00000290  65:73:31:32:38:2d:67:63:6d:40:6f:70:65:6e:73:73  es128-gcm@openss
000002a0  68:2e:63:6f:6d:2c:61:65:73:32:35:36:2d:67:63:6d  h.com,aes256-gcm
000002b0  40:6f:70:65:6e:73:73:68:2e:63:6f:6d:2c:61:65:73  @openssh.com,aes
000002c0  31:32:38:2d:63:62:63:2c:61:65:73:31:39:32:2d:63  128-cbc,aes192-c
000002d0  62:63:2c:61:65:73:32:35:36:2d:63:62:63:2c:62:6c  bc,aes256-cbc,bl
000002e0  6f:77:66:69:73:68:2d:63:62:63:2c:63:61:73:74:31  owfish-cbc,cast1
000002f0  32:38:2d:63:62:63:2c:33:64:65:73:2d:63:62:63:00  28-cbc,3des-cbc.
00000300  00:00:d5:75:6d:61:63:2d:36:34:2d:65:74:6d:40:6f  ...umac-64-etm@o
00000310  70:65:6e:73:73:68:2e:63:6f:6d:2c:75:6d:61:63:2d  penssh.com,umac-
00000320  31:32:38:2d:65:74:6d:40:6f:70:65:6e:73:73:68:2e  128-etm@openssh.
00000330  63:6f:6d:2c:68:6d:61:63:2d:73:68:61:32:2d:32:35  com,hmac-sha2-25
00000340  36:2d:65:74:6d:40:6f:70:65:6e:73:73:68:2e:63:6f  6-etm@openssh.co
00000350  6d:2c:68:6d:61:63:2d:73:68:61:32:2d:35:31:32:2d  m,hmac-sha2-512-
00000360  65:74:6d:40:6f:70:65:6e:73:73:68:2e:63:6f:6d:2c  etm@openssh.com,
00000370  68:6d:61:63:2d:73:68:61:31:2d:65:74:6d:40:6f:70  hmac-sha1-etm@op
00000380  65:6e:73:73:68:2e:63:6f:6d:2c:75:6d:61:63:2d:36  enssh.com,umac-6
00000390  34:40:6f:70:65:6e:73:73:68:2e:63:6f:6d:2c:75:6d  4@openssh.com,um
000003a0  61:63:2d:31:32:38:40:6f:70:65:6e:73:73:68:2e:63  ac-128@openssh.c
000003b0  6f:6d:2c:68:6d:61:63:2d:73:68:61:32:2d:32:35:36  om,hmac-sha2-256
000003c0  2c:68:6d:61:63:2d:73:68:61:32:2d:35:31:32:2c:68  ,hmac-sha2-512,h
000003d0  6d:61:63:2d:73:68:61:31:00:00:00:d5:75:6d:61:63  mac-sha1....umac
000003e0  2d:36:34:2d:65:74:6d:40:6f:70:65:6e:73:73:68:2e  -64-etm@openssh.
000003f0  63:6f:6d:2c:75:6d:61:63:2d:31:32:38:2d:65:74:6d  com,umac-128-etm
00000400  40:6f:70:65:6e:73:73:68:2e:63:6f:6d:2c:68:6d:61  @openssh.com,hma
00000410  63:2d:73:68:61:32:2d:32:35:36:2d:65:74:6d:40:6f  c-sha2-256-etm@o
00000420  70:65:6e:73:73:68:2e:63:6f:6d:2c:68:6d:61:63:2d  penssh.com,hmac-
00000430  73:68:61:32:2d:35:31:32:2d:65:74:6d:40:6f:70:65  sha2-512-etm@ope
00000440  6e:73:73:68:2e:63:6f:6d:2c:68:6d:61:63:2d:73:68  nssh.com,hmac-sh
00000450  61:31:2d:65:74:6d:40:6f:70:65:6e:73:73:68:2e:63  a1-etm@openssh.c
00000460  6f:6d:2c:75:6d:61:63:2d:36:34:40:6f:70:65:6e:73  om,umac-64@opens
00000470  73:68:2e:63:6f:6d:2c:75:6d:61:63:2d:31:32:38:40  sh.com,umac-128@
00000480  6f:70:65:6e:73:73:68:2e:63:6f:6d:2c:68:6d:61:63  openssh.com,hmac
00000490  2d:73:68:61:32:2d:32:35:36:2c:68:6d:61:63:2d:73  -sha2-256,hmac-s
000004a0  68:61:32:2d:35:31:32:2c:68:6d:61:63:2d:73:68:61  ha2-512,hmac-sha
000004b0  31:00:00:00:04:6e:6f:6e:65:00:00:00:04:6e:6f:6e  1....none....non
000004c0  65:00:00:00:00:00:00:00:00:00:00:00:00:00        e.............

-> UNKNOWN (34) (since last: 0.0002, network: 0s)
00000000  00:00:06:00:00:00:08:00:00:00:10:00              ............

<- NET_SSH2_MSG_KEXDH_REPLY (since last: 0.098, network: 0.098s)
00000000  00:00:01:01:00:da:57:b1:89:76:e9:c5:5c:ea:c3:bf  ......W..v..\...
00000010  ff:70:41:9a:15:50:25:8e:a7:35:94:00:bd:4f:ac:8f  .pA..P%..5...O..
00000020  42:03:b7:3e:0b:c5:4d:62:c0:a2:d9:aa:9b:54:3f:ac  B..>..Mb.....T?.
00000030  a0:29:05:14:ea:42:6d:e6:fe:f8:97:cb:85:82:43:51  .)...Bm.......CQ
00000040  1d:ce:51:70:42:0c:79:9d:88:8d:cf:dc:45:02:ff:49  ..QpB.y.....E..I
00000050  b6:6f:34:e7:5c:00:e9:8a:55:40:8a:79:1f:f5:cf:ea  .o4.\...U@.y....
00000060  7c:28:8f:8e:66:64:22:6a:6a:90:be:23:7d:2e:40:c2  |(..fd"jj..#}.@.
00000070  07:b5:ad:0c:ae:df:da:49:46:e6:3a:ea:35:1a:09:ef  .......IF.:.5...
00000080  46:25:15:fe:d4:09:86:94:24:1c:d0:7e:2c:b7:72:7b  F%......$..~,.r{
00000090  39:b8:b1:b9:46:7d:72:df:b9:08:d8:16:9f:5d:b3:cd  9...F}r......]..
000000a0  5a:6b:eb:e1:34:4c:58:5a:88:25:08:b7:60:40:2e:86  Zk..4LXZ.%..`@..
000000b0  eb:9b:55:48:a7:b9:86:35:ec:fc:dc:02:ff:62:b2:9c  ..UH...5.....b..
000000c0  53:84:71:42:fc:59:8a:dc:66:f6:22:f6:e9:f7:3b:df  S.qB.Y..f."...;.
000000d0  02:b3:d7:95:c0:df:23:d0:0e:5a:3a:77:48:f3:e1:d5  ......#..Z:wH...
000000e0  b0:6f:46:d4:56:8c:e3:f4:cc:57:e6:7d:4c:36:df:5c  .oF.V....W.}L6.\
000000f0  12:80:06:20:69:8c:72:7c:c5:f5:bc:ac:f3:b7:e1:7e  ... i.r|.......~
00000100  37:d1:cf:fa:cb:00:00:00:01:02                    7.........

-> UNKNOWN (32) (since last: 0.0013, network: 0s)
00000000  00:00:01:01:00:9c:c6:72:37:8e:50:b5:cc:e4:15:ba  .......r7.P.....
00000010  95:89:48:77:f7:dd:01:c9:bc:ba:0d:3e:87:b1:ce:de  ..Hw.......>....
00000020  25:61:0f:23:66:9e:da:dc:4d:51:90:2e:90:34:5a:2b  %a.#f...MQ...4Z+
00000030  75:77:d7:c8:97:d1:f5:51:1a:6b:ae:af:1d:6c:80:1e  uw.....Q.k...l..
00000040  91:52:9f:44:c7:4c:eb:60:f7:d6:ad:52:56:3b:24:c5  .R.D.L.`...RV;$.
00000050  2a:de:43:f0:93:f7:fc:1d:a5:b3:67:34:2a:d6:5f:dc  *.C.......g4*._.
00000060  59:0a:28:9f:33:67:85:81:f4:f5:5f:41:1e:58:4a:32  Y.(.3g...._A.XJ2
00000070  4c:35:6e:f9:f4:d4:2f:46:22:6a:09:4d:40:ae:3e:1b  L5n.../F"j.M@.>.
00000080  0a:7f:8b:0f:7d:81:ae:1c:8f:28:c6:57:e3:c2:54:bc  ....}....(.W..T.
00000090  ab:c8:a1:7a:3a:68:03:7e:44:57:a0:d8:87:0c:f8:0d  ...z:h.~DW......
000000a0  98:4a:77:45:71:97:6a:70:f5:8e:ec:3c:83:49:fc:d9  .JwEq.jp.....I..
000000b0  0e:98:7f:a1:6a:2d:8a:11:2c:4f:38:42:d5:42:84:af  ....j-..,O8B.B..
000000c0  f9:6e:c9:51:6b:72:d7:27:e3:02:3b:89:f9:04:bd:f6  .n.Qkr.'..;.....
000000d0  4b:d9:3a:41:54:bd:3a:c4:75:55:b9:97:76:13:e9:5e  K.:AT.:.uU..v..^
000000e0  fe:18:fe:fa:1b:1d:0d:26:fc:e0:53:03:06:26:b2:80  .......&..S..&..
000000f0  98:f5:70:23:70:c4:4c:e9:66:3f:6b:13:e8:71:1d:98  ..p#p.L.f?k..q..
00000100  2c:c1:11:c7:1d                                   ,....

<- UNKNOWN (33) (since last: 0.0356, network: 0.0356s)
00000000  00:00:01:17:00:00:00:07:73:73:68:2d:72:73:61:00  ........ssh-rsa.
00000010  00:00:03:01:00:01:00:00:01:01:00:af:5f:02:64:30  ............_.d0
00000020  2c:e2:5d:d1:75:81:7a:ae:ff:d1:d9:b1:16:56:20:bf  ,.].u.z......V .
00000030  30:7a:18:87:ad:92:b8:1f:99:77:bd:69:ec:d9:d0:db  0z.......w.i....
00000040  34:76:1b:84:a3:b5:b0:a6:1d:b1:bb:92:c1:ef:35:df  4v............5.
00000050  f2:6f:34:66:38:36:9f:e9:2f:89:7f:62:e2:0a:41:93  .o4f86../..b..A.
00000060  23:9c:e9:a6:a1:38:4e:0f:77:bc:53:27:29:5c:08:13  #....8N.w.S')\..
00000070  9f:67:cc:2d:88:91:05:b2:da:d5:f2:79:9c:bb:7e:d9  .g.-.......y..~.
00000080  19:18:3b:a8:06:96:a3:4a:fe:d5:20:ad:dd:f2:cb:ad  ..;....J.. .....
00000090  1f:b4:c5:cc:54:6e:73:2b:06:84:fe:5a:30:9e:29:f3  ....Tns+...Z0.).
000000a0  2b:a0:15:f6:e1:3c:f8:40:e5:71:18:f5:4c:51:36:29  +......@.q..LQ6)
000000b0  9d:8b:07:b8:e4:05:36:1b:9b:73:27:29:02:47:ff:88  ......6..s').G..
000000c0  04:2d:d1:6d:5e:77:0f:8c:b8:28:68:3b:6f:93:38:10  .-.m^w...(h;o.8.
000000d0  84:27:5b:01:e8:b4:52:1b:48:73:79:15:86:e2:87:d3  .'[...R.Hsy.....
000000e0  09:37:7a:e3:64:f8:81:86:a0:eb:ee:e2:d7:d2:2f:34  .7z.d........./4
000000f0  31:4b:a6:01:e8:07:c2:cd:b4:ee:fe:4e:a5:16:4e:5f  1K.........N..N_
00000100  40:f3:bc:d0:ed:11:c2:67:b3:b7:47:5e:bb:6f:af:8a  @......g..G^.o..
00000110  1c:b2:1a:99:82:b3:ed:5b:9e:a0:c7:00:00:01:00:1c  .......[........
00000120  5c:ec:87:88:dc:fb:d4:ab:fc:51:b3:9f:c3:80:a2:e5  \........Q......
00000130  c5:2c:45:5f:f7:17:72:cf:69:fa:8b:60:55:4d:73:f5  .,E_..r.i..`UMs.
00000140  1c:1f:c5:41:e9:4f:8a:3a:db:5d:86:09:dd:92:75:aa  ...A.O.:.]....u.
00000150  5b:6d:ab:0b:6c:50:34:1a:ae:04:18:12:e8:f7:a2:91  [m..lP4.........
00000160  23:ff:20:cc:93:78:ef:32:7e:9d:c3:83:7e:c6:82:09  #. ..x.2~...~...
00000170  f2:0f:d3:d0:66:7e:18:ca:05:dc:84:ca:33:c1:3b:d4  ....f~......3.;.
00000180  07:61:ef:c9:cc:24:3d:6c:0f:cc:43:48:5b:a1:63:d4  .a...$=l..CH[.c.
00000190  c8:41:a3:10:f5:d0:3b:ea:de:d6:93:a0:b6:65:1f:0c  .A....;......e..
000001a0  48:58:a1:0f:d1:70:46:0b:33:5e:24:7e:3f:86:0e:fc  HX...pF.3^$~?...
000001b0  9f:3b:d8:27:97:36:04:cd:8e:c4:c3:e0:fe:41:0b:c5  .;.'.6.......A..
000001c0  8c:b3:db:89:37:95:a8:e4:31:df:f2:bd:8f:a5:b9:77  ....7...1......w
000001d0  97:58:1a:90:17:c1:ba:5a:2e:bc:c6:a5:f1:c6:90:a6  .X.....Z........
000001e0  28:36:37:93:f8:47:ed:12:e3:a0:9b:48:38:b1:f4:de  (67..G.....H8...
000001f0  a2:81:5e:25:5d:61:61:46:0e:70:33:4b:7c:74:71:87  ..^%]aaF.p3K|tq.
00000200  c0:37:68:67:17:d0:80:de:6d:ab:93:d6:cf:e3:06:88  .7hg....m.......
00000210  4b:d6:83:31:30:8d:b7:38:31:01:0b:90:08:ba:29:00  K..10..81.....).
00000220  00:01:14:00:00:00:0c:72:73:61:2d:73:68:61:32:2d  .......rsa-sha2-
00000230  32:35:36:00:00:01:00:6f:41:ea:a6:2d:a1:fc:82:13  256....oA..-....
00000240  cc:83:b0:9c:dd:49:7a:b7:30:31:d6:5b:be:33:9a:00  .....Iz.01.[.3..
00000250  8a:ba:fd:57:5a:c2:fe:0b:5c:2f:00:f5:04:a4:2d:d7  ...WZ...\/....-.
00000260  0d:df:db:fa:5e:9e:33:94:3a:61:25:3a:4d:e8:86:30  ....^.3.:a%:M..0
00000270  81:0a:11:dc:8d:60:2b:16:4a:3a:2f:96:bb:fe:f5:39  .....`+.J:/....9
00000280  01:e5:68:2c:e6:82:07:c7:48:f5:f0:1d:8a:e7:70:04  ..h,....H.....p.
00000290  62:13:a5:6d:60:47:c4:6e:8e:c8:9b:47:13:8e:f3:cc  b..m`G.n...G....
000002a0  c7:b0:80:18:2c:d0:1c:f3:46:9f:41:c1:7b:29:fb:b9  ....,...F.A.{)..
000002b0  82:b7:43:ab:13:b9:2d:70:98:ab:3c:65:0f:26:2d:68  ..C...-p...e.&-h
000002c0  22:bb:88:b0:b1:dc:4c:17:b6:7b:d7:54:43:5a:c4:ad  ".....L..{.TCZ..
000002d0  b6:dc:f2:4c:5e:51:29:d9:66:64:53:3f:e0:96:e6:f6  ...L^Q).fdS?....
000002e0  78:9c:25:e3:0d:4a:b9:dd:37:43:85:06:bd:d1:72:a5  x.%..J..7C....r.
000002f0  e2:e2:bb:01:26:6b:1d:19:bc:89:9a:73:a4:a0:45:4c  ....&k.....s..EL
00000300  97:fd:c4:79:ed:a7:2e:5f:5f:57:2c:20:36:b7:18:30  ...y...__W, 6..0
00000310  3d:6d:7a:de:e5:8f:47:16:c3:5f:0c:0e:30:f9:31:57  =mz...G.._..0.1W
00000320  04:cd:1e:57:ad:82:5a:58:8b:9d:81:4d:db:d8:4e:49  ...W..ZX...M..NI
00000330  27:30:a0:6e:c1:d1:03                             '0.n...

-> NET_SSH2_MSG_NEWKEYS (since last: 0.001, network: 0s)
                                                 

<- NET_SSH2_MSG_NEWKEYS (since last: 0, network: 0s)
                                                 

-> NET_SSH2_MSG_SERVICE_REQUEST (since last: 0.0009, network: 0s)
00000000  00:00:00:0c:73:73:68:2d:75:73:65:72:61:75:74:68  ....ssh-userauth

<- NET_SSH2_MSG_SERVICE_ACCEPT (since last: 0.1056, network: 0.1056s)
00000000  00:00:00:0c:73:73:68:2d:75:73:65:72:61:75:74:68  ....ssh-userauth

-> NET_SSH2_MSG_USERAUTH_REQUEST (since last: 0.0003, network: 0s)
00000000  00:00:00:06:62:61:63:6b:75:70:00:00:00:0e:73:73  ....backup....ss
00000010  68:2d:63:6f:6e:6e:65:63:74:69:6f:6e:00:00:00:09  h-connection....
00000020  70:75:62:6c:69:63:6b:65:79:00:00:00:00:0c:72:73  publickey.....rs
00000030  61:2d:73:68:61:32:2d:32:35:36:00:00:01:17:00:00  a-sha2-256......
00000040  00:07:73:73:68:2d:72:73:61:00:00:00:03:01:00:01  ..ssh-rsa.......
00000050  00:00:01:01:00:cc:5f:8d:87:bf:c0:71:d1:f4:d2:59  ......_....q...Y
00000060  27:c7:6c:be:f1:00:fe:f6:15:c3:7b:34:df:4c:95:5e  '.l.......{4.L.^
00000070  58:1b:0a:0c:91:a9:81:ce:08:c0:d4:57:c9:33:7a:d9  X..........W.3z.
00000080  f9:64:66:c8:d4:a0:5d:97:bc:76:82:47:ca:ef:3e:14  .df...]..v.G..>.
00000090  ad:f8:fa:11:54:00:7b:d5:ab:69:9f:31:6e:b6:eb:6b  ....T.{..i.1n..k
000000a0  a8:bb:87:9a:de:38:43:fa:f5:cb:f2:5d:7c:a9:96:96  .....8C....]|...
000000b0  f3:be:ca:45:e2:7b:49:6a:17:a2:3a:cf:a4:55:41:52  ...E.{Ij..:..UAR
000000c0  ea:3a:38:ae:45:19:56:cb:ed:b1:ec:b8:b1:83:d7:ba  .:8.E.V.........
000000d0  17:c5:d2:7a:83:34:59:cc:a4:1e:7c:2a:ee:57:33:7e  ...z.4Y...|*.W3~
000000e0  26:f4:b0:07:95:3f:84:8b:4f:71:9d:52:bd:17:11:5d  &....?..Oq.R...]
000000f0  b7:d0:d1:3b:8f:b5:11:ad:b9:63:c8:7b:f5:99:f8:a4  ...;.....c.{....
00000100  aa:5e:96:4d:f8:73:41:85:5a:d3:04:1c:ed:62:7a:30  .^.M.sA.Z....bz0
00000110  97:19:a4:cf:91:55:24:f9:b8:f4:46:11:67:44:5e:85  .....U$...F.gD^.
00000120  02:49:23:f9:72:eb:2a:ba:e4:74:06:3c:fc:45:e1:f9  .I#.r.*..t...E..
00000130  e1:32:c7:18:fd:40:6e:43:de:15:57:82:87:36:28:f9  .2...@nC..W..6(.
00000140  de:b8:5a:99:08:09:27:b0:9d:63:c9:49:5b:78:73:bb  ..Z...'..c.I[xs.
00000150  4a:6d:f1:f2:6b                                   Jm..k

<- NET_SSH2_MSG_USERAUTH_PK_OK (60) (since last: 0.0374, network: 0.0373s)
00000000  00:00:00:0c:72:73:61:2d:73:68:61:32:2d:32:35:36  ....rsa-sha2-256
00000010  00:00:01:17:00:00:00:07:73:73:68:2d:72:73:61:00  ........ssh-rsa.
00000020  00:00:03:01:00:01:00:00:01:01:00:cc:5f:8d:87:bf  ............_...
00000030  c0:71:d1:f4:d2:59:27:c7:6c:be:f1:00:fe:f6:15:c3  .q...Y'.l.......
00000040  7b:34:df:4c:95:5e:58:1b:0a:0c:91:a9:81:ce:08:c0  {4.L.^X.........
00000050  d4:57:c9:33:7a:d9:f9:64:66:c8:d4:a0:5d:97:bc:76  .W.3z..df...]..v
00000060  82:47:ca:ef:3e:14:ad:f8:fa:11:54:00:7b:d5:ab:69  .G..>.....T.{..i
00000070  9f:31:6e:b6:eb:6b:a8:bb:87:9a:de:38:43:fa:f5:cb  .1n..k.....8C...
00000080  f2:5d:7c:a9:96:96:f3:be:ca:45:e2:7b:49:6a:17:a2  .]|......E.{Ij..
00000090  3a:cf:a4:55:41:52:ea:3a:38:ae:45:19:56:cb:ed:b1  :..UAR.:8.E.V...
000000a0  ec:b8:b1:83:d7:ba:17:c5:d2:7a:83:34:59:cc:a4:1e  .........z.4Y...
000000b0  7c:2a:ee:57:33:7e:26:f4:b0:07:95:3f:84:8b:4f:71  |*.W3~&....?..Oq
000000c0  9d:52:bd:17:11:5d:b7:d0:d1:3b:8f:b5:11:ad:b9:63  .R...]...;.....c
000000d0  c8:7b:f5:99:f8:a4:aa:5e:96:4d:f8:73:41:85:5a:d3  .{.....^.M.sA.Z.
000000e0  04:1c:ed:62:7a:30:97:19:a4:cf:91:55:24:f9:b8:f4  ...bz0.....U$...
000000f0  46:11:67:44:5e:85:02:49:23:f9:72:eb:2a:ba:e4:74  F.gD^..I#.r.*..t
00000100  06:3c:fc:45:e1:f9:e1:32:c7:18:fd:40:6e:43:de:15  ...E...2...@nC..
00000110  57:82:87:36:28:f9:de:b8:5a:99:08:09:27:b0:9d:63  W..6(...Z...'..c
00000120  c9:49:5b:78:73:bb:4a:6d:f1:f2:6b                 .I[xs.Jm..k

-> NET_SSH2_MSG_USERAUTH_REQUEST (since last: 0.0036, network: 0s)
00000000  00:00:00:06:62:61:63:6b:75:70:00:00:00:0e:73:73  ....backup....ss
00000010  68:2d:63:6f:6e:6e:65:63:74:69:6f:6e:00:00:00:09  h-connection....
00000020  70:75:62:6c:69:63:6b:65:79:01:00:00:00:0c:72:73  publickey.....rs
00000030  61:2d:73:68:61:32:2d:32:35:36:00:00:01:17:00:00  a-sha2-256......
00000040  00:07:73:73:68:2d:72:73:61:00:00:00:03:01:00:01  ..ssh-rsa.......
00000050  00:00:01:01:00:cc:5f:8d:87:bf:c0:71:d1:f4:d2:59  ......_....q...Y
00000060  27:c7:6c:be:f1:00:fe:f6:15:c3:7b:34:df:4c:95:5e  '.l.......{4.L.^
00000070  58:1b:0a:0c:91:a9:81:ce:08:c0:d4:57:c9:33:7a:d9  X..........W.3z.
00000080  f9:64:66:c8:d4:a0:5d:97:bc:76:82:47:ca:ef:3e:14  .df...]..v.G..>.
00000090  ad:f8:fa:11:54:00:7b:d5:ab:69:9f:31:6e:b6:eb:6b  ....T.{..i.1n..k
000000a0  a8:bb:87:9a:de:38:43:fa:f5:cb:f2:5d:7c:a9:96:96  .....8C....]|...
000000b0  f3:be:ca:45:e2:7b:49:6a:17:a2:3a:cf:a4:55:41:52  ...E.{Ij..:..UAR
000000c0  ea:3a:38:ae:45:19:56:cb:ed:b1:ec:b8:b1:83:d7:ba  .:8.E.V.........
000000d0  17:c5:d2:7a:83:34:59:cc:a4:1e:7c:2a:ee:57:33:7e  ...z.4Y...|*.W3~
000000e0  26:f4:b0:07:95:3f:84:8b:4f:71:9d:52:bd:17:11:5d  &....?..Oq.R...]
000000f0  b7:d0:d1:3b:8f:b5:11:ad:b9:63:c8:7b:f5:99:f8:a4  ...;.....c.{....
00000100  aa:5e:96:4d:f8:73:41:85:5a:d3:04:1c:ed:62:7a:30  .^.M.sA.Z....bz0
00000110  97:19:a4:cf:91:55:24:f9:b8:f4:46:11:67:44:5e:85  .....U$...F.gD^.
00000120  02:49:23:f9:72:eb:2a:ba:e4:74:06:3c:fc:45:e1:f9  .I#.r.*..t...E..
00000130  e1:32:c7:18:fd:40:6e:43:de:15:57:82:87:36:28:f9  .2...@nC..W..6(.
00000140  de:b8:5a:99:08:09:27:b0:9d:63:c9:49:5b:78:73:bb  ..Z...'..c.I[xs.
00000150  4a:6d:f1:f2:6b:00:00:01:14:00:00:00:0c:72:73:61  Jm..k........rsa
00000160  2d:73:68:61:32:2d:32:35:36:00:00:01:00:b4:26:71  -sha2-256.....&q
00000170  65:de:c0:76:3f:52:7d:3a:0a:69:21:c3:30:24:86:59  e..v?R}:.i!.0$.Y
00000180  e8:40:fb:83:e8:09:05:72:b7:cf:81:a1:59:37:03:8c  .@.....r....Y7..
00000190  07:50:d2:8e:f5:8a:e1:26:81:eb:14:c3:19:9f:af:f0  .P.....&........
000001a0  e3:b1:45:02:56:96:40:2c:53:9d:11:59:37:c0:a4:66  ..E.V.@,S..Y7..f
000001b0  13:4e:c9:7e:93:fe:55:23:47:72:f2:d7:91:f5:cb:31  .N.~..U#Gr.....1
000001c0  be:4c:ef:8a:9e:53:b2:28:ae:2c:bd:43:05:80:6c:51  .L...S.(.,.C..lQ
000001d0  c7:d0:e8:a9:92:54:6c:13:8a:1d:d2:b6:25:76:fa:7c  .....Tl.....%v.|
000001e0  9f:0e:e6:d0:c9:7b:1b:35:c5:38:b2:03:e4:0e:d8:a3  .....{.5.8......
000001f0  99:75:78:96:8d:26:13:b1:63:ef:61:cc:f5:86:2a:33  .ux..&..c.a...*3
00000200  79:af:1d:69:26:37:c5:c0:e3:29:f9:8a:91:ec:d1:8e  y..i&7...)......
00000210  61:5e:52:64:d9:57:f3:ef:c1:e9:d8:55:d7:9e:bc:c5  a^Rd.W.....U....
00000220  e6:7d:81:6e:65:4e:3b:8a:48:a8:09:32:d8:c0:d6:fd  .}.neN;.H..2....
00000230  2a:8a:ac:50:21:b5:ca:1b:9d:93:91:d9:8a:48:6f:02  *..P!........Ho.
00000240  de:0b:f2:1e:9f:06:7a:e3:06:33:6a:96:31:c9:3b:b2  ......z..3j.1.;.
00000250  17:5d:e1:69:13:33:a2:84:69:24:77:cd:5a:b9:e6:b9  .].i.3..i$w.Z...
00000260  ed:0b:f2:55:0e:dc:a7:63:de:74:c6:ab:98           ...U...c.t...

<- NET_SSH2_MSG_USERAUTH_FAILURE (since last: 0.0345, network: 0.0345s)
00000000  00:00:00:14:6b:65:79:62:6f:61:72:64:2d:69:6e:74  ....keyboard-int
00000010  65:72:61:63:74:69:76:65:01                       eractive.
```


I have enabled multifactor with JumpCloud, so i can't figure out if it's a problem with them og what it is. Hope you can help.


I can see that it fails with `keyboard-interactive`, but the server should not be prompting for anything when loggin in with that user and a private key. If I login with command line `ssh -p <port> <user>@<host>` it does not prompt with anything
I wonder if creating a `phpseclib/math` package would be a good idea for v3, moving the entire https://github.com/phpseclib/phpseclib/tree/master/phpseclib/Math namespace, replacing https://github.com/phpseclib/phpseclib/issues/158?
At begining I asked myself why i can login with bash but not with phpseclib !

```
ssh root_dsi@xxx.xxx.xxx.xxx -p 37057
The authenticity of host '[xxx.xxx.xxx.xxx]:37057 ([xxx.xxx.xxx.xxx]:37057)' can't be established.
ECDSA key fingerprint is SHA256:BW4K5v3pQfLTvw/XjDiexyQwwUk97evZUOne/fyP7vs.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '[xxx.xxx.xxx.xxx]:37057' (ECDSA) to the list of known hosts.
Last login: Thu Dec 12 23:47:43 2019 from xxx.xxx.xxx.xxx
root_dsi@devaruvsrv0003l:~$
```

and ssh object :  

```
#0	Ssh:798	[2019-12-13 16:22:07] phpseclib\Net\SSH2 Object
(
    [identifier] => SSH-2.0-phpseclib_2.0 (libsodium, openssl)
    [fsock] => Resource id #82
    [bitmap] => 1
    [errors] => Array
        (
        )

    [server_identifier] => SSH-2.0-OpenSSH_7.4p1 Debian-10+deb9u7
    [kex_algorithms] => Array
        (
            [0] => curve25519-sha256
            [1] => curve25519-sha256@libssh.org
            [2] => ecdh-sha2-nistp256
            [3] => ecdh-sha2-nistp384
            [4] => ecdh-sha2-nistp521
            [5] => diffie-hellman-group-exchange-sha256
            [6] => diffie-hellman-group16-sha512
            [7] => diffie-hellman-group18-sha512
            [8] => diffie-hellman-group14-sha256
            [9] => diffie-hellman-group14-sha1
        )

    [kex_algorithm] => curve25519-sha256@libssh.org
    [kex_dh_group_size_min] => 1536
    [kex_dh_group_size_preferred] => 2048
    [kex_dh_group_size_max] => 4096
    [server_host_key_algorithms] => Array
        (
            [0] => ecdsa-sha2-nistp256
        )

    [encryption_algorithms_client_to_server] => Array
        (
            [0] => chacha20-poly1305@openssh.com
            [1] => aes128-ctr
            [2] => aes192-ctr
            [3] => aes256-ctr
            [4] => aes128-gcm@openssh.com
            [5] => aes256-gcm@openssh.com
        )

    [encryption_algorithms_server_to_client] => Array
        (
            [0] => chacha20-poly1305@openssh.com
            [1] => aes128-ctr
            [2] => aes192-ctr
            [3] => aes256-ctr
            [4] => aes128-gcm@openssh.com
            [5] => aes256-gcm@openssh.com
        )

    [mac_algorithms_client_to_server] => Array
        (
            [0] => umac-64-etm@openssh.com
            [1] => umac-128-etm@openssh.com
            [2] => hmac-sha2-256-etm@openssh.com
            [3] => hmac-sha2-512-etm@openssh.com
            [4] => hmac-sha1-etm@openssh.com
            [5] => umac-64@openssh.com
            [6] => umac-128@openssh.com
            [7] => hmac-sha2-256
            [8] => hmac-sha2-512
            [9] => hmac-sha1
        )

    [mac_algorithms_server_to_client] => Array
        (
            [0] => umac-64-etm@openssh.com
            [1] => umac-128-etm@openssh.com
            [2] => hmac-sha2-256-etm@openssh.com
            [3] => hmac-sha2-512-etm@openssh.com
            [4] => hmac-sha1-etm@openssh.com
            [5] => umac-64@openssh.com
            [6] => umac-128@openssh.com
            [7] => hmac-sha2-256
            [8] => hmac-sha2-512
            [9] => hmac-sha1
        )

    [compression_algorithms_client_to_server] => Array
        (
            [0] => none
            [1] => zlib@openssh.com
        )

    [compression_algorithms_server_to_client] => Array
        (
            [0] => none
            [1] => zlib@openssh.com
        )

    [languages_server_to_client] => Array
        (
            [0] => 
        )

    [languages_client_to_server] => Array
        (
            [0] => 
        )

    [preferred] => Array
        (
        )

    [encrypt_block_size] => 8
    [decrypt_block_size] => 8
    [decrypt] => 
    [encrypt] => 
    [hmac_create] => 
    [hmac_check] => 
    [hmac_size] => 
    [server_public_host_key] => 
    [session_id] => 
    [exchange_hash] => 
    [message_numbers] => Array
        (
            [1] => NET_SSH2_MSG_DISCONNECT
            [2] => NET_SSH2_MSG_IGNORE
            [3] => NET_SSH2_MSG_UNIMPLEMENTED
            [4] => NET_SSH2_MSG_DEBUG
            [5] => NET_SSH2_MSG_SERVICE_REQUEST
            [6] => NET_SSH2_MSG_SERVICE_ACCEPT
            [20] => NET_SSH2_MSG_KEXINIT
            [21] => NET_SSH2_MSG_NEWKEYS
            [30] => NET_SSH2_MSG_KEXDH_INIT
            [31] => NET_SSH2_MSG_KEXDH_REPLY
            [50] => NET_SSH2_MSG_USERAUTH_REQUEST
            [51] => NET_SSH2_MSG_USERAUTH_FAILURE
            [52] => NET_SSH2_MSG_USERAUTH_SUCCESS
            [53] => NET_SSH2_MSG_USERAUTH_BANNER
            [80] => NET_SSH2_MSG_GLOBAL_REQUEST
            [81] => NET_SSH2_MSG_REQUEST_SUCCESS
            [82] => NET_SSH2_MSG_REQUEST_FAILURE
            [90] => NET_SSH2_MSG_CHANNEL_OPEN
            [91] => NET_SSH2_MSG_CHANNEL_OPEN_CONFIRMATION
            [92] => NET_SSH2_MSG_CHANNEL_OPEN_FAILURE
            [93] => NET_SSH2_MSG_CHANNEL_WINDOW_ADJUST
            [94] => NET_SSH2_MSG_CHANNEL_DATA
            [95] => NET_SSH2_MSG_CHANNEL_EXTENDED_DATA
            [96] => NET_SSH2_MSG_CHANNEL_EOF
            [97] => NET_SSH2_MSG_CHANNEL_CLOSE
            [98] => NET_SSH2_MSG_CHANNEL_REQUEST
            [99] => NET_SSH2_MSG_CHANNEL_SUCCESS
            [100] => NET_SSH2_MSG_CHANNEL_FAILURE
        )

    [disconnect_reasons] => Array
        (
            [1] => NET_SSH2_DISCONNECT_HOST_NOT_ALLOWED_TO_CONNECT
            [2] => NET_SSH2_DISCONNECT_PROTOCOL_ERROR
            [3] => NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED
            [4] => NET_SSH2_DISCONNECT_RESERVED
            [5] => NET_SSH2_DISCONNECT_MAC_ERROR
            [6] => NET_SSH2_DISCONNECT_COMPRESSION_ERROR
            [7] => NET_SSH2_DISCONNECT_SERVICE_NOT_AVAILABLE
            [8] => NET_SSH2_DISCONNECT_PROTOCOL_VERSION_NOT_SUPPORTED
            [9] => NET_SSH2_DISCONNECT_HOST_KEY_NOT_VERIFIABLE
            [10] => NET_SSH2_DISCONNECT_CONNECTION_LOST
            [11] => NET_SSH2_DISCONNECT_BY_APPLICATION
            [12] => NET_SSH2_DISCONNECT_TOO_MANY_CONNECTIONS
            [13] => NET_SSH2_DISCONNECT_AUTH_CANCELLED_BY_USER
            [14] => NET_SSH2_DISCONNECT_NO_MORE_AUTH_METHODS_AVAILABLE
            [15] => NET_SSH2_DISCONNECT_ILLEGAL_USER_NAME
        )

    [channel_open_failure_reasons] => Array
        (
            [1] => NET_SSH2_OPEN_ADMINISTRATIVELY_PROHIBITED
        )

    [terminal_modes] => Array
        (
            [0] => NET_SSH2_TTY_OP_END
        )

    [channel_extended_data_type_codes] => Array
        (
            [1] => NET_SSH2_EXTENDED_DATA_STDERR
        )

    [send_seq_no] => 2
    [get_seq_no] => 1
    [server_channels] => Array
        (
        )

    [channel_buffers] => Array
        (
        )

    [channel_status] => Array
        (
        )

    [packet_size_client_to_server] => Array
        (
        )

    [message_number_log] => Array
        (
            [0] => <-
            [1] => ->
            [2] => -> NET_SSH2_MSG_KEXINIT (since last: 0.0153, network: 0s)
            [3] => <- NET_SSH2_MSG_KEXINIT (since last: 0, network: 0s)
            [4] => -> NET_SSH2_MSG_KEXDH_INIT (since last: 0.0002, network: 0s)
        )

    [message_log] => Array
        (
        )

    [window_size] => 2147483647
    [window_size_server_to_client] => Array
        (
        )

    [window_size_client_to_server] => Array
        (
        )

    [signature] => 
    [signature_format] => 
    [interactiveBuffer] => 
    [log_size] => 
    [timeout] => 10
    [curTimeout] => 9.9907808303833
    [realtime_log_file] => 
    [realtime_log_size] => 
    [signature_validated] => 
    [realtime_log_wrap] => 
    [quiet_mode] => 
    [last_packet] => 1576250527.1748
    [exit_status] => 
    [request_pty] => 
    [in_request_pty_exec] => 
    [in_subsystem] => 
    [stdErrorLog] => 
    [last_interactive_response] => 
    [keyboard_requests_responses] => Array
        (
        )

    [banner_message] => 
    [is_timeout] => 
    [log_boundary] => :
    [log_long_width] => 65
    [log_short_width] => 16
    [host] => xxx.xxx.xxx.xxx
    [port] => 37057
    [windowColumns] => 80
    [windowRows] => 24
    [crypto_engine] => 
    [agent] => 
    [send_id_string_first] => 1
    [send_kex_first] => 1
    [bad_key_size_fix] => 
    [retry_connect] => 
    [binary_packet_buffer] => 
    [preferred_signature_format] => 
    [auth] => Array
        (
            [0] => Array
                (
                    [0] => root_dsi
                    [1] => phpseclib\Crypt\RSA Object
                        (
                            [zero] => phpseclib\Math\BigInteger Object
                                (
                                    [value] => 0x
                                    [engine] => internal (64-bit.OpenSSL)
                                )

                            [one] => phpseclib\Math\BigInteger Object
                                (
                                    [value] => 0x01
                                    [engine] => internal (64-bit.OpenSSL)
                                )

                            [privateKeyFormat] => 0
                            [publicKeyFormat] => 7

[...]
                        )

                )

        )
)
```
Do you have any work around with this ?

Hello, thank you for the wonderful library and all the work you do with phpseclib. 

I am curious about the following case.

When I'm setting timeout for some command like 'ping' it works as expected.

When I'm setting timeout and call 'sleep', command waits the exact number of seconds passed to sleep, instead of respecting the timeout set to SSH2.

The code:

```php
<?php
use phpseclib\Crypt\RSA;
use phpseclib\Net\SSH2;

$key = new RSA();
$key->loadKey(file_get_contents('private-key.txt'));

$ssh = new SSH2('127.0.0.1');
if (!$ssh->login('username', $key)) {
    exit('Login Failed');
}

$ssh->setTimeout(3);

$start = microtime(true);
$ssh->exec('ping google.com');
$elapsed = microtime(true) - $start;

if ($ssh->isTimeout()) {
   echo sprintf('Command timed out in %01.2f seconds', $elapsed);
} else {
   echo sprintf('Command completed in %01.2f seconds', $elapsed);
}
```

The code above returns as expected:

> Command timed out in 3.12 seconds

However:

```php
<?php
use phpseclib\Crypt\RSA;
use phpseclib\Net\SSH2;

$key = new RSA();
$key->loadKey(file_get_contents('private-key.txt'));

$ssh = new SSH2('127.0.0.1');
if (!$ssh->login('username', $key)) {
    exit('Login Failed');
}

$ssh->setTimeout(3);

$start = microtime(true);
$ssh->exec('sleep 10');
$elapsed = microtime(true) - $start;

if ($ssh->isTimeout()) {
   echo sprintf('Command timed out in %01.2f seconds', $elapsed);
} else {
   echo sprintf('Command completed in %01.2f seconds', $elapsed);
}
```
I am expecting the command to time out after 3 seconds. But the second code runs for 10 seconds instead of 3 and outputs

> Command timed out in 10.11 seconds

What am I missing here?
I get the error that's the title of this issue intermittently, other times I do not get the error at all. I'm trying to connect to a JSCAPE SFTP box. It only allows `blowfish-cbc,3des-cbc` which I tried specifying to the wrapper and still have no luck.

OS: OSX Catalina
PHPSecLib: 1.0.18

```PHP 7.4.0 (cli) (built: Nov 29 2019 16:18:44) ( NTS )
Copyright (c) The PHP Group
Zend Engine v3.4.0, Copyright (c) Zend Technologies
    with Zend OPcache v7.4.0, Copyright (c), by Zend Technologies
```

This is the first error I usually get:
```Notice: Error reading from socket in /Users/matthew/Code/docker-build/php/phpseclib1.0.18/Net/SSH2.php on line 3374

Notice: Connection closed by server in /Users/matthew/Code/docker-build/php/phpseclib1.0.18/Net/SSH2.php on line 1556
array(0) {
}
```

This is what I normally get on my third attempt of running the script.
```

Notice: Connection closed by server in /Users/matthew/Code/docker-build/php/phpseclib1.0.18/Net/SSH2.php on line 1556
array(1) {
  [0]=>
  string(88) "SSH_MSG_DISCONNECT: NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED
No common algorithms found."
}
```

This is the code I use.

```
        $sftp = new Net_SFTP("server.host", 22, 60);
        $sftp->setPreferredAlgorithms([
            'client_to_server' => [
                'crypt' => ['blowfish-cbc', '3des-cbc']
            ]
        ]);
        if (!$sftp->login('name', 'pass')) {
            die($sftp->getLog());
        }

```

Here's the full log data.

```Notice: Connection closed by server in /Users/matthew/Code/docker-build/php/phpseclib1.0.18/Net/SSH2.php on line 1556
<-
00000000  53:53:48:2d:32:2e:30:2d:4a:53:43:41:50:45:0d:0a  SSH-2.0-JSCAPE..

->
00000000  53:53:48:2d:32:2e:30:2d:70:68:70:73:65:63:6c:69  SSH-2.0-phpsecli
00000010  62:5f:31:2e:30:20:28:6f:70:65:6e:73:73:6c:2c:20  b_1.0 (openssl, 
00000020  62:63:6d:61:74:68:29:0d:0a                       bcmath)..

-> NET_SSH2_MSG_KEXINIT (since last: 0.0184, network: 0s)
00000000  f4:b3:38:cb:ad:97:b3:24:c4:b4:f0:76:b8:be:9f:0e  ..8....$...v....
00000010  00:00:00:7e:64:69:66:66:69:65:2d:68:65:6c:6c:6d  ...~diffie-hellm
00000020  61:6e:2d:67:72:6f:75:70:2d:65:78:63:68:61:6e:67  an-group-exchang
00000030  65:2d:73:68:61:32:35:36:2c:64:69:66:66:69:65:2d  e-sha256,diffie-
00000040  68:65:6c:6c:6d:61:6e:2d:67:72:6f:75:70:2d:65:78  hellman-group-ex
00000050  63:68:61:6e:67:65:2d:73:68:61:31:2c:64:69:66:66  change-sha1,diff
00000060  69:65:2d:68:65:6c:6c:6d:61:6e:2d:67:72:6f:75:70  ie-hellman-group
00000070  31:34:2d:73:68:61:31:2c:64:69:66:66:69:65:2d:68  14-sha1,diffie-h
00000080  65:6c:6c:6d:61:6e:2d:67:72:6f:75:70:31:2d:73:68  ellman-group1-sh
00000090  61:31:00:00:00:29:72:73:61:2d:73:68:61:32:2d:32  a1...)rsa-sha2-2
000000a0  35:36:2c:72:73:61:2d:73:68:61:32:2d:35:31:32:2c  56,rsa-sha2-512,
000000b0  73:73:68:2d:72:73:61:2c:73:73:68:2d:64:73:73:00  ssh-rsa,ssh-dss.
000000c0  00:00:ff:61:65:73:31:32:38:2d:63:74:72:2c:61:65  ...aes128-ctr,ae
000000d0  73:31:39:32:2d:63:74:72:2c:61:65:73:32:35:36:2d  s192-ctr,aes256-
000000e0  63:74:72:2c:61:65:73:31:32:38:2d:63:62:63:2c:61  ctr,aes128-cbc,a
000000f0  65:73:31:39:32:2d:63:62:63:2c:61:65:73:32:35:36  es192-cbc,aes256
00000100  2d:63:62:63:2c:62:6c:6f:77:66:69:73:68:2d:63:74  -cbc,blowfish-ct
00000110  72:2c:62:6c:6f:77:66:69:73:68:2d:63:62:63:2c:33  r,blowfish-cbc,3
00000120  64:65:73:2d:63:74:72:2c:33:64:65:73:2d:63:62:63  des-ctr,3des-cbc
00000130  2c:61:72:63:66:6f:75:72:32:35:36:2c:61:72:63:66  ,arcfour256,arcf
00000140  6f:75:72:32:35:36:2c:61:72:63:66:6f:75:72:31:32  our256,arcfour12
00000150  38:2c:61:72:63:66:6f:75:72:31:32:38:2c:74:77:6f  8,arcfour128,two
00000160  66:69:73:68:31:32:38:2d:63:74:72:2c:74:77:6f:66  fish128-ctr,twof
00000170  69:73:68:31:39:32:2d:63:74:72:2c:74:77:6f:66:69  ish192-ctr,twofi
00000180  73:68:32:35:36:2d:63:74:72:2c:74:77:6f:66:69:73  sh256-ctr,twofis
00000190  68:31:32:38:2d:63:62:63:2c:74:77:6f:66:69:73:68  h128-cbc,twofish
000001a0  31:39:32:2d:63:62:63:2c:74:77:6f:66:69:73:68:32  192-cbc,twofish2
000001b0  35:36:2d:63:62:63:2c:74:77:6f:66:69:73:68:2d:63  56-cbc,twofish-c
000001c0  62:63:00:00:00:ff:61:65:73:31:32:38:2d:63:74:72  bc....aes128-ctr
000001d0  2c:61:65:73:31:39:32:2d:63:74:72:2c:61:65:73:32  ,aes192-ctr,aes2
000001e0  35:36:2d:63:74:72:2c:61:65:73:31:32:38:2d:63:62  56-ctr,aes128-cb
000001f0  63:2c:61:65:73:31:39:32:2d:63:62:63:2c:61:65:73  c,aes192-cbc,aes
00000200  32:35:36:2d:63:62:63:2c:62:6c:6f:77:66:69:73:68  256-cbc,blowfish
00000210  2d:63:74:72:2c:62:6c:6f:77:66:69:73:68:2d:63:62  -ctr,blowfish-cb
00000220  63:2c:33:64:65:73:2d:63:74:72:2c:33:64:65:73:2d  c,3des-ctr,3des-
00000230  63:62:63:2c:61:72:63:66:6f:75:72:32:35:36:2c:61  cbc,arcfour256,a
00000240  72:63:66:6f:75:72:32:35:36:2c:61:72:63:66:6f:75  rcfour256,arcfou
00000250  72:31:32:38:2c:61:72:63:66:6f:75:72:31:32:38:2c  r128,arcfour128,
00000260  74:77:6f:66:69:73:68:31:32:38:2d:63:74:72:2c:74  twofish128-ctr,t
00000270  77:6f:66:69:73:68:31:39:32:2d:63:74:72:2c:74:77  wofish192-ctr,tw
00000280  6f:66:69:73:68:32:35:36:2d:63:74:72:2c:74:77:6f  ofish256-ctr,two
00000290  66:69:73:68:31:32:38:2d:63:62:63:2c:74:77:6f:66  fish128-cbc,twof
000002a0  69:73:68:31:39:32:2d:63:62:63:2c:74:77:6f:66:69  ish192-cbc,twofi
000002b0  73:68:32:35:36:2d:63:62:63:2c:74:77:6f:66:69:73  sh256-cbc,twofis
000002c0  68:2d:63:62:63:00:00:00:39:68:6d:61:63:2d:73:68  h-cbc...9hmac-sh
000002d0  61:32:2d:32:35:36:2c:68:6d:61:63:2d:73:68:61:31  a2-256,hmac-sha1
000002e0  2d:39:36:2c:68:6d:61:63:2d:73:68:61:31:2c:68:6d  -96,hmac-sha1,hm
000002f0  61:63:2d:6d:64:35:2d:39:36:2c:68:6d:61:63:2d:6d  ac-md5-96,hmac-m
00000300  64:35:00:00:00:39:68:6d:61:63:2d:73:68:61:32:2d  d5...9hmac-sha2-
00000310  32:35:36:2c:68:6d:61:63:2d:73:68:61:31:2d:39:36  256,hmac-sha1-96
00000320  2c:68:6d:61:63:2d:73:68:61:31:2c:68:6d:61:63:2d  ,hmac-sha1,hmac-
00000330  6d:64:35:2d:39:36:2c:68:6d:61:63:2d:6d:64:35:00  md5-96,hmac-md5.
00000340  00:00:04:6e:6f:6e:65:00:00:00:04:6e:6f:6e:65:00  ...none....none.
00000350  00:00:00:00:00:00:00:00:00:00:00:00              ............

<- NET_SSH2_MSG_KEXINIT (since last: 0.0001, network: 0s)
00000000  b4:2a:bb:19:eb:c3:61:4c:7c:10:3c:f7:4c:bb:9a:9f  .*....aL|...L...
00000010  00:00:00:63:64:69:66:66:69:65:2d:68:65:6c:6c:6d  ...cdiffie-hellm
00000020  61:6e:2d:67:72:6f:75:70:31:34:2d:73:68:61:31:2c  an-group14-sha1,
00000030  64:69:66:66:69:65:2d:68:65:6c:6c:6d:61:6e:2d:67  diffie-hellman-g
00000040  72:6f:75:70:2d:65:78:63:68:61:6e:67:65:2d:73:68  roup-exchange-sh
00000050  61:31:2c:64:69:66:66:69:65:2d:68:65:6c:6c:6d:61  a1,diffie-hellma
00000060  6e:2d:67:72:6f:75:70:2d:65:78:63:68:61:6e:67:65  n-group-exchange
00000070  2d:73:68:61:32:35:36:00:00:00:07:73:73:68:2d:72  -sha256....ssh-r
00000080  73:61:00:00:00:15:62:6c:6f:77:66:69:73:68:2d:63  sa....blowfish-c
00000090  62:63:2c:33:64:65:73:2d:63:62:63:00:00:00:15:62  bc,3des-cbc....b
000000a0  6c:6f:77:66:69:73:68:2d:63:62:63:2c:33:64:65:73  lowfish-cbc,3des
000000b0  2d:63:62:63:00:00:00:12:68:6d:61:63:2d:73:68:61  -cbc....hmac-sha
000000c0  31:2c:68:6d:61:63:2d:6d:64:35:00:00:00:12:68:6d  1,hmac-md5....hm
000000d0  61:63:2d:73:68:61:31:2c:68:6d:61:63:2d:6d:64:35  ac-sha1,hmac-md5
000000e0  00:00:00:04:7a:6c:69:62:00:00:00:04:7a:6c:69:62  ....zlib....zlib
000000f0  00:00:00:00:00:00:00:00:00:00:00:00:00           .............

-> UNKNOWN (34) (since last: 0.0001, network: 0s)
00000000  00:00:06:00:00:00:08:00:00:00:10:00              ............

<- NET_SSH2_MSG_DISCONNECT (since last: 0.0033, network: 0.0033s)
00000000  00:00:00:03:00:00:00:1b:4e:6f:20:63:6f:6d:6d:6f  ........No commo
00000010  6e:20:61:6c:67:6f:72:69:74:68:6d:73:20:66:6f:75  n algorithms fou
00000020  6e:64:2e:00:00:00:02:65:6e                       nd.....en
```

Any idea what could be the issue? I know I get an error when doing 
`sftp user@host` but when I run `sftp -c 3des-cbc user@host` it works fine. 
v. 2.0.23

in case of some relatively slow sftp server it's possible to encounter connection timeout, happens randomly on different commands (I had it for rawlist() for some directories) and sometimes it's hard to provide reasonable timeout as third parameter in ```new SFTP()```
but resulting error doesn't provide any meaningful info, i.e. 
```
Expected SSH_FXP_HANDLE or SSH_FXP_STATUS in vendor/phpseclib/phpseclib/phpseclib/Net/SFTP.php on line 939
```
is raised 

and while there is isTimeout(), it's not always possible to access instance directly (third party library calls phpseclib) so it would be great to have some more detailed error, i.e. "command/server timeout" or some like it 

OS: CentOS 7
PHP Version: 7.2.24
phpseclib Version: 2.0.23

I'm trying to connect to our VPN Gateway via SSH2 to automate our VPN configuration. I'm already using the same setup from the same server to connect to another CentOS machine which is working fine.

When I started on this the project was still running an older version of phpseclib but the error didn't change after updating it.

The app throws the error on the exec() call but does actually execute the command before it dies.
Here is my code:
```
$ssh = new SSH2($this->host);
        if (!$ssh->login($this->usr, $this->pwd)) {
            throw new Exception('authentication failed');
        }

        define('NET_SSH2_LOGGING', SSH2::LOG_COMPLEX);

        $ssh->exec("cd /");

        $ssh->getLog();

        $ssh->disconnect();
```
Result:
`PHP Notice:  Connection closed prematurely in .../vendor/phpseclib/phpseclib/phpseclib/Net/SSH2.php on line 3901`


This is what I get when I log the connection:
```
-> NET_SSH2_MSG_CHANNEL_OPEN (since last: 32.8881, network: 0.0001s)\r\n
00000000  00:00:00:07:73:65:73:73:69:6f:6e:00:00:00:01:7f  ....session.....\r\n
00000010  ff:ff:ff:00:00:40:00                             .....@.\r\n
\r\n
<- NET_SSH2_MSG_CHANNEL_OPEN_CONFIRMATION (since last: 0.0005, network: 0.0001s)\r\n
00000000  00:00:00:01:00:00:00:01:00:00:ff:00:00:00:40:00  ..............@.\r\n
\r\n
-> NET_SSH2_MSG_CHANNEL_REQUEST (since last: 0.0003, network: 0.0001s)\r\n
00000000  00:00:00:01:00:00:00:04:65:78:65:63:01:00:00:00  ........exec....\r\n
00000010  04:63:64:20:2f                                   .cd /\r\n
\r\n
<- NET_SSH2_MSG_CHANNEL_SUCCESS (since last: 0.0018, network: 0.0001s)\r\n
00000000  00:00:00:01                                      ....\r\n
\r\n
<- NET_SSH2_MSG_CHANNEL_REQUEST (since last: 0.0403, network: 0.0001s)\r\n
00000000  00:00:00:01:00:00:00:0b:65:78:69:74:2d:73:74:61  ........exit-sta\r\n
00000010  74:75:73:00:00:00:00:00                          tus.....\r\n
\r\n
<- NET_SSH2_MSG_CHANNEL_EOF (since last: 0.0001, network: 0s)\r\n
00000000  00:00:00:01                                      ....\r\n
\r\n
<- NET_SSH2_MSG_CHANNEL_CLOSE (since last: 0.0001, network: 0s)\r\n
00000000  00:00:00:01                                      ....\r\n
\r\n
```

Is there anything I can do to make it work properly or is the SSH Server on our VPN Gateway just not behaving correctly?
Hi guys, i have this error that gonna make me crazy ,

the crazy part about this is sometimes my code work normal,  some throw to me this error telling me that is connection closed by server 

ps : i can log to my remote server normally without any issue
i'm using the last release v2

here is my log 

```
{
    "message": "Connection closed by server",
    "exception": "ErrorException",
    "file": "/var/dms/vendor/phpseclib/phpseclib/phpseclib/Net/SSH2.php",
    "line": 1228,
    "trace": [
        {
            "function": "handleError",
            "class": "Illuminate\\Foundation\\Bootstrap\\HandleExceptions",
            "type": "->"
        },
        {
            "file": "/var/dms/vendor/phpseclib/phpseclib/phpseclib/Net/SSH2.php",
            "line": 1228,
            "function": "user_error"
        },
        {
            "file": "/var/dms/vendor/phpseclib/phpseclib/phpseclib/Net/SSH2.php",
            "line": 2101,
            "function": "_connect",
            "class": "phpseclib\\Net\\SSH2",
            "type": "->"
        },
        {
            "function": "_login",
            "class": "phpseclib\\Net\\SSH2",
            "type": "->"
        },
        {
            "file": "/var/dms/vendor/phpseclib/phpseclib/phpseclib/Net/SFTP.php",
            "line": 414,
            "function": "call_user_func_array"
        },
        {
            "file": "/var/dms/app/Libraries/Ssh.php",
            "line": 59,
            "function": "login",
            "class": "phpseclib\\Net\\SFTP",
            "type": "->"
        },
        {
            "file": "/var/dms/app/Http/Controllers/user/PmtaController.php",
            "line": 61,
            "function": "connect",
            "class": "app\\Libraries\\Ssh",
            "type": "->"
        },
        ...
    ]
}
```
My code

```
$ssh = new Ssh($server->ip, $server->username, $server->password, $server->login_type, $server->port);
if (!$ssh->connect()) {
                    return response()->json(['status' => FALSE, 'data' => 'ERROR AUTH', 'id' => $request->id]);
}
$result = $ssh->exec("pmta pause queue {$vmta};");

```
ssh class
```
public function __construct($ip, $username, $password, $login_type, $port = 22, $id = null, $domain = null)
{
        $this->id = $id;
        $this->ip = $ip;
        $this->port = $port;
        $this->username = $username;
        $this->password = $password;
        $this->login_type = strtolower($login_type);
        $this->domain = $domain;
}
public function connect()
    {
        $key = null;
        $this->ssh = new SFTP($this->ip, $this->port);

        if($this->login_type == "password"){
            $key = $this->password;
        } else {
            $key = new RSA();
            $key->loadKey($this->password);
        }
        if($this->ssh->login($this->username, $key))
        {
           return true;
        }
        return false;
    }

    public function exec($command)
    {
        if($this->ssh->isConnected() && $this->ssh->isAuthenticated()) {
            return $this->ssh->exec($command);
        }
        return false;
    }
```

any suggestion please ?


My RSA public/private key has this format:

```
<RSAKeyValue>
<Modulus>tCZiqDS5BVQQZDBUYbyeoP4rENN4mX5FZJjjMNfGbyzfzH45RY2/YsMaY0yI1jMCOpukvkUyl153tcn0LXhMCDdsEhhZPoKbPUGMniKtFGjs18rv/b5FFUUW1utgwoL8+WJqjOqhQGgvbja63X9+WMFP0nM3d8yudn9C/X55KyM=</Modulus>
    <Exponent>AQAB</Exponent>    <P>5HXvmU4IfqUG2jFLSqi/BMEQ3x1NsUDvx3zN5O1p9yLLspJ4sqAt4RUkxzcGodYgBSdXsR9IGcPwjQfbx3a7nQ==</P>    <Q>yd2hDCF/5Zqtz9DXjY1NRYGvBjTS4AQn83ERR46Y5eBSnLjpVjv6gPfARuhsUP44nikrQPvwPnjxQcOhJaOlvw==</Q>    <DP>ztuqUplBP8qU5cN0dOlN7DQT3rFdw30Unv/2Pa5qIAc1gT72YmZ+pCrM3kSIkMicvY3d7NZyJkIv8MKI0ZZEUQ==</DP> <DQ>QFLJ5YarLWubZPQEK4vSCornTY/5ff51CIKH4ghTOjS/vkbBu4PDL+NCNpYLJcfMHMG7kap2BEIfhjgjGk5KGw==</DQ>   <InverseQ>WE6TqpcexQJwt9Mnp1FbeLtarBcFkXVdBauouFKHcbHCfQjA3IjUrGTxgSO74O/4QSKqaF2gnlL6GI7gKuGbzQ==</InverseQ>  <D>czYtWDfHsFGv3fNOs+cGaB3E+xDTiw7HYGuquJz2qjk/s69x/zqFEKuIH8Ndq+eZYFQUCx+EGGxxENDkmYPa0z8wbfFI6JEHpxaLmQfpkkbSL1BJIp9Z5BNM2gy6jJqgbWwQPcN/4jpiMefHZWAqhMKqenUu1KIq1ZX6Bz5xKYk=</D>
</RSAKeyValue>
```

And I use this code to get public/provate key from it:

```php
public function __construct($xmlRsakey=null,$type=null)
 {
         $xmlObj = null;
         if ($xmlRsakey==null) {
             $xmlObj = simplexml_load_file("xmlfile/RSAKey.xml");
          } elseif ($type==RSAKeyType::XMLFile) {
             $xmlObj = simplexml_load_file($xmlRsakey);
          } else {
             $xmlObj = simplexml_load_string($xmlRsakey);
          }
         $this->modulus = RSA::binary_to_number(base64_decode($xmlObj->Modulus));
         $this->public_key = RSA::binary_to_number(base64_decode($xmlObj->Exponent));
         $this->private_key = RSA::binary_to_number(base64_decode($xmlObj->D));
         $this->key_length = strlen(base64_decode($xmlObj->Modulus))*8;
 }
 public function getPublicKey() {
  return $this->public_key;
 }
 public function getPrivateKey() {
  return $this->private_key;
 }
```

It seems this public/private key I am getting this way, is incompatible with your code so I cannot use your code to sign data. Is there a way to convert this xml file to something compatible to your code?

Hi,

I'm trying to pull a file from a different server using SFTP but I keep getting "No compatible key exchange algorithms found" errorExeption whenever I try to connect. I'm currently using Laravel 5. 8 in a CentOS Redhat server.

Thank you.