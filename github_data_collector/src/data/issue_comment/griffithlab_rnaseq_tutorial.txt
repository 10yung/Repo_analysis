Hi,
I just quantified RNA-Seq reads generated with a Oxford Nanopore MinION sequencing device using kallisto 0.46.0. The est_counts reflected well the number of reads I observed for some example genes but I was wondering if the tpm calculation is using the read length parameter. Since each nanopore read should more or less represent a whole transcript, then incorporating a fixed read length in TPM estimation would lead to wrong results, right?

Regards,
Markus  
I am new to RNA seq data analysis. I have followed hisat2,stringtie and ballgown pipeline. I have created the list of genes by following all steps mentioned in the paper protocol. list of genes created by step number 15. This list contains all differential expressed genes present in all samples. and this list did not contain any identifier which tells me this gene belong to this sample. My question is that  how can I identify a number of differentially expressed genes belong to one sample. here mine gene list file.
`

feature | id | fc | pval | qval
-- | -- | -- | -- | --
gene | MSTRG.28632 | 0.34122 | 1.95E-05 | 0.176761
gene | MSTRG.3615 | 5.155727 | 2.21E-05 | 0.176761
gene | MSTRG.7507 | 0.251907 | 2.22E-05 | 0.176761
gene | MSTRG.70532 | 0.318647 | 2.42E-05 | 0.176761

`
same case with the trancript file 
`

geneNames | geneIDs | geneNames.1 | geneIDs.1 | feature | id | fc | pval | qval |  
-- | -- | -- | -- | -- | -- | -- | -- | -- | --
. | MSTRG.165 | . | MSTRG.37909 | transcript | 94562 | 7.209395 | 6.37E-07 | 0.029347 |  
. | MSTRG.165 | . | MSTRG.26699 | transcript | 66342 | 0.095091 | 9.80E-06 | 0.117421 |  
. | MSTRG.166 | . | MSTRG.11475 | transcript | 28435 | 3.41491 | 1.17E-05 | 0.117421 |  
. | MSTRG.170 | . | MSTRG.17454 | transcript | 42831 | 16.80033 | 1.22E-05 | 0.117421 |  
. | MSTRG.173 | . | MSTRG.1249 | transcript | 3256 | 0.076575 | 1.85E-05 | 0.117421 |  

`
next question is that how can i change the gene id in these above file into ensembl format to get   gene ontology?
I  did the tutorial, typically, as it is. I used the same tools versions, but I have 2 main problems in DE visualisation.

The distribution plot of UHR vs HBR, shows a less number of genes, and the labelled genes are not the real 25 top genes of probability values.
but, when I look to my UHR_vs_HBR_gene_results_sig.tsv, I have about 310 genes, the top 25 genes (I attached the plots PDFs)
are:
IGLC3
MPPED1
PRAME
IGLV2-23
CDC45
APOBEC3B
PLA2G3
SHANK3
RP5-1119A7.17
CACNA1I
ATF4
IGLV2-14
KDELR3
ERCC-00004
Sep-03
LA16c-3G11.7
SYNGR1
MYO18B
ERCC-00002
GNAZ
MLC1
MAPK8IP2
ERCC-00130
TEF

[Tutorial_Part3_Supplementary_R_output.pdf](https://github.com/griffithlab/rnaseq_tutorial/files/2542324/Tutorial_Part3_Supplementary_R_output.pdf)
[outfile.pdf](https://github.com/griffithlab/rnaseq_tutorial/files/2542325/outfile.pdf)



Hi there,

I followed the tutorial to align RNAseq PE reads.
I found both --rna-strandness FR and RF produced the same results and they are also the same as the results  generated by ignoring strans-specificity.

Just wonder why is this.

Thanks heaps in advance for your help.

Huanlee
Hi,

I have a couple of questions about dUTP method generated RNAseq data.
Do you thinks it has the same strand specificity as 'TruSeq Strand Specific Total RNA'?

I found this piece of code from 'Trinity-v2.6.5/util/align_and_estimate_abundance.pl'
'''
if ($SS_lib_type) {
        # add strand-specific options for kallisto
        **my $kallisto_ss_opt = ($SS_lib_type =~ /^R/) ? "--rf-stranded" : "--fr-stranded";**
        if ($kallisto_add_opts !~ /$kallisto_ss_opt/) {
            $kallisto_add_opts .= " $kallisto_add_opts";
        }
    }
'''

Which means Trinity --SS_lib_type RF is equal to kallisto quant --rf-stranded.
Do you think it is correct?

Many thanks.

Huanlee
I am trying to follow the tutorial, but I cannot get past the "expression" section.

In particular, when I try to get the expression matrix with `./stringtie_expression_matrix.pl` , I get a compilation error:

` ./stringtie_expression_matrix.pl --expression_metric=TPM --result_dirs='HBR_Rep1,HBR_Rep2,HBR_Rep3,UHR_Rep1,UHR_Rep2,UHR_Rep3' --transcript_matrix_file=transcript_tpm_all_samples.tsv --gene_matrix_file=gene_tpm_all_samples.tsv
`


`
Type of arg 1 to keys must be hash (not private array) at ./stringtie_expression_matrix.pl line 49, near "@sample_list;"
Execution of ./stringtie_expression_matrix.pl aborted due to compilation errors.
` 

I am not really an expert in PERL, so I am having some problems troubleshooting the code, but it seems that `sample_list` is not a hash (well, it says that in the error...).

How do I solve this?
I'm getting a couple errors when trying to run HISAT2

my input is $hisat2 -p 8 --dta -x index {-1 input1_1,input2_1 -2 input1_2,input2_1} -S [output.sam]

but I keep getting the error message: (ERR): Different number of files specified with --reads/-1 as with -2

Any help would be much appreciated. 
I think that this tutorial could use a module on normalizing the gene/transcript expression estimates provided by stringtie, before differential expression estimation.
Hi, I'm experiencing errors when running the hisat2 to generate sam files.
`hisat2 -p 8 --rg-id=UHR_Rep2 --rg SM:UHR --rg LB:UHR_Rep2_ERCC-Mix1 --rg PL:ILLUMINA --rg PU:CXX1234-TGACAC.1 -x $RNA_REF_INDEX --dta --rna-strandness RF -1 $RNA_DATA_DIR/UHR_Rep2_ERCC-Mix1_Build37-ErccTranscripts-chr22.read1.fastq.gz -2 $RNA_DATA_DIR/UHR_Rep2_ERCC-Mix1_Build37-ErccTranscripts-chr22.read2.fastq.gz -S ./UHR_Rep2.sam
Warning: the current version of HISAT2 (2.0.4) is older than the version (2.167.69) used to build the index.
         Users are strongly recommended to update HISAT2 to the latest version.
Error reading block of _offs[] array: 0, 2097152
Error: Encountered internal HISAT2 exception (#1)
Command: /home/ubuntu/workspace/rna_seq/tools/hisat2-2.0.4/hisat2-align-s --wrapper basic-0 -p 8 --rg-id=UHR_Rep2 --rg SM:UHR --rg LB:UHR_Rep2_ERCC-Mix1 --rg PL:ILLUMINA --rg PU:CXX1234-TGACAC.1 -x /home/ubuntu/workspace/rna_seq/reference_genome/chr22_with_ERCC92 --dta --rna-strandness RF -S ./UHR_Rep2.sam -1 /tmp/1602.inpipe1 -2 /tmp/1602.inpipe2 
(ERR): hisat2-align exited with value 1`

Any idea what caused it?
Create a mapping file, output a final list of DE gene names, create a mapping to gene name in R and use gene names as symbols in final figures.