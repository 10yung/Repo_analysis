å¦‚å›¾, è™½ç„¶è®¾ç½®çš„æ˜¯é»˜è®¤5åˆ†é’Ÿçš„ä¸ŠæŠ¥é—´éš”, ä½†æ•°æ®åº“ä¸­2:10åˆ°2:35ä¸­é—´éƒ½æ²¡æœ‰ä¸ŠæŠ¥, 2:55ä¹Ÿæ²¡æœ‰ä¸ŠæŠ¥.
![å›¾ç‰‡](https://user-images.githubusercontent.com/19394320/72677480-d25e5a80-3ad7-11ea-88e9-15e3c9b70ae5.png)
![å›¾ç‰‡](https://user-images.githubusercontent.com/19394320/72677514-236e4e80-3ad8-11ea-8f42-303379406316.png)  
è¯·é—®ä¸ŠæŠ¥æ—¶é—´é™¤äº†é…ç½®é‡Œè®¾ç½®çš„insertInterval, è¿˜ç”±ä»€ä¹ˆå…¶ä»–å› ç´ å†³å®šå—?






### What language are you using?
 
 
### What operating system (Linux, Ubuntu, â€¦) and version?
 
 
### What runtime / compiler are you using (e.g. jdk version or version of gcc)
 
 
Make sure you include information that can help us debug (full error message, exception listing, stack trace, logs).


### What language are you using?
 c++å’Œjava
 
### What operating system (Linux, Ubuntu, â€¦) and version?
 centos
 
å¯¹äºtarsç»“æ„ä½“å®šä¹‰åœ¨è§£åŒ…æ—¶ï¼Œc++ä¸javaä¸­çš„boolå‹é»˜è®¤å€¼ï¼Œå‰è€…æ˜¯true,åè€…å´æ˜¯falseï¼Œ
åŒæ—¶c++åœ¨åºåˆ—åŒ–æ—¶é»˜è®¤å€¼å­—æ®µæ˜¯ä¸æ‰“åŒ…çš„ï¼Œå¯¼è‡´javaä¸­è§£åŒ…å‡ºæ¥çš„boolå‹å­—æ®µå€¼é”™è¯¯ï¼Œè¿™æ˜¯ä¸€ä¸ªéšæ‚£ï¼Œå»ºè®®åç»­ç‰ˆæœ¬èƒ½ç»Ÿä¸€ã€‚


```
# ä¸€é”®æ‰§è¡ŒğŸ‘‡
curl -s https://raw.githubusercontent.com/Jamlee/download/master/tars-build.sh | sudo sh
```

### 1. å†…å®¹æ¦‚è¿°
åœ¨dockerä¸­å®‰è£…gccç­‰æ„å»ºå·¥å…·ï¼Œç”¨ docker in docker çš„æ–¹å¼æ‰“åŒ… tars çš„dockeréƒ¨ç½²æ–‡ä»¶ã€‚ç‰¹ç‚¹å¦‚ä¸‹ï¼š

1. ä½¿ç”¨ yum å®‰è£…çš„mysqlè¿›è¡Œç¼–è¯‘ï¼Œæ— éœ€ç¼–è¯‘mysqlï¼Œèƒ½å¤ŸèŠ‚çœç¼–è¯‘ä¸€ç‚¹æ—¶é—´ã€‚mysqlç”¨å®¹å™¨çš„æ–¹å¼å®‰è£…ã€‚
2. å‚»ç“œå¼ä¸€é”®æ“ä½œï¼Œ**æ— éœ€å…ˆçˆ¬æ–‡æ¡£**å³å¯å¿«é€Ÿä½“éªŒ tarsã€‚
3. è„šæœ¬å³æ–‡æ¡£ï¼ŒæŸ¥çœ‹è„šæœ¬äº†è§£æ•´ä¸ªç¼–è¯‘è¿‡ç¨‹


### 2. ç³»ç»Ÿå‡†å¤‡

æ“ä½œç³»ç»Ÿ: ubuntu1604/1804, centos7(centosæš‚æœªæµ‹è¯•ï¼‰
Docker: 18 æˆ–è€… 19
 
### 3. ä¸€é”®è¿è¡Œ
å°†ä¸‹é¢è„šæœ¬å­˜å‚¨ä¸º build.sh, ç„¶åæ‰§è¡Œ

1.20191109ç¬¬äºŒæ¬¡ä¿®æ”¹

 ```
# ä¿®æ”¹dockeré…ç½®
sudo cp /lib/systemd/system/docker.service /etc/systemd/system  \
   && sudo sed -i 's/\ -H\ fd:\/\// -H\ unix:\/\/\/var\/run\/docker.sock -H tcp:\/\/0.0.0.0\ /g' /etc/systemd/system/docker.service \
   && sudo systemctl daemon-reload && sudo service docker restart

# å†™å…¥dockerfile
cat <<EOF >Dockerfile
FROM centos:7.5.1804 as builder

ENV DOCKER_HOST="tcp://0.0.0.0:2375"
RUN curl -s -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.cloud.tencent.com/repo/centos7_base.repo
RUN sed  -i 's/enabled\=1/enabled\=0/g' /etc/yum/pluginconf.d/fastestmirror.conf \
   && sed  -i 's/enabled\=1/enabled\=0/g' /etc/yum/pluginconf.d/ovl.conf \
   && yum makecache
RUN yum -y install git
RUN mkdir -p /usr/local/tars/cpp/deploy && git clone https://github.com/TarsCloud/TarsWeb.git  /usr/local/tars/cpp/deploy/web
RUN mkdir -p /app && git clone https://github.com/TarsCloud/TarsFramework.git --recursive /app/Tars

RUN rpm --rebuilddb && yum -y install wget make gcc gcc-c++ cmake yasm glibc-devel flex bison ncurses-devel zlib-devel autoconf net-tools
RUN wget -i -c http://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm \
   && yum -y install mysql57-community-release-el7-10.noarch.rpm \
   && yum -y install  mysql-devel mysql-community-client
RUN yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
RUN yum install docker-ce-cli  -y
RUN mkdir /usr/local/mysql && ln -sf /lib64/mysql /usr/local/mysql/lib && ln -sf /usr/include/mysql  /usr/local/mysql/include

# compile tars
RUN cd /app/Tars/build && ./build.sh prepare && ./build.sh all && ./build.sh install
RUN cd /usr/local/tars/cpp/deploy \
  && echo 'RUN cd \${TARS_INSTALL}/web && . /root/.bashrc && npm --registry https://registry.npm.taobao.org install --quiet' >> Dockerfile \
  && sh docker.sh v1
EOF

# å¼€å§‹æ„å»º
docker build --network host -t tar:build .
```
 
### æœ€ç»ˆç»“æœæˆªå›¾
 
![image](https://user-images.githubusercontent.com/5196641/68483270-33ff7e80-0276-11ea-86e1-6a08a46d80bd.png)

 æœ€è¿‘æ›´æ–°çš„ç¼–è¯‘è„šæœ¬å¾ˆæ£’å¾ˆæ–¹ä¾¿è€¶ï¼å‰å®³äº†æ£’æ£’çš„tars å›¢é˜Ÿ

å¯åŠ¨ç¼–è¯‘å‡ºæ¥çš„é•œåƒï¼š
```
# æ—¶åŒºéœ€è¦é…ç½®æ­£ç¡®
docker run -d -p3306:3306 -e MYSQL_ROOT_PASSWORD=456677 -v /etc/localtime:/etc/localtime:ro mysql:5.6

# æ³¨æ„ä½ çš„ç½‘å¡æ˜¯ä¸æ˜¯eth0, åƒen3s0 éœ€è¦æŠŠæ”¹æˆ -eINET=en3s0 
docker run -d --net=host -e MYSQL_HOST=192.168.33.10 -e MYSQL_ROOT_PASSWORD=456677  -v /etc/localtime:/etc/localtime:ro -eREBUILD=false -eINET=eth0 -eSLAVE=false -v/data/log/app_log:/usr/local/app/tars/app_log  -v/data/log/web_log:/usr/local/app/web/log  -v/data/patchs:/usr/local/app/patchs  tars-docker:v1 /root/tars-install/docker-init.sh
```

![image](https://user-images.githubusercontent.com/5196641/68486268-b63e7180-027b-11ea-8705-fe379b520f0d.png)

åœ¨å®‰è£…æ–‡æ¡£ä¸­çš„ï¼ŒMySQLçš„æºç å®‰è£…æ–¹å¼ä¸­ï¼Œè¿˜å­˜åœ¨rm -rf /usr/local/mysql/dataç­‰åˆ é™¤æ•°æ®åº“æ•°æ®çš„ä¸å®‰å…¨è¯­å¥ï¼Œéœ€è¦ä¿®æ”¹
yum install perl
cd /usr/local/mysql
useradd mysql
rm -rf /usr/local/mysql/data
mkdir -p /data/mysql-data
ln -s /data/mysql-data /usr/local/mysql/data
chown -R mysql:mysql /data/mysql-data /usr/local/mysql/data
cp support-files/mysql.server /etc/init.d/mysql
**å¦‚æœ/etc/ç›®å½•ä¸‹æœ‰my.cnfå­˜åœ¨ï¼Œéœ€è¦æŠŠè¿™ä¸ªé…ç½®åˆ é™¤äº†**
rm -rf /etc/my.cnf
yum install -y perl-Module-Install.noarch
perl scripts/mysql_install_db --user=mysql
vim /usr/local/mysql/my.cnf
è‡ªå®šä¹‰ä¸ŠæŠ¥ä¿¡æ¯å·²ç»å†™å…¥MySQLåº“é‡Œäº†
![å›¾ç‰‡](https://user-images.githubusercontent.com/35215878/65748454-8fe2cd80-e136-11e9-8a50-86989e0a7923.png)
ä½†æ˜¯ç®¡ç†å¹³å°ä¸Šæ€ä¹ˆæŸ¥çœ‹è¿™äº›ä¸ŠæŠ¥ä¿¡æ¯ï¼Ÿ
æˆ‘çš„æœåŠ¡EchoServerï¼ˆä¸ŠæŠ¥çš„æœåŠ¡ï¼‰ã€tarspropertyã€tarsstatéƒ½çœ‹ä¸åˆ°ï¼Œè¯¥æ€ä¹ˆè¿‡æ»¤å‡ºè¿™äº›è‡ªå®šä¹‰ä¸ŠæŠ¥çš„ä¿¡æ¯ï¼Ÿ
![å›¾ç‰‡](https://user-images.githubusercontent.com/35215878/65748523-c15b9900-e136-11e9-8ad9-476a7138bff3.png)

### What language are you using?
 php
 
### What operating system (Linux, Ubuntu, â€¦) and version?
 linux

Make sure you include information that can help us debug (full error message, exception listing, stack trace, logs).

æ¯æ¬¡é‡å¯æœåŠ¡åä¸€ä¼šå„¿ï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼Œä¼šæ‰“å°ï¼š
tars_logger.ERROR: Tars\core\{closure} All workers are not alive any more. [] []
ä½†æ˜¯æœåŠ¡æ˜¯æ­£å¸¸çš„ï¼Œèƒ½è®¿é—®ï¼Œä¸ºä»€ä¹ˆè¿˜ä¼šæç¤ºè¿™ä¸ªå‘¢
dotnetcoreç°åœ¨å·²ç»å¾ˆæˆç†Ÿç¨³å®šäº†ã€‚ç›®å‰æ˜¯2.2ç‰ˆæœ¬ï¼Œå¾ˆå¿«ä¼šå‡º3.0ç‰ˆæœ¬ã€‚ç°åœ¨å¾ˆå¤šå…¬å¸å·²ç»åœ¨ç”Ÿäº§ç¯å¢ƒå¤§é‡ä½¿ç”¨dotnetcoreã€‚
### What language are you using?
 
 
### What operating system (Linux, Ubuntu, â€¦) and version?
 
 
### What runtime / compiler are you using (e.g. jdk version or version of gcc)
 
 
Make sure you include information that can help us debug (full error message, exception listing, stack trace, logs).

