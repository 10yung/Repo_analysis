
Use [CodeLingo](https://codelingo.io) to automatically fix function comments following the
[Code Review Comments guidelines](https://github.com/golang/go/wiki/CodeReviewComments#error-strings).

This patch was generated by running the CodeLingo Rewrite Flow over the "[go-error-fmt](https://github.com/codelingo/codelingo/blob/master/tenets/codelingo/code-review-comments/go-error-fmt/codelingo.yaml)" Tenet. Note: the same Tenet can be used to automate PR reviews and generate contributor docs.

[Install CodeLingo to drive Continuous Higher Standards](https://github.com/apps/codelingo)

[Learn about CodeLingo](https://codelingo.io)

Not sure if it's possible to initialize dlite without being ask interactively like passing options with flag or something

```bash
$ ./dlite init
Virtual machine hostname [local.docker]:
Disk size (in gigabytes) [20]:
CPU cores to allocate to VM [2]:
Memory to allocate to VM (in gigabytes) [2]:
DNS server [192.168.64.1]:
Docker version [latest]: 17.03.1-ce
Extra flags to pass to the docker daemon:
Allow direct connections to containers [yes]:
```

## Bug Reports

### dlite version:

2.0.0-beta9 (dlite-os version 1.0.0-beta3)

### expected behavior:

The time should be kept in sync with the MacOS time also when the Mac has been in sleep mode.

### actual behavior:

If you let your Mac sleep the time inside the dlite os will not be insync when the Mac comes back from sleep.

### steps to reproduce

Start dlite. Put you Mac to sleep. Wake it up after a noticeable time and observe the time.

When you keep dlite running for days or weeks and you put your MacBook to sleep during nights or weekends the time will be increasingly more off.

Today (2017-04-11) the time in dlite was only at (2017-04-02). Containers inherit the date from dlite-os and I ran into problems (a container contacted a webservice but failed because it was presented with a TLS-certificate from "the future").
I am trying to run ELK from the sebp/elk image, but I am having trouble setting sysctl -w vm.map_max_count in dlite.

It works with release 1.1.4, but not with 2.0.0-beta9

## Bug Reports

- dlite version in use (run `dlite --version`): dlite version 2.0.0-beta9

- expected behavior: vm.max_map_count should equal 262144 in the container.

- actual behavior: vm.max_map_count equals 65530 in the container

- steps to reproduce
Init dlite with 4g memory (the memory is strictly not necessary)
$ ssh local.docker
$ sudo sysctl -w vm.max_map_count=262144
 vm.max_map_count=262144

Or set vm.max_map_count=262144 in /etc/sysctl.conf and run sysctl -p

$ git clone git@github.com:CarstenHoyer/dlite-issue.git
$ cd dlite-issue
$ docker-compose up

Notice vm.max_map_count in the output from the container.




## Feature Requests

If possible, please explain why this is working in dlite 1.1.4 but not in the latest 2.x release
Or even better - make a fix for it :)

## Feature Requests

Are the build dependencies in the README still correct? The qcow packages do not build on macOS 10.12.3:

```
=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=  üê´
Processing  2/2: [qcow: ocaml build] [qcow-format: make]
[ERROR] The compilation of qcow-format failed at "make PREFIX=/Users/shawnduncan/.opam/system".
[ERROR] The compilation of qcow failed at "ocaml pkg/pkg.ml build --pinned false --tests false".

#=== ERROR while installing qcow.0.7.0 ========================================#
# opam-version 1.2.2
# os           darwin
# command      ocaml pkg/pkg.ml build --pinned false --tests false
# path         /Users/shawnduncan/.opam/system/build/qcow.0.7.0
# compiler     system (4.04.0)
# exit-code    1
# env-file     /Users/shawnduncan/.opam/system/build/qcow.0.7.0/qcow-16327-e7966f.env
# stdout-file  /Users/shawnduncan/.opam/system/build/qcow.0.7.0/qcow-16327-e7966f.out
# stderr-file  /Users/shawnduncan/.opam/system/build/qcow.0.7.0/qcow-16327-e7966f.err
### stdout ###
# [...]
# Use Bytes.set instead.
# File "cli/impl.ml", line 115, characters 2-17:
# Warning 3: deprecated: String.set
# Use Bytes.set instead.
# File "cli/impl.ml", line 144, characters 18-29:
# Error: Signature mismatch:
#        ...
#        The type `info' is required but not provided
#        The type `id' is required but not provided
# Command exited with code 2.
### stderr ###
# pkg.ml: [ERROR] cmd ['ocamlbuild' '-use-ocamlfind' '-classic-display' '-tag' 'debug'
# [...]
#      'lib/qcow_rwlock.cmx' 'lib/qcow_rwlock.cmi' 'lib/qcow_rwlock.mli'
#      'lib/qcow_diet.cmx' 'lib/qcow_diet.cmi' 'lib/qcow_diet.mli'
#      'lib/qcow_s.cmx' 'lib/qcow_s.cmi' 'lib/qcow_s.mli'
#      'lib/qcow_physical.cmx' 'lib/qcow_physical.cmi' 'lib/qcow_physical.mli'
#      'lib/qcow_virtual.cmx' 'lib/qcow_virtual.cmi' 'lib/qcow_virtual.mli'
#      'lib/qcow_types.cmx' 'lib/qcow_types.cmi' 'lib/qcow_types.mli'
#      'lib/qcow_error.cmx' 'lib/qcow_error.cmi' 'lib/qcow_error.mli'
#      'lib/qcow_header.cmx' 'lib/qcow_header.cmi' 'lib/qcow_header.mli'
#      'cli/main.native']: exited with 10


#=== ERROR while installing qcow-format.0.5.0 =================================#
# opam-version 1.2.2
# os           darwin
# command      make PREFIX=/Users/shawnduncan/.opam/system
# path         /Users/shawnduncan/.opam/system/build/qcow-format.0.5.0
# compiler     system (4.04.0)
# exit-code    2
# env-file     /Users/shawnduncan/.opam/system/build/qcow-format.0.5.0/qcow-format-16327-d8a4ae.env
# stdout-file  /Users/shawnduncan/.opam/system/build/qcow-format.0.5.0/qcow-format-16327-d8a4ae.out
# stderr-file  /Users/shawnduncan/.opam/system/build/qcow-format.0.5.0/qcow-format-16327-d8a4ae.err
### stdout ###
# [...]
# findlib: [WARNING] Interface topdirs.cmi occurs in several directories: /usr/local/lib/ocaml/compiler-libs, /usr/local/lib/ocaml
# /Users/shawnduncan/.opam/system/bin/ocamlfind ocamlc -c -g -annot -bin-annot -I lib -package astring -package cmdliner -package cstruct -package cstruct.lwt -package io-page -package io-page.unix -package logs -package logs.fmt -package lwt -package lwt.unix -package mirage-block -package mirage-block-unix -package mirage-types.lwt -package ppx_sexp_conv -package result -package sexplib -I cli -I lib -o cli/impl.cmo cli/impl.ml
# + /Users/shawnduncan/.opam/system/bin/ocamlfind ocamlc -c -g -annot -bin-annot -I lib -package astring -package cmdliner -package cstruct -package cstruct.lwt -package io-page -package io-page.unix -package logs -package logs.fmt -package lwt -package lwt.unix -package mirage-block -package mirage-block-unix -package mirage-types.lwt -package ppx_sexp_conv -package result -package sexplib -I cli -I lib -o cli/impl.cmo cli/impl.ml
# findlib: [WARNING] Interface topdirs.cmi occurs in several directories: /usr/local/lib/ocaml/compiler-libs, /usr/local/lib/ocaml
# File "cli/impl.ml", line 108, characters 18-29:
# Error: Signature mismatch:
#        ...
#        The type `info' is required but not provided
#        The type `id' is required but not provided
# Command exited with code 2.
### stderr ###
# E: Failure("Command ''/Users/shawnduncan/.opam/system/bin/ocamlbuild' lib/qcow.cma lib/qcow.cmxa lib/qcow.a lib/qcow.cmxs cli/main.native -tag debug -classic-display' terminated with error code 10")
# make: *** [build] Error 1



=-=- Error report -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=  üê´
The following actions failed
  ‚àó  install qcow        0.7.0
  ‚àó  install qcow-format 0.5.0
No changes have been performed
```
## Bug Reports

- dlite version in use (run `dlite --version`): 
2.0.0-beta9

- expected behavior:
vm.tty has correct permissions

- actual behavior:
vm.tty doesn't exist when chown is run, causing `dlite start` to exit with an error

- steps to reproduce
`dlite start`
this is random, caused by a race condition


opening this issue for myself :)

need to add some code to make sure that `vm.tty` exists before attempting to change permissions on it.

## Bug Reports

- dlite version in use (run `dlite --version`): dlite 1.1.5, installed on Mac OS X El Capitan 10.11.6

- expected behavior: within docker, expecting `curl google.com` to return results. also getting connection refused when running `docker pull` or `docker import`

- actual behavior: `curl.google.com` hangs then can't resolve host. same for directly curling the IP

- steps to reproduce: `docker run --rm -it <container> bash` then trying to curl. Docker image is a modified Ubuntu 14.04.4 LTS

This is my /etc/resolv.conf within the container:
nameserver 8.8.8.8
nameserver 192.168.64.1 # eth0

If I run this with regular Docker (aka not dlite), it works fine. It also works fine on a 2nd machine that has both dlite and regular Docker installed. Is there some dlite config that somehow got modified or is missing? Has anyone else experienced this?
## Bug Reports

- dlite version in use (run `dlite --version`): 

```
dlite version 2.0.0-beta8
```
- expected behavior:

```
$ dlite ssh
$ lsmod | grep fuse && echo has fuse || echo no fuse
has fuse
```

- actual behavior:

```
$ dlite ssh
$ lsmod | grep fuse && echo has fuse || echo no fuse
no fuse
```
- steps to reproduce

```
$ dlite ssh
$ lsmod | grep fuse && echo has fuse || echo no fuse
```

## Feature Requests

Allow the use of fuse kernel extensions in container. This seems to be the only way to enable usage of images like [`xueshanf/s3fs`](https://hub.docker.com/r/xueshanf/s3fs/).

Please let me know if there are other ways to go about it.
## Bug Reports

- dlite version in use (run `dlite --version`): 

`dlite version 2.0.0-beta9`

- expected behavior:

Be able to pull docker images.

- actual behavior:

> Error response from daemon: Get https://registry-1.docker.io/v2/: dial tcp: lookup registry-1.docker.io on 192.168.64.1:53: read udp 192.168.64.38:50471->192.168.64.1:53: read: connection refused

- steps to reproduce

While _dnsmasq_ is active, run `dlite start`.  
When you execute e.g. `docker pull nginx`, you will get the error message above.

---

I know this issue came up briefly in #135, but that thread was closed...  
Is there a known solution for this, so that I can use _dnsmasq_ together with _dlite_?

Because, _dlite_ seems to work a lot faster (and easier) than most other solutions I already tried on macOS... ;-)

## Things I already tried

When I stop _dnsmasq_ and restart _dlite_, the problem goes away.  
Docker starts pulling in the images as it should. Great!

And it seems like it keeps working when I restart _dnsmasq_, after I started _dlite_?

Already tried updating my _dnsmasq.conf_ for
- binding to ip 127.0.0.1
- restricting it to `en0` (Wi-Fi) and `en1` (ethernet)
- excluding `en5` (an interface which only seems to exists when _dlite_ is running)
- ...
