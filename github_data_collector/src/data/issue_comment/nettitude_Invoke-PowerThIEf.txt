Replace any instance of Write-Host with WriteOutput. Remove any use of -foregroundcolor
HookLoginForms works on some sites, and it does not work on other sites.  

Maybe DocumentComplete is not fired on every website? I don't know. 

It works on paypal.com, but it does not work on amazon.com.