NOTE: Gem::Specification#rubyforge_project= is deprecated with no replacement. It will be removed on or after 2019-12-01.
NOTE: Gem::Specification#rubyforge_project= is deprecated with no replacement. It will be removed on or after 2019-12-01.
NOTE: Gem::Specification#rubyforge_project= is deprecated with no replacement. It will be removed on or after 2019-12-01.


## Issue report
When running rails for the first time, passenger starts compiling and then fails. Both yes and no to the optimisation option result in the build failing

```
The Phusion Passenger agent binary could not be downloaded. Compiling it from source instead.

Checking for required software...

 * Checking for C compiler...
      Found: yes
      Location: /usr/bin/cc
 * Checking for C++ compiler...
      Found: yes
      Location: /usr/bin/c++
 * Checking for Rake (associated with /home/lukepicicau/.rvm/gems/ruby-2.6.3/wrappers/ruby)...
      Found: yes
      Location: /home/lukepicicau/.rvm/gems/ruby-2.6.3/wrappers/rake
 * Checking for Curl development headers with SSL support...
      Found: yes
      curl-config location: /usr/bin/curl-config
      Header location: /usr/include/curl/curl.h
      Version: libcurl 7.66.0
      Usable: yes
      Supports SSL: yes
 * Checking for OpenSSL development headers...
      Found: yes
      Location: /usr/include/openssl/ssl.h
 * Checking for Zlib development headers...
      Found: yes
      Location: /usr/include/zlib.h


--------------------------------------------

Compile the agent with optimizations?

Compiling the agent with optimizations will make Phusion Passenger faster, but
it will take longer to compile and it requires at least 2 GB of memory.
(You have 15.0 GB memory.)

Compile with optimizations? [y/n]: y

Compiling Phusion Passenger agent...
[***********                                       ] /
*** ERROR: a Rake command failed. You can find the full log in /tmp/passenger-install-log-8bzyg. Below, you can find the last few lines of the command's output.
------------- Begin command output snippet -------------
rake aborted!
Command failed with status (1): [c++ -o /tmp/passenger-install.11sueks/support-binaries/WatchdogMain.o  -Isrc/agent -Isrc/cxx_supportlib -Isrc/cxx_supportlib/vendor-copy -Isrc/cxx_supportlib/vendor-modified -Isrc/cxx_supportlib/vendor-modified/libev -Isrc/cxx_supportlib/vendor-copy/libuv/include -Isrc/cxx_supportlib/vendor-copy/websocketpp -D_REENTRANT -I/usr/local/include -Wall -Wextra -Wno-unused-parameter -Wno-parentheses -Wpointer-arith -Wwrite-strings -Wno-long-long -Wno-missing-field-initializers -feliminate-unused-debug-symbols -feliminate-unused-debug-types -fvisibility=hidden -DVISIBILITY_ATTRIBUTE_SUPPORTED -Wno-attributes -DHAS_ALLOCA_H -DHAVE_ACCEPT4 -DHAS_SFENCE -DHAS_LFENCE -DPASSENGER_DEBUG -DBOOST_DISABLE_ASSERTS -ggdb -std=gnu++11 -Wno-unused-local-typedefs -Wno-format-nonliteral -DHAS_UNORDERED_MAP -c src/agent/Watchdog/WatchdogMain.cpp]
```


Full compile log:

[passenger-install-log-b26pvf.txt](https://github.com/phusion/passenger/files/4024182/passenger-install-log-b26pvf.txt)


**Question 2: Passenger version and integration mode**:
gem 'passenger', '5.3.4'

**Question 3: OS or Linux distro, platform (including version)**:
- Fedora 31

**Question 4: Passenger installation method**:

Your answer:
[x] RubyGems + Gemfile
[ ] RubyGems, no Gemfile
[ ] Phusion APT repo
[ ] Phusion YUM repo
[ ] OS X Homebrew
[ ] source tarball
[ ] Other, please specify:

**Question 5: Your app's programming language (including any version managers) and framework (including versions)**:
- For example: Ruby 2.3.0, RVM, Rails 5.0.0; Node.js 4.0.0 with Express 4.13.4

Your answer: Ruby 2.6.3 RVM, Rails 5.2.0

**Question 6: Are you using a PaaS and/or containerization? If so which one?**
- For example: Heroku, Amazon Container Services, Docker 1.9 with an image based on passenger-docker

Your answer: no

**Question 7: Anything else about your setup that we should know?**

Your answer: no

## Issue

I can’t reinstall Passenger 6.0.4 after FreeBSD upgrade

## Steps

I upgraded my test servers from FreeBSD 12.0 to 12.1. I followed the official handbook as usual.

I installed Ruby 2.6.5 using RVM. The same version has been running before the upgrade. It’s the latest public version.

All my Rails gems were installed, and 1,000+ Rails tests passed.

When I try to install Passenger, the following happens. Note that my systems are as close to the default FreeBSD install as possible (I’m using the default compilers, etc).

```
c++ -o buildout/apache2/module_libboost_oxt/boost/tss_null.o  -Isrc/cxx_supportlib -Isrc/cxx_supportlib/vendor-copy -Isrc/cxx_supportlib/vendor-modified -fPIC -I/usr/local/include/apr-1 -I/usr/local/include/apr-1 -I/usr/include -I/usr/local/include -I/usr/local/include/db5 -pipe -DLIBICONV_PLUG -fstack-protector-strong -fno-strict-aliasing -I/usr/local/include/apache24 -D_REENTRANT -I/usr/local/include -Wall -Wextra -Wno-unused-parameter -Wno-parentheses -Wpointer-arith -Wwrite-strings -Wno-long-long -Wno-missing-field-initializers -Wno-ambiguous-member-template -fvisibility=hidden -DVISIBILITY_ATTRIBUTE_SUPPORTED -DHAVE_ACCEPT4 -DHAS_SFENCE -DHAS_LFENCE -DPASSENGER_DEBUG -DBOOST_DISABLE_ASSERTS -g -fno-limit-debug-info -Wno-unused-local-typedefs -Wno-format-nonliteral -DHAS_UNORDERED_MAP -c src/cxx_supportlib/vendor-modified/boost/libs/thread/src/tss_null.cpp
mkdir -p buildout/apache2/module_libboost_oxt/oxt
c++ -o buildout/apache2/module_libboost_oxt/oxt/system_calls.o  -Isrc/cxx_supportlib -Isrc/cxx_supportlib/vendor-copy -Isrc/cxx_supportlib/vendor-modified -fPIC -I/usr/local/include/apr-1 -I/usr/local/include/apr-1 -I/usr/include -I/usr/local/include -I/usr/local/include/db5 -pipe -DLIBICONV_PLUG -fstack-protector-strong -fno-strict-aliasing -I/usr/local/include/apache24 -D_REENTRANT -I/usr/local/include -Wall -Wextra -Wno-unused-parameter -Wno-parentheses -Wpointer-arith -Wwrite-strings -Wno-long-long -Wno-missing-field-initializers -Wno-ambiguous-member-template -fvisibility=hidden -DVISIBILITY_ATTRIBUTE_SUPPORTED -DHAVE_ACCEPT4 -DHAS_SFENCE -DHAS_LFENCE -DPASSENGER_DEBUG -DBOOST_DISABLE_ASSERTS -g -fno-limit-debug-info -Wno-unused-local-typedefs -Wno-format-nonliteral -DHAS_UNORDERED_MAP -c src/cxx_supportlib/oxt/system_calls.cpp
src/cxx_supportlib/oxt/system_calls.cpp:153:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:135:9: note: expanded from macro 'CHECK_INTERRUPTION'
                        && (!this_thread::syscalls_interruptable() \
                             ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:153:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:136:31: note: expanded from macro 'CHECK_INTERRUPTION'
                            || !(_intr_requested = this_thread::interruption_requested())) \
                                                   ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:153:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:143:7: note: expanded from macro 'CHECK_INTERRUPTION'
                 && this_thread::syscalls_interruptable() \
                    ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:165:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:135:9: note: expanded from macro 'CHECK_INTERRUPTION'
                        && (!this_thread::syscalls_interruptable() \
                             ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:165:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:136:31: note: expanded from macro 'CHECK_INTERRUPTION'
                            || !(_intr_requested = this_thread::interruption_requested())) \
                                                   ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:165:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:143:7: note: expanded from macro 'CHECK_INTERRUPTION'
                 && this_thread::syscalls_interruptable() \
                    ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:177:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:135:9: note: expanded from macro 'CHECK_INTERRUPTION'
                        && (!this_thread::syscalls_interruptable() \
                             ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:177:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:136:31: note: expanded from macro 'CHECK_INTERRUPTION'
                            || !(_intr_requested = this_thread::interruption_requested())) \
                                                   ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:177:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:143:7: note: expanded from macro 'CHECK_INTERRUPTION'
                 && this_thread::syscalls_interruptable() \
                    ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:189:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:135:9: note: expanded from macro 'CHECK_INTERRUPTION'
                        && (!this_thread::syscalls_interruptable() \
                             ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:189:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:136:31: note: expanded from macro 'CHECK_INTERRUPTION'
                            || !(_intr_requested = this_thread::interruption_requested())) \
                                                   ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:189:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:143:7: note: expanded from macro 'CHECK_INTERRUPTION'
                 && this_thread::syscalls_interruptable() \
                    ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:201:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:135:9: note: expanded from macro 'CHECK_INTERRUPTION'
                        && (!this_thread::syscalls_interruptable() \
                             ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:201:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:136:31: note: expanded from macro 'CHECK_INTERRUPTION'
                            || !(_intr_requested = this_thread::interruption_requested())) \
                                                   ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:201:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:143:7: note: expanded from macro 'CHECK_INTERRUPTION'
                 && this_thread::syscalls_interruptable() \
                    ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:213:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:135:9: note: expanded from macro 'CHECK_INTERRUPTION'
                        && (!this_thread::syscalls_interruptable() \
                             ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:213:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:136:31: note: expanded from macro 'CHECK_INTERRUPTION'
                            || !(_intr_requested = this_thread::interruption_requested())) \
                                                   ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:213:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:143:7: note: expanded from macro 'CHECK_INTERRUPTION'
                 && this_thread::syscalls_interruptable() \
                    ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
src/cxx_supportlib/oxt/system_calls.cpp:225:2: error: reference to 'this_thread' is ambiguous
        CHECK_INTERRUPTION(
        ^
src/cxx_supportlib/oxt/system_calls.cpp:135:9: note: expanded from macro 'CHECK_INTERRUPTION'
                        && (!this_thread::syscalls_interruptable() \
                             ^
/usr/include/c++/v1/__threading_support:465:11: note: candidate found by name lookup is 'std::__1::this_thread'
namespace this_thread
          ^
src/cxx_supportlib/vendor-modified/boost/thread/pthread/condition_variable.hpp:30:15: note: candidate found by name lookup is 'boost::this_thread'
    namespace this_thread
              ^
fatal error: too many errors emitted, stopping now [-ferror-limit=]
20 errors generated.
rake aborted!
Command failed with status (1): [c++ -o buildout/apache2/module_libboost_oxt/oxt/system_calls.o  -Isrc/cxx_supportlib -Isrc/cxx_supportlib/vendor-copy -Isrc/cxx_supportlib/vendor-modified -fPIC -I/usr/local/include/apr-1 -I/usr/local/include/apr-1 -I/usr/include -I/usr/local/include -I/usr/local/include/db5 -pipe -DLIBICONV_PLUG -fstack-protector-strong -fno-strict-aliasing -I/usr/local/include/apache24 -D_REENTRANT -I/usr/local/include -Wall -Wextra -Wno-unused-parameter -Wno-parentheses -Wpointer-arith -Wwrite-strings -Wno-long-long -Wno-missing-field-initializers -Wno-ambiguous-member-template -fvisibility=hidden -DVISIBILITY_ATTRIBUTE_SUPPORTED -DHAVE_ACCEPT4 -DHAS_SFENCE -DHAS_LFENCE -DPASSENGER_DEBUG -DBOOST_DISABLE_ASSERTS -g -fno-limit-debug-info -Wno-unused-local-typedefs -Wno-format-nonliteral -DHAS_UNORDERED_MAP -c src/cxx_supportlib/oxt/system_calls.cpp]
/usr/home/mage/.rvm/gems/ruby-2.6.3/gems/passenger-6.0.4/build/support/cplusplus.rb:53:in `run_compiler'
/usr/home/mage/.rvm/gems/ruby-2.6.3/gems/passenger-6.0.4/build/support/cplusplus.rb:104:in `compile_cxx'
/usr/home/mage/.rvm/gems/ruby-2.6.3/gems/passenger-6.0.4/build/support/cplusplus.rb:162:in `block in define_cxx_object_compilation_task'
Tasks: TOP => apache2 => buildout/apache2/mod_passenger.so => buildout/apache2/module_libboost_oxt.a => buildout/apache2/module_libboost_oxt/oxt/system_calls.o
(See full trace by running task with --trace)

--------------------------------------------

It looks like something went wrong

Please read our documentation for troubleshooting tips:

   https://www.phusionpassenger.com/library/install/apache/
   https://www.phusionpassenger.com/library/admin/apache/troubleshooting/

If that doesn't help, please use our support facilities. We'll do our best to help you.

   https://www.phusionpassenger.com/support
```
Yes, the issue is with Nginx/passenger. I have the same configuration running on my local ubuntu Machine but it is not working on the server, I am receiving an error 504 or sometimes passenger's is not able to spawn the process. I have added the backtrace at the bottom. 

Open source Phusion Passenger 5.3.5, nginx/1.16.1
OS: Ubuntu 18.04
Passenger installation method**:
[ ] RubyGems + Gemfile
[ ] RubyGems, no Gemfile
[x] Phusion APT repo
[ ] Phusion YUM repo
[ ] OS X Homebrew
[ ] source tarball
[ ] Other, please specify:

Meteor 1.9.3
The app is deployed on VPS and I am not using docker or anything.

Backtrace
```
     in 'bool Passenger::SpawningKit::HandshakePerform::checkCurrentState()' (Perform.h:257)
     in 'void Passenger::SpawningKit::HandshakePerform::waitUntilSpawningFinished(boost::unique_lock<boost::mutex>&)' (Perform.h:213)
     in 'Passenger::SpawningKit::Result Passenger::SpawningKit::HandshakePerform::execute()' (Perform.h:1752)
     in 'Passenger::SpawningKit::Result Passenger::SpawningKit::DirectSpawner::internalSpawn(const AppPoolOptions&, Passenger::SpawningKit::Config&, Passenger::SpawningKit::HandshakeSession&, const Passenger::Json::Value&, Passenger::SpawningKit::JourneyStep&)' (DirectSpawner.h:211)
     in 'virtual Passenger::SpawningKit::Result Passenger::SpawningKit::DirectSpawner::spawn(const AppPoolOptions&)' (DirectSpawner.h:261)
     in 'void Passenger::ApplicationPool2::Group::spawnThreadRealMain(const SpawnerPtr&, const Passenger::ApplicationPool2::Options&, unsigned int)' (SpawningAndRestarting.cpp:95)
```

## Issue report

Fill in as much as possible so that we can understand, find and fix the problem.

**Are you sure this is a bug in Passenger?**
Please read our troubleshooting and debugging guides first:
https://www.phusionpassenger.com/library/admin/troubleshooting/
https://www.phusionpassenger.com/library/admin/

**Please try with the newest version of Passenger to avoid issues that have already been fixed**

**Question 1: What is the problem?**
- Application sends replies (only headers without body) with http code 102 to client. nodejs api is [used](https://nodejs.org/api/http.html#http_response_writeprocessing)
- Client does not get any response from passenger. Logs show nothing
```
App 19071 output: ======================================writeProcessing <---- here app tried to send responce
App 19071 output: CheckTaskStatus: Creating Virtual Datacenter vdc_24902281724(ee7fa7e7-5f3e-4ebd-b510-bd11e19694ae)
```

Your answer:

**Question 2: Passenger version and integration mode**:
- Phusion Passenger 6.0.2 opensource (nginx integration mode)

**Question 3: OS or Linux distro, platform (including version)**:
- Ubuntu 14.04.5 LTS

**Question 4: Passenger installation method**:

Your answer:
[ ] Phusion APT repo

**Question 5: Your app's programming language (including any version managers) and framework (including versions)**:
- Nodejs v12.13.1

Your answer:

**Question 6: Are you using a PaaS and/or containerization? If so which one?**
- No, just simple vm on Ubuntu
---

We strive for quality and appreciate you taking the time to submit a report! Please note that if you want guaranteed response times and priority issue support we encourage you to join our [enterprise customer](https://www.phusionpassenger.com/enterprise) base. They also provide us with the means to continue our high level of open source support!

Yes, the issue is with Nginx/passenger. I don't see anything wrong with anything but sometimes, we receive the following message "application did not send a complete response" out of nowhere while using the application and when I refresh the same page, the page works. 

Open source Phusion Passenger 5.3.5, nginx/1.16.1
OS: Ubuntu 18.04
Passenger installation method**: 
[ ] RubyGems + Gemfile
[ ] RubyGems, no Gemfile
[x] Phusion APT repo
[ ] Phusion YUM repo
[ ] OS X Homebrew
[ ] source tarball
[ ] Other, please specify:

Meteor 1.9.3
The app is deployed on VPS and I am not using docker or anything.
## Issue report

**Are you sure this is a bug in Passenger?**
Please read our troubleshooting and debugging guides first:
https://www.phusionpassenger.com/library/admin/troubleshooting/
https://www.phusionpassenger.com/library/admin/

Read those guides as well as a lot of docs / SO questions.

**Question 1: What is the problem?**

Initially, a sufficient amount of instances are started. Then after 10-20 minutes instance count sometimes drops below the `PassengerMinInstances` count. Logs say they are garbage collected.

- What is the expected behavior?
Passenger instance process count should be at least `PassengerMinInstances`.

- What is the actual behavior?
Passenger instance process count drops to `PassengerMinInstances` - 2.

- How can we reproduce it? Please try to provide a sample application (or Virtual Machine) demonstrating the issue. Otherwise, if we can't reproduce it, we might have to ask you a number of followup questions or run certain commands to try and figure out the problem.

Feel free to ask questions and to perform additional checks/logs on my live installation. It can be reproduced easily.

Let we have `PassengerMinInstances 4` as in config below.
Apache was restarted at 14:25
ps before (14:31:41) - looks good:
```
-+= 92006 root PassengerAgent watchdog
 \-+= 92008 root PassengerAgent core
   \-+- 92032 redmine ruby25: Passenger AppPreloader: /srv/redmine (ruby25)
     |--- 92255 redmine ruby25: Passenger AppPreloader: /srv/redmine (forking...) (ruby25)
     |--- 92263 redmine ruby25: Passenger AppPreloader: /srv/redmine (forking...) (ruby25)
     |--- 92274 redmine ruby25: Passenger AppPreloader: /srv/redmine (forking...) (ruby25)
     |--- 92287 redmine ruby25: Passenger AppPreloader: /srv/redmine (forking...) (ruby25)
     \--- 92295 redmine ruby25: Passenger AppPreloader: /srv/redmine (forking...) (ruby25)
```

ps after killing 3 instances (14:31:43):
```
|-+= 92003 root /usr/local/sbin/httpd -DNOHTTPACCEPT
| |-+= 92006 root PassengerAgent watchdog
 | | \--= 92008 root PassengerAgent core
| ...
|--- 92255 redmine ruby25: Passenger AppPreloader: /srv/redmine (forking...) (ruby25)
|--- 92295 redmine ruby25: Passenger AppPreloader: /srv/redmine (forking...) (ruby25)
```

So instances 92263, 92274, 92287 are killed and there are only two processes for ten minutes at least. Also, it seems interesting that remaining processes now have 1 as their parent PID, not the passenger core. Logs don't say anything about detaching them.

Full log since the start until the problem  - https://gist.github.com/theirix/42fc0826e798257be1b13eca8ed24433
Logs for this interval:
```
[ D 2019-11-27 14:31:40.0092 92008/T4 age/Cor/App/Poo/AnalyticsCollection.cpp:151 ]: Collecting system metrics
[ D 2019-11-27 14:31:40.0092 92008/T4 age/Cor/App/Poo/AnalyticsCollection.cpp:69 ]: Analytics collection done; next analytics collection in 4.991 sec
[ D 2019-11-27 14:31:42.0147 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:150 ]: Garbage collection time...
[ D 2019-11-27 14:31:42.0147 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:185 ]: Garbage collection done; next garbage collect in 0.103 sec
[ D 2019-11-27 14:31:42.1220 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:150 ]: Garbage collection time...
[ D 2019-11-27 14:31:42.1221 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:120 ]: Garbage collect idle process: (pid=92263, group=/srv/redmine (production)), group=/srv/redmine (production)
[ D 2019-11-27 14:31:42.1221 92008/T3 age/Cor/App/Gro/ProcessListManagement.cpp:483 ]: Detaching process (pid=92263, group=/srv/redmine (production))
[ N 2019-11-27 14:31:42.1221 92008/T3 age/Cor/CoreMain.cpp:1147 ]: Checking whether to disconnect long-running connections for process 92263, application /srv/redmine (production)
[ D 2019-11-27 14:31:42.1222 92008/T3 age/Cor/App/Gro/ProcessListManagement.cpp:281 ]: Starting detached processes checker
[ D 2019-11-27 14:31:42.1222 92008/T8 age/Cor/Con/TurboCaching.h:246 ]: Clearing turbocache
[ D 2019-11-27 14:31:42.1222 92008/Tc age/Cor/Con/TurboCaching.h:246 ]: Clearing turbocache
[ D 2019-11-27 14:31:42.1222 92008/Tb age/Cor/Con/TurboCaching.h:246 ]: Clearing turbocache
[ D 2019-11-27 14:31:42.1222 92008/Te age/Cor/Con/TurboCaching.h:246 ]: Clearing turbocache
[ D 2019-11-27 14:31:42.1223 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:185 ]: Garbage collection done; next garbage collect in 0.112 sec
[ D 2019-11-27 14:31:42.1223 92008/T1n age/Cor/App/Gro/ProcessListManagement.cpp:328 ]: Detached process (pid=92263, group=/srv/redmine (production)) has 0 active sessions now. Triggering shutdown.
App 92263 output: [ 2019-11-27 14:31:42.1225 92263/0x0000000801431dc8(Main thread) request_handler.rb ]: Waiting until all threads have become idle...
App 92263 output: [ 2019-11-27 14:31:42.1226 92263/0x0000000801431dc8(Main thread) request_handler.rb ]: There are currently 2 threads
App 92263 output: [ 2019-11-27 14:31:42.2226 92263/0x0000000801431dc8(Main thread) request_handler.rb ]: All threads are now idle
App 92263 output: [ 2019-11-27 14:31:42.2227 92263/0x0000000801431dc8(Main thread) request_handler.rb ]: Stopping all threads
App 92263 output: [ 2019-11-27 14:31:42.2231 92263/0x000000080483f7c8(Worker 1) request_handler/thread_handler.rb ]: Thread handler main loop exited normally
App 92263 output: [ 2019-11-27 14:31:42.2233 92263/0x000000080483da40(HTTP helper worker) request_handler/thread_handler.rb ]: Thread handler main loop exited normally
App 92263 output: [ 2019-11-27 14:31:42.2234 92263/0x0000000801431dc8(Main thread) request_handler.rb ]: All threads stopped
App 92263 output: [ 2019-11-27 14:31:42.2234 92263/0x0000000801431dc8(Main thread) request_handler.rb ]: Request handler main loop exited normally
App 92263 output: [ 2019-11-27 14:31:42.2235 92263/0x0000000801431dc8(Main thread) request_handler.rb ]: Exiting request handler main loop
[ D 2019-11-27 14:31:42.2347 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:150 ]: Garbage collection time...
[ D 2019-11-27 14:31:42.2348 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:120 ]: Garbage collect idle process: (pid=92274, group=/srv/redmine (production)), group=/srv/redmine (production)
[ D 2019-11-27 14:31:42.2348 92008/T3 age/Cor/App/Gro/ProcessListManagement.cpp:483 ]: Detaching process (pid=92274, group=/srv/redmine (production))
[ N 2019-11-27 14:31:42.2348 92008/T3 age/Cor/CoreMain.cpp:1147 ]: Checking whether to disconnect long-running connections for process 92274, application /srv/redmine (production)
[ D 2019-11-27 14:31:42.2348 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:185 ]: Garbage collection done; next garbage collect in 0.149 sec
[ D 2019-11-27 14:31:42.3277 92008/T1n age/Cor/App/Gro/ProcessListManagement.cpp:335 ]: Detached process (pid=92263, group=/srv/redmine (production)) has shut down. Cleaning up associated resources.
[ D 2019-11-27 14:31:42.3278 92008/T1n age/Cor/App/Gro/ProcessListManagement.cpp:328 ]: Detached process (pid=92274, group=/srv/redmine (production)) has 0 active sessions now. Triggering shutdown.
App 92274 output: [ 2019-11-27 14:31:42.3280 92274/0x0000000801431dc8(Main thread) request_handler.rb ]: Waiting until all threads have become idle...
App 92274 output: [ 2019-11-27 14:31:42.3281 92274/0x0000000801431dc8(Main thread) request_handler.rb ]: There are currently 2 threads
[ D 2019-11-27 14:31:42.3897 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:150 ]: Garbage collection time...
[ D 2019-11-27 14:31:42.3898 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:120 ]: Garbage collect idle process: (pid=92287, group=/srv/redmine (production)), group=/srv/redmine (production)
[ D 2019-11-27 14:31:42.3898 92008/T3 age/Cor/App/Gro/ProcessListManagement.cpp:483 ]: Detaching process (pid=92287, group=/srv/redmine (production))
[ N 2019-11-27 14:31:42.3898 92008/T3 age/Cor/CoreMain.cpp:1147 ]: Checking whether to disconnect long-running connections for process 92287, application /srv/redmine (production)
[ D 2019-11-27 14:31:42.3899 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:133 ]: Garbage collect idle spawner: group=/srv/redmine (production)
[ D 2019-11-27 14:31:42.3899 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:185 ]: Garbage collection done; next garbage collect in 0.146 sec
App 92274 output: [ 2019-11-27 14:31:42.4281 92274/0x0000000801431dc8(Main thread) request_handler.rb ]: All threads are now idle
App 92274 output: [ 2019-11-27 14:31:42.4282 92274/0x0000000801431dc8(Main thread) request_handler.rb ]: Stopping all threads
App 92274 output: [ 2019-11-27 14:31:42.4285 92274/0x000000080483f480(Worker 1) request_handler/thread_handler.rb ]: Thread handler main loop exited normally
App 92274 output: [ 2019-11-27 14:31:42.4289 92274/0x000000080483d5b8(HTTP helper worker) request_handler/thread_handler.rb ]: Thread handler main loop exited normally
App 92274 output: [ 2019-11-27 14:31:42.4290 92274/0x0000000801431dc8(Main thread) request_handler.rb ]: All threads stopped
App 92274 output: [ 2019-11-27 14:31:42.4291 92274/0x0000000801431dc8(Main thread) request_handler.rb ]: Request handler main loop exited normally
App 92274 output: [ 2019-11-27 14:31:42.4291 92274/0x0000000801431dc8(Main thread) request_handler.rb ]: Exiting request handler main loop
[ D 2019-11-27 14:31:42.4338 92008/T1n age/Cor/App/Gro/ProcessListManagement.cpp:328 ]: Detached process (pid=92287, group=/srv/redmine (production)) has 0 active sessions now. Triggering shutdown.
App 92287 output: [ 2019-11-27 14:31:42.4340 92287/0x0000000801431dc8(Main thread) request_handler.rb ]: Waiting until all threads have become idle...
App 92287 output: [ 2019-11-27 14:31:42.4341 92287/0x0000000801431dc8(Main thread) request_handler.rb ]: There are currently 2 threads
App 92287 output: [ 2019-11-27 14:31:42.5342 92287/0x0000000801431dc8(Main thread) request_handler.rb ]: All threads are now idle
App 92287 output: [ 2019-11-27 14:31:42.5342 92287/0x0000000801431dc8(Main thread) request_handler.rb ]: Stopping all threads
App 92287 output: [ 2019-11-27 14:31:42.5345 92287/0x000000080483d590(HTTP helper worker) request_handler/thread_handler.rb ]: Thread handler main loop exited normally
App 92287 output: [ 2019-11-27 14:31:42.5347 92287/0x000000080483fd40(Worker 1) request_handler/thread_handler.rb ]: Thread handler main loop exited normally
App 92287 output: [ 2019-11-27 14:31:42.5348 92287/0x0000000801431dc8(Main thread) request_handler.rb ]: All threads stopped
App 92287 output: [ 2019-11-27 14:31:42.5348 92287/0x0000000801431dc8(Main thread) request_handler.rb ]: Request handler main loop exited normally
App 92287 output: [ 2019-11-27 14:31:42.5349 92287/0x0000000801431dc8(Main thread) request_handler.rb ]: Exiting request handler main loop
[ D 2019-11-27 14:31:42.5397 92008/T1n age/Cor/App/Gro/ProcessListManagement.cpp:335 ]: Detached process (pid=92274, group=/srv/redmine (production)) has shut down. Cleaning up associated resources.
[ D 2019-11-27 14:31:42.5677 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:150 ]: Garbage collection time...
[ D 2019-11-27 14:31:42.5678 92008/T3 age/Cor/App/Poo/GarbageCollection.cpp:185 ]: Garbage collection done; next garbage collect in 173.263 sec
[ D 2019-11-27 14:31:42.6427 92008/T1n age/Cor/App/Gro/ProcessListManagement.cpp:335 ]: Detached process (pid=92287, group=/srv/redmine (production)) has shut down. Cleaning up associated resources.
[ D 2019-11-27 14:31:42.6428 92008/T1n age/Cor/App/Gro/ProcessListManagement.cpp:361 ]: Stopping detached processes checker
```

**Question 2: Passenger version and integration mode**:

open-source, 6.0.4, apache module

**Question 3: OS or Linux distro, platform (including version)**:

FreeBSD 12.0-RELEASE-p7 GENERIC  amd64


**Question 4: Passenger installation method**:

[x] RubyGems, no Gemfile

Just 'gem install passenger'

**Question 5: Your app's programming language (including any version managers) and framework (including versions)**:

Ruby 2.5.5, rubygems 3.0.4, passenger 6.0.4, apache 2.4.39_1

Apache/2.4.39 (FreeBSD) OpenSSL/1.1.1a-freebsd mod_fcgid/2.3.9 mod_fastcgi/mod_fastcgi-SNAP-0910052141 mod_wsgi/4.6.5 Python/2.7 Phusion_Passenger/6.0.4

**Question 6: Are you using a PaaS and/or containerization? If so which one?**

No, local installation

**Question 7: Anything else about your setup that we should know?**

Apache config:
```
LoadModule passenger_module /usr/local/lib/ruby/gems/2.5/gems/passenger-6.0.4/buildout/apache2/mod_passenger.so
<IfModule mod_passenger.c>
  PassengerRoot /usr/local/lib/ruby/gems/2.5/gems/passenger-6.0.4
  PassengerDefaultRuby /usr/local/bin/ruby25
</IfModule>


PassengerDisableSecurityUpdateCheck on
PassengerMaxPoolSize 10
PassengerMaxRequestQueueSize 0
PassengerMinInstances 4
PassengerPreStart http://DOMAIN/
PassengerLogLevel 5
```

---

We strive for quality and appreciate you taking the time to submit a report! Please note that if you want guaranteed response times and priority issue support we encourage you to join our [enterprise customer](https://www.phusionpassenger.com/enterprise) base. They also provide us with the means to continue our high level of open source support!

## Issue report
hi
Today we had a crash of PassengerAgent during the daily logrotate for apache2
```
/var/log/apache2/error.log
{
   rotate 60
   daily
  maxsize 268435456
   missingok
   notifempty
   compress
        sharedscripts
   postrotate
      /bin/systemctl reload apache2 > /dev/null
   endscript
}
```
Backtrace:

```
Core was generated by `Passenger core                                                      '.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  0x00005582e89fd0fa in Passenger::Agent::Fundamentals::dumpBacktrace (state=..., userData=0x0) at src/agent/Shared/Fundamentals/AbortHandler.cpp:595
595     src/agent/Shared/Fundamentals/AbortHandler.cpp: No such file or directory.
[Current thread is 1 (Thread 0x7f7d17fff700 (LWP 3368))]
(gdb) bt
#0  0x00005582e89fd0fa in Passenger::Agent::Fundamentals::dumpBacktrace (state=..., userData=0x0) at src/agent/Shared/Fundamentals/AbortHandler.cpp:595
#1  0x00005582e89fc09d in Passenger::Agent::Fundamentals::runInSubprocessWithTimeLimit (state=..., callback=0x5582e89fcd8b <Passenger::Agent::Fundamentals::dumpBacktrace(Passenger::Agent::Fundamentals::AbortHandlerWorkingState&, void*)>, userData=0x0, timeLimit=4000)
    at src/agent/Shared/Fundamentals/AbortHandler.cpp:294
#2  0x00005582e89fdb54 in Passenger::Agent::Fundamentals::dumpDiagnostics (state=...) at src/agent/Shared/Fundamentals/AbortHandler.cpp:746
#3  0x00005582e89ff073 in Passenger::Agent::Fundamentals::abortHandler (signo=6, info=0x7f7d157f5fb0, _unused=0x7f7d157f5e80) at src/agent/Shared/Fundamentals/AbortHandler.cpp:1085
#4  <signal handler called>
#5  0x00007f7d20b59fff in raise () from /lib/x86_64-linux-gnu/libc.so.6
#6  0x00007f7d20b5b42a in abort () from /lib/x86_64-linux-gnu/libc.so.6
#7  0x00007f7d214720ad in __gnu_cxx::__verbose_terminate_handler() () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#8  0x00007f7d21470066 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#9  0x00007f7d2146f089 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#10 0x00007f7d2146f9dd in __gxx_personality_v0 () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#11 0x00007f7d20ed5f33 in ?? () from /lib/x86_64-linux-gnu/libgcc_s.so.1
#12 0x00007f7d20ed6437 in _Unwind_Resume () from /lib/x86_64-linux-gnu/libgcc_s.so.1
#13 0x00005582e89a690f in Passenger::removeDirTree (path="/tmp/passenger.spawn.XXXXS2B3C0") at src/cxx_supportlib/FileTools/FileManip.cpp:311
#14 0x00005582e8aba791 in Passenger::SpawningKit::HandshakeWorkDir::~HandshakeWorkDir (this=0x7f7cdc001860, __in_chrg=<optimized out>) at src/agent/Core/SpawningKit/Handshake/WorkDir.h:81
#15 0x00005582e8b2f413 in boost::checked_delete<Passenger::SpawningKit::HandshakeWorkDir> (x=0x7f7cdc001860) at src/cxx_supportlib/vendor-modified/boost/core/checked_delete.hpp:34
#16 0x00005582e8b0ed6f in boost::scoped_ptr<Passenger::SpawningKit::HandshakeWorkDir>::~scoped_ptr (this=0x7f7d157f8560, __in_chrg=<optimized out>) at src/cxx_supportlib/vendor-modified/boost/smart_ptr/scoped_ptr.hpp:88
#17 0x00005582e8abae39 in Passenger::SpawningKit::HandshakeSession::~HandshakeSession (this=0x7f7d157f8550, __in_chrg=<optimized out>) at src/agent/Core/SpawningKit/Handshake/Session.h:91
#18 0x00005582e8ad6544 in Passenger::SpawningKit::SmartSpawner::spawn (this=0x7f7d0c007ca0, options=...) at src/agent/Core/SpawningKit/SmartSpawner.h:1299
#19 0x00005582e8c043bb in Passenger::ApplicationPool2::Group::spawnThreadRealMain (this=0x7f7d0c007240, spawner=..., options=..., restartsInitiated=0) at src/agent/Core/ApplicationPool/Group/SpawningAndRestarting.cpp:107
#20 0x00005582e8c03d71 in Passenger::ApplicationPool2::Group::spawnThreadMain (this=0x7f7d0c007240, self=..., spawner=..., options=..., restartsInitiated=0) at src/agent/Core/ApplicationPool/Group/SpawningAndRestarting.cpp:53
#21 0x00005582e8c51986 in boost::_mfi::mf4<void, Passenger::ApplicationPool2::Group, boost::shared_ptr<Passenger::ApplicationPool2::Group>, boost::shared_ptr<Passenger::SpawningKit::Spawner>, Passenger::ApplicationPool2::Options, unsigned int>::operator() (this=0x7f7d0c031fa0, p=0x7f7d0c007240, a1=..., a2=...,
    a3=..., a4=0) at src/cxx_supportlib/vendor-modified/boost/bind/mem_fn_template.hpp:506
#22 0x00005582e8c4de90 in boost::_bi::list5<boost::_bi::value<Passenger::ApplicationPool2::Group*>, boost::_bi::value<boost::shared_ptr<Passenger::ApplicationPool2::Group> >, boost::_bi::value<boost::shared_ptr<Passenger::SpawningKit::Spawner> >, boost::_bi::value<Passenger::ApplicationPool2::Options>, boost::_bi::value<unsigned int> >::operator()<boost::_mfi::mf4<void, Passenger::ApplicationPool2::Group, boost::shared_ptr<Passenger::ApplicationPool2::Group>, boost::shared_ptr<Passenger::SpawningKit::Spawner>, Passenger::ApplicationPool2::Options, unsigned int>, boost::_bi::list0> (this=0x7f7d0c031fb0, f=..., a=...)
    at src/cxx_supportlib/vendor-modified/boost/bind/bind.hpp:531
#23 0x00005582e8c4990d in boost::_bi::bind_t<void, boost::_mfi::mf4<void, Passenger::ApplicationPool2::Group, boost::shared_ptr<Passenger::ApplicationPool2::Group>, boost::shared_ptr<Passenger::SpawningKit::Spawner>, Passenger::ApplicationPool2::Options, unsigned int>, boost::_bi::list5<boost::_bi::value<Passenger::ApplicationPool2::Group*>, boost::_bi::value<boost::shared_ptr<Passenger::ApplicationPool2::Group> >, boost::_bi::value<boost::shared_ptr<Passenger::SpawningKit::Spawner> >, boost::_bi::value<Passenger::ApplicationPool2::Options>, boost::_bi::value<unsigned int> > >::operator() (this=0x7f7d0c031fa0)
    at src/cxx_supportlib/vendor-modified/boost/bind/bind.hpp:1294
#24 0x00005582e8c44693 in boost::detail::function::void_function_obj_invoker0<boost::_bi::bind_t<void, boost::_mfi::mf4<void, Passenger::ApplicationPool2::Group, boost::shared_ptr<Passenger::ApplicationPool2::Group>, boost::shared_ptr<Passenger::SpawningKit::Spawner>, Passenger::ApplicationPool2::Options, unsigned
int>, boost::_bi::list5<boost::_bi::value<Passenger::ApplicationPool2::Group*>, boost::_bi::value<boost::shared_ptr<Passenger::ApplicationPool2::Group> >, boost::_bi::value<boost::shared_ptr<Passenger::SpawningKit::Spawner> >, boost::_bi::value<Passenger::ApplicationPool2::Options>, boost::_bi::value<unsigned int>
> >, void>::invoke (function_obj_ptr=...) at src/cxx_supportlib/vendor-modified/boost/function/function_template.hpp:158
#25 0x00005582e89b11c0 in boost::function0<void>::operator() (this=0x7f7d0c0015a0) at src/cxx_supportlib/vendor-modified/boost/function/function_template.hpp:764
#26 0x00005582e8aa57fb in oxt::dynamic_thread_group::thread_main (this=0x7f7d0c0072b0, data=0x7f7d0c0015a0) at src/cxx_supportlib/oxt/dynamic_thread_group.hpp:131
#27 0x00005582e8b9cbe8 in boost::_mfi::mf1<void, oxt::dynamic_thread_group, oxt::dynamic_thread_group::thread_func_data*>::operator() (this=0x7f7cdc0008e0, p=0x7f7d0c0072b0, a1=0x7f7d0c0015a0) at src/cxx_supportlib/vendor-modified/boost/bind/mem_fn_template.hpp:165
#28 0x00005582e8b8dde3 in boost::_bi::list2<boost::_bi::value<oxt::dynamic_thread_group*>, boost::_bi::value<oxt::dynamic_thread_group::thread_func_data*> >::operator()<boost::_mfi::mf1<void, oxt::dynamic_thread_group, oxt::dynamic_thread_group::thread_func_data*>, boost::_bi::list0> (this=0x7f7cdc0008f0, f=...,
    a=...) at src/cxx_supportlib/vendor-modified/boost/bind/bind.hpp:319
#29 0x00005582e8b7cbdb in boost::_bi::bind_t<void, boost::_mfi::mf1<void, oxt::dynamic_thread_group, oxt::dynamic_thread_group::thread_func_data*>, boost::_bi::list2<boost::_bi::value<oxt::dynamic_thread_group*>, boost::_bi::value<oxt::dynamic_thread_group::thread_func_data*> > >::operator() (this=0x7f7cdc0008e0)
    at src/cxx_supportlib/vendor-modified/boost/bind/bind.hpp:1294
#30 0x00005582e8b64e42 in boost::detail::function::void_function_obj_invoker0<boost::_bi::bind_t<void, boost::_mfi::mf1<void, oxt::dynamic_thread_group, oxt::dynamic_thread_group::thread_func_data*>, boost::_bi::list2<boost::_bi::value<oxt::dynamic_thread_group*>, boost::_bi::value<oxt::dynamic_thread_group::thread_func_data*> > >, void>::invoke (function_obj_ptr=...) at src/cxx_supportlib/vendor-modified/boost/function/function_template.hpp:158
#31 0x00005582e89b11c0 in boost::function0<void>::operator() (this=0x7f7d157f9e40) at src/cxx_supportlib/vendor-modified/boost/function/function_template.hpp:764
#32 0x00005582e8cd2330 in oxt::thread::thread_main(boost::function<void ()>, boost::shared_ptr<oxt::thread_local_context>) (func=..., ctx=...) at src/cxx_supportlib/oxt/implementation.cpp:416
#33 0x00005582e89921c1 in boost::_bi::list2<boost::_bi::value<boost::function<void ()> >, boost::_bi::value<boost::shared_ptr<oxt::thread_local_context> > >::operator()<void (*)(boost::function<void ()>, boost::shared_ptr<oxt::thread_local_context>), boost::_bi::list0>(boost::_bi::type<void>, void (*&)(boost::function<void ()>, boost::shared_ptr<oxt::thread_local_context>), boost::_bi::list0&, int) (a=<synthetic pointer>..., f=<optimized out>, this=<optimized out>) at src/cxx_supportlib/vendor-modified/boost/bind/bind.hpp:319
#34 boost::_bi::bind_t<void, void (*)(boost::function<void ()>, boost::shared_ptr<oxt::thread_local_context>), boost::_bi::list2<boost::_bi::value<boost::function<void ()> >, boost::_bi::value<boost::shared_ptr<oxt::thread_local_context> > > >::operator()() (this=<optimized out>)
    at src/cxx_supportlib/vendor-modified/boost/bind/bind.hpp:1294
#35 boost::detail::thread_data<boost::_bi::bind_t<void, void (*)(boost::function<void ()>, boost::shared_ptr<oxt::thread_local_context>), boost::_bi::list2<boost::_bi::value<boost::function<void ()> >, boost::_bi::value<boost::shared_ptr<oxt::thread_local_context> > > > >::run() (this=<optimized out>)
    at src/cxx_supportlib/vendor-modified/boost/thread/detail/thread.hpp:117
#36 0x00005582e8cc67da in boost::(anonymous namespace)::thread_proxy (param=0x7f7d0c031b70) at src/cxx_supportlib/vendor-modified/boost/libs/thread/src/pthread/thread.cpp:177
#37 0x00007f7d224ba4a4 in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0
#38 0x00007f7d20c0fd0f in clone () from /lib/x86_64-linux-gnu/libc.so.6
```



**Question 2: Passenger version and integration mode**:
- passenger 1:6.0.4-1\~stretch1 and libapache2-mod-passenger 1:6.0.4-1\~stretch1

**Question 3: OS or Linux distro, platform (including version)**:
- Debian 9.11

**Question 4: Passenger installation method**:
[x] Phusion APT repo

**Question 5: Your app's programming language (including any version managers) and framework (including versions)**:
- ruby 2.3 running redmine.

**Question 6: Are you using a PaaS and/or containerization? If so which one?**
- no