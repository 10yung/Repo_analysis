Please fill out the sections below to help us address your issue Version of AWS SDK for PHP Version of PHP php v What issue did you see I cant post a message to a websocket apigateway using the postToConnection method I always get error Steps to reproduce config region ENV AWSDEFAULTREGION version latest endpoint connectionId requestheaderxconnectionid apiClient new ApiGatewayManagementApiClientconfig apiClientpostToConnection ConnectionId connectionId Data jsonencode status ok Additional context This is the error output Error executing PostToConnection on AWS HTTP error Client error POST resulted in a Forbidden response messageForbidden What Im seeing there is that the method is using the endpoint url without the stage part POST I tried the same request with awscli and it works properly Please fill out the sections below to help us address your issue Version of AWS SDK for PHP Latest Error has began to reproduce since updating from version to Version of PHP php v Various reproduced on and branches What issue did you see exception Aws S Exception S Exception with message Error executing PutObject on AWS HTTP error cURL error Could not resolve host test see GuzzleHttp Exception ConnectException cURL error Could not resolve host test see in varwwwhtmltimebookdevprotectedvendorguzzlehttpguzzlesrcHandlerCurlFactoryphp Stack trace Steps to reproduce Try to upload any object to the storage with this config to bucket named test endpoint credentials key secret region useast version latest Additional context Possible error in S EndpointMiddlewarephp on line we only check if bucket name is DNScompatible but not host too IP address case Please fill out the sections below to help us address your issue Version of AWS SDK for PHP Latest Version of PHP php v PHP What issue did you see Error executing PutParameter on AWS HTTP error Client error POST resulted in a Bad Request response Parameter name cant be prefixed with ssm caseinsensitive If formed as a path it can consist of subpaths divided by slash symbol each subpath can be formed as a mix of lette rs numbers and the following symbols Exception thrown is even when ssm isnt included in the parameter name The first time this happened I was using smptsupport however I get failures using similar parameter names as well Other failed parameter names myPrefixjmptjupportgmailcom myPrefixmptupportgmailcom myPrefixsmptsupportgmailcom myPrefixsmtpsupportgmailcom otherprefixemailsupportgmailcom Steps to reproduce p Name myPrefixxmptsupportgmailcom Type String Value Overwrite true try result ssmputParameterp if resulthasKeyErrors success else vardumpresultgetErrors catch Aws Ssm Exception SsmException e msg egetMessage n msg egetAwsErrorType n msg egetAwsErrorMessage n msg egetAwsErrorCode n msg egetTraceAsString n echo msg Additional context Using Parameter Store in Systems Manager Version of AWS SDK for PHP Version of PHP php v php What issue did you see Using ApiGatewayV ClientgetDomainName with a domain name created using ApiGatewayClient leads to the following error DateTimeconstruct Failed to parse time string at position Unexpected character Please fill out the sections below to help us address your issue Version of AWS SDK for PHP Version of PHP php v PHP What issue did you see AWS SDK for PHP tries to read awsconfig dozens of times when using the S client Its not necessary as the file does not exist and we provided all S related config keys to the client in the constructor Steps to reproduce If you have a runnable example please include it as a snippet or link to a repositorygist for larger code examples This is how the args passed to Aws S S Client look like neon httphandler amazonHttpClient our Guzzle client region euwest version latest credentials key xxx secret yyy I also learned that some of the read attempts go down when I additionally pass s useast regionalendpoint legacy in there even when we use a different region Additional context Any additional information relevant to the issue Examples include any framework you may be using eg Laravel Wordpress in conjunction with the AWS SDK for PHP or PHPenvironment config settings if the issue is related to memory or performance This is causing us performance issues I try to deploy Laravel application using AWS Lambda Version of AWS SDK for PHP Version of PHP php v What issue did you see Error executing SendMessage on https sqsapsoutheast amazonawscom LaravelCLIproduction AWS HTTP error Client error POST https sqsapsoutheast amazonawscom LaravelCLIproduction resulted in a Forbidden response nSender TypeI truncated n InvalidClientTokenId client The security token included in the request is invalid Sender TypeInvalidClientTokenId CodeThe security token included in the request is invalid Message Errorc c e fe f c e b ac RequestId ErrorResponse Steps to reproduce I have created an role with following permissions Version Statement Action ec CreateNetworkInterface ec DeleteNetworkInterface ec DescribeNetworkInterfaces logsCreateLogGroup logsCreateLogStream logsPutLogEvents ssmGetParameters ssmGetParameter lambdainvokeFunction s ses sqs dynamodb route domains Effect Allow Resource and create a Lambda function with custom runtime and try to dispatch a job to SQS to queue but that time I got this message VPC is not assigned HHVM LTS can run both composer and PHPUnit so it should be used to test against Using GuzzleHttp and awssdk from master we get this error Undefined class constant VERSION at vendorawsawssdkphpsrcfunctionsphp cause they removed the deprecated VERSION constant Version of AWS SDK for PHP awsawssdkphp Version of PHP php v PHP cli built Mar NTS Copyright c The PHP Group Zend Engine v Copyright c Zend Technologies with Zend OPcache v Copyright c by Zend Technologies What issue did you see as previous since Dec th from Guzzles ClientInterface VERSION constant is removed Steps to reproduce this is the function that cause the issue function defaulthttphandler version string ClientInterfaceVERSION if version return new Aws Handler GuzzleV GuzzleHandler elseif version return new Aws Handler GuzzleV GuzzleHandler else throw new RuntimeExceptionUnknown Guzzle version version Additional context as in copied function it could be necessary create a new v GuzzleHandler Version of AWS SDK for PHP Version of PHP php v What issue did you see The issue is with exported image files from Photoshop CC Windows With the SDK when trying to use getimagesize on a jpg image with custom stream wrapper getimagesize s s euwest amazonawscombucketnameimagePhotoshopDuplicatejpg the function will return an error but when using a standard stream wrapper getimagesize the function will work as expected This issue is caused because Photoshop is adding some metadata headers to the original file upon exportsave I dont know why exactly this is happening but clearly the StreamWrapper is failing in handling these special headers This looks like a bug with Photoshop but I think the StreamWrapper needs to know how to handle it Steps to reproduce Get an uncorrupted image from any source duplicate it import the duplicate to Photoshop CC Windows maybe other versions will work too and exportsave it as a jpeg file Upload the photoshop duplicate and the original image to an S bucket Using the SDK create an S client and register a custom Stream Wrapper s will suffice try to run getimagesize on both of the images with and without the custom stream wrapper You can use the following code as an example vardumpgetimagesize vardumpgetimagesize s s euwest amazonawscombucketnameimageOriginaljpg vardumpgetimagesize vardumpgetimagesize s s euwest amazonawscombucketnameimagePhotoshopDuplicatejpg The getimagesize function will fail on the photoshop duplicate image when using the custom stream wrapper showing an error about corrupted bytes but the https will read it perfectly optional Use a tool like ExifTool to compare the headers and metadata of the original image and the one exported by Photoshop Run exiftool all imagePhotoshopDuplicatejpg to remove all the headers from the Photoshop exported image and then reupload it to S and run the same tests again as in step You should now get a perfect result on all tests Additional context I found a closed issue from with exactly the same problem The image that was uploaded to that issue was indeed an image with Photoshop CC Windows headers it can be used for a test if theres no Photoshop CC software available I hope that now with enough evidence this issue can be solved Please fill out the sections below to help us address your issue Version of AWS SDK for PHP Version of PHP php v What issue did you see Average response time exceeds second When I create SecretsManagerClient to GetSecretValue The response time exceeds second Attach is the newrelic track trace Why is the method response to get credentials so slow This issue does not occur in older versions Maybe there are other ways to get credentials My application run in ec Steps to reproduce If you have a runnable example please include it as a snippet or link to a repositorygist for larger code examples image Additional context Any additional information relevant to the issue Examples include any framework you may be using eg Laravel Wordpress in conjunction with the AWS SDK for PHP or PHPenvironment config settings if the issue is related to memory or performance 