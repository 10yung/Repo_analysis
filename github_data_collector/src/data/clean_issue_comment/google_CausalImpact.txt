I apply casual impact with the following code impact CausalImpactSynthTS preperiod postperiod modelargs listniter nseasons seasonduration dynamicregressionFALSE but I hit the following error Error in parsetext x keepsource FALSE text unexpected symbol My Column For debugging my SynthTS is a zoo object strSynthTS zoo series from to Data num attr dimnamesList of NULL chr My Column My Column My Column My Column Index Date format Can it be an issue that my column names have a space inside Hi I used a customized BSTS model for CausalImpact by using zoo object for response variable however the plot function didnt show the preintervention error bar shown as below Any ideas about how to fix it Thanks I am trying to exclude a single date in my post period and model the impact with the rest of the dates If I dont filter out the single date see greydate below the code runs fine and returns results If I do filter out the greydate then it causes R to crash prestart preend poststart postend preperiod asDatecprestart preend postperiod asDatecpoststart postend greydate metric xyz datacomp dat filterds asDateprestart ds asDatepostend filterds asDategreydate this line causes crash works fine without it selectds country metric spreadcountry metric timeseries zoodatacomp selectNO NL datacompds CausalImpact impact CausalImpact timeseries preperiod postperiod modelargs listpriorlevelsd niter nseasons seasonduration See impactinferenceR line R summary dplyrmutatesummary RelEffect AbsEffect Pred RelEffectlower AbsEffectlower Pred RelEffectupper AbsEffectupper Pred RelEffectsd AbsEffectsd Pred I noticed negative RelEffectsd in my CausalImpactObjectsummary which is clearly the product of not using absPred as the denominator as I believe it should be in each of these cases In particular the upper and lower bounds are out of order too when Pred Hi from looking at the code I can see that CausalImpact generates the posterior predictive samples by getting the state value draws and sampling noise with variance equal to the sigmaobs draws from the bsts model object When I try to replicate the inference step using predictbsts I get different results In particular the credible intervals produced by generating the posterior predictive with bstspredict are larger than CausalImpact suggests The bounds of the relative difference credible interval can differ by Is there inherently a difference between how CausalImpact prediction and predictbsts works Ive attached example code below librarymagrittr libraryCausalImpact Dummy data setseed x arimasimmodel listar n y x rnorm y y data cbindy x preperiod c postperiod c Run CausalImpact impact CausalImpactdata preperiod postperiod modelargs listniter standardizedata F Predictions from bsts bstsmodel impactmodelbstsmodel bstspredict predictbstsbstsmodel newdata data postperiod postperiod x Actuals as a matrix observedpost data postperiod postperiod y repnrowbstspredictdistribution matrixnrow nrowbstspredictdistribution byrow T Calculate differences ppddiff observedpost bstspredictdistribution Cumulative to last day of post period diffcum rowSumsppddiff reldiffcum rowSumsppddiffrowSumsobservedpost Calculated stats catAbsolute difference n cquantilediffcum mn meandiffcum quantilediffcum print Returns catRelative difference n cquantilereldiffcum mn meanreldiffcum quantilereldiffcum print Returns Compare to CausalImpact CIs summaryimpact Returns thanks for releasing this amazing library Are there any documented use cases of how Google uses this CausalImpact library on real world data Itd also be helpful if someone could point me to any documentation of this library being used for practical real use cases and not just sample data Im trying to understand the limitations in the interpretation of the output before I use this library to reach any conclusions for an actual use case Thanks Hi Ive been working with bsts to model timeseries and make forecasts but have run into some problems with the predict function and holidays When I train the model with regressor holidays these regressors do not appear to be used in the predict function For instance in a simple local level model the holiday regressor causes the response variable to go down but the predictor of the response over the same period does not capture this behaviour I attach below a minimum working example based on the regressionholiday code from the documentation librarybsts libraryggplot setseed trend cumsumrnorm dates seqDatefrom asDate length lengthtrend by day y zootrend rnormlengthtrend dates AddHolidayEffect functiony dates effect Adds a holiday effect to simulated data Args y A zoo time series with Dates for indices dates The dates of the holidays effect A vector of holiday effects of odd length The central effect is the main holiday with a symmetric influence window on either side Returns y with the holiday effects added time dates lengtheffect for i in lengtheffect y time y time effect i time time returny Define some holidays memorialday NamedHolidayMemorialDay memorialdayeffect c memorialdaydates asDatec y AddHolidayEffecty memorialdaydates memorialdayeffect The holidays can be in any order holidaylist listmemorialday Lets train the model to just before MemorialDay cutdate asDate traindata y timey cutdate testdata y timey cutdate ss AddLocalLevellist traindata ss AddRegressionHolidayss traindata holidaylist holidaylist model bststraindata statespecification ss niter ping Now lets make a prediction covering MemorialDay myhorizon Note adding the time stamps here doesnt help either pred predictobject model horizon myhorizon Make a data frame for plotting plotinfo dataframeDate timey value y predictmean NA predictupper NA predictlower NA plotinfo plotinfoDate in timetestdata myhorizon predictmean predmean plotinfo plotinfoDate in timetestdata myhorizon predictlower predinterval plotinfo plotinfoDate in timetestdata myhorizon predictupper predinterval Lets make a pretty plot to demonstrate the problem filterplotinfo Date timetestdata Date timetestdata myhorizon ggplotaesx Date y value geomline geomlineaesy predictmean col Forest Green The prediction geomlineaesy predictlower col Forest Green lty lower bound geomlineaesy predictupper col Forest Green lty upper bound Using the same dataset multiple runs of CausalImpact produce different pvalues and confidence intervals using bsts They are within a small range of each other when using large niter values but I want to produce the same values each time How can these be controlled so that the results are consistent with every run Thanks Hi what is the best way to handle past known interventions effects in the time series thx Hi While using my dataset for this model Ive run into this error bstsmodeloriginalseries must end on a stretch of NA at least as long as ycf Ive tried to read the github code to better understand this error but Im still stuck Is there any advice that I can use in diagnosing this Thanks