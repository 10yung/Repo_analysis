 file xlsxNewFile sheet err fileAddSheetSheet if err nil fmtPrintlnerrError return sheetCell SetStringBBBBBB colStyle xlsxNewStyle colStyleFillFgColor EEEEEE colStyleFillPatternType solid colStyleApplyFill true col xlsxNewColForRange colSetStylecolStyle sheetSetColParameterscol sheetCell SetStylecolStyle err fileSaveEGoModxlsxTtdxlsx if nil err fmtPrintlnerrError return dxlsx go for sheet range fileSheets for row range sheetRows for cell range rowCells cellGetStyleAlignmentHorizontal center This code will cost too much mem Hope for a more efficient GetStyle implementation version v v v xlsx panic runtime error invalid memory address or nil pointer dereference signal SIGSEGV segmentation violation code x addr x pc x e d goroutine running archivezipFilefindBodyOffset x x xc aab x usrlocalCellargo libexecsrcarchivezipreadergo x archivezipFileOpen x xc aab xc fb x x usrlocalCellargo libexecsrcarchivezipreadergo x githubcomxiaoxiaoxiaoxlsxreadSheetFromFile x xc x x ef x xc x x x xc d Usersyunzhanghu gosrcgithubcomtealegxlsxlibgo x b githubcomxiaoxiaoxiaoxlsxreadSheetsFromZipFile xc e xc d xc f x e x x b xc a x xc efd xc Usersyunzhanghu gosrcgithubcomtealegxlsxlibgo x c githubcomxiaoxiaoxiaoxlsxReadZipReaderWithRowLimit xc a x e x x x Usersyunzhanghu gosrcgithubcomtealegxlsxlibgo x f githubcomxiaoxiaoxiaoxlsxReadZipWithRowLimit xc a x e x x x Usersyunzhanghu gosrcgithubcomtealegxlsxlibgo x f githubcomxiaoxiaoxiaoxlsxOpenFileWithRowLimit xc x x e x xc cfb x Usersyunzhanghu gosrcgithubcomtealegxlsxfilego x d mainReadXlsx xc x x f x d x xc x Usersyunzhanghu gosrctestmaingo x mainmain Usersyunzhanghu gosrctestmaingo x exit status code worksheetRelsFile fiworksheetRels sheetrsheetSheetId worksheetRels newxlsxWorksheetRels rc err worksheetRelsFileOpen if err nil return nil err worksheetRelsFile is Null version v go func main file xlsxNewFile array string string string sheet err fileAddSheetSheet if err nil panicerr for arr range array if n sheetAddRowWriteSlice arr lenarr n panic sheetSetColWidth lenarray sheetColsForEachfuncidx int col xlsxCol fmtPrintlnidx colWidth err fileSavetestxlsx if err nil panicerr testlargefilexlsx this file hava many rows and cols need a large of memory below function can support go OpenFileWithCtxctx contextContext pathFile error ctx cancel ctx cancel contextWithTimeoutcontextBackground timeMillisecond defer cancel f err OpenFileWithCtxctx path when i open an xlsx file there is an error runtime errorindex out of range occurred in xmlStylego at line if colorIndexed nil stylesColors nil return stylesColorsindexedColorcolorIndexed colorTint return colorRGB func c xlsxColors indexedColorindex int tint float string return cIndexedColors index Rgb Hi introduces a change that makes previously fine code panic Now this generates a panic file xlsxNewFile sheet fileAddSheetSheet sheetCol What is the new way of accessing a column to set a style I would like to start by thanking you for building a great Excel library One improvement that would be awesome would be to be able to support loading and writing documents containing charts and drawings A use case example you want to build an Excel report that contains some fancy charts in order to achieve this you load templatexlsx that contains the charts and one sheet that you populate with data Then write the result to reportxlsx I have tested a simple workaround where i just copy the xlchart and xldrawings files from templatexlsx to reportxlsx This naive solution does not work Excel finds the file damaged and removes the charts when it attempts to fix the problem So I guess it is required to keep some references up to date when modifying the file which I have not investigated further Excel files contents for reference Archive templatezip inflating ContentTypes xml inflating relsrels inflating xlrelsworkbookxmlrels inflating xlworkbookxml inflating xlstylesxml inflating xlsharedStringsxml inflating xldrawingsdrawing xml inflating xlchartschart xml inflating xlthemetheme xml inflating xlchartscolors xml inflating xlchartsstyle xml inflating xlchartsrelschart xmlrels inflating xlworksheetssheet xml inflating xlworksheetssheet xml inflating xlworksheetsrelssheet xmlrels inflating xldrawingsrelsdrawing xmlrels inflating docPropsappxml inflating docPropscorexml Archive reportzip inflating ContentTypes xml inflating xlworksheetssheet xml inflating xlworksheetssheet xml inflating docPropsappxml inflating xlthemetheme xml inflating xlsharedStringsxml inflating xlworkbookxml inflating relsrels inflating docPropscorexml inflating xlrelsworkbookxmlrels inflating xlstylesxml 