I suppose it should return OHLC of a period but the results are the last row of a period Is this a bug r df FANG filtersymbolFB slice FB JanFeb data tqtransmutedf selectopenclose mutatefuntomonthly date open high low close yearmon dbl dbl dbl dbl Jan Feb manually transform to xts then tomonthly get the right data df selectdate Openopen Highhigh Lowlow Closeclose tkxts tomonthly Open High Low Close Jan Feb I have the following code Load Libs Time Series analysis of CCI crypto index installloadinstallload tidyquant timetk tibbletime tsibble sweep anomalize caret forecast funModeling xts fpp lubridate tidyverse urca prophet Daily OHLCV url destfile cci OHLCVcsv downloadfileurl destfile destfile df readcsvcci OHLCVcsv classdf Format Date dfDate lubridateymddfDate dftibble astsibbledf index Date classdftibble headdftibble taildftibble Add varaibles dftibble dftibble tqmutate select Close mutatefun dailyReturn colrename DailyReturn At this point it fails with the following error Selecting index Date Selecting index Date Selecting index Date Error in dplyrmatchesdatevar isstringmatch is not TRUE Session Info sessionInfo R version Platform x w mingw x bit Running under Windows x build Matrix products default locale LCCOLLATEEnglishUnited States LCCTYPEEnglishUnited States LCMONETARYEnglishUnited States LCNUMERICC LCTIMEEnglishUnited States attached base packages stats graphics grDevices utils datasets methods base other attached packages prophet rlang Rcpp urca forcats stringr dplyr purrr readr tidyr tibble tidyverse fpp tseries lmtest expsmooth fma funModeling Hmisc Formula survival forecast caret ggplot lattice anomalize sweep tsibble timetk tidyquant quantmod TTR PerformanceAnalytics xts zoo lubridate loaded via a namespace and not attached readxl backports plyr lazyeval splines entropy inline digest foreach htmltools gdata fansi magrittr checkmate cluster ROCR recipes modelr gower matrixStats anytime prettyunits colorspace installload rvest haven xfun callr crayon jsonlite zeallot iterators glue gtable ipred pkgbuild Quandl rstan scales DBI htmlTable foreign stats lava StanHeaders prodlim htmlwidgets httr gplots RColorBrewer acepack pkgconfig loo nnet dbplyr utf tidyselect reshape munsell cellranger tools cli generics moments broom ModelMetrics processx knitr fs pander caTools packrat nlme xml compiler rstudioapi curl reprex stringi ps Matrix vctrs pillar lifecycle datatable bitops R latticeExtra KernSmooth gridExtra codetools MASS gtools assertthat withr fracdiff parallel hms quadprog grid rpart timeDate class pROC base enc Hello tidy quant Im having an issues plotting geombarchart geomcandlestick function Using a Simple code to Test the plot I plot a barchart but there is no difference in width for the shadow and body Code AAPL ggplotaesx date y close geomcandlestickaesopen open high high low low close close geommacolor darkgreen coordxdatexlim ctoday weeks today ylim c Plot CandlestickPlot Im i missing some dependencies Thank you in advance I have been using tidyquanttqtransmute inside a function of one of my packages but today I got the following error Error in checktransmutefunoptionsmutatefun fun xtsapplymonthly not a valid option My tidyquant version is In the replacebadnames function seems its setup to look for low as part of an OHLC format but it also detects titles with those three letters for example maslow for naming a slow moving average Suggestion to change the regex so that it only selects specifically low When I calculate a monthly portfolio return I found an issue The results are not equal when you add and do not add the rebalanceon cmonths argument And By calculating returns on myself I think the argument should not be omitted I don not know how the tqportfolio works exactly and I suggest you guys to make a check If I were right then original examples about portfolio returns should be corrected For your convenience the following is my codes librarytidyquant stockreturnsmonthly cAAPL GOOG NFLX tqgetget stockprices from to groupbysymbol tqtransmuteselect adjusted mutatefun periodReturn period monthly colrename Ra weights c stocks cAAPL GOOG NFLX weighttibble tibblesymbol stocks bindcolstibbleweights portfolioreturnsmonthlyrebalance stockreturnsmonthly tqportfolioassetscol symbol returnscol Ra weights weighttibble rebalanceon cmonths colrename portretrebalance portfolioreturnsmonthly stockreturnsmonthly tqportfolioassetscol symbol returnscol Ra weights weighttibble rebalanceon cmonths colrename portret portfolioreturnsmonthlybyhand stockreturnsmonthly leftjoin weighttibble by symbol groupbydate mutate portretbyhand sumRaweights select date portretbyhand distinctall all portfolioreturnsmonthlyrebalance bindcolsportfolioreturnsmonthly bindcolsportfolioreturnsmonthlybyhand note the nd th and th column are calculated with rebalanceon option without that option and by hand Here an example logrettable gatherkey asset value ret date groupbyasset tqperformanceRa ret performancefun AdjustedSharpeRatio Output A tibble x Groups asset asset AnnualizedSharpeRatioRf chr dbl ACWI ATX I have following tbltime object data structurelistindex structurec class Date zadnja c ma c ma c macd c dn c up c pctB c ema c rownames cNA L ticker HT indexquo index indextimezone UTC class ctbltime tbldf tbl dataframe I can create new differenced column data tidyquanttqmutatedata select cls mutatefun diffxts but cant do the same inside function that is using strings for column names cls zadnja data tidyquanttqmutatedata select cls mutatefun diffxts It returns an error Error in matchx table nomatch L match requires vector arguments I would also like to change column name in place In above example if I want to change column zadnja it add new column zadnja librarytidyquant aaplkeyratios tqgetAAPL get keyratios Warning messages x AAPL get keyratios Error in UseMethodaslist no applicable method for aslist applied to an object of class NULL x AAPL get keyratios Error in evallhs parent parent object keyratiosbind not found appears these URLs or no longer work to scrape the data files However the option to download key ratiosstatements still exists i assume the URL has been changed How do I import a timeseries that I have obtained elsewhere and stored in an R object eg a dataframe into a tidyquant tibble 