It is currently impossible to create a model without intercept for various linear regression models I noticed this for example for lmStepAIC leapSeq leapForward leapBackward I have managed to create my own modelInfo for leapSeq that works shown below its the same as the generic one but with interceptint set to F but it would be nice if this could be done in a better way No hurry just an idea modelInfo listlabel Linear Regression with Stepwise Selection library leaps type Regression parameters dataframeparameter nvmax class numeric label Maximum Number of Predictors grid functionx y len NULL search grid ifsearch grid out dataframenvmax len else out dataframenvmax sortuniquesample ncolx size len replace TRUE out loop functiongrid grid grid ordergridnvmax decreasing TRUE drop FALSE loop grid drop FALSE submodels listgrid drop FALSE listloop loop submodels submodels fit functionx y wts param lev last classProbs theDots list ifanynamestheDots nbest stopnbest should not be specified ifanynamestheDots method stopmethod should not be specified ifanynamestheDots nvmax stopnvmax should not be specified leapsregsubsetsasmatrixx y weights ifisnullwts wts else rep lengthy nbest nvmax paramnvmax method seqrep intercept F int F predict functionmodelFit newdata submodels NULL newdata asmatrixnewdata foo functionb x x namesbdrop FALSE b path modelFitnvmax betas coefmodelFit id modelFitnvmax newdata cbindrep nrownewdata asmatrixnewdata colnamesnewdata Intercept out foobetas lengthbetas newdata ifisnullsubmodels numTerms unlistlapplybetas length ifanynamesbetas lengthbetas Intercept numTerms numTerms Need to find the elements of betas that correspond to the values of submodelsnvmax keepers whichnumTerms in submodelsnvmax iflengthkeepers lengthsubmodelsnvmax stopSome values of nvmax are not in the model sequence The grid code sorted from largest to smallest so to match them reverse the order keepers revkeepers preds lapplybetas keepers foo x newdata preds docallcbind preds out asdataframecbindout preds out aslistout out tags cLinear Regression Feature Selection Wrapper prob NULL sort functionx x orderx Trying to use a bartMachine model the following error appears with caret but not with caret Error in if grepladaptive trControlmethod nrowtuneGrid argument is of length zero Minimal reproducible example R librarycaret librarymlbench dataBostonHousing bartFit train medv data BostonHousing method bartMachine trControl trainControlmethod cv Session Info R R version Platform x pclinuxgnu bit Running under Ubuntu LTS Matrix products default BLASLAPACK optOpenBLASliblibopenblaspr so locale LCCTYPEenUSUTF LCNUMERICC LCTIMEenGBUTF LCCOLLATEenUSUTF LCMONETARYenGBUTF LCMESSAGESenUSUTF LCPAPERenGBUTF LCNAMEenGBUTF LCADDRESSenGBUTF LCTELEPHONEenGBUTF LCMEASUREMENTenGBUTF LCIDENTIFICATIONenGBUTF attached base packages stats graphics grDevices utils datasets methods base other attached packages mlbench caret ggplot lattice sos brew loaded via a namespace and not attached bartMachine splines foreach carData prodlim assertthat stats cellranger yaml ipred pillar backports glue pROC digest randomForest colorspace recipes htmltools Matrix plyr timeDate pkgconfig haven purrr bartMachineJARs scales itertools openxlsx gower lava rio tibble generics car withr nnet lazyeval survival magrittr crayon readxl evaluate nlme MASS forcats foreign class tools datatable hms lifecycle stringr munsell zip missForest compiler rlang grid iterators rstudioapi rmarkdown gtable ModelMetrics codetools abind curl reshape R lubridate knitr dplyr zeallot rJava stringi parallel Rcpp vctrs rpart tidyselect xfun x Start a new R session x Install the latest version of caret updatepackagesoldPkgscaret askFALSE x Write a minimal reproducible example x Do not use parallel processing in the code unless you are certain that the issue is about parallel processing x run sessionInfo I get this error with a train object of knn type in this code line pred extractPredictionlistmodelpls modellm modelknn modelrp testX testData testY testDataClose plotObsVsPredpred Error in knnregTraintrain c dims of test and train differ This is the code for knn with train the other models work with the plot function modelknn trainClose datatrainData methodknn trControl controltuneGrid hypergrid ggplotmodelknn knnpredict predictmodelknn testData postResampleknnpredict testDataCloseeth How can I solve this Many thanks Is it possible to add qrnn tau parameter user specified quantiles into train and predict function of the caret package To my understanding only tau parameter is automatically used eg qneuroncox traincox data datatraincox method qrnn tuneLength trControl control metric RMSE predictqneuroncox newdata datatestcox Where to add tau parameter Hi I am trying to recreate a random forest model from a paper and the code doesnt seem to work i am only just learning R and this is very much over my head but i will try to explain as best I can The source code from the paper can be found here The paper supplies two datasets training and test and then creates two subsets for each dataset see attached notepad for a head of the data trainingtxt testtxt should be able to directly copy to a csv code is below sinktesttxt splitTRUE printdata process databintrainreadcsvtrainingcsv headTRUE namesdatabintrain databintestreadcsvtestcsv headTRUE namesdatabintest dsptbintrainsubsetdatabintrainselectcDeamidation dsptbintestsubsetdatabintestselectcDeamidation classbintrainsubsetdatabintrain selectcDeamidation classbintestsubsetdatabintest selectcDeamidation librarycaret libraryROCR librarypROC fitControl trainControlmethod CVnumber returnResamp all verboseIter FALSE classProbs TRUE setseed this bit works fine Then the next bit of code is where i get the error libraryrandomForest printRandom Forest binary class via caret randomForest caretrfbinrandomfcv trainDeamidation datadatabintrain method rf preProcess ccenter scale tuneLength trControl fitControl caretrfbinrandomfcv varImpcaretrfbinrandomfcv rfbinPreds extractPredictionlistcaretrfbinrandomfcv testXdsptbintest testYclassbintest Error in dataframenewdata objectmethodcenter drop FALSE undefined columns selected Any help would be amazing The paper used R v caret whereas i am running updated versions of both which is where i believe the error is coming from but im not sure how to fix it or to be honest what the error even is Thank you TinoMass below is the sessionInfo R version Platform x w mingw x bit Running under Windows x build Matrix products default locale LCCOLLATEEnglishUnited Kingdom LCCTYPEEnglishUnited Kingdom LCMONETARYEnglishUnited Kingdom LCNUMERICC LCTIMEEnglishUnited Kingdom attached base packages stats graphics grDevices utils datasets methods base other attached packages randomForest pROC ROCR gplots caret ggplot lattice loaded via a namespace and not attached Rcpp pillar compiler gower plyr bitops iterators class tools rpart ipred lubridate lifecycle tibble nlme gtable pkgconfig rlang Matrix foreach rstudioapi prodlim e withr stringr dplyr caTools gtools generics recipes stats grid nnet tidyselect datatable glue R survival gdata lava reshape purrr magrittr ModelMetrics scales codetools MASS splines assertthat timeDate colorspace KernSmooth stringi lazyeval munsell crayon x Start a new R session x Install the latest version of caret updatepackagesoldPkgscaret askFALSE x Write a minimal reproducible example x Do not use parallel processing in the code unless you are certain that the issue is about parallel processing x run sessionInfo Overview When using caret to train an XGBoost model with parallelization at the resample level execution continues indefinitely or at least for more than several hours in my tests when the first summaryFunc used is of type twoClassSummary For the same code if a call is first made to train on any arbitrary data however the executions proceeds as expected and in the case of the example below finishes in seconds This effect does not appear to depend on the parallelization backend used tested with doParallelPSOCK doMC doFuture It also occurs if the twoClassSummary is used alongside of other summary functions as part of a yardstick metricset Based on this behavior Im guessing there is some kind of initialization of the interface with the parallelization backend that normally occurs during the first invocation to train which is not taking place asexpected in the case below Minimal reproducible example To see the behavior in action first run the code below asis and at least in the linux environment Im testing it in it will likely continue running for a long time Next uncomment the commented first call to train and rerun the script It will execute in parallel and finish quickly as expected r librarycaret setseed create fake data testdat twoClassSim librarydoFuture registerDoFuture planmultiprocess workers paralleldetectCores fast when the lines below are uncommented mod trainClass data testdat method xgbTree tuneLength nthread trControl trainControlsearch random messagewarmup done traincontrol trainControlsearch random classProbs TRUE summaryFunction twoClassSummary t Systime mod trainClass data testdat method xgbTree tuneLength nthreads trControl traincontrol metric ROC t Systime t t with warmup seconds without warmup hrs Session Info Tested for two different versions of Rcaret the same Linux machine R Using the current version of caret on CRAN r R version Platform x pclinuxgnu bit Running under Arch Linux Matrix products default BLAS usrliblibopenblaspr so LAPACK usrlibliblapackso locale LCCTYPEenUSUTF LCNUMERICC LCTIMEenUSUTF LCCOLLATEenUSUTF LCMONETARYenUSUTF LCMESSAGESenUSUTF LCPAPERenUSUTF LCNAMEC LCADDRESSC LCTELEPHONEC LCMEASUREMENTenUSUTF LCIDENTIFICATIONC attached base packages parallel stats graphics grDevices utils datasets methods base other attached packages doFuture iterators foreach future globals caret ggplot lattice loaded via a namespace and not attached Rcpp pillar compiler gower plyr tools class digest rpart ipred lubridate lifecycle tibble nlme gtable pkgconfig rlang Matrix prodlim e stringr withr dplyr generics recipes xgboost stats grid nnet tidyselect datatable glue listenv R survival lava reshape purrr magrittr ModelMetrics scales codetools MASS splines assertthat timeDate colorspace stringi lazyeval munsell crayon R nightly Using latest version of Caret from the GH master branch commit cdd R Under development unstable r Platform x pclinuxgnu bit Running under Arch Linux Matrix products default BLAS usrliblibopenblaspr so LAPACK usrlibliblapackso locale LCCTYPEenUSUTF LCNUMERICC LCTIMEenUSUTF LCCOLLATEenUSUTF LCMONETARYenUSUTF LCMESSAGESenUSUTF LCPAPERenUSUTF LCNAMEC LCADDRESSC LCTELEPHONEC LCMEASUREMENTenUSUTF LCIDENTIFICATIONC attached base packages parallel stats graphics grDevices utils datasets methods base other attached packages doFuture iterators foreach future globals caret ggplot lattice loaded via a namespace and not attached Rcpp pillar compiler gower plyr tools class digest rpart ipred lubridate lifecycle tibble nlme gtable pkgconfig rlang Matrix prodlim e stringr withr dplyr generics recipes xgboost stats grid nnet tidyselect datatable glue listenv R survival lava reshape purrr magrittr ModelMetrics scales codetools MASS splines assertthat timeDate colorspace stringi lazyeval munsell crayon Hi I came across a weird problem When I use the package in windows and it is okay But when I use the package in linux there is some problems the AUC is negative Could you have some suggestions r librarycaret setseed imbaltrain twoClassSim intercept linearVars ctrl trainControlmethod repeatedcv repeats classProbs TRUE summaryFunction twoClassSummary setseed origfit trainClass data imbaltrain method treebag nbagg metric ROC trControl ctrl origfit Bagged CART samples predictor classes Class Class No preprocessing Resampling CrossValidated fold repeated times Summary of sample sizes Resampling results ROC Sens Spec Hello I got this warning message again when use Caret for ANN model Warning message In nominalTrainWorkflowx x y y wts weights info trainInfo There were missing values in resampled performance I checked the resample performance as suggested by this but find no NA Could you please advise the reason for this issue Is there by any chance I can ask Caret to output the performance matrics of every cross validation samples When returnData is TRUE in trainControl and the training data is a sparse matrix object the following warning is generated Warning traindefaultx trainx y asfactorifelsetrainy The training data could not be converted to a data frame for saving This fixes the problem mentioned in by adding a simple condition checking for sparseMatrix objects in traindefault and converts it to regular matrix object before conversion to dataframe This fixes carets glmnet model object so that sparse matrix objects are not converted to regular matrix anymore I was experiencing extremely long CV and training times with caret in comparison to vanilla glmnetcvglmnet with sparse matrix data coming from text vec This problem was mentioned in Carets code for training and testing a glmnet model currently checks if the input data is a sparse matrix using the class function This is incorrect as sparse matrices from Matrix can be of different classes For example my object returned by text vec is of class dgCMatrix The fix relying on the inherits function instead of class should work with any sparse matrix returned by the Matrix package Note that I didnt include in the commit the updated binary pkgcaretinstmodelsmodelsRData generated by modelsparseModelsR