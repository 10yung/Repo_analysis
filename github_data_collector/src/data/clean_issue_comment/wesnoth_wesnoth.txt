 This removes the need for the separate file and the giant if chain by using a stdmap instead Game and System Information Upcoming I am translating Describe the bug srcformulastringutilscpp msgid timespan num year msgstr srcformulastringutilscpp msgid timespan num years msgstr This is wrong and needs to be ngettext format Same for months etc To Reproduce Get the string on screen with a locale like gd and have it fetch a plural number I dont know where it is used exactly Expected behavior srcformulastringutilscpp msgid timespan num year msgidplural timespan num years msgstr msgstr msgstr msgstr The Naga line of the Dunefolk didnt make much sense to me but I realize it may have been done with an eye to MP balance so I tried to be conservative in revisions The biggest issue was that the bow seemed to be a reason to use the hunter naga portrait but was very forced Maybe it was for MP balance as well In any case I plan to get basic animation defense at the very least for these but thats not started yet If the system default language is used then this can activate a translation that is too incomplete to be displayed in the translations list Should this happen or should it fall back to English instead Context investigating issue although my next task is to ask the author of that issue how the language was selected Replication ptPT is translated and can be recognised by having Editor do Mapa on the title screen ptBR is translated and can be recognised by having Editor de Mapa on the title screen set the language in the GUI to system default language run Wesnoth with LANGptUTF and LANGptBRUTF note that the ptUTF instance is showing the translated language The replication steps will change slightly if is fixed Game and System Information but observed from times as well for used workaround which no longer works due to Describe the bug wesnoth p fails when input contains QUICK MPLEADERS orTURNSOVERADVANTAGE To Reproduce Have addonInmaincfg containing QUICK MPLEADERS Run wesnoth p addonIn addonOut Expected behavior QUICK MPLEADERS is expanded Actual behavior Battle for Wesnoth v Started on Sat Jan Automatically found a possible data directory at C Users USER games Battle for Wesnoth added defines preprocessing common macros from datacore acquired datacore defines preprocessing specified resource addonIn error preprocessor Macrofile QUICK MPLEADERS is missing at CUsersRavanagamesBattle included from Wesnothfor included from unknown addonInmaincfg Additional context This stacktrace seems strange Game and System Information Describe the bug preprocessoutputmacros and preprocessinputmacros do not support default arguments To Reproduce For easier reproductions all paths are relative to wesnoth directory In file addonInmaincfg put tag keyARGUSE tag In file addonMacrosmaincfg put define ARGNAME error enddef define ARGUSE arg ARGNAME success endarg ARGNAME enddef Run wesnoth preprocessdefines MULTIPLAYERSKIPCORE p addonMacros addonMacrosOut preprocessoutputmacros wesnoth preprocessdefines MULTIPLAYERSKIPCORE preprocessinputmacros addonMacrosOutMACROScfg p addonIn addonOut Expected behavior addonOutmaincfg contains tag keysuccess tag Actual behaviour addonOutmaincfg contains tag keyerror tag Additional context Battle for Wesnoth v Started on Sat Jan Automatically found a possible data directory at C Users USER games Battle for Wesnoth Overriding data directory with C Users Ravana games Battle for Wesnoth Reading cached defines from core MACROScfg Read defines SKIPCORE defined added defines skipped datacore preprocessing specified resource C Users Ravana Documents My Games Wesnoth data addons AgelessEra warning preprocessor Redefining macro AURAHALO without explicit undef at addonsAgelessEradataEoCdataanimationutilscfg included from addonsAgelessEramaincfg included from addonsAgelessEradatamaincfg included from addonsAgelessEramaincfg previously defined at addonsAgelessEraanimmacrosanimmacrosEoScfg included from addonsAgelessEramaincfg warning preprocessor Redefining macro HALFANIMATEDBOWANIMATION without explicit undef at addonsAgelessEradataEoCdataanimationutilscfg included from addonsAgelessEramaincfg included from addonsAgelessEradatamaincfg included from addonsAgelessEramaincfg previously defined at addonsAgelessEraanimmacrosanimmacrosEoScfg included from addonsAgelessEramaincfg warning preprocessor Redefining macro MISSILEFRAMERAVAGE without explicit undef at addonsAgelessEradataEoCdataanimationutilscfg included from addonsAgelessEramaincfg included from addonsAgelessEradatamaincfg included from addonsAgelessEramaincfg previously defined at addonsAgelessEraanimmacrosanimmacroscfg included from addonsAgelessEramaincfg warning preprocessor Redefining macro MISSILEFRAMEWATERSPRAY without explicit undef at addonsAgelessEradataEoCdataanimationutilscfg included from addonsAgelessEramaincfg included from addonsAgelessEradatamaincfg included from addonsAgelessEramaincfg previously defined at addonsAgelessEraanimmacrosanimmacrosEoScfg included from addonsAgelessEramaincfg error preprocessor Preprocessor symbol OVERLAY defined at coreterraingraphicsoverlaycfg expects arguments but has arguments at coremacrostraitscfg included from coremaincfg included from maincfg included from addonsAgelessEraunitsarchaicunitsukiansracecfg included from addonsAgelessEramaincfg included from addonsAgelessEraunitsmaincfg included from addonsAgelessEramaincfg addonsAgelessEraunitsarchaicunitsukiansracecfg is TRAITLOYAL Game and System Information Wesnoth from Ubuntu repo Ubuntu CPU Intel i cores threads Installed addons Color Changer Ladder Era Mini Isar Plan Unit Advance Describe the bug High CPU usage when playing or observing multiplayer game To Reproduce Steps to reproduce the behavior Open Wesnoth and connect to default Mplayer server According htop there is only Wesnoth process and its eating CPU thread with usage Create map MicroIsar for example or join as observer to any running game According htop there are Wesnoth process and all CPU threads now eating There is still main process with and other with Expected behavior Intel i is a top desktop CPU for one of previous platforms So its very strange behavior from rather simple game to eat it so hard Screenshots wesnothhighcpuusage Describe the bug The statistics dialog has a variable width which depends on the widest row in the currently selected list Selection of another list causes a change of the width of the dialog To Reproduce Open Statistics and change list Expected behavior Statistics dialog should have a fixed width or at least should not be shrinked Screenshots The width of the dialog changed when I changed Recruits Recalls statrecruit statrecall Game and System Information OS Linux Version compiled from master Game and System Information Windows Home ATI RX Graphics adapter Version Driver Version Battle for Wesnoth v eba fModified Steam version The Battle for Wesnoth version eba fModified Running on Microsoft Windows Game paths Data dir E Steam steamapps common wesnoth User config dir C Users USER Documents My Games Wesnoth User data dir C Users USER Documents My Games Wesnoth Saves dir C Users USER Documents My Games Wesnoth saves Addons dir C Users USER Documents My Games Wesnoth data addons Cache dir C Users USER Documents My Games Wesnoth cache Libraries Boost OpenSSLlibcrypto f runtime f Cairo runtime Pango runtime SDL runtime SDLimage runtime SDLmixer runtime SDLttf runtime Describe the bug After playing for about hours the screen suddenly scrambles when scrolling reproducing tiles over and over again Moving the cursor ober a unit restores the screen Scrolling again reproduces the error Restarting the game with the same savegame does not reproduce the error at once The error reoccurs after a new playing time of about one to two hours To Reproduce Play wesnoth for about hours Screenshots Scrambled Screen 