Hi Joseph I think there might be a small issue in stTrainm From what I know the clustersx and clustersy save the index of the center of each patch When the image is Paded by imPad the index begins the upleft point of a patch Thats why when you extract the feature of every path by using chnsxyj xyj pxyj xyj p where p is patchSiz However for negative patch index which you got from findM the index you need to got is also the center of a patch right If so however you index those negative patches assuming the point is the upleft point as can been sen in chnsxyj xyj pxyj xyj p because the size of chns is the paded size Let me know if I am wrong please Zizhao The Installation section of the README says to put BSR in dataBSR but the code looks for it directly in BSR without the data part 