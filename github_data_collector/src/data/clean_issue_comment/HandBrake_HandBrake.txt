 Problem description I have x so to get maximum core usage I use versions of handbrake running at the same time One of the apps just closes no error message just stops and when I reload it shoes the queue and where it was broken According to the Event Viewer its an unhandled exception HandBrake version eg Operating system and version eg Ubuntu macOS Catalina Windows Windows Error message text andor screenshot NET Runtime Application HandBrakeexe Framework Version v Description The process was terminated due to an unhandled exception Exception Info exception code c exception address AD FEC Application Error Faulting application name HandBrakeexe version time stamp x e Faulting module name hbDLL version time stamp x Exception code xc Fault offset x d fec Faulting process id x ac Faulting application start time x d cdf a cbb Faulting application path C Drive Applications Video HandBrake HandBrakeexe Faulting module path C Drive Applications Video HandBrake hbDLL Report Id f bf cb ab f a b Faulting package full name Faulting packagerelative application ID HandBrake Activity Log An Activity Log is required for support Please read for more information HandBrake OS Microsoft Windows NT CPU AMD Ryzen X Core Processor Ram MB GPU Information NVIDIA GeForce GTX Ti Screen x Temp Dir c Temp Workstation Install Dir C Drive Applications Video HandBrake Data Dir C Users Workstation AppData Roaming HandBrake Starting Encode hbinit starting libhb thread Starting work at Sun Jan jobs to process json job Audio AudioList Bitrate DRC Encoder avaac Gain Mixdown NormalizeMixLevel false Samplerate Name Pirates Of The CaribbeanThe Curse Of The Black Pearl Track DitherMethod CopyMask copyaac copyac copydtshd copydts copyeac copyflac copymp copytruehd FallbackEncoder ac Destination ChapterList Name Chapter ChapterMarkers true AlignAVStart false File C Drive Transcode Output Recode Pirates Of The Caribbean The Curse Of The Black Pearlmkv Mp Options IpodAtom false Mp Optimize false Mux mkv Filters FilterList ID Settings mode ID Settings blockheight blockthresh blockwidth filtermode mode motionthresh spatialmetric spatialthresh ID Settings cropbottom cropleft cropright croptop height width ID Settings mode rate PAR Num Den Metadata SequenceID Source Angle Range Type chapter Start End Title Path C Drive Transcode Action Adventure Pirates Of The Caribbean The Curse Of The Black Pearlmkv Subtitle Search Burn true Default false Enable true Forced true SubtitleList Video Encoder x bit Level auto TwoPass false Turbo false ColorMatrixCode Options Preset medium Profile auto Quality QSV Decode false AsyncDepth CPU AMD Ryzen X Core Processor logical processor count Intel Quick Sync Video support no hbscan pathC Drive Transcode Action Adventure Pirates Of The Caribbean The Curse Of The Black Pearlmkv titleindex udfread ERROR ECMA Volume Recognition failed srclibbluraydiscdiscc failed opening UDF image C Drive Transcode Action Adventure Pirates Of The Caribbean The Curse Of The Black Pearlmkv srclibbluraydiscdiscc error opening file BDMV indexbdmv srclibbluraydiscdiscc error opening file BDMV BACKUP indexbdmv srclibblurayblurayc navgettitlelistC Drive Transcode Action Adventure Pirates Of The Caribbean The Curse Of The Black Pearlmkv failed bd not a bd trying as a streamfile instead libdvdnav Using dvdnav version libdvdread Encrypted DVD support unavailable libdvdreadDVDOpenFileUDFUDFFindFile VIDEOTSVIDEOTSIFO failed libdvdreadDVDOpenFileUDFUDFFindFile VIDEOTSVIDEOTSBUP failed libdvdread Cant open file VIDEOTSIFO libdvdnav vm failed to read VIDEOTSIFO dvd not a dvd trying as a streamfile instead Input matroskawebm from C Drive Transcode Action Adventure Pirates Of The Caribbean The Curse Of The Black Pearlmkv Metadata encoder libebml v libmatroska v creationtime T Z Duration start bitrate kbs Stream Video h High yuv pprogressive x SAR DAR fps tbr k tbn tbc default Metadata title Pirates Of The CaribbeanThe Curse Of The Black Pearl By Li Stream eng Audio dts DTS Hz side fltp kbs default Metadata title Pirates Of The CaribbeanThe Curse Of The Black Pearl scan decoding previews for title scan audio x dca rate Hz bitrate English DTS ch kbps scan previews x fps autocrop aspect PAR scan supported video decoders avcodec qsv libhb scan thread found valid titles Skipping subtitle scan No suitable subtitle tracks Starting Task Encoding Pass Skipping cropscale filter work only chapter disabling chapter markers job configuration source C Drive Transcode Action Adventure Pirates Of The Caribbean The Curse Of The Black Pearlmkv title chapters to container matroskawebm data rate kbps destination C Drive Transcode Output Recode Pirates Of The Caribbean The Curse Of The Black Pearlmkv container Matroska libavformat video track decoder h filters Comb Detect mode spatialmetric motionthresh spatialthresh filtermode blockthresh blockwidth blockheight Decomb mode Framerate Shaper mode rate frame rate fps peak rate limited to fps Output geometry storage dimensions x pixel aspect ratio display dimensions x encoder H bit libx preset medium profile auto level auto quality RF color profile audio track name Pirates Of The CaribbeanThe Curse Of The Black Pearl decoder English DTS ch kbps track id x bitrate kbps samplerate Hz mixdown Stereo dither none encoder AAC libavcodec bitrate kbps samplerate Hz sync expecting video frames x info HEVC encoder version b c a bbbe x info build info Windows GCC bit bit x info using cpu capabilities MMX SSE Fast LZCNT SSSE SSE AVX FMA BMI AVX x info Main profile Level Main tier x info Thread pool created using threads x info Slices x info frame threads pool features wpp rows x warning Source height p disabling lookaheadslices x info Coding QT max CU size min CU size x info Residual QT max TU size max depth inter intra x info ME range subpel merge hex x info Keyframe min max scenecut bias x info Lookahead bframes badapt x info bpyramid weightp weightb x info References reflimit cu depth off on x info AQ mode str qgsize cutree x info Rate Control qCompress CRF x info tools rd psyrd earlyskip rskip signhide tmvp bintra x info tools strongintrasmoothing deblock sao sync first pts video is sync Chapter at frame time sync first pts audio x is Problem description Install HandBrake first time run program close Run program again Go C Users J rjestelm nvalvojaDESKTOPO R TFN AppData Roaming HandBrake delete file presetsjson Run program Close program Run program again HandBrake version eg Operating system and version eg Ubuntu macOS Catalina Windows Windows Error message text andor screenshot errorNimet n HandBrake Activity Log An Activity Log is required for support Please read for more information HandBrake OS Microsoft Windows NT CPU IntelR CoreTM i K CPU GHz Ram MB GPU Information NVIDIA GeForce GTX Screen x Temp Dir F Temp Install Dir E Program Files HandBrake x WinGUI HandBrake Data Dir C Users J rjestelm nvalvojaDESKTOPO R TFN AppData Roaming HandBrake Compiletime hardening features are enabled Nvenc version Preset Service Attempting Preset Recovery Preset Service Recovery Completed Description of the feature or enhancement youd like to see in HandBrake In case an queued job fails one has to work himself through the Activity Log to figure out why But since the app already found out why why not show this as a Status or Result as the latest Summary Item from my point of view and if all users have FullHD displays there is plenty space and either a Result Succeeded or the specific error message which can be found in the Activity Log anyways are displayed Depending on the size of the job or so to say the length of each item specific Activity Log this would save some time and still if the error is more complex a user can dig deeper From my point of view this shouldnt be such a big deal just due to the fact that the error is already handled at the point the item is marked failed nor What version of HandBrake are you currently running eg Nightly master What operating system and version are you running eg Ubuntu macOS Catalina Windows Windows v x all recent updates etc HandBrake Activity Log If this request is related to an error or unsupported file an Activity Log will help us track down what exactly is not working properly or not implemented Please read for more information Please replace this text with the Activity Log or upload the log file to Github by dragging and dropping the file on this post Leave the marks above and below Problem description Bug Title says it all really with Handbrake custom dimensions always reset when adding multiple files to a queue meaning anyone who wants to convert to aspect ratio for instance has to tediously load each file individually make the dimension changes hit start encode wait for it to complete load the next file repeat the process continue until you want to blow your own brains out Bug Considering the option is there Im assuming a H pass encode is meant to be possible but the pass option is grayed out System is an R on Win Pro build Is there any danger of getting more options in Handbrake Such as being able to encode with VP and having more control over encoder presets than just moving a slider left or right as GPU based encoding still looks like arse vs CPU based Im sure that gap could be lessened with more controloptions Elapsed time and remaining time are not accurate when an encode takes longer than hours For example if an encode has been running for hours elapsed time will display hour Description of Change When nlmeansprefilter is preparing to apply a prefilter to an image plane it first attempts to make a copy of the mem image plane into the mempre plane which will hold the prefilters output However the existing logic which mirrors the loop over all pixel rows in nlmeansalloc improperly leaves the bottom border rows of the mempre plane uninitialized Where nlmeansalloc correctly copies the source images rows into its plane by adding the correct offset to the memcpy destination to locate the image pixel data between the horizontal and vertical borders in nlmeansprefilter the intention is to copy both the image and the borders However the current loop only iterates h times ie the size of the image itself and skips the last bh h border rows As described in this bug is not apparent when using the older mean and median prefilters as they rewrite every pixels value in the mempre plane However when using the newer CSM prefilter which only rewrites a pixels value if it should change any pixels whose value should remain unaltered by the prefilter ie those which fall through the end of the ifelse block in nlmeansfiltercsm and which happen to be in the bottom border rows of the image will actually be left with uninitialized values Instead we replace the loop with a single memcpy call which just duplicates the entire mem image plane including the border data Tested on Windows via MinGW macOS x Ubuntu Linux Screenshots If relevant Illustration of bug when using HandBrakeCLI nlmeansyprefilter nlmeanscsmedgeboostbug After applying this PR and rerunning HandBrakeCLI with the same options and inputs nlmeanscsmedgeboostfix Resolves Problem description The NLMeans filter includes the option to use a prefilter such as the new CSM Conservative Smoothing with Medianlike tendencies prefilter introduced in d ab However the bottom rows of an image may be corrupted when using this prefilter because they are not fully copied from the source image into the prefilters scratch buffer Before any prefilter is applied the image is first duplicated by the nlmeansprefilter method into a second buffer However the duplication code uses a loop which only copies h rows the size of the actual image when it source copy bh rows the size of the image plus the size of the upper and lower borders Unlike the previous existing prefilters such as the mean and median ones the CSM prefilter does not overwrite every pixel so this bug becomes apparent when using this prefilter for any pixels in the bottom rows which should not change value in the prefilter step In the mean and median prefilters every pixel is written into the second buffer so it doesnt matter that the buffer wasnt populated correctly and the bug has no effect When using the edgeboost option with the CSM prefilter the problem may be especially apparent as shown in the following screenshot HandBrake version eg HandBrake Operating system and version eg Ubuntu macOS Catalina Windows Ubuntu Linux Error message text andor screenshot nlmeanscsmedgeboostbug HandBrake Activity Log Run the HandBrakeCLI commandline utility with the nlmeansyprefilter option to run the NLMeans x CSM prefilter with the edgeboost prefilter or nlmeansyprefilter for the x CSM prefilter in passthrough mode encoding with veryfast VP with pass makes the first pass run SLOWER versus the other presets I looked at cpu usage and it is much lower versus the other presets on the first pass I read that specifying a speed for the pass just slows things down and can reduce the amount of cores it runs on and am wondering if that is what it is doing Am using Handbrake Description of the feature or enhancement youd like to see in HandBrake Currently in HandBrake I can control when encoding stops only for the current job by hitting the Stop button which shows options to cancel immediately stop after current etc But what I would really like is the ability to insert a breakpoint into my queue telling HandBrake to stop when this is reached as this would allow me to tell HandBrake to stop after finishing a season a folder of files or after five roughly one hour jobs etc I would envision this being added to the contextual menu for jobs the queue window with an option for Stop After This Job Selecting this would insert a breakpoint into the queue after that job to show where HandBrake will stop It should also be possible to reorder or remove the breakpoint if the user changes their mind When HandBrake encounters such a breakpoint it should stop encoding and remove the breakpoint from the queue ready to continue when the user chooses to It would also probably make sense to adjust the Stop buttons Stop after current job option to use the same behaviour ie it would add a breakpoint after the current job with other options removing such a breakpoint if one is found What version of HandBrake are you currently running eg What operating system and version are you running eg Ubuntu macOS Catalina Windows macOS Catalina Problem description My Google Pixel phone records MP H video with yuvj p flag The videos directly from the Pixel play fine on VLC When I use HandBrake to reencode the videos to H or H the flag is changed to yuv p but the videos are washed out when played with VLC To eliminate playback issues I converted the same video with ffmpeg using vf scalew h inrangepcoutrangetv That video plays with correct colors in VLC Only the HandBrake video plays with washed out colors HandBrake version eg Operating system and version eg Ubuntu macOS Catalina Windows Windows Error message text andor screenshot NA HandBrake Activity Log An Activity Log is required for support Please read for more information HandBrake OS Microsoft Windows NT CPU AMD Ryzen X Core Processor Ram MB GPU Information NVIDIA GeForce GT Screen x Temp Dir C Users xxx AppData Local Temp Install Dir C Program Files HandBrake Data Dir C Users xxxx AppData Roaming HandBrake Starting Encode base preset Super HQ p Surround hbinit starting libhb thread Starting work at Sun Jan jobs to process json job Audio AudioList Bitrate DRC Encoder avaac Gain Mixdown NormalizeMixLevel false Samplerate Track DitherMethod Bitrate DRC Encoder ac Gain Mixdown NormalizeMixLevel false Samplerate Track DitherMethod CopyMask copyaac copyac copydtshd copydts copyeac copyflac copymp copytruehd FallbackEncoder ac Destination ChapterList Name Chapter ChapterMarkers true AlignAVStart true File E Video VID mp Mp Options IpodAtom false Mp Optimize false Mux mp Filters FilterList ID Settings mode ID Settings blockheight blockthresh blockwidth filtermode mode motionthresh spatialmetric spatialthresh ID Settings cropbottom cropleft cropright croptop height width ID Settings mode rate PAR Num Den Metadata SequenceID Source Angle Range Type chapter Start End Title Path E Media VID mp Subtitle Search Burn true Default false Enable true Forced true SubtitleList Video Encoder x Level TwoPass false Turbo false ColorMatrixCode Options ref bframes Preset veryslow Profile high Quality QSV Decode false AsyncDepth CPU logical processor count Intel Quick Sync Video support no hbscan pathE Media VID mp titleindex udfread ERROR ECMA Volume Recognition failed srclibbluraydiscdiscc failed opening UDF image E Media VID mp srclibbluraydiscdiscc error opening file BDMV indexbdmv srclibbluraydiscdiscc error opening file BDMV BACKUP indexbdmv srclibblurayblurayc navgettitlelistE Media VID mp failed bd not a bd trying as a streamfile instead libdvdnav Using dvdnav version libdvdread Encrypted DVD support unavailable libdvdreadDVDOpenFileUDFUDFFindFile VIDEOTSVIDEOTSIFO failed libdvdreadDVDOpenFileUDFUDFFindFile VIDEOTSVIDEOTSBUP failed libdvdread Cant open file VIDEOTSIFO libdvdnav vm failed to read VIDEOTSIFO dvd not a dvd trying as a streamfile instead Input movmp m a gp g mj from E Media VID mp Metadata majorbrand mp minorversion compatiblebrands isommp creationtime T Z location xxxxxxx locationeng xxxxxxxx comandroidversion comandroidcapturefps Duration start bitrate kbs Stream eng Video h High avc x yuvj ppc smpte m x kbs SAR DAR fps tbr k tbn k tbc default Metadata rotate creationtime T Z handlername VideoHandle Side data displaymatrix rotation of degrees Stream eng Audio aac LC mp a x D Hz mono fltp kbs default Metadata creationtime T Z handlername SoundHandle scan decoding previews for title scan audio x aac rate Hz bitrate English AAC LC ch kbps scan previews x fps autocrop aspect PAR scan supported video decoders avcodec qsv libhb scan thread found valid titles Skipping subtitle scan No suitable subtitle tracks Starting Task Encoding Pass work only chapter disabling chapter markers job configuration source E Media VID mp title chapters to container movmp m a gp g mj data rate kbps destination E Video VID mp container MPEG libavformat align initial AV stream timestamps video track decoder h bitrate kbps filters Comb Detect mode spatialmetric motionthresh spatialthresh filtermode blockthresh blockwidth blockheight Decomb mode Framerate Shaper mode rate frame rate fps peak rate limited to fps Crop and Scale width height croptop cropbottom cropleft cropright source crop scale Output geometry storage dimensions x pixel aspect ratio display dimensions x encoder H libx preset veryslow options ref bframes profile high level quality RF color profile audio track decoder English AAC LC ch kbps track id x bitrate kbps samplerate Hz mixdown Mono dither none encoder AAC libavcodec bitrate kbps samplerate Hz audio track decoder English AAC LC ch kbps track id x bitrate kbps samplerate Hz mixdown Mono dither none encoder AC libavcodec bitrate kbps samplerate Hz sync expecting video frames encx minkeyint keyint encx encoding at constant RF encx unparsed options ref bframes level badapt directautoanalyseallmeumhmerange subme trellis vbvbufsize vbvmaxrate rclookahead x info using SAR x info using cpu capabilities MMX SSE Fast SSSE SSE AVX FMA BMI AVX x info profile High level bit sync first pts video is sync first pts audio x is sync first pts audio x is sync Chapter at frame time reader done scr changes work average encoding speed for job is fps comb detect heavy light uncombed total decomb deinterlaced blended unfiltered total vfr frames output dropped and duped for CFRPFR vfr lost time frames vfr gained time frames not accounted for aacdecoder done frames decoder errors aacdecoder done frames decoder errors h decoder done frames decoder errors sync got frames expected sync framerate min fps max fps avg fps x info frame I Avg QP size x info frame P Avg QP size x info frame B Avg QP size x info consecutive Bframes x info mb I I x info mb P I P skip x info mb B I B direct skip L L BI x info x transform intra inter x info direct mvs spatial temporal x info coded yuvDCuvAC intra inter x info i vhdcp x info i vhdcddlddrvrhdvlhu x info i vhdcddlddrvrhdvlhu x info i c dchvp x info Weighted PFrames Y UV x info ref P L x info ref B L x info ref B L x info kbs mux track frames bytes kbps fifo mux track frames bytes kbps fifo mux track frames bytes kbps fifo Finished work at Sun Jan libhb work result Encode Completed 