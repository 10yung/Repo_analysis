This is a really basic one that used to work that appears not to work for me anymore Hi at the beginning I did not plan to move so much code around but here we are smiley Before I go any further it might be a good idea to get some feedback from you and have a conversation to see where things go If you dont like my changes feel happy to take only what you like or nothing at all Im not emotional attached to it coding was justforfun This code should behave exactly like the current master code Since the code has no tests all I did was a quick manual test through the splitup code structure should it make easier to write tests in future It would be nice if looprs could run the loop body in parallel using numcpu Suggestion for the flag name parallel p We have a bunch of images that need to be pushed to a registry so often so we do them all in one big script Problem is Gitlabs container registry constantly fails all the time so loop is a perfect fit for this Trying something like loop s summary scriptspushimagessh tried with i as well But the problem is that there is zero output Whereas normally our scriptspushimagessh outputs something like Pushing registrygitlabcomthingprod The push refers to repository registrygitlabcomthing e e c Preparing d eb deee Preparing e a e f e d Preparing f b f Preparing e a bca Preparing c a a Preparing bff f cb Preparing c a a Waiting And updates as the scripts progress through each image Is there anyway to keep that stdout and print it to term live as loop receives it from the subprocess Ran cargo build and rustc ver output the following Compiling looprs v filehomeumliDownloadsLoop error nonreference pattern used to match a reference see issue srcmainrs if let Somestring optuntilcontains help consider using a reference Somestring error nonreference pattern used to match a reference see issue srcmainrs if let Someregex optuntilmatch help consider using a reference Someregex error nonreference pattern used to match a reference see issue srcmainrs if let Someerrorcode optuntilerror help consider using a reference Someerrorcode error nonreference pattern used to match a reference see issue srcmainrs ErrorCodeAny if resultexitstatussuccess help consider using a reference ErrorCodeAny error nonreference pattern used to match a reference see issue srcmainrs ErrorCodeCodecode help consider using a reference ErrorCodeCodecode error aborting due to previous errors error Could not compile looprs I want loop to be in Debian and Ubuntu Lets make that happen Required first Actually write some useful tests The README makes it seem that untilerror does not require an argument Or until it fails with untilerror which also accepts an optional error code But when I try it without an argument I get this error The argument untilerror untilerror requires a value but none was supplied USAGE loop input countby countby every every offset offset untilerror untilerror So I think that maybe untilfail is what I want based on this Or if you have a list of files but need to find the one which causes your program to fail ls loop myprogram ITEM untilfail But I get this error Found argument untilfail which wasnt expected or isnt valid in this context And I still dont know how to run a command until it fails Seems like it is currently impossible The official recommendation is that this should be committed into the repository Since its a binary compatibility with other versions of libraries isnt important and having the lock file around can potentially help avoid annoying breakages in the future I thought the shell completions would be very useful in loop And since the project already uses clap it was very easy to add a completions subcommand to generate them the same way rustup does When using the untiltime flag the timestamps you use are implicitly in UTC It would be nice to this default to the computers local time or have a flag to specify the timezone