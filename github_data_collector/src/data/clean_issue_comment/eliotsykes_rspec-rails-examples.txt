Updates link in comment fixing It looks like the Pivotal blog link in this comment after running once within a process should now be to Details Ensure database cleaner wont run until after Capybara has finished loading pages to stop false negative failures This can manifest itself if a page is still rendering when a Capybara test finishes without an expectation eg Spec example has final line with an action to load a page eg clicklink Next without an expectation to check the action completed successfully While the page render triggered by step is still in progress database cleaner truncates tables that the page render is dependent on RSpec detects exceptions raised during page render and fails the test These failures are hard to debug as they have no accompanying expectation To fix ensure the database cleaner doesnt start until after Capybara has finished its work diff aspecsupportdatabasecleanerrb bspecsupportdatabasecleanerrb RSpecconfigure do config DatabaseCleanerstart end configaftereach do configappendaftereach do DatabaseCleanerclean end diff aspecsupporttimehelpersrb bspecsupporttimehelpersrb RSpecconfigure do config configinclude ActiveSupportTestingTimeHelpers configaftereach do travelback end end ruby File specsupporturloptionsrb RSpecconfigure do config configaroundeach type model do example originaldefaulturloptions Railsapplicationroutesdefaulturloptions Railsapplicationroutesdefaulturloptions host wwwexampleorg protocol https examplerun Railsapplicationroutesdefaulturloptions originaldefaulturloptions end end File specsupportcapybaraextensionsrb ruby module CapybaraExtensions Selects option from select drop down then closes the drop down Useful when a drop down obscures an element that needs to be clicked def selectthenclosevalue options selectvalue options presstabkey end def presstabkey findbodysendkeys tab end end RSpecconfigure do config configinclude CapybaraExtensions type feature end for now no requires GitHub API key that would access all repos under account Research Gemnasium Notes diff diff git aspecapieventsapispecrb bspecapieventsapispecrb index f c d f f ef aspecapieventsapispecrb bspecapieventsapispecrb require railshelper RSpecdescribe apievents do context OPTIONSpreflight do it responds with CORS headers do options apievents expectresponseto havehttpstatusok expectresponseheaders AccessControlAllowHeaders to eq ContentType More like this expectresponseheaders to eq expectresponsebodyto eq end end context POSTcreate do context with correct paramaters do xit creates a new event for the registered application do it creates a new event for the registered application do user createuser application createapplication params name the name of the event headers ContentType applicationjson Accept applicationjson Origin applicationurl post apievents paramstojson post apievents paramstojson headers json JSONparseresponsebody expectjsonto eq diff git aspeccontrollersapieventscontrollerspecrb bspeccontrollersapieventscontrollerspecrb index bcfb d f aspeccontrollersapieventscontrollerspecrb bspeccontrollersapieventscontrollerspecrb require railshelper RSpecdescribe APIEventsController type controller do describe OPTIONSpreflight do it returns status do get preflight process preflight OPTIONS expectresponseto havehttpstatus expectresponseheaders AccessControlAllowHeaders to eqContentType end diff git aspecsupportrequesthelperrb bspecsupportrequesthelperrb new file mode index d b devnull bspecsupportrequesthelperrb module RequestHelper Add support for testing options requests in RSpec See def optionsargs reset unless integrationsession integrationsessionsendprocess options argstap do copysessionvariables end end end RSpecconfigure do config configinclude RequestHelper type request end No newline at end of file Consier favoring the it should validateofattrname style 