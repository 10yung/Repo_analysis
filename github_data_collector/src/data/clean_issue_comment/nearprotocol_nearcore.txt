When a node runs out of disk space it should not result in some inconsistent storage and restarting the node when there is space should just work Right now it somehow leads to an InvalidBlockHeight error Simplifying Promise type within VMLogic Heres the Weekly Digest for nearprotocolnearcore ISSUES Last week issues were created Of these issues have been closed and issues are still open OPEN ISSUES greenheart Dont skip chunks if the chunk was received before the previous block by SkidanovAlex greenheart setupmockallvalidators should be redone by Kouprin greenheart Remote transaction signing by bowenwang greenheart Transaction validity period should be larger by bowenwang greenheart Fix logs when view call panicks by bowenwang greenheart Restaking service validator RPC improvement by ilblackdragon greenheart Add more safe math to the Runtime by evgenykuzyakov greenheart README includes incorrect link to createnearapp by amgando greenheart Logs arent captured if view calls panics by vgrichina greenheart Progressive Updates for Validators by potatodepaulo greenheart Change Receipt priority by evgenykuzyakov greenheart seals implementation and testing chunks grieving by Kouprin greenheart Merge master into staging by bowenwang greenheart Initial near run use too many open files by ailisp greenheart Allow nonx platforms through NaN canonicalization by nearmax greenheart Network crashed after Failed sending broadcast messageMailbox has closed by ailisp CLOSED ISSUES heart Fix setupmockallvalidators by bowenwang heart Panic on running from staging branch by k a heart Allow coverage upload fails by ailisp heart Remove dead code warnings from test by mfornet heart update link to docs by amgando heart Check for invalid shard id by bowenwang heart challengesroot by Kouprin heart testsallchunksaccepted by Kouprin heart Move network requests to ViewClient by bowenwang heart Dont crash on Connection reset by peer by mikhailOK heart Downgrade sysinfo to avoid too many open files bug by ailisp heart Change the pool order to be randomized and continue from the last used key by evgenykuzyakov heart Nearcore crashes on chunk RPC call requesting a shard id that does not exist by frol heart Pytest util to compile rust snippet by ailisp heart Fix u overflow during contract preparation by nearmax heart Pytest deploy smart contract and call function by ailisp heart Enable floats but prohibit some CPU architectures by nearmax heart Error running localness node by k a LIKED ISSUE Allow nonx platforms through NaN canonicalization by nearmax It received x smile x tada x and heart x NOISY ISSUE speaker Network crashed after Failed sending broadcast messageMailbox has closed by ailisp It received comments PULL REQUESTS Last week pull requests were created updated or merged UPDATED PULL REQUEST Last week pull requests were updated yellowheart Restaking service validator RPC improvement by ilblackdragon yellowheart seals implementation and testing chunks grieving by Kouprin yellowheart Merge master into staging by bowenwang yellowheart Fix TransactionOutcome Borsh deserialization by light client by k a yellowheart Turn on deterministic wasmer runtime by ailisp yellowheart Runtime limiters by evgenykuzyakov MERGED PULL REQUEST Last week pull requests were merged purpleheart Allow coverage upload fails by ailisp purpleheart Remove dead code warnings from test by mfornet purpleheart update link to docs by amgando purpleheart Check for invalid shard id by bowenwang purpleheart challengesroot by Kouprin purpleheart Move network requests to ViewClient by bowenwang purpleheart Dont crash on Connection reset by peer by mikhailOK purpleheart Downgrade sysinfo to avoid too many open files bug by ailisp purpleheart Pytest util to compile rust snippet by ailisp purpleheart Fix u overflow during contract preparation by nearmax purpleheart Pytest deploy smart contract and call function by ailisp purpleheart Enable floats but prohibit some CPU architectures by nearmax purpleheart limiting number of blocks chunks per height adversary tests by Kouprin purpleheart Release by bowenwang purpleheart Diagnostics by mfornet purpleheart Check max peer is not passed by mfornet purpleheart Restructured Telemetry data and added agent nearrs name and version by frol CONTRIBUTORS Last week there were contributors bustinsilhouette amgando bustinsilhouette bowenwang STARGAZERS Last week there were stagazers star lzehrung star MrCamelV star aguedob star arduino star ChrisIhler star d iasm star fladaauxv You all are the stars star RELEASES Last week there were no releases Thats all for last week please kbdeyes Watchkbd and kbdstar Starkbd the repository nearprotocolnearcore to receive next weekly updates smiley You can also view all Weekly Digests by clicking here Your Weekly Digest bot calendar Fixes Also fixes calculation of encodedchunksnumchunksforblock closes Running test for nearruntime fails Any ideas error process didnt exit successfully Usersfronearnearcoretargetdebugdepsnear dd e a cdfbc signal SIGILL illegal instruction near gitstaging cargo test Compiling near v Usersfronearnearcorenear Compiling testlib v Usersfronearnearcoretestutilstestlib Finished test unoptimized debuginfo targets in m s Running Usersfronearnearcoretargetdebugdepsnear dd e a cdfbc running tests T Z INFO near Did not find varfolders lcvr mxj vvdw fd hyjwg gnTtestchallengesYshRaqwt mdata path will be creating new store database T Z INFO near Did not find varfolders lcvr mxj vvdw fd hyjwg gnTtestvalidatorgetvalidatorinfovjZJmkAzhh Odata path will be creating new store database T Z INFO near Did not find varfolders lcvr mxj vvdw fd hyjwg gnTtestvalidatorstakechangemultipletimessjiZuTbJ VfLdata path will be creating new store database T Z INFO near Did not find varfolders lcvr mxj vvdw fd hyjwg gnTtestchallengesxZe AUeIXE Ddata path will be creating new store database T Z INFO near Did not find varfolders lcvr mxj vvdw fd hyjwg gnTtestchallenges c oeMPfvkdata path will be creating new store database T Z INFO near Did not find varfolders lcvr mxj vvdw fd hyjwg gnTtestvalidatorgetvalidatorinfoYcPL xIOhtqtdata path will be creating new store database T Z INFO near Did not find varfolders lcvr mxj vvdw fd hyjwg gnTtestchallengesPrTVyrKmHsQTdata path will be creating new store database test configtesttestdeserializestate ok T Z INFO near Did not find varfolders lcvr mxj vvdw fd hyjwg gnTtestkeyvaluechangesVzqEV f mjtdata path will be creating new store database T Z INFO nearshardtracker Tracking shards T Z INFO nearshardtracker Tracking shards T Z INFO nearshardtracker Tracking shards T Z INFO nearshardtracker Tracking shards T Z INFO nearshardtracker Tracking shards T Z INFO nearshardtracker Tracking shards T Z INFO nearshardtracker Tracking shards T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearruntime block height is nextblockepochstart true T Z DEBUG nearepochmanager epoch id EpochId RBsoeyoRwajj MZfZE gMDJQVYGYcdSfx zxqxNHbr prevepochid EpochId prevprevepochid EpochId T Z DEBUG nearepochmanager prevprevstakechange test test prevstakechange test test stakechange test test slashed T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearepochmanager stakeinfo test test validatorreward near T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG noderuntime account test return stake T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG noderuntime account test return stake T Z DEBUG noderuntime slashing of from test T Z DEBUG nearruntime block height is nextblockepochstart true T Z DEBUG nearepochmanager epoch id EpochId RBsoeyoRwajj MZfZE gMDJQVYGYcdSfx zxqxNHbr prevepochid EpochId prevprevepochid EpochId T Z DEBUG nearepochmanager prevprevstakechange test test prevstakechange test test stakechange test test slashed T Z DEBUG nearepochmanager stakeinfo test test validatorreward near T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG noderuntime account test return stake T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearruntime block height is nextblockepochstart false T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearruntime block height is nextblockepochstart true T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearepochmanager epoch id EpochId RBsoeyoRwajj MZfZE gMDJQVYGYcdSfx zxqxNHbr prevepochid EpochId prevprevepochid EpochId T Z DEBUG nearepochmanager prevprevstakechange test test prevstakechange test test stakechange test test slashed T Z DEBUG nearepochmanager All proposals Kickouts test Block Tracker Shard Tracker Num expected chunks T Z DEBUG nearruntime block height is nextblockepochstart true T Z DEBUG nearepochmanager stakeinfo test test validatorreward near T Z DEBUG nearepochmanager epoch id EpochId RBsoeyoRwajj MZfZE gMDJQVYGYcdSfx zxqxNHbr prevepochid EpochId prevprevepochid EpochId T Z DEBUG nearruntime block height is nextblockepochstart true T Z DEBUG nearruntime block height is nextblockepochstart true T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG noderuntime account test return stake T Z DEBUG nearepochmanager prevprevstakechange test test prevstakechange test test stakechange test test slashed T Z DEBUG nearruntime block height is nextblockepochstart true T Z DEBUG nearepochmanager epoch id EpochId RBsoeyoRwajj MZfZE gMDJQVYGYcdSfx zxqxNHbr prevepochid EpochId prevprevepochid EpochId T Z DEBUG nearepochmanager epoch id EpochId RBsoeyoRwajj MZfZE gMDJQVYGYcdSfx zxqxNHbr prevepochid EpochId prevprevepochid EpochId T Z DEBUG nearepochmanager stakeinfo test test validatorreward near T Z DEBUG nearepochmanager prevprevstakechange test test test prevstakechange test test test stakechange test test test slashed T Z DEBUG nearepochmanager prevprevstakechange test test test test prevstakechange test test test test stakechange test test test test slashed T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearepochmanager epoch id EpochIdFnqbqF YJekTNEMkZJMcujSouSfd CzTacotg LmSqeV prevepochid EpochId RBsoeyoRwajj MZfZE gMDJQVYGYcdSfx zxqxNHbr prevprevepochid EpochId T Z DEBUG nearepochmanager prevprevstakechange test test prevstakechange test test stakechange test test slashed test Other T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearepochmanager stakeinfo test test test validatorreward near T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG nearepochmanager stakeinfo test validatorreward test near T Z DEBUG nearepochmanager stakeinfo test test test test validatorreward near T Z DEBUG noderuntime account test return stake T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG nearruntime block height is nextblockepochstart false T Z DEBUG noderuntime account test return stake T Z DEBUG noderuntime account test adding reward to stake T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG noderuntime account test return stake T Z DEBUG noderuntime account test return stake T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG noderuntime account test return stake T Z DEBUG nearruntime block height is nextblockepochstart false T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG noderuntime account test return stake T Z DEBUG noderuntime account test return stake T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG nearruntime add validator proposals at block height ValidatorStake accountid test publickey ed Eo W tRMwcYcoua yM Xfr DjgR EWQFM RU MEX amount T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG noderuntime account test return stake T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG noderuntime account test return stake T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG noderuntime account test return stake T Z DEBUG nearruntime block height is nextblockepochstart false T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearepochmanager All proposals ValidatorStake accountid test publickey ed Eo W tRMwcYcoua yM Xfr DjgR EWQFM RU MEX amount Kickouts test Block Tracker Shard Tracker Num expected chunks T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearruntime block height is nextblockepochstart false T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearruntime block height is nextblockepochstart true T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearruntime add validator proposals at block height T Z DEBUG nearepochmanager epoch id EpochId RBsoeyoRwajj MZfZE gMDJQVYGYcdSfx zxqxNHbr prevepochid EpochId prevprevepochid EpochId T Z DEBUG nearepochmanager All proposals Kickouts test Block Tracker Shard Tracker Num expected chunks T Z DEBUG nearepochmanager prevprevstakechange test test test test test prevstakechange test test test test test stakechange test test test test test slashed T Z DEBUG nearepochmanager stakeinfo test test test test test validatorreward near T Z DEBUG noderuntime account test stake maxofstakes T Z DEBUG noderuntime account test return stake T Z DEBUG noderuntime account test stake maxofstakes thread panicked while processing panic aborting T Z DEBUG nearruntime add validator proposals at block height ValidatorStake accountid test publickey ed FXXrTXiKWpXj R r fBvMLpstd gPyrBq qMByqKVzKF amount error process didnt exit successfully Usersfronearnearcoretargetdebugdepsnear dd e a cdfbc signal SIGILL illegal instruction As a continuation of rpctypegen introduced in we should have a tool that allows us to map any Rust structenumunion to its closest equivalent in a different language The tool should be implemented as a cargo plugin and will use syn and quote to process the source code of the given project For example the following command will iterate over the file structure of the given Rust project and for each file generate Python file that for each Rust structenumunion struct contains Python class together with methods that allow us to serializedeserialize Rust structenumunion Python class between each other using JSON or Borsh cargo rusttofu langpy outputtmpmypythonproject Note that currently for some languages we are using an intermediate JSON schema eg for TypeScript and Python to perform serializationdeserialization With this tool it might not be needed since we can generate the TypeScript or Python code We would need to support the following languages for which we are already doing the mapping manually CTypeScriptAssemblyScriptPythonSolidity Note I propose the name Rust Tofu as a play on the phrase Rust to foo where foo denotes something Other name suggestions are welcome Right now if the partial encoded chunk arrives before a block the next block producer will reject the partial encoded chunk and wont include it in the block Add a cache for future chunks up to MAXHEIGHTSAHEAD heights ahead and store there partial encoded chunks for which we dont know the previous block We need to add some rpchttp endpoint for transaction signing