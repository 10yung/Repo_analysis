Hi all I am using the version M and I realized that updateOne can update just one attribute in the collection in the Sink Here I have two questions Why updateOne does not support a list of attributes to be updated I am missing is the replaceOne method that is available in the scala driver Are you planning to implement it Thanks for your help Purpose Set virtualhoststyle access as the default for AWS S from being pathstyle before This change may break existing usages as it applies much harder restrictions on the bucket names References Changes Mark the pathstyleaccess setting as deprecated with references to the blog post Issue warnings if pathstyleaccess is enabled Background Context Even though virtualhoststyle access is much more restrictive on bucket names it is the designated way forward for S Elasticsearch changes its REST API between major versions Alpakka could make use of Testcontainers Elasticsearch to run against different ES versions in our tests References Are you looking for help If you have a Lightbend Subscription please reach out via the Lightbend Portal This is an issue tracker used to manage and track the development of this particular module Please report issues regarding other projects in their respective issue trackers eg Akka Akka HTTP Alpakka Alpakka Kafka Please ask questions or discuss ideas in the discussakkaio forum Please add the following sections to your bug report Versions used add any other relevant versions here please Akka version Expected Behavior We should be able to start an MQTT Server using alpakka mqtt streaming when running last Alpakka artifact in a project along with Akka Actual Behavior Get this runtime exception javalangNoClassDefFoundError akkaactortypedscaladsladapterpackageUntypedActorRefOps at akkastreamalpakkamqttstreamingscaladslActorMqttServerSessioninitMqttSessionscala The problem is that implicit class UntypedActorRefOps has been renamed to ClassicActorRefOps from Akka to Akka x so when the artifact is built compiling with Akka it fails to run with Akka x Relevant logs Reproducible Test Case Build Alpakka with Akka and then use the artifact in a project with Akka Try to start a MQTT broker with akkastreamalpakkamqttstreamingscaladslActorMqttServerSession We are using MongoDB v on IBM Cloud over the Reactive MongoDB Driver v We are currently experiencing the following exception randomly usually after some period of the app inactivity commongodbMongoSocketWriteException Exception sending message at commongodbinternalconnectionInternalStreamConnectiontranslateWriteExceptionInternalStreamConnectionjava at commongodbinternalconnectionInternalStreamConnectionaccess InternalStreamConnectionjava at commongodbinternalconnectionInternalStreamConnection failedInternalStreamConnectionjava at commongodbinternalconnectionAsynchronousChannelStream failedAsynchronousChannelStreamjava at commongodbinternalconnectionAsynchronousChannelStream failedAsynchronousChannelStreamjava at commongodbinternalconnectionAsynchronousChannelStreamAsyncWritableByteChannelAdapterWriteCompletionHandlerfailedAsynchronousChannelStreamjava at commongodbinternalconnectiontlschannelasyncAsynchronousTlsChannel runAsynchronousTlsChanneljava at javautilconcurrentExecutorsRunnableAdaptercallExecutorsjava at javautilconcurrentFutureTaskrunFutureTaskjava at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava at javalangThreadrunThreadjava Caused by javaioIOException Connection reset by peer at sunniochFileDispatcherImplwrite Native Method at sunniochSocketDispatcherwriteSocketDispatcherjava at sunniochIOUtilwriteFromNativeBufferIOUtiljava at sunniochIOUtilwriteIOUtiljava at sunniochSocketChannelImplwriteSocketChannelImpljava at commongodbinternalconnectiontlschannelimplTlsChannelImplwriteToChannelTlsChannelImpljava at commongodbinternalconnectiontlschannelimplTlsChannelImplwriteToChannelTlsChannelImpljava at commongodbinternalconnectiontlschannelimplTlsChannelImplwrapAndWriteTlsChannelImpljava at commongodbinternalconnectiontlschannelimplTlsChannelImplwriteTlsChannelImpljava at commongodbinternalconnectiontlschannelClientTlsChannelwriteClientTlsChanneljava at commongodbinternalconnectiontlschannelasyncAsynchronousTlsChannelGroupwriteHandlingTasksAsynchronousTlsChannelGroupjava at commongodbinternalconnectiontlschannelasyncAsynchronousTlsChannelGroupdoWriteAsynchronousTlsChannelGroupjava at commongodbinternalconnectiontlschannelasyncAsynchronousTlsChannelGroupaccess AsynchronousTlsChannelGroupjava at commongodbinternalconnectiontlschannelasyncAsynchronousTlsChannelGroup runAsynchronousTlsChannelGroupjava more From what Ive read and from what the JavaDoc gives for the driver keepAlive parameter is supposed to be set to true by default But to be on the safe side we are setting it explicitly MongoClientSettings settings MongoClientSettingsbuilder applyConnectionStringnew ConnectionStringxxx applyToSocketSettingsbuilder builderkeepAlivetrue build MongoClient client MongoClientscreatesettings But that does not seem to solve the issue It occurs randomly and rarely Any help is much appreciated error Test akkastreamalpakkaftpFtpsWithProxyStageTestremove failed javautilconcurrentTimeoutException null took sec error at javautilconcurrentCompletableFuturetimedGetCompletableFuturejava error at javautilconcurrentCompletableFuturegetCompletableFuturejava error at scalaconcurrentjava FuturesConvertersImplCFsupergetFutureConvertersImplscala error at scalaconcurrentjava FuturesConvertersImplCFanonfunget FutureConvertersImplscala error at scalaconcurrentBlockContextDefaultBlockContextblockOnBlockContextscala error at scalaconcurrentpackageblockingpackagescala error at scalaconcurrentjava FuturesConvertersImplCFgetFutureConvertersImplscala error at akkastreamalpakkaftpCommonFtpStageTestremoveCommonFtpStageTestjava error at akkastreamalpakkaftpFtpsWithProxyStageTestremoveFtpsWithProxyStageTestjava error Similar to Purpose The purpose of this PR is to implement a retry logic for Elasticsearch flow which guarantees message ordering making it compatible with ElasticsearchFlowcreateWithContext References References Changes Backport of RetryFlowCoordinator from Akka Changed ElasticsearchSimpleFlowStage inputoutput ports types Changed ElasticsearchFlowsimpleStageFlow to wrap flow with RetryFlowCoordinator Added test mirroring the current ElasticsearchFlowStage retry testing logic Background Context This PR adds support for retry logic to ElasticsearchSimpleFlowStage using a backported implementation of RetryFlowCoordinator from Akka The idea is to use RetryFlowCoordinator to check for failures in the bulks WriteResult In case any failure is found the failed messages are resubmitted to the ElasticsearchSimpleFlowStage with the successful results as passthrough Furthermore the single WriteMessage passtrhough value is augmented with the index of the message inside the bulk so that at the end they can be reordered to the original ordering Alpakka M We sporadically see this error in our logs the auth token handling is not handling error responses correctly In this case a retry should be done like in and Also apply to the googlecloudpubsub module Also the trace for this error does not show it is related to alpakka playapiUnexpectedException Unexpected exception DeserializationException Object is missing required member accesstoken at playapihttpHttpErrorHandlerExceptionsthrowableToUsefulExceptionHttpErrorHandlerscala at playapihttpDefaultHttpErrorHandleronServerErrorHttpErrorHandlerscala at playcoreserverAkkaHttpServeranonfun applyOrElseAkkaHttpServerscala at playcoreserverAkkaHttpServeranonfun applyOrElseAkkaHttpServerscala at scalaconcurrentimplPromiseTransformationrunPromisescala at akkadispatchBatchingExecutorAbstractBatchprocessBatchBatchingExecutorscala at akkadispatchBatchingExecutorBlockableBatchanonfunrun BatchingExecutorscala at scalaruntimejava JFunction mcVspapplyJFunction mcVspscala at scalaconcurrentBlockContextwithBlockContextBlockContextscala at akkadispatchBatchingExecutorBlockableBatchrunBatchingExecutorscala at akkadispatchTaskInvocationrunAbstractDispatcherscala at akkadispatchForkJoinExecutorConfiguratorAkkaForkJoinTaskexecForkJoinExecutorConfiguratorscala at javautilconcurrentForkJoinTaskdoExecForkJoinTaskjava at javautilconcurrentForkJoinPoolWorkQueuetopLevelExecForkJoinPooljava at javautilconcurrentForkJoinPoolscanForkJoinPooljava at javautilconcurrentForkJoinPoolrunWorkerForkJoinPooljava at javautilconcurrentForkJoinWorkerThreadrunForkJoinWorkerThreadjava sprayjsonDeserializationException Object is missing required member accesstoken at sprayjsonpackagedeserializationErrorpackagescala at sprayjsonProductFormatsfromFieldProductFormatsscala at sprayjsonProductFormatsfromFieldProductFormatsscala at sprayjsonDefaultJsonProtocolfromFieldDefaultJsonProtocolscala at sprayjsonProductFormatsInstancesanon readProductFormatsInstancesscala at sprayjsonProductFormatsInstancesanon readProductFormatsInstancesscala at akkahttpscaladslmarshallerssprayjsonSprayJsonSupportanonfunsprayJsonUnmarshaller SprayJsonSupportscala at akkahttpscaladslutilFastFutureanonfunmap FastFuturescala at akkahttpscaladslutilFastFuturestrictTransform FastFuturescala at akkahttpscaladslutilFastFutureanonfuntransformWith FastFuturescala at scalaconcurrentimplPromiseTransformationrunPromisescala at akkadispatchBatchingExecutorAbstractBatchprocessBatchBatchingExecutorscala at akkadispatchBatchingExecutorBlockableBatchanonfunrun BatchingExecutorscala at scalaruntimejava JFunction mcVspapplyJFunction mcVspscala at scalaconcurrentBlockContextwithBlockContextBlockContextscala at akkadispatchBatchingExecutorBlockableBatchrunBatchingExecutorscala at akkadispatchTaskInvocationrunAbstractDispatcherscala at akkadispatchForkJoinExecutorConfiguratorAkkaForkJoinTaskexecForkJoinExecutorConfiguratorscala at javautilconcurrentForkJoinTaskdoExecForkJoinTaskjava at javautilconcurrentForkJoinPoolWorkQueuetopLevelExecForkJoinPooljava at javautilconcurrentForkJoinPoolscanForkJoinPooljava at javautilconcurrentForkJoinPoolrunWorkerForkJoinPooljava at javautilconcurrentForkJoinWorkerThreadrunForkJoinWorkerThreadjava javautilNoSuchElementException key not found accesstoken at scalacollectionMapOpsdefaultMapscala at scalacollectionMapOpsdefaultMapscala at scalacollectionAbstractMapdefaultMapscala at scalacollectionMapOpsapplyMapscala at scalacollectionMapOpsapplyMapscala at scalacollectionAbstractMapapplyMapscala at sprayjsonProductFormatsfromFieldProductFormatsscala at sprayjsonProductFormatsfromFieldProductFormatsscala at sprayjsonDefaultJsonProtocolfromFieldDefaultJsonProtocolscala at sprayjsonProductFormatsInstancesanon readProductFormatsInstancesscala at sprayjsonProductFormatsInstancesanon readProductFormatsInstancesscala at akkahttpscaladslmarshallerssprayjsonSprayJsonSupportanonfunsprayJsonUnmarshaller SprayJsonSupportscala at akkahttpscaladslutilFastFutureanonfunmap FastFuturescala at akkahttpscaladslutilFastFuturestrictTransform FastFuturescala at akkahttpscaladslutilFastFutureanonfuntransformWith FastFuturescala at scalaconcurrentimplPromiseTransformationrunPromisescala at akkadispatchBatchingExecutorAbstractBatchprocessBatchBatchingExecutorscala at akkadispatchBatchingExecutorBlockableBatchanonfunrun BatchingExecutorscala at scalaruntimejava JFunction mcVspapplyJFunction mcVspscala at scalaconcurrentBlockContextwithBlockContextBlockContextscala at akkadispatchBatchingExecutorBlockableBatchrunBatchingExecutorscala at akkadispatchTaskInvocationrunAbstractDispatcherscala at akkadispatchForkJoinExecutorConfiguratorAkkaForkJoinTaskexecForkJoinExecutorConfiguratorscala at javautilconcurrentForkJoinTaskdoExecForkJoinTaskjava at javautilconcurrentForkJoinPoolWorkQueuetopLevelExecForkJoinPooljava at javautilconcurrentForkJoinPoolscanForkJoinPooljava at javautilconcurrentForkJoinPoolrunWorkerForkJoinPooljava at javautilconcurrentForkJoinWorkerThreadrunForkJoinWorkerThreadjava Release Train Issue Template for Alpakka Liberally copied and adopted from Scala itself For every Alpakka release make a copy of this file named after the release and expand the variables Ideally replacing variables could become a script you can run on your local machine Variables to be expanded in this template Key links akkaalpakka milestone week before the release Check that any new deprecated annotations use the correct version name Check that open PRs and issues assigned to the milestone are reasonable Decide on planned release date Notify depending projects Akka persistence plugins about the upcoming release Create a new milestone for the next version Check closed issues without a milestone and either assign them the upcoming release milestone or invalidnot releasebound day before the release Make sure all important big PRs have been merged by now Communicate that a new version is about to be released in Gitter Akka Dev Channel so that no new Pull Requests are merged Preparing release notes in the documentation announcement For nonpatch releases rename the alpakkaxxstable and alpakkasupportedxxstable reporting projects in WhiteSource accordingly unfortunately this requires permissions that cannot be shared outside of Lightbend Check readiness levels in projectprojectinfoconf and put in the release date for any new modules Check supported projects listing in whitesourceSupported Add a release notes entry in docssrcmainparadoxreleasenotes listing contributors generated by sbtauthors eg sbt authors v HEAD For nonpatch releases Create a news item draft PR on akkagithubcom using the milestone Move all unclosed issues for this milestone to the next milestone Release notes PR has been merged Cutting the release Wait until master build finished after merging the release notes Create a new release with the next tag version v title and release description linking to announcement release notes and milestone Check that Travis CI release build has executed successfully Travis will start a CI build for the new tag and publish artifacts to Bintray and documentation to Gustav Go to Bintray and select the just released version Go to the Maven Central tab check the Close and release repository when done checkbox and sync with Sonatype using your Sonatype TOKEN key and password Close the milestone Check availability Check API documentation Check reference documentation Check the release on Maven central When everything is on maven central Log into gustavakkaio as akkarepo update the current links on repoakkaio to point to the latest version with ln nsf wwwdocsalpakkacurrent ln nsf wwwapialpakkacurrent ln nsf wwwdocsalpakka ln nsf wwwapialpakka check changes and commit the new version to the local git repository cd www git add docsalpakka docsalpakkacurrent docsalpakka git add apialpakka apialpakkacurrent apialpakka git commit m Alpakka Announcements For nonpatch releases Merge draft news item for akkaio Send a release notification to Lightbend discuss Tweet using the akkateam account or ask someone to about the new release Announce on Gitter akkaakka Announce internally Afterwards If Couchbase has relevant changes createupdate PR in Akka Persistence Couchbase to upgrade to Update version for Lightbend Supported Modules in private project Close this issue info CSV Formatting info should format simple value FAILED second milliseconds info A timeout occurred waiting for a future to complete Queried times sleeping milliseconds between each query CsvFormattingSpecscala info orgscalatestconcurrentFuturesFutureConceptanon info at orgscalatestconcurrentFuturesFutureConcepttryTryAgain Futuresscala info at orgscalatestconcurrentFuturesFutureConceptfutureValueImplFuturesscala info at orgscalatestconcurrentFuturesFutureConceptfutureValueImplFuturesscala info at orgscalatestconcurrentScalaFuturesanon futureValueImplScalaFuturesscala info at orgscalatestconcurrentFuturesFutureConceptfutureValueFuturesscala info at orgscalatestconcurrentFuturesFutureConceptfutureValueFuturesscala info at orgscalatestconcurrentScalaFuturesanon futureValueScalaFuturesscala info at docsscaladslCsvFormattingSpecanonfunnew CsvFormattingSpecscala info at akkastreamtestkitscaladslStreamTestKitassertAllStagesStoppedStreamTestKitscala info at docsscaladslCsvFormattingSpecanonfunnew CsvFormattingSpecscala info at orgscalatestOutcomeOfoutcomeOfOutcomeOfscala info at orgscalatestOutcomeOfoutcomeOfOutcomeOfscala info at orgscalatestOutcomeOfoutcomeOfOutcomeOfscala info at orgscalatestTransformerapplyTransformerscala info at orgscalatestTransformerapplyTransformerscala info at orgscalatestWordSpecLikeanon applyWordSpecLikescala info at orgscalatestTestSuitewithFixtureTestSuitescala info at orgscalatestTestSuitewithFixtureTestSuitescala info at orgscalatestWordSpecwithFixtureWordSpecscala info at orgscalatestWordSpecLikeinvokeWithFixture WordSpecLikescala info at orgscalatestWordSpecLikeanonfunrunTest WordSpecLikescala info at orgscalatestSuperEnginerunTestImplEnginescala info at orgscalatestWordSpecLikerunTestWordSpecLikescala info at orgscalatestWordSpecLikerunTestWordSpecLikescala info at docsscaladslCsvSpecorgscalatestBeforeAndAfterEachsuperrunTestCsvSpecscala info at orgscalatestBeforeAndAfterEachrunTestBeforeAndAfterEachscala info at orgscalatestBeforeAndAfterEachrunTestBeforeAndAfterEachscala info at docsscaladslCsvSpecrunTestCsvSpecscala info at orgscalatestWordSpecLikeanonfunrunTests WordSpecLikescala info at orgscalatestSuperEngineanonfunrunTestsInBranch Enginescala info at scalacollectionimmutableListforeachListscala info at orgscalatestSuperEnginetraverseSubNodes Enginescala info at orgscalatestSuperEnginerunTestsInBranchEnginescala info at orgscalatestSuperEngineanonfunrunTestsInBranch Enginescala info at scalacollectionimmutableListforeachListscala info at orgscalatestSuperEnginetraverseSubNodes Enginescala info at orgscalatestSuperEnginerunTestsInBranchEnginescala info at orgscalatestSuperEnginerunTestsImplEnginescala info at orgscalatestWordSpecLikerunTestsWordSpecLikescala info at orgscalatestWordSpecLikerunTestsWordSpecLikescala info at orgscalatestWordSpecrunTestsWordSpecscala info at orgscalatestSuiterunSuitescala info at orgscalatestSuiterunSuitescala info at orgscalatestWordSpecorgscalatestWordSpecLikesuperrunWordSpecscala info at orgscalatestWordSpecLikeanonfunrun WordSpecLikescala info at orgscalatestSuperEnginerunImplEnginescala info at orgscalatestWordSpecLikerunWordSpecLikescala info at orgscalatestWordSpecLikerunWordSpecLikescala info at docsscaladslCsvSpecorgscalatestBeforeAndAfterAllsuperrunCsvSpecscala info at orgscalatestBeforeAndAfterAllliftedTree BeforeAndAfterAllscala info at orgscalatestBeforeAndAfterAllrunBeforeAndAfterAllscala info at orgscalatestBeforeAndAfterAllrunBeforeAndAfterAllscala info at docsscaladslCsvSpecrunCsvSpecscala info at orgscalatesttoolsFrameworkorgscalatesttoolsFrameworkrunSuiteFrameworkscala info at orgscalatesttoolsFrameworkScalaTestTaskexecuteFrameworkscala info at sbtTestRunnerrunTest TestFrameworkscala info at sbtTestRunnerrunTestFrameworkscala info at sbtTestFrameworkanon anonfunlessinitgreater anonfunapply TestFrameworkscala info at sbtTestFrameworksbtTestFrameworkwithContextLoaderTestFrameworkscala info at sbtTestFrameworkanon anonfunlessinitgreater applyTestFrameworkscala info at sbtTestFrameworkanon anonfunlessinitgreater applyTestFrameworkscala info at sbtTestFunctionapplyTestFrameworkscala info at sbtTestsanonfuntoTask Testsscala info at sbtstdTransformanon anonfunapply Systemscala info at sbtstdTransformanon workSystemscala info at sbtExecuteanonfunsubmit Executescala info at sbtinternalutilErrorHandlingwideConvertErrorHandlingscala info at sbtExecuteworkExecutescala info at sbtExecuteanonfunsubmit Executescala info at sbtConcurrentRestrictionsanon anonfunsubmitValid ConcurrentRestrictionsscala info at sbtCompletionServiceanon callCompletionServicescala info at javautilconcurrentFutureTaskrunFutureTaskjava info at javautilconcurrentExecutorsRunnableAdaptercallExecutorsjava info at javautilconcurrentFutureTaskrunFutureTaskjava info at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava info at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava info at javalangThreadrunThreadjava 