 Provide a general summary of the issue in the Title above prefixed with packageName Unable to install KB over openssh on Windows x This package is a dependency of vcredist openssh is configured to use windows powershell as the default shell I am able to install other packages using choco over openssh The account being used has administrator privileges When physically logged RDP or physically at the machine onto the machine running choco install y KB works This issue appears to be the similar to and Expected Behavior If youre describing a bug tell us what should happen If youre suggesting a changeimprovement tell us how it should work KB should install Current Behavior If describing a bug tell us what happens instead of the expected behavior If suggesting a changeimprovement explain the difference from current behavior KB fails to install with given error message Attached ZIP contains the event log KB Installzip ps PS C Users engineer choco install kb y Chocolatey v Installing the following packages kb By installing you accept licenses for the packages Progress Downloading KB KB v Approved kb package files install completed Performing other installation steps Downloading KB bit from Progress Completed download of C Users engineer AppData Local Temp chocolatey KB Windows KB x msu MB Download of Windows KB x msu MB completed Hashes match Installing KB WARNING User you cancelled the installation WARNING Update KB installation failed exit code WARNING More details may be found in the installation log C Users engineer AppData Local Temp chocolatey KB Installev t or the system CBS log C Windows Logs CBS CBSlog ERROR Update KB installation failed exit code The install of kb was NOT successful Error while running C ProgramData chocolatey lib KB Tools ChocolateyInstallps See log for details Chocolatey installed packages packages failed See the log for details C ProgramData chocolatey logs chocolateylog Failures kb exited Error while running C ProgramData chocolatey lib KB Tools ChocolateyInstallps See log for details Possible Solution Not obligatory but suggest a fixreason for the bug or ideas how to implement the addition or change Seeing the related issue used an elevated prompt to solve the issue I tried StartProcess powershell ArgumentList Command choco install y kb outfile logtxt Verb RunAs Wait and powershell executionpolicy bypass StartProcess powershell ArgumentList executionpolicy bypass Command choco install y kb outfile logtxt Verb RunAs Wait with neither working Context How has this issue affected you What are you trying to accomplish Providing context helps us come up with a solution that is most useful in the real world Im trying to provision Windows x computers over openssh using windows powershell Your Environment Include as many relevant details about the environment you experienced the bug in Package Version used Operating System and version Windows x Chocolatey version Installuninstall gist choco install y kb C windows system cinst gitextensions Chocolatey v Business Installing the following packages gitextensions By installing you accept licenses for the packages Progress Downloading gitextensions gitextensions v Approved gitextensions package files install completed Performing other installation steps Installing GitExtensions msi GitExtensions msi has been installed Added C ProgramData chocolatey bin gitexexe shim pointed to c program files x gitextensions gitexcmd gitextensions may be able to be automatically uninstalled Environment Vars like PATH have changed Closereopen your shell to see the changes or in powershellcmdexe just type refreshenv The install of gitextensions was successful Software install location not explicitly set could be in package or default install location if installer Chocolatey installed packages See the log for details C ProgramData chocolatey logs chocolateylog Expected Behavior With winscpportable and likely winscpinstaller too the file WinSCPcom should get a shim Current Behavior WinSCPexe gets a shim during installation but WinSCPcom doesnt Context WinSCPcom is the consoleonly version which can be used in automated scripts etc Its possible to use WinSCPexe console for some situations but exit codes dont work the same way Very rarely is upgrading to the latest stable release on the day it comes out a good idea because most python package developers are not preparing for it by testing against the alpha Most are one major release behind with Python still not supported by any different packages even though its been out for months now Python keeps roughly to major versions up to date all at once due to the major compatibility differences between them so when a new build is out a new build is out on the same day and youd only really be able to install it on Chocolatey by removing any pins you may have verifying the new version in the version history and is so far down now you have to click on see more to see it installing that exact version manually and then repinning So in my opinion it doesnt really make much sense to have a single python package I think it would be better to have python python python python etc The Firefox Installer support a range of commandline options This package currently has no support for them The commandline options are useful ie for defining if a desktop shortcut should be created if the configurations set through distributionpoliciesjson should be kept and a few more Expected Behavior Commandline Options can be passed to the installer through the params mechanism Current Behavior As a workaround command line options can be passed using installarguments or ia But this does not allow to check for correct input or to set defaults in the package which differ from the installer defaults Possible Solution Implement package parameters in the package An example implementation could be seen in the Wazuh agent package update tags Update description of wpsofficefree Delete old version and turn them into symlinks to new version Provide a general summary of your changes in the Title above prefixed with packageName Description Describe your changes in detail Overwrite old versions directory with symlink to new versions directory When there are already symlinks relink it This example illustrates my aim First install C tools vim vim Updated to vim C tools vim vim vim C tools vim vim Updated to vim C tools vim vim vim C tools vim vim vim C tools vim vim Motivation and Context Why is this change required What problem does it solve Current vim package doesnt delete old version when minor version upgraded Vims minor version has updated recently and now most users have two versions on their machine Current situation C tools vim vim C tools vim vim This is actually my mistake I overlooked this upgrade scenario when I fixed this package This change turns vim into symlink to vim so that we can keep using the old path This is very convenient because we dont have to change taskber icon tile on Start and all other settings which uses vims path If it fixes an open issue please link to the issue here Use fixesfixed when referencing the issue In this change I had to use mklink and rmdir in cmdexe because NewItem ItemType SymbolicLink fails on testenv and Powershell cant unlink directory symlinks It will delete linktarget directorys contents too How Has this Been Tested Please describe in detail how you tested your changes I tested in the chocolatey test environment Include details of your testing environment and the tests you ran to Install upgrade scenario see how your change affects other areas of the script etc Screenshot if appropriate usually isnt needed Types of changes What types of changes does your code introduce Put an x in all the boxes that apply x Bug fix nonbreaking change which fixes an issue x New feature nonbreaking change which adds functionality Breaking change fix or feature that would cause existing functionality to change Migrated package a package has been migrated from another repository Checklist Go over all the following points and put an x in all the boxes that apply If youre unsure about any of these dont hesitate to ask Were here to help x My code follows the code style of this repository My change requires a change to documentation this usually means the notes in the description of a package I have updated the documentation accordingly this usually means the notes in the description of a package x All files are up to date with the latest Contributing Guidelines x The addedmodified package passed installuninstall in the chocolatey test environment x The changes only affect a single package not including meta package Provide a general summary of your changes in the Title above prefixed with packageName Changed touch alias into NewItem to fix Description Describe your changes in detail Changed the touch in the after install part of the script to avoid shimgen Motivation and Context Why is this change required What problem does it solve If it fixes an open issue please link to the issue here Use fixesfixed when referencing the issue Fixed it because I received notification from CodeTriage How Has this Been Tested Please describe in detail how you tested your changes Include details of your testing environment and the tests you ran to see how your change affects other areas of the script etc Local installuninstall test test env project Screenshot if appropriate usually isnt needed Types of changes What types of changes does your code introduce Put an x in all the boxes that apply x Bug fix nonbreaking change which fixes an issue New feature nonbreaking change which adds functionality Breaking change fix or feature that would cause existing functionality to change Migrated package a package has been migrated from another repository Checklist Go over all the following points and put an x in all the boxes that apply If youre unsure about any of these dont hesitate to ask Were here to help x My code follows the code style of this repository My change requires a change to documentation this usually means the notes in the description of a package I have updated the documentation accordingly this usually means the notes in the description of a package x All files are up to date with the latest Contributing Guidelines x The addedmodified package passed installuninstall in the chocolatey test environment x The changes only affect a single package not including meta package The following section can be removed if the package has not been migrated from another location Original Location Original Repository addlinktooriginalrepositorylocation Open Issues linktothegenericlocationofopenissues Add the different issues underneath and tick those that are fixed in this PR x gpg win The term touch is not recognized as the name of a cmdlet Include the link to the opened PR that removes the package from the original location The migration guidelines have been followed 