checkextra fails when lambda and trail are in different regions but technically the trail can be in a different region where lambda is and trail can record lambda api operations anyway Adds a command for check check that ec instances are associated with an instance role It is always possible something running on the instance is using an IAM key no way to prevent that just like we cant stop someone from copying instance credentials from another instance but if there is no instance role associated then I think it is safe to mark a fail By submitting this pull request I confirm that my contribution is made under the terms of the Apache license Add Prowler check for unused elastic IP addresses AWS charges for any EIPs not associated with a network interface By submitting this pull request I confirm that my contribution is made under the terms of the Apache license By submitting this pull request I confirm that my contribution is made under the terms of the Apache license Make the decolorization changes in consistent for all lines Cant produce file report output with prowler to save my dear life Absolutely positive that im missing something obvious but just cant figure out what Running the following only results in terminal text output I need something file based via format I can aggregate and report on prowler p prod e b s x rootcloudtoolsprowlerreports Any advice New checks require latest AWS CLI version additionally with the new AWS CLI v we need to make sure the v version is used to make Prowler run properly File includeawsclidetector is the place to add this logic Ive done some rough tests with the code below AWSCLI installed or not AWSCLIwhich aws if z AWSCLI then echo e nRED ERRORNORMAL AWSCLI aws command not found Make sure it is installed correctly and in your PATH n EXITCODE exit EXITCODE fi AWSCLI v detector variable CURRENTCLIVERSIONAWSCLI versionawk print cut d f grep if z CURRENTCLIVERSION then echo e nRED ERRORNORMAL AWSCLI aws command is not v Make sure you use latest available version of AWSCLI v n EXITCODE exit EXITCODE fi AWSCLI version checker test function awscliversionchecker LATESTCLIVERSIONcurl s Tagging awk print grep head if LATESTCLIVERSION CURRENTCLIVERSION then echo e nNOTICE ATTENTIONNORMAL Your installed AWSCLI is vCURRENTCLIVERSION and latest is vLATESTCLIVERSION echo e Make sure you have the newest version available to get the best from Prowler n else echo e nOK OKNORMAL You are using the latest available version AWSCLI vLATESTCLIVERSION n fi That funciont could be probably called also by v along with Prowler version cc zfLQ qx The check extra Find secrets in Lambda functions code Not Scored Not part of CIS benchmark errors by default with the following An error occurred AccessDeniedException when calling the GetFunction operation User userprowler is not authorized to perform lambdaGetFunction on resource arnawslambdaeuwest functionApiSimpleDelayDDMonitor Adding this policy successfully runs that check By submitting this pull request I confirm that my contribution is made under the terms of the Apache license Same as for ec instances but for Launch Configurations AUTO SCALING Launch Configurations user data Based on new feature regarding IMDSv Instance Metadata Service and info here 