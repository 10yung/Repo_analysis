I install firmadyne by docker I using the examplesh It run success but get no interface I received the notice Creating TAP device tap Set tap persistent and owned by uid Bringing up TAP device Adding route to Starting firmware emulation use Ctrla x to exit qemusystemmipsel nic invalid option Deleting route Bringing down TAP device Deleting TAP device tap Set tap nonpersistent I did not change anything in runsh Hi I did successfull emulation of different tplink based routers like dir or dir or n In all cases I cant connect wan port but it works I added new tap device I can get dhcp working But on router still is the message that cable is not connected How to emulate this I tested a lot of routers why ca n t I get the IP address birdpwnubuntufuzzerfirmadyne scriptsinferNetworksh Querying database for architecture Password for user firmadyne mipseb Running firmware terminating after secs qemusystemmips net nicvlan vlan is deprecated Please use netdev instead qemusystemmips terminating on signal from pid timeout Inferring network Interfaces Done Sir I see you mentioned that We evaluate FIRMADYNE on a realworld dataset of firmware images across device vendors gathered by our system Using a sample of exploits on the firmware images that our system can successfully extract we discover that firmware images spanning at least distinct products are vulnerable to one or more of the sampled exploits Could you show the exact firmware version that firmadyne can simulate I use firmadyne but I can only simulate the only Netgear WNAP I simulate DIR LREVBMIDDLEFIRMWAREONLYv B DIR B FW b DIR DIR DIR but all of them failed Could you give me some suggestion Thank you Thank you very much I want to debug the firmware But the gdbserver can not start on the original kenel When I look other peoples issues I use the kenel bit instead But When I use this kernel firmadyne cannot infer network rootkalifirmadyne scriptsinferNetworksh Querying database for architecture Password for user firmadyne mipseb Running firmware terminating after secs qemusystemmips net nicvlan vlan is deprecated Please use netdev instead qemusystemmips terminating on signal from pid timeout Inferring network Interfaces Done and start the system failed qemusystemmips net nicvlan vlan is deprecated Please use netdev instead Initializing cgroup subsys cpuset Initializing cgroup subsys cpu Linux version kcmalta debiankernellistsdebianorg gcc version Debian Debian bootconsole early enabled CPU revision is MIPS Kc FPU revision is Determined physical RAM map memory reserved memory ef ROM data memory b f reserved memory f b usable debug ignoring loglevel setting Wasting bytes for tracking unused pages Initrd not found or empty disabling initrd Zone PFN ranges DMA x x Normal x x ffff Movable zone start PFN for each node earlynodemap active PFN ranges x x ffff On node totalpages freeareainitnode node pgdat bfd nodememmap DMA zone pages used for memmap DMA zone pages reserved DMA zone pages LIFO batch Normal zone pages used for memmap Normal zone pages LIFO batch pcpualloc s r d u alloc pcpualloc Built zonelists in Zone order mobility grouping on Total pages Kernel command line rootdevsda consolettyS nandsimparts rdinitfirmadynepreInitsh rw debug ignoreloglevel printfatalsignals userdebug firmadynesyscall PID hash table entries order bytes Dentry cache hash table entries order bytes Inodecache hash table entries order bytes Primary instruction cache kB VIPT way linesize bytes Primary data cache kB way VIPT no aliases linesize bytes Writing ErrCtl register Readback ErrCtl register Memory k k available k kernel code k reserved k data k init k highmem NRIRQS CPU frequency MHz Console colour dummy device x Calibrating delay loop BogoMIPS lpj pidmax default minimum Security Framework initialized AppArmor AppArmor disabled by boot time parameter Mountcache hash table entries Initializing cgroup subsys cpuacct Initializing cgroup subsys memory Initializing cgroup subsys devices Initializing cgroup subsys freezer Initializing cgroup subsys netcls Initializing cgroup subsys blkio Initializing cgroup subsys perfevent devtmpfs initialized printconstraints dummy NET Registered protocol family bio create slab at vgaarb loaded SCSI subsystem initialized libata version loaded pci ab type class x pci reg mem x x ffffff pref pci a type class x pci a type class x pci a reg io x x f pci a type class x c pci a reg io x x f pci a type class x pci a address space collision io x x f conflicts with GT PCI IO io x x fffff pci b type class x pci b reg io x x f pci b reg mem x x f pci b reg mem x x ffff pref pci type class x pci reg io x x f pci reg mem x x f pci reg mem x x ffff pref pci type class x pci reg io x x f pci reg mem x x f pci reg mem x x ffff pref pci type class x pci reg io x x f pci reg mem x x f pci reg mem x x ffff pref pci b type class x pci reg mem x x ffffff pref pci reg mem x x fff pci reg mem x x ffff pref vgaarb device added PCI decodesiomemownsnonelocksnone pci a BAR io x x f has bogus alignment pci BAR assigned mem x x ffffff pref pci b BAR assigned mem x x ffff pref pci BAR assigned mem x x ffff pref pci BAR assigned mem x x bffff pref pci BAR assigned mem x c x fffff pref pci BAR assigned mem x x ffff pref pci BAR assigned mem x x fff pci a BAR assigned io x x f pci b BAR assigned io x x f pci b BAR assigned mem x x f pci BAR assigned io x x f pci BAR assigned mem x x f pci BAR assigned io x x f pci BAR assigned mem x x f pci BAR assigned io x x f pci BAR assigned mem x x f pci a BAR assigned io x a x af Switching to clocksource MIPS NET Registered protocol family IP route cache hash table entries order bytes TCP established hash table entries order bytes TCP bind hash table entries order bytes TCP Hash tables configured established bind TCP reno registered UDP hash table entries order bytes UDPLite hash table entries order bytes NET Registered protocol family RPC Registered named UNIX socket transport module RPC Registered udp transport module RPC Registered tcp transport module RPC Registered tcp NFSv backchannel transport module PCI Enabling device a PCI CLS bytes default audit initializing netlink socket disabled type audit initialized VFS Disk quotas dquot Dquotcache hash table entries order bytes nfs filelayoutinit NFSv File Layout Driver Registering msgmni has been set to alg No test for stdrng krng Block layer SCSI generic bsg driver version loaded major io scheduler noop registered io scheduler deadline registered io scheduler cfq registered default PCI Enabling device cirrusfb Cirrus Logic chipset on PCI bus RAM kB at x Console switching to colour frame buffer device x Serial driver ports IRQ sharing enabled serial ttyS at IO x f irq is a A console ttyS enabled bootconsole disabled console ttyS enabled bootconsole disabled serial ttyS at IO x f irq is a A atapiix a version PCI Enabling device a PCI Setting latency timer of device a to scsi atapiix scsi atapiix ata PATA max UDMA cmd x f ctl x f bmdma x a irq ata PATA max UDMA cmd x ctl x bmdma x a irq pcnet pcnet cv Apr tsbogendalphafrankende PCI Enabling device b PCI Setting latency timer of device b to pcnet PCnetPCI II C A at x assigned IRQ pcnet eth registered as PCnetPCI II C A PCI Enabling device PCI Setting latency timer of device to pcnet PCnetPCI II C A at x assigned IRQ pcnet eth registered as PCnetPCI II C A PCI Enabling device PCI Setting latency timer of device to pcnet PCnetPCI II C A at x assigned IRQ pcnet eth registered as PCnetPCI II C A PCI Enabling device PCI Setting latency timer of device to pcnet PCnetPCI II C A at x assigned IRQ pcnet eth registered as PCnetPCI II C A pcnet cardsfound serio i KBD port at x x irq serio i AUX port at x x irq mousedev PS mouse device common for all mice rtccmos rtccmos rtc core registered rtccmos as rtc rtc alarms up to one day bytes nvram TCP cubic registered NET Registered protocol family Registering the dnsresolver key type PM Hibernation image not present or could not be loaded registered taskstats version rtccmos rtccmos setting system clock to UTC Initializing network drop monitor service input AT Raw Set keyboard as devicesplatformi serio inputinput ata NODEV after polling detection ata NODEV after polling detection ata ATA QEMU HARDDISK max UDMA ata sectors multi LBA ata ATAPI QEMU DVDROM max UDMA ata configured for UDMA ata configured for UDMA scsi DirectAccess ATA QEMU HARDDISK PQ ANSI sd sda byte logical blocks GB GiB sd sda Write Protect is off sd sda Mode Sense a scsi CDROM QEMU QEMU DVDROM PQ ANSI sd sda Write cache enabled read cache enabled doesnt support DPO or FUA sda sda sd sda Attached SCSI disk EXT fs sda couldnt mount as ext due to feature incompatibilities EXT fs sda mounting ext file system using the ext subsystem EXT fs sda warning mounting unchecked fs running e fsck is recommended EXT fs sda mounted filesystem without journal Opts null VFS Mounted root ext filesystem on device Freeing prom memory k freed Freeing unused kernel memory k freed Mounting etc to ramfs DONE Mounting var to jffs FAILED Checking SSH keys DONE Checking for run file DONE Starting System Logger DONE Starting Kernel Logger DONE klogd potentially unexpected fatal signal Cpu a ffffffff fbcae fbcaca b b fbcade ffffffff fbcb f fbcb f fbcb b b c fbcaee b cbc b e fbcacf ffffffff b c Hi Lo epc b x b Not tainted ra b c x b c Status a USER EXL IE Cause BadVA ffffffff PrId MIPS Kc Starting Panel LED panelleddriver modulelayout kernel tainted Disabling lock debugging due to kernel taint panelleddriver version magic WNAP V modunload MIPS R BIT should be kcmalta modunload modversions MIPS R BIT insmod cannot insert libmodulespanelledpanelleddriverko invalid module format FAILED Starting watchdog Error in opening the device No such device syswatchdog version magic WNAP V modunload MIPS R BIT should be kcmalta modunload modversions MIPS R BIT insmod cannot insert libmodulessyswatchdogsyswatchdogko invalid module format FAILED Error in opening the device No such device Starting Reset Detect panelresetsw version magic WNAP V modunload MIPS R BIT should be kcmalta modunload modversions MIPS R BIT insmod cannot insert libmodulespanelresetswpanelresetswko invalid module format FAILED WN TSYSRESETDETECTIOC returned err Checking Manufac data DONE Checking board file CREATED Loading Ethernet module ag mod version magic WNAP V modunload MIPS R BIT should be kcmalta modunload modversions MIPS R BIT insmod cannot insert libmodulesethernetag modko invalid module format FAILED Checking database DONE Verifing checksum DONE Loading Bridge module llc version magic WNAP V modunload MIPS R BIT should be kcmalta modunload modversions MIPS R BIT insmod cannot insert libmodulesnetllcllcko invalid module format FAILED Loading wlan modules athhal version magic WNAP V modunload MIPS R BIT should be kcmalta modunload modversions MIPS R BIT insmod cannot insert libmoduleswlanathhalko invalid module format FAILED Creating vap interface usrlocalbinwlanconfig ioctl No such device ifconfig SIOCSIFTXQLEN No such device usrlocalbinwlanconfig ioctl No such device ifconfig SIOCSIFTXQLEN No such device usrlocalbinwlanconfig ioctl No such device ifconfig SIOCSIFTXQLEN No such device usrlocalbinwlanconfig ioctl No such device ifconfig SIOCSIFTXQLEN No such device usrlocalbinwlanconfig ioctl No such device ifconfig SIOCSIFTXQLEN No such device usrlocalbinwlanconfig ioctl No such device ifconfig SIOCSIFTXQLEN No such device usrlocalbinwlanconfig ioctl No such device ifconfig SIOCSIFTXQLEN No such device usrlocalbinwlanconfig ioctl No such device ifconfig SIOCSIFTXQLEN No such device DONE Creating wds interface usrlocalbinwlanconfig ioctl No such device ifconfig SIOCSIFMTU No such device usrlocalbinwlanconfig ioctl No such device ifconfig SIOCSIFMTU No such device usrlocalbinwlanconfig ioctl No such device ifconfig SIOCSIFMTU No such device usrlocalbinwlanconfig ioctl No such device ifconfig SIOCSIFMTU No such device DONE Starting configd DONE Starting web server DONE Starting Translator startstopdaemon cannot start usrbinlogro No such file or directory syslog Starting Translator password Starting Translator ssh Starting Translator snmp Starting Translator telnet Starting Translator dns Starting Translator add bridge failed Package not installed set forward delay failed No such device ifconfig SIOCGIFFLAGS No such device set stp status failed No such device interface eth does not exist pcnet b eth link up set cascaded bridge failed No such device ifconfig SIOCSIFADDR No such device route SIOCADDRT No such device bridgeandvlantranslator Starting Translator hostapdtr potentially unexpected fatal signal Cpu a f a b b fffffff fb ffa d c ffa ba fe ffffffff ffa c f fd d ffa f ffa f Hi Lo epc fd d x fd d Tainted GF ra x Status a USER EXL IE Cause BadVA PrId MIPS Kc Segmentation fault hostapdtr Starting Translator nmbdtr Starting Translator sh cannot create procsysnetbridgebridgehttpredirectflushmac nonexistent directory sh cannot create procsysnetbridgebridgehttpredirectenabled nonexistent directory httpredirecttr Starting Translator dhcp Starting Translator kill cannot kill pid No such process ntp Starting Translator timezone Starting Translator kill cannot kill pid No such process scradio Error in opening the device No such device System initilization is DONE Welcome to SDK Have a lot of fun netgear login Could anyone help me Thank you Trying to test out this tool The example firmware worked perfectly Grabbed a Dlink router firmware DIR B When it try to emulate it under firmadyne the run script gives the following I added set e Adding route to HOSTNETDEV tap sudo ip link add link tap name tap type vlan id sudo ip link set tap up RTNETLINK answers Network is down echo Bringing up TAP device Bringing up TAP device sudo ip link set tap up RTNETLINK answers Network is down sudo ip addr add dev tap echo Adding route to Adding route to sudo ip route add via dev tap Error Nexthop has invalid gateway trap cleanup EXIT exit cleanup And I cant reach the emulation over the network Any ideas Traceback most recent call last File fatpy line in module main File fatpy line in main arch identifyarchimageid File fatpy line in identifyarch childexpectPassword for user firmadyne File usrlibpython distpackagespexpectspawnbasepy line in expect timeout searchwindowsize async File usrlibpython distpackagespexpectspawnbasepy line in expectlist return expexpectlooptimeout File usrlibpython distpackagespexpectexpectpy line in expectloop return selftimeoute File usrlibpython distpackagespexpectexpectpy line in timeout raise TIMEOUTmsg pexpectexceptionsTIMEOUT Timeout exceeded pexpectptyspawnspawn object at x f af bb d command rootfirmadynescriptsgetArchsh args rootfirmadynescriptsgetArchsh images targz buffer last chars xe x xa xe x xb firmadyne xe x a x xe x f xa xe xbb xa xef xbc x a before last chars xe x xa xe x xb firmadyne xe x a x xe x f xa xe xbb xa xef xbc x a after class pexpectexceptionsTIMEOUT I follow up the setup instructions of Firmware Analysis Toolkit and I get this problem Im looking forward to your suggestionsThank you very much I have a question of the line in the code It seems insert oid as number to all links file The ordinary file in files oids will use x correct oid in object table of the database as oid in line of the code Why use the number for all the link file curexecutemanyquery iid iid oid x filename x regularfile True uid x gid x mode x for x in files oids curexecutemanyquery iid iid oid filename x regularfile False uid None gid None mode None for x in links If there is no oid equal to in the object table of databaseeg if you clear the object table of the database rather than create a new one the oid will not start from it will cause error as follows Traceback most recent call last File rootdeepanaconda envsiotlibpython pdbpy line in main pdbrunscriptmainpyfile File rootdeepanaconda envsiotlibpython pdbpy line in runscript selfrunstatement File rootdeepanaconda envsiotlibpython bdbpy line in run execcmd globals locals File string line in module File rootdeepiotfirmadynefirmadynescriptstar dbpy line in module main File rootdeepiotfirmadynefirmadynescriptstar dbpy line in main processiid infile File rootdeepiotfirmadynefirmadynescriptstar dbpy line in process insertObjectToImageiid file oid links cur File rootdeepiotfirmadynefirmadynescriptstar dbpy line in insertObjectToImage for x in links psycopg IntegrityError insert or update on table objecttoimage violates foreign key constraint objecttoimageoidfkey DETAIL Key oid is not present in table object Some guy encountered this error too as firmware DIR A FW WWb was emulated successfully but failed in doexecve hook mode txt firmadyne doexecve PID rcS argv f etcinit dS pthroughsh envp HOME TERMvt LDPRELOADfirmadynelibnvramso userdebug PATHsbinusrsbinbinusrbin SHELLbinsh USERroot firmadyne doexecve PID svchlper argv sh varservdPHYINFETH startsh envp SHELLbinsh HOME PATHsbinusrsbinbinusrbin firmadyne doexecve PID svchlper argv sh varservdPHYINFETH startsh envp SHELLbinsh HOME PATHsbinusrsbinbinusrbin firmadyne doexecve PID svchlper argv sh varservdPHYINFETH startsh envp SHELLbinsh HOME PATHsbinusrsbinbinusrbin firmadyne doexecve PID S pthroughsh argv echo etcinit dS pthroughsh start envp USERroot SHELLbinsh PATHsbinusrsbinbinusrbin userdebug LDPRELOADfirmadynelibnvramso TERMvt HOME firmadyne doexecve PID S pthroughsh argv echo etcinit dS pthroughsh start envp USERroot SHELLbinsh PATHsbinusrsbinbinusrbin userdebug LDPRELOADfirmadynelibnvramso TERMvt HOME firmadyne doexecve PID S pthroughsh argv br port eth entering forwarding state BUG soft lockup CPU stuck for s sh Modules linked in Cpu a a bc f b f bb f b e a f f bba ffffffff ffe bdf f b f b e a d f bb ab f f e fe f b eac Hi Lo bc epc e handlebpint x x Not tainted ra eac kretprobetrampoline x xc Status a KERNEL EXL IE Cause PrId MIPS Kc 