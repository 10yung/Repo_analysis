Hello ZheDong thanks for you sharing such a good work I want to reproduce it in Pytorchbut Im sorry that I encountered the overfitting problem To get the results quickly I randomly choose samples as traindata and as valdata as testdata separately Finally I got about recall on the training set while only half of it on the val data And Im a fresh man to ImageTextEmbeddingcould you share some solutions to that I guess there are relevant reasons Data normalization I dont compute the mean and var of traindata explicitly and just divide it by subtract and thendivide it by L regularization I just use the e regularization intensity The complexity of classifier After generator I add a classifier with a softmax layer directly Whether more fully connection layers can slow down the fitting of the training set Finally I want to ask how to mine the hard triplet online in Pytorch efficiently Thanks How to use the trained model txtimage rank mAP Medr txtimage rank rank which is normally lower than reported I made no change to the parameters any ideas what could possibly be the reason for the performance drop trained on Ubuntu LTS Matlab b preprocessing data on another machine with a higher version for jsondecode support cudnn with a Titan Xp I am trying to train the model on MSCOCO and run into the following issues When running traincocoword poolm as you suggest I get the error that the function cocoword poolnow v does not exist I therefore changed it for cocoword pool since this function is indeed in the directory is this what you meant Then I get the following error Error using reshape To RESHAPE the number of elements must not change Error in cocoword pool line netparamsfirstvalue reshapesinglesubsetfeatures Error in traincocoword pool line net cocoword pool I experience the same issue when running traincocoword poolvgg m The reason that I am training is that I want to reproduce your results but the epochs in your pretrained model dont seem to be enough Are these the parameters that you used to report test results I am running the code on a MacBook Pro on Matlab R b Thank you in advance Recently read your thesis there are problems in the process of running the code ask you The following problem occurs when split data set in ImageTextEmbedding Index exceeds matrix dimensions Error in prepareimdb line Images fullfileimdbimagesdatatrain end Going beyond the border I don t know what s wrong Hey layumi I am trying to replicate your results for mscoco in tensorflow I had some questions about processing data and loss At the end of Stage my text CNN objectivetxt loss is high around what was the loss you got at the end of Stage in datasetMSCOCOpreparepreparewordcnnfeature m you create wordcnn zeros int then loop over all the captions in MSCOCO but there is captions in MSCOCO so whats the reason of this difference it throws an out of range error when I implemented it in tensorflow because there is more captions than the rowscolumns in the matrix wordcnn created cocodictionarymat dimensions is in your code but my dimensions are different I wonder if this is the reason why the loss is high or it might be because tensorflow uses a different random generator than matlab if you have any suggestion on this that would be great Thank you Hi I run the traincocoword poolm but after more than epochs I found the train result is still badas below I didnt change any hyper parameters but I dont know why it doesnt work qq Can you tell me what make this result happen And I found the learning rate in your code is but its reported as in the paper Which lr is correct and better in this task is there any way to get text or image embedding if given text or image as input thanks