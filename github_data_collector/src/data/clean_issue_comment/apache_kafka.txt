Makes the main thread wait for workers to be ready to test the desired functionality before proceeding Committer Checklist excluded from commit message Verify design and implementation Verify test coverage and CI build status Verify documentation including upgrade notes Demonstrate the consolidation approach via migrating KStreamSessionWindowAggregateProcessorTest to use MockInternalProcessorContext instead of InternalMockProcessorContext Committer Checklist excluded from commit message Verify design and implementation Verify test coverage and CI build status Verify documentation including upgrade notes This PR releases countDownLatch in ZooKeeperClienthandleRequests in the scenario where exception happens This prevents the deadlock shown below zksessionexpiryhandler daemon prio osprio tid x fcc c nid xfb waiting on condition x fcbb f javalangThreadState WAITING parking at sunmiscUnsafeparkNative Method parking to wait for x ee f a javautilconcurrentCountDownLatchSync at javautilconcurrentlocksLockSupportparkLockSupportjava at javautilconcurrentlocksAbstractQueuedSynchronizerparkAndCheckInterruptAbstractQueuedSynchronizerjava at javautilconcurrentlocksAbstractQueuedSynchronizerdoAcquireSharedInterruptiblyAbstractQueuedSynchronizerjava at javautilconcurrentlocksAbstractQueuedSynchronizeracquireSharedInterruptiblyAbstractQueuedSynchronizerjava at javautilconcurrentCountDownLatchawaitCountDownLatchjava controllereventthread prio osprio tid x fceaeec nid x waiting on condition x fccb c javalangThreadState WAITING parking at sunmiscUnsafeparkNative Method parking to wait for x d be a a javautilconcurrentCountDownLatchSync at javautilconcurrentlocksLockSupportparkLockSupportjava at javautilconcurrentlocksAbstractQueuedSynchronizerparkAndCheckInterruptAbstractQueuedSynchronizerjava at javautilconcurrentlocksAbstractQueuedSynchronizerdoAcquireSharedInterruptiblyAbstractQueuedSynchronizerjava at javautilconcurrentlocksAbstractQueuedSynchronizeracquireSharedInterruptiblyAbstractQueuedSynchronizerjava at javautilconcurrentCountDownLatchawaitCountDownLatchjava See for background Summary of testing strategy including rationale for the feature or bug fix Unit andor integration tests are expected for any behaviour change and system tests should be considered for larger changes Committer Checklist excluded from commit message Verify design and implementation Verify test coverage and CI build status Verify documentation including upgrade notes part of KIP create to producer per thread if eosbeta enabled commit all tasks at once if eosbeta enabled Call for review abbccdda guozhangwang Also add version to make use of flexible versions per KIP Committer Checklist excluded from commit message Verify design and implementation Verify test coverage and CI build status Verify documentation including upgrade notes Also addresses KAFKA Note that we still have to fall back to using pattern subscription if the user has added any regexbased source nodes to the topology Includes some minor cleanup on the side Instead of closing the zkClient immediately after controller shutdown the controller now resigns on shutdown rather than relying on the zkClient shutdown to implicitly do so New SMT plain text structmap regex group condition with ordered key name compatible with single plain text input and struct field input plain text sample Aug OPTIONS apiv serviceconfig HTTP Mozilla Macintosh Intel Mac OS X AppleWebKit KHTML like Gecko Chrome Safari SMT connect config with regular expression below can easily transform a plain text to struct or map data transforms TimestampTopic RegexTransform transformsRegexTransformtype orgapachekafkaconnecttransformsToStructByRegexTransformValue transformsRegexTransformstructfield message transformsRegexTransformregex d S S w s d GETPOSTOPTIONSHEADPUTDELETEPATCH d transformsRegexTransformmapping IPRemoteUserAuthedRemoteUserDateTimeMethodRequestProtocolResponseBytesSentMsNUMBERReferrerUserAgent The connectors located at classpath are loaded by AppClassLoader so Worker fails to find the PluginClassLoader for them It should be normal case but the log level is ERROR there is similar case in DelegatingClassLoaderloadClass and the log level is TRACE Committer Checklist excluded from commit message Verify design and implementation Verify test coverage and CI build status Verify documentation including upgrade notes 