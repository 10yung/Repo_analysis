In your featuresipynb In df matchcommercial df searchterm strlowerstrcontainscommercial df flagcommercial astypenpfloat In sumdf matchcommercial Out If df searchterm contains commercial and df flagcommercial it will return is it what you expected Since True will return 