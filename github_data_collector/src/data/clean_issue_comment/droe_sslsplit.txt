This patch mimiks the original timestamps for forging certificates I am currently trying to intercept some iot devices traffic The problem with that the iot device is that the clock isnt necessarily on the todays date it may be in the past So sslsplit should also mimik the original certificates timestamps I will get following error message when I try using sni sslsplit D l connectionslog j tmpsslsplit S tmpsslsplitlogdir c tmpsslsplitcacrt k tmpsslsplitcakey W tmpsslsplitgendir P https sni See logfile Active events warn Unable to seed random number generator DNS cant run Failed to create dnsbase Failed to start thread manager Received privsep req type sz on srvsock Received privsep req type sz on srvsock Received privsep req type sz on srvsock Child pid exited with status Version b System Linux kali kali amd SMP Debian kali x GNULinux IPTables sysctl w netipv ipforward iptables t nat F iptables t nat A PREROUTING p tcp dport j REDIRECT toports errorsslsplitlog Per the sslx forge function it looks like theres support for adding extra SANs to the generated certificates However in pxyconnc this is always set to NULL if generating a new certificate for the first time at least from what I can tell my Cs not great In some instances eg weird network routing topologyclient options a request might come in for a hostname which is not the hostname of the upstream server In those instances it might be nice to add a SAN to the generated certificates eg with a command line option Im running sslsplit with the T and I options mirroring decrypted streams to a local IFB interface ifb This works but the issue is that sslsplit insists on doing an ARP request and expects a response even for a local interface To work around this I first start sslsplit wait a second and then spoof an ARP reply both from and to ifb including its own MAC and IP This works but seems unnecessary I have looked at logpktetherlookup in logc but have been unable to figure out how to shortcut the process when the interface is local and already known It seems it should also be possible to mirror to a local interface without requiring it to have a configured IP address although this is less of an issue This may seem like an unusual case but I believe it could be very useful My application here is to do the following Mirror all incoming traffic using tc from monitored interface to ifb Egress filter ifb using tc to remove streams captured by sslsplit Use sslsplit to mirror the decrypted streams to ifb In effect this means we can run tcpdump against ifb and get all the traffic from the monitored interface with all the SSLTLS flows decrypted A useful feature imho Python reaches EOL at the end of this year so update the Python scripts in the extra directory to be compatible with Python Hi will it be possible to force sslsplit to ask for client certificates The upstream dispatch with a and b works fine but i have an IOT device that refuses tls connections if the mitm server does not specifically asks for its client certificate Danke logpktc In function logpktpcapbuild logpktc warning converting a packed ip hdrt aka struct anonymous pointer alignment to a uint t aka short unsigned int pointer alignment may result in an unaligned pointer value Waddressofpackedmember CHKSUMADDRANGEsum ip hdr sizeofip hdrt logpktc note defined here typedef struct attributepacked logpktc warning converting a packed tcphdrt aka struct anonymous pointer alignment to a uint t aka short unsigned int pointer alignment may result in an unaligned pointer value Waddressofpackedmember CHKSUMADDRANGEsum tcphdr sizeoftcphdrt payloadlen logpktc note defined here typedef struct attributepacked For build problems please supply Output of uname a Linux thinkpadnohatsca fc x SMP Fri Aug UTC x x x GNULinux Full output of failed make including the header SSLsplit Report bugs at Please supply this header for diagnostics when reporting build issues Before reporting bugs make sure to try the latest develop branch first git clone b develop Via pkgconfig openssl libevent libeventopenssl libeventpthreads libpcap check LIBNETBASE usr Build options DHAVENETFILTER Build info VFILE HDIFF N c edf uname a Linux thinkpadnohatsca fc x SMP Fri Aug UTC x x x GNULinux cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o cachemgro cachemgrc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o logbufo logbufc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o certo certc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o logo logc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o cachefkcrto cachefkcrtc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o optso optsc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o syso sysc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o thrqueueo thrqueuec cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o proco procc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o cachetgcrto cachetgcrtc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER DBUILDPKGNAME sslsplit DBUILDVERSION DBUILDDATE DBUILDINFO VFILE HDIFF N c edf DBUILDFEATURES DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o buildo buildc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o privsepo privsepc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o urlo urlc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o base o base c cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o nato natc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o cachedsesso cachedsessc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o maino mainc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o logpkto logpktc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o utilo utilc logpktc In function logpktpcapbuild logpktc warning converting a packed ip hdrt aka struct anonymous pointer alignment to a uint t aka short unsigned int pointer alignment may result in an unaligned pointer value Waddressofpackedmember CHKSUMADDRANGEsum ip hdr sizeofip hdrt logpktc note defined here typedef struct attributepacked logpktc warning converting a packed tcphdrt aka struct anonymous pointer alignment to a uint t aka short unsigned int pointer alignment may result in an unaligned pointer value Waddressofpackedmember CHKSUMADDRANGEsum tcphdr sizeoftcphdrt payloadlen logpktc note defined here typedef struct attributepacked cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o cacheo cachec cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o pxyconno pxyconnc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o proxyo proxyc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o loggero loggerc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o dynbufo dynbufc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o sslo sslc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o pxythrmgro pxythrmgrc cc c isystemusrinclude DGNUSOURCE DPKGLABEL SSLsplit DHAVENETFILTER O g pipe Wall Werrorformatsecurity WpDFORTIFYSOURCE WpDGLIBCXXASSERTIONS fexceptions fstackprotectorstrong grecordgccswitches specsusrlibrpmredhatredhathardenedcc specsusrlibrpmredhatredhatannobincc m mtunegeneric fasynchronousunwindtables fstackclashprotection fcfprotection pthread stdc Wall Wextra pedantic DFORTIFYSOURCE fstackprotectorall pthread o cachessesso cachessessc sed e susrlocaletcsslsplitusrlocaletcsslsplit e sVERSION e sDATE sslsplitconfin sslsplitconf sed e susrlocaletcsslsplitusrlocaletcsslsplit e sVERSION e sDATE sslsplit in sslsplit sed e susrlocaletcsslsplitusrlocaletcsslsplit e sVERSION e sDATE sslsplitconf in sslsplitconf cc Lusrlib pthread o sslsplit cachemgro logbufo certo logo cachefkcrto optso syso thrqueueo proco cachetgcrto buildo privsepo urlo base o nato cachedsesso maino logpkto utilo cacheo pxyconno proxyo loggero dynbufo sslo pxythrmgro cachessesso lnet lssl lcrypto leventopenssl leventpthreads levent lpcap Version and origin of OpenSSL used openssl c fc x Version and origin of libevent used libevent fc x If possible it would be useful for sslsplit to optionally add a HTTP header to indicate the originating client The method I am familiar with XForwardedFor However it appears that there is also RFC which might be more appropriate Thank you Testing using lighttpd v with modextforward Current libnetlibpcap ARP lookup in packet mirroring mode works well enough and is portable but it would be beneficial to eventually improve on it in two ways Support IPv target addresses T not only IPv Detect when target host goes down at some point while forwarding not only at program launch