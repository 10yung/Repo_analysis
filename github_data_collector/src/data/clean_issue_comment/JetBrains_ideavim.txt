This PR extracts all of the key handler state from KeyHandler and moves it to pereditor Some state was already pereditor and some was global which lead to weird bugs like typing d in one editor switching to another and typing w and deleting a load of text This PR also fixes VIM by allowing numbers to be mapped while still handling which cant be mapped as per Vim see help mapmodes A bug with counts eg d w would delete words instead of The way digraphs and literals key strokes are handled meaning CK and CVCQ can be remapped I implemented CTRLN and CTRLP in the command mode Fixes It passes all tests but implementation is rather inefficient Implementation for normal command Currently the Esc CA etc commands could be entered as they are eg norm iHelloWorldEsc Entering such commands in the vimway will be possible after the implementation of iCTRLV command This is my attempt to fix VIM The IDE itself does something slightly different at the moment see here while JComponentprocessKeyBindingsKeyEvent boolean falls back on the normal key code when it finds no matching binding Id like to link the source here but it seems to be only available as scrszip Because I dont know if I break something else with this change and I want to see if I get a response on IDEA I prefaced this with WIP I the meantime I am testing this change on my system Any feedback would be appreciated This is a port of VIMs argtextobjvim script It adds two new text objects ia and aa that represent an function argument This implementation also supports angle brackets and curly braces which is handy for C templates and Java generics and C brace initialization lists