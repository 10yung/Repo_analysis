I am able to add a VM to ManualDesktop using DesktopAddMachinesToManualDesktop service however I am struggling with Assign a user to the VM created and added to the Desktop pool I am trying to used MachineService with MachineUpdate option The part of the code is attached below The scripts in the github repository dont have examples to create VM and assign a user so raising this ticket Any help is appreciated I am trying to assign a user to a VM added to the Desktop pool AddUserEntitlementsqueryServicequeryservicecreatehvServices defnresults id VMBaseUpdate NewObject VMwarehvmachinebase VMBaseUpdateName vmName VMBaseUpdateDnsName vmName VMBaseUpdateUser AccessUserID VMBaseUpdateDesktop desktopId VMUpdate NewObject VMwareHvMachineInfo VMUpdateBase VMBaseUpdate VMUpdateId vmID updateid NewObject VMwareHvMapEntry updateidkey id updateidvalue VMID updatebase NewObject VMwareHvMapEntry updatebasekey base updatebasevalue VMBaseUpdatebase vmupdates vmupdates updateid vmupdates updatebase MachineService NewObject VMwareHvMachineService MachineServiceMachineupdatehvServices VMID vmupdates Error message after running last line PS C MachineServiceMachineupdatehvServices VMID vmupdates Exception calling MachineUpdate with arguments ExceptionType VMwareHvUnexpectedFault ErrorMessage Encountered unexpected error during execution CauseString javalangIllegalArgumentException Cannot get access group for nonassigned machines CauseStackTrace SystemString ErrorCode ErrorAttributes At line char MachineServiceMachineupdatehvServices VMID vmupdates CategoryInfo NotSpecified MethodInvocationException FullyQualifiedErrorId VimException Hi connection server version is build and im getting this error PS C servicesMonitoringMonitoringGetHealthCounters Exception calling MonitoringGetHealthCounters with arguments There is an error in the XML document At line char servicesMonitoringMonitoringGetHealthCounters CategoryInfo NotSpecified MethodInvocationException FullyQualifiedErrorId InvalidOperationException What could be the issue In the Json spec when creating a Desktop Pool there is a property called DesktopSettingsdisplayProtocolSettingspcoipDistplaySettingsVGPUGridProfile The VGPUGridProfile variable is NOT being set from the Json object This causes the NewHVPool function to fail when you want vGPU support The code should be equivalent to the code for the enableGRIDvGPUs property Please publish the VMwareVMCNSXT module in the PowerShellGallery for standardized UX Hello guys As a newbie to powercli and api I am struggling to write this simple script for automating regular scheduled snapshot and corresponding recomposing the linked clone pool based on the image After hours of searching I landed on hvhelper module and managed to work on the simple script However I faced the seemingly last but not the least obstacle I face the below error message which seems related to the module of hvhelper judging from it saying that I am having some parameter exception and missing Anyone could help me Any help would be appreciated My Script ConnectVIServer Server User Password Day values for snapshot name Today GetDateToString yyyyMMd Yesterday GetDateAddDays ToString yyyyMMd vm GetVM Name vmName Create snapshot for today NewSnapshot VM templete Name Today Description Today daily snapshot Delete snapshot from the previous day GetSnapshot VM vm WhereObject name contains Yesterday RemoveSnapshot Confirmfalse ImportModule VMwareVimAutomationHorizonView ImportModule VMwareHvHelper ConnectHVServer Server User Password StartHVPool Pool link Recompose LogoffSetting FORCELOGOFF ParentVM templete SnapshotVM Today StopOnFirstError false The resulting error message Exception calling DesktopRecompose with arguments ExceptionType VMwareHvMethodFault ErrorMessage Missing value for nonoptional field snapshot At C Program Files WindowsPowerShell Modules VMwareHvHelper VMwareHVHelperpsm char desktophelperDesktopRecomposeservicesitemspec CategoryInfo NotSpecified MethodInvocationException FullyQualifiedErrorId VimException GetMapEntry Cannot bind argument to parameter Value because it is null At C Program Files WindowsPowerShell Modules VMwareHvHelper VMwareHVHelperpsm char ettingsvirtualCenterProvisioningDatasnapshot value specSnapshot CategoryInfo InvalidData GetMapEntry ParameterBindingValidationException FullyQualifiedErrorId ParameterArgumentValidationErrorNullNotAllowedGetMapEntry NewHVPool InstantClone PoolName String PoolDisplayName String Description String AccessGroup String GlobalEntitlement String UserAssignment String AutomaticAssignment Boolean Enable Boolean ConnectionServerRestrictions String AutomaticLogoffPolicy String AutomaticLogoffMinutes Int allowUsersToResetMachines Boolean allowMultipleSessionsPerUser Boolean deleteOrRefreshMachineAfterLogoff String supportedDisplayProtocols String defaultDisplayProtocol String allowUsersToChooseProtocol Int enableHTMLAccess Boolean renderer D String Quality String Throttling String Vcenter String ParentVM String SnapshotVM String VmFolder String HostOrCluster String ResourcePool String datacenter String Datastores String StorageOvercommit String UseVSAN Boolean UseSeparateDatastoresReplicaAndOSDisks Boolean ReplicaDiskDatastore String UseNativeSnapshots Boolean ReclaimVmDiskSpace Boolean RedirectWindowsProfile Boolean Nics DesktopNetworkInterfaceCardSettings EnableProvisioning Boolean StopProvisioningOnError Boolean TransparentPageSharingScope String NamingMethod String NamingPattern String MaximumCount Int SpareCount Int ProvisioningTime String MinimumCount Int SpecificNames String StartInMaintenanceMode Boolean NumUnassignedMachinesKeptPoweredOn Int AdContainer Object NetBiosName String DomainAdmin String ReusePreExistingAccounts Boolean PowerOffScriptName String PowerOffScriptParameters String PostSynchronizationScriptName String PostSynchronizationScriptParameters String HvServer Object WhatIf Confirm CommonParameters NewHVPool LinkedClone PoolName String PoolDisplayName String Description String AccessGroup String GlobalEntitlement String UserAssignment String AutomaticAssignment Boolean Enable Boolean ConnectionServerRestrictions String PowerPolicy String AutomaticLogoffPolicy String AutomaticLogoffMinutes Int allowUsersToResetMachines Boolean allowMultipleSessionsPerUser Boolean deleteOrRefreshMachineAfterLogoff String refreshOsDiskAfterLogoff String refreshPeriodDaysForReplicaOsDisk Int refreshThresholdPercentageForReplicaOsDisk Int supportedDisplayProtocols String defaultDisplayProtocol String allowUsersToChooseProtocol Int enableHTMLAccess Boolean renderer D String enableGRIDvGPUs Boolean vRamSizeMB Int maxNumberOfMonitors Int maxResolutionOfAnyOneMonitor String Quality String Throttling String overrideGlobalSetting Boolean enabled Boolean url String Vcenter String ParentVM String SnapshotVM String VmFolder String HostOrCluster String ResourcePool String datacenter String Datastores String StorageOvercommit String UseVSAN Boolean UseSeparateDatastoresReplicaAndOSDisks Boolean ReplicaDiskDatastore String UseNativeSnapshots Boolean ReclaimVmDiskSpace Boolean ReclamationThresholdGB Int RedirectWindowsProfile Boolean UseSeparateDatastoresPersistentAndOSDisks Boolean PersistentDiskDatastores String PersistentDiskStorageOvercommit String DiskSizeMB Int DiskDriveLetter String redirectDisposableFiles Boolean NonPersistentDiskSizeMB Int NonPersistentDiskDriveLetter String UseViewStorageAccelerator Boolean ViewComposerDiskTypes String RegenerateViewStorageAcceleratorDays Int BlackoutTimes DesktopBlackoutTime Nics DesktopNetworkInterfaceCardSettings EnableProvisioning Boolean StopProvisioningOnError Boolean TransparentPageSharingScope String NamingMethod String NamingPattern String MinReady Int MaximumCount Int SpareCount Int ProvisioningTime String MinimumCount Int SpecificNames String StartInMaintenanceMode Boolean NumUnassignedMachinesKeptPoweredOn Int AdContainer Object NetBiosName String DomainAdmin String CustType String ReusePreExistingAccounts Boolean SysPrepName String PowerOffScriptName String PowerOffScriptParameters String PostSynchronizationScriptName String PostSynchronizationScriptParameters String HvServer Object WhatIf Confirm CommonParameters As you can see I can create a linkedclone pool with enableGRIDvGPUs but not with instanclone I hope this can be in the next release We have datastores that are maintained by another team The way they were setup we ended up with hostorclusterids I am able to create a new pool using newhvpool and of the data stores I then tried to add another using dsId NewObject VMwareHvDatastoreId dsId Datastorexxx SetHVPool PoolName poolName key automateddesktopdatavirtualCenterProvisioningSettingsvirtualCenterStorageSettingsdatastoresdatastore Value dsId I have also tried a few variations datastoresdatastore and datastoresdatastore but I get invalid member name each time Is it possible to add another datastore using SetHVPool We make our full clone desktops from running VMs which are always fully patched This ensures any new machines are fully patched upon first boot ParentVM and SnapshotId of NewHVPool are for instant and linked clones only so I cant use these to build my Full Clone pool PARAMETER ParentVM Parent Virtual Machine to clone Virtual machines Applicable only to Linked Clone and Instant Clone pools PARAMETER SnapshotVM Base image VM for Linked Clone pool and current Image for Instant Clone Pool When attempting to get a spec of pool using a running VM as a template the following error produces PS C Users myuser GetHVPool TESTPOOL GetHVPoolSpec Exception calling VmTemplateList with arguments There is an error in the XML document At C Program Files WindowsPowerShell Modules VMwareHVHelper VMwareHVHelperpsm char info servicesVmTemplateVmTemplateListVcId Where CategoryInfo NotSpecified MethodInvocationException FullyQualifiedErrorId InvalidOperationException The command completes and the json of the pool I attempt to get looks like so for pool VirtualCenterProvisioningData template null parentVm null snapshot null When I attempt to create a pool using a running VM as my template this is exactly how it is presented in the gui I receive the following error PS C Users myuser NewHVPool spec specfile NewHVPool Failed to create Pool with error No template VM found with Name POWERSHELLPOOL At line char NewHVPool spec specfile CategoryInfo NotSpecified WriteError WriteErrorException FullyQualifiedErrorId MicrosoftPowerShellCommandsWriteErrorExceptionNewHVPool The json for my spec file is set as so VirtualCenterProvisioningData template POWERSHELLPOOL parentVm null snapshot null In the module I experimented by switching templateList to globaltemplateList to see what is returned and it is indeed only proper templates from the cluster This cmdlet does not have an ID parameter which allows a user to define the ID for a preinstalled application and by default the ApplicationName parameter is also used for the ID This is a problem because if this cmdlet was used previously to create an application like Calculator then it cannot be used subsequently on another farm to create the same Calculator application Attempts to do so throws the message appname already exists in the Application Pool And since the ApplicationName parameter must match the name of the preinstalled application youre just stuck if you need to publish the same application name from different farms Is there a workaround here Noticed in the psm it is already version but the psd still states 