I have tested the solution on this document But trying to write to a cell destroys elements of the document This is my code module Excel class SendContract require spreadsheet def selfreturncontract Spreadsheetclientencoding UTF tempXLSX RailsrootjoinappassetsspreadsheetscontractTOMv xls target Railsrootjoin xls target Railsrootjoin outxls FileUtilscopyfiletempXLSX target book Spreadsheetopentarget sheet bookworksheet puts sheet sheet Tester bookwrite target return target end end end I call it from console this way f ExcelSendContract returncontract The output says KONTRAKT OPLYSNINGER PathnameUserssreProjectMotorrummetweb xls I open the f file using open f And then Excel says Alert File error data may have been lost After this alert Alert Unable to read file Then Alert We found a problem with some content in xxxx Do you want us to try to recover as much as we can Saying yes opens up the document The good thing The cell headline was changed The bad All formatting is lost And even of the sheets is completely missing Anyone who can help Kind Regards S ren Rehn Add open option to set the sheet password I dont see any code that update the columns array like for example the update for the rows array here that result that when i call columns on a sheet filled with columns it return an empty array