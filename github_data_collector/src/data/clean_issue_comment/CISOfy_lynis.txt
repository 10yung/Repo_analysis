Describe the bug Upon trying to find NTP cronjobs in etccronhourly the directory listing of the pwd is used instead of the correct directory listing Version Distribution Debian buster Lynis version Expected behavior check for ntpdate or rdate in etccronhourly and not in pwd Output each x represents a different file that is not present in etccronhourly but rather in the pwd Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Test checking for ntpdate or rdate in etccronhourlyx Additional context the test works fine in etccrond but fails upon entering the etccronhourly stage This fixes Summary of changes Enhancements Search for the ntpctlbinary Check if OpenNTPD is installed by checking if ntpctl is installed Confirm the use of OpenNTPD by confirming ntpctl is working or an process with the commandline ntpd ntp engine exists Add typical OpenNTPD configuration files to TIME New tests TIME Report if ntpctl cannot communicate with OpenNTPD TIME Check status of OpenNTPD time synchronisation TIME Check OpenNTPD has working peers This has been tested on FreeBSD I wondering how many people are running tmp with nosuid and noexec It might be only on ubuntu and debian but those options cause a lot of issue the give simple example and easy to reproduce define noexec and try to launch a docker container define noexec and do an apt update or install define nosuid with etckeeper installed and tamper a file in etc than update etckeeper database The Raspberry Pi kernels reside within raspberrypikernel package Initial version of CRYP see There are few shortcomings This will not detect all RNGs for instance OneRNG registers itself as devttyACM and not through Linuxs HW RNG drivers There is no verification that rngd is actually using the found HW RNG It could as well be using devzero etc This can be implemented but might require a bit more complex check as the input can be configured in several places conf files cmdline parameters etc Describe the bug lynis reports the following warning under CentOS iptables modules loaded but no rules active FIRE CentOS uses a different firewall structure the primary frontend is now firewalld via the firewallcmd tool and iptables has been kept as an alternative frontend for more complex rules Version CentOS git Expected behavior Understand the specifics of firewalld and the various XML zone rules under etcfirewalldzones lynix should be able to read those rules first and the iptables rules second Then decide if there are really no firewall rules at all Function CheckItem searches in REPORTFILE whereas HTTP puts its findings into LOGFILE Hence the message that modevasive so and modsewcurity could not be found openSUSE Tumbleween Leap Lynis Modules are active and should be found Suggestions Install Apache modevasive to guard webserver against DoSbrute force attempts HTTP Install Apache modreqtimeout or modqos to guard webserver against Slowloris attacks HTTP Install Apache modsecurity to guard webserver against web application attacks HTTP Is your feature request related to a problem Please describe Lynis could check for existence of TRNG and whether rngd is running Describe the solution youd like Check that sysclassmischwrandomrngcurrent value is not none Check that rngd is running and utilizing the TRNG Required changes x Assign CRYP ID CRYP Assign potential hardening points Implement a test for this Additional context Somewhat relates to fixes I know about issue which is about versions of MySQL leaving deleted open files in tmp an exception for these version was implemented for LOGG I have a fresh Ubuntu x install with an aptget install mysqlserver resulting in a mysqld I find LOGG of lynis still reports deleted open files for mysqld Now I dont know yet if this is a regression of the bug supposedly fixed for mysqld a new bug or simply expected behaviour of mysqld I suspect its the latter If so it would be nice if certain processes could be exempted by name from getting warned for Im thinking along the lines of skiptestLOGG mysqld This would remove the need for implementing explicit exceptions such as the one that was the cause for allow for endusers customizing specific exceptions themselves without having to resort to completely disabling the test 