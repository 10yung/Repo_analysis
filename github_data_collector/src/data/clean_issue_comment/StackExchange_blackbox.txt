Available in pkgsrc via pkgin as scmblackbox Just noticed that I forgot to do this along with I register a new file and see in the blackboxfilestxt its full path for example cusersuserdocumentsgithubnotestestmd If I then add a new admin reencrypt files commit and push and new admin will pull and try to decrypt he will get an error of not being able to find a file by my old path wich includes my username I can be doing something wrong This might not be an issue with blackbox so much as user error but Im not sure where else to post Im running into gpg decryption failed No secret key I have a new machine with a new gpg key and from that machine which has ssh access to my git secrets repo I did blackboxaddadmin with the corresponding email address However any attempt to run blackbocat blackboxedit etc runs into the above error I think I need to do blackboxupdateallfiles but doing so gives the same error I also tried running blackboxupdateallfiles on an old machine which can run all the other blackbox commands fine Update all files fails with the same error Now my guess is that to reencrypt all files all of the admins gpg keys must be on the same machine Is that the case If so I understand why Im hitting this error otherwise Im quite confused Thanks for any help Is there a way to suppress the log spam from GPG just corrected some grammatical mistakes I followed the instructions on how to setup automated users role accounts in the readme file and whenever I try to blackboxpostdeploy I just get the nosecret key error in NEWMASTER even if gpg K and gpg K say the secret key is imported I had to regenerate a new key using gpg v instead of gpg for my role account to work Posting here in case someone experiences the same thing Im trying to create a subkey for one of our servers which has gpg and when I get to the point of trying to decrypt the files I get stuck with a failing preparekeyring Looks like the command gpg keyring homeuserprojectkeyringslivepubringkbx export returns an error even though the output looks good Im not sure if the problem is with my keys or with blackbox userhostproject GPGgpg bash x which blackboxpostdeploy export PATHusrbinbinhomeuserbinhomeuserlocalbinusrlocalsbinusrlocalbinusrsbinusrbinsbinbinusrgamesusrlocalgamessnapbin PATHusrbinbinhomeuserbinhomeuserlocalbinusrlocalsbinusrlocalbinusrsbinusrbinsbinbinusrgamesusrlocalgamessnapbin set e source usrlocalbinblackboxcommonsh source usrlocalbinstacklibsh cd usrlocalbin pwd usrlocalbin declare a BLACKBOXDATACANDIDATES BLACKBOXDATACANDIDATESblackbox keyringslive vi gpg which git git revparse showtoplevel VCSTYPEgit git revparse showtoplevel REPOBASEhomeuserproject export VCSTYPE physicaldirectoryof homeuserproject dirname homeuserproject local dhomeuser basename homeuserproject local fproject cd homeuser pwd P sed s echo homeuserproject export REPOBASEhomeuserproject REPOBASEhomeuserproject n z BLACKBOXDATAblackbox for candidate in BLACKBOXDATACANDIDATES d homeuserprojectblackbox for candidate in BLACKBOXDATACANDIDATES d homeuserprojectkeyringslive BLACKBOXDATAkeyringslive break KEYRINGDIRhomeuserprojectkeyringslive BBADMINSFILEblackboxadminstxt BBADMINShomeuserprojectkeyringsliveblackboxadminstxt BBFILESFILEblackboxfilestxt BBFILEShomeuserprojectkeyringsliveblackboxfilestxt SECRINGhomeuserprojectkeyringslivesecringgpg FILEGROUP changetovcsroot local rbasehomeuserproject cd homeuserproject preparekeychain local keyringasc echo Importing keychain START Importing keychain START makeselfdeletingtempfile keyringasc local resultvarkeyringasc local name case uname s in uname s mktemp nametmptmpdaEPkMZLbX addonexit rm f tmptmpdaEPkMZLbX local n onexititems n rm f tmptmpdaEPkMZLbX eq trap onexit EXIT eval keyringasctmptmpdaEPkMZLbX keyringasctmptmpdaEPkMZLbX export LANGCUTF LANGCUTF gpg g p g gpg import getpubringpath f homeuserprojectkeyringslivepubringgpg echo homeuserprojectkeyringslivepubringkbx gpg keyring homeuserprojectkeyringslivepubringkbx export gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg key FABA E userstagingflashnodeio userhostdomaincom not changed gpg key C EC user developersdomaincom not changed gpg key E CA user user domaincom not changed gpg key D D C userhost domaincom userhost domaincom not changed gpg key C EC user developersdomaincom not changed gpg key E CA user user domaincom not changed gpg key D D C userhost domaincom userhost domaincom not changed gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg skipped packet of type in keybox gpg key FABA E userhostdomaincom userhostdomaincom not changed gpg Total number processed gpg unchanged onexit for i in onexititems eval rm f tmptmpdaEPkMZLbX rm f tmptmpdaEPkMZLbX Hi when you run blackboxaddadmin the code firstly add the admintobe to the blackboxadminstxt then access GPG database and fails if the key does not exists Steps to reproduce mkdir devshmemptyrepo cd git init blackboxinitialize blackboxaddadmin dummyadmindummydomaincom The code will fail with GPG warning nothing were exported and GPG key dummyadmindummydomaincom not found But the repo is changed cat blackboxblackboxadminstxt dummyadmindummydomaincom I think that adding a check for the key existence or simply moving the code below the GPG import part would be enough K blackboxaddadmin userid adds all keys to the internal keychain that match the given userid even if one of the keys is revoked Every command is separate eg blackboxedit blackboxcat There should be a single blackbox command that takes verbs like edit cat ls as arguments I cant even run the command blackbox because it doesnt exist So you cant even do blackbox help Am I the only one who finds this behavior to be absolute insanity