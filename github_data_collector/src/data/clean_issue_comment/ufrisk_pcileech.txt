I am wondering if there is a reference or piece of code I can look at that can help me get a base address of a process running on target computer using pciscreamer r The code I am looking at uses an old version of the project and the function is no longer valid it seems I just want to add some offsets to the base address so I can read and write to some parts of the memory Since this question is asked multiple times and I am curious about this as well I researched it a little bit and came across several resources ie research papers Detecting Peripheralbased Attacks on the Host Memory Can Hardware Performance Counters be Trusted Poster Towards detecting DMA malware Hi Im working on a demo of pcileech PCIeScreamer R on an hp elitebook laptop running Win The whole rooting process was working perfectly yesterday until today when I tried to reharse my demo and it doesnt work anymore Symptoms pcieleech works normally with patching eg I was still able to dump memory probe memory and run patch sig stickykeyscmdwin Pcileech consistently fails to install the KMD rootxxxxpciepcileechfiles pcileech wx pscmd kmd WIN X KMD Code inserted into the kernel Waiting to receive execution C Sometimes the target kernel BSODs or freezes but most often nothing happens Ive tried with the windows version both and versions give the same results I wanted to go the ntfssys way but it looks like this one is not available on more recent windows versions Im still baffled why it worked yesterday and not today I tried removingadding windows patches verifying the wiring trying from my linux computer withwithout power plug changing the pcie flat cable tried with WIN X fails too Right now Im updating to Win hoping this would change something I have another laptop with where the attack works Any idea of possible problems I have overlooked Thanks Hi Ulf Ive flashed my PCIeScreamer R with pcileechpciescreamerxc a My target machine and analysis machine are separate devices both running Windows The PCIeScreamer shows up correctly in the target machines device manager When I run a probe it does detect my GB of RAM but fails to read every single page pcileech device fpga v vv probe DEVICE FPGA PCIeScreamer R PCIe gen x v Successfully loaded LeechCore v Device Memory Map START END PAGES Current Action Probing Memory Access Mode Normal Progress Speed MBs Address x Pages read Pages failed Memory Probe Completed On some boots Ive noticed it only seems to detect GB progress reports and failed pages but Im not sure if that is relevant Other commands such as display fail as well pcileech device fpga v vv display min x DEVICE FPGA PCIeScreamer R PCIe gen x v Successfully loaded LeechCore v Device Memory Display Failed reading memory at address x Ive tried reflashing the board and also reseating it in different slots x and x with no changes I double checked my BIOS configuration I disabled IOMMU and SVM Mode virtualization early on but there are other options that may be relevant the GB memory option under PCI settings looks interesting but does not seem to have any effect The board is an msi b tomahawk here are some of the relevant options bios Any suggestions to resolve this issue would be greatly appreciated Thanks Hello I am very interested in using the TotalMeltdown vulnerability as memoryacquisition method Some questions i have are The meltdown vulnerability was only for Intel as far as i know Is the totalmeltdown also for AMD processors Is it possible to use it in virtual machines or does it need to be a physical PC How could one obtain that specific windows version Hello in the release notes is written that experimental feature user mode injects are added Does that mean dllinjection Hi I am using the ac ft platform and it seems I have successfully flashed the device I am running the toolkit on a windows pc When trying to run any pcileeh command it just returns PCILEECH Failed to connect to the device Any idea how I can go on and debug the system Thanks Hey im trying to follow the guide for this project Im using AC board and the FT x usb convector After i build a bit file and programmed the device all seems about right i tried running a few commands from the pcileechexe and got the error about the FTDI FTD XXdll missing error i have downloaded and added them and then the message changed to FPGA ERROR Unable to connect to usbft device v PCILEECH Failed to connect to the device i got this messages when running the pcileechexe kmdload kmd win x device fpga v command i saw on another issue online how can i verify the connection to the board in order to verify the cable is fine or the converter i didnt saw anything regarding this error online so ill be thankful for any advice or solutions Thanks hi ufrisk I used pciescreamer R When i running pcileech under Windows everything was fine and I compiled pcileechleechcoreft x under the raspberry pi lsmod uiopdrvgenirq uio uiopdrvgenirq ft x iptables iptablenat xtables iptablesiptMASQUERADE ipv lsusb Bus Device ID f Future Technology Devices International Ltd Bus Device ID ec Standard Microsystems Corp SMSC Fast Ethernet Adapter Bus Device ID Standard Microsystems Corp SMC Hub Bus Device ID d b Linux Foundation root hub Once an pciescreame device is inserted the driver will create a device object in devft x rootraspberrypipcfiles ls al devft crwrwrw root root Apr devft x when i run pcileech kmdload kmd win x give me PCILEECH Failed to connect to the device whats wrong By the way how do you run pcilceech on Android like linux Also use ft x Waiting for a reply Thank you I am using a SP FT with a PCIe to M Key adapter on a Laptop Pcileech is version and the SP firmware is Host machine is Linux and target OS is Win VTd is disabled in BIOS If I stop the boot at the boot menu I am able to read memory However if I attempt to do the same on the Win sign in screen I get a lot of these errors Device Info FPGA Bad PCIe TLP received Should not happen Do you have any idea what might be causing this and a possible mitigation 