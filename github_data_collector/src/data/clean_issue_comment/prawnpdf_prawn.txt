Starting a new issue for visibility but this year old issue is also relevant Im using Open Sans from the google font website Attached sample PDF It opens fine in Chrome Mac Preview but will not open in Adobe Acrobat latest mac version When opening the error is Cannot extract the embedded font ab c OpenSansBold Some characters may not display or print correctly Relevant code from installing custom TTF font fontfamiliesupdateOpen Sans normal Railsrootjoinapp fonts OpenSansRegularttftos bold Railsrootjoinapp fonts OpenSansBoldttftos italic Railsrootjoinapp fonts OpenSansItalicttftos bolditalic Railsrootjoinapp fonts OpenSansBoldItalicttftos font Open Sans style normal Honestly I would be fine using the default system font and not bothering with embedded TTF fonts but then I lose portability and UTF support Any ideas Environment Ruby Christy Sheppard pdf textbox string at textbox string at I have two text boxes like above from top to bottom I would like to make the boxes dynamic so that when string increases it does not overlap string Can somebody help me how to do this The font metric cache doesnt work properly in Ruby Its not properly considering the font size when resolving the string width which can lead to incorrect results if the same string with a different size had previously been cached This seems to be due to a change in how Ruby uses a Struct for a hash key Its not calling hash on each property And since the Font object is mutable two different font sizes can end up resolving to the same key A quick fix is to invoke hash on the font when initializing the CacheEntry rb CacheEntrynew fhash options encodedstring Im having a hard time reproducing outside of the application because it highly depends on the call order But the main issue is that the font size of a font can change which in turn changes the key in the hash Theres a note in the code that defining a hash method on Font fixes the issue but that assumption doesnt seem to hold true anymore I am using textbox as it allows me to define a box which the text resides in and will never escape from I also want to change the color of the font However the color option is not supported and I have no idea how I would be able to change the color while using textbox The documentation does not provide a solution to this problem I would recommend either to enhance the documentation to explain how coloring of the text can be achieved or add support for that option to that method Im trying to generate a PDF containing a signed link The signature strings contains characters that need to be URL encoded for use in the query parameters eg wJ OAi u WSJtzEq bxaoEG yY So my entire encoded link should be something like nonsense link of course just for illustration purposes Now if I render this link using text with inlineformat the resulting link will have the percentcharacters in the already encoded string encoded again resulting in this invalid link However if I pass the unencoded URL ie no URLescaping is happening at all which also gives me a broken link because the is interpreted as a space Heres some sample code to reproduce the behaviour ruby require cgi require prawn PrawnDocumentgenerateurlescapedpdf do signature CGIescapewJ OAi u WSJtzEq bxaoEG yY textucolor rgb c fa link href coloru inlineformat true end PrawnDocumentgenerateurlunescapedpdf do signature wJ OAi u WSJtzEq bxaoEG yY textucolor rgb c fa link href coloru inlineformat true end Why is the character seemingly escaped by prawn but nothing else Is this a legit bug or am I not using this method correctly There are at least some changes in master since the release of v in March Its hard to say exactly how many because there appears to be no tag in the repo for to compare to master But one change I noticed is that still expresses a dependency on pdfcore so wont use the latest pdfcore release I came here to report that but then noticed it was already fixed in master Would it be possible to do a new prawn release so I can update to latest pdfcore as well Ideally with a git tag for version for new release To better discuss We use different background images for different pages adding it with a repeater this way repeatpg pg do blendmodeOverlay do loadbackgroundimage end end We need to do it in Overlay mode because the text is rendered behind the image The overlay affects the rendering so we want to get rid of it I think what is happening is that the repeat block or stamp is called after the page has been rendered not before When theres not enough height for a line of text on the current page Prawn advances that line to the next page handled by PrawnTextFormattedWrap When this happens the soft hyphens in that line are stripped As a result soft hyphens are absent when the line is rendered This affects hyphenation The soft hyphens should be preserved Hi Im running into some issues trying to get Prawn to render Nepali text and Im not sure where the issue might be any help would be appreciated Using Prawn pdf PrawnDocumentnew pdffont libTimesNewRomanttf pdffontfamiliesupdateMiedingerBook normal libMiedingerBookttf pdffallbackfonts MiedingerBook pdftextbox pdfrenderfileoutprawnpdf When I run this I get Traceback most recent call last from Usersmervmgemsruby gemsprawn libprawntextboxrb in render from Usersmervmgemsruby gemsprawn libprawntextformattedboxrb in render from Usersmervmgemsruby gemsprawn libprawnfontrb in savefont from Usersmervmgemsruby gemsprawn libprawntextformattedboxrb in block in render from Usersmervmgemsruby gemspdfcore libpdfcoretextrb in characterspacing from Usersmervmgemsruby gemsprawn libprawntextformattedboxrb in block levels in render from Usersmervmgemsruby gemspdfcore libpdfcoretextrb in textrenderingmode from Usersmervmgemsruby gemsprawn libprawntextformattedboxrb in block levels in render from Usersmervmgemsruby gemsprawn libprawnfontrb in fontsize from Usersmervmgemsruby gemsprawn libprawntextformattedboxrb in block levels in render from Usersmervmgemsruby gemsprawn libprawntextformattedwraprb in wrap from Usersmervmgemsruby gemsprawn libprawntextformattedlinewraprb in wrapline from Usersmervmgemsruby gemsprawn libprawntextformattedlinewraprb in applyfontsettingsandaddfragmenttoline from Usersmervmgemsruby gemsprawn libprawntextformattedarrangerrb in applyfontsettings from Usersmervmgemsruby gemspdfcore libpdfcoretextrb in characterspacing from Usersmervmgemsruby gemsprawn libprawntextformattedarrangerrb in block in applyfontsettings RuntimeError Bad font family However if I set the font explicitly instead of using the fallback then the error goes away I have tested this with multiple Nepali fonts and gotten the same result However the issue doesnt come up when using a Thai font as a fallback for Thai strings