Right now goproxy eats over full CPU cores Where the problem is DNS resolving code Expected Behavior Working well without resolving when there is no need for exampleips are random in example client requests connection to server does it directly without doing any DNS requests Current Behavior Horribly big CPU load even if no traffic goes anymore thru goproxy after using torrent client on a popular torrent Why Because it FLOODS my DNS server taking lot of resources to do it Possible Solution do not resolve IPs if not requested to resolve Steps to Reproduce Configure qBitTorrent to use socks for everyting Start any popular torrent with thousands of peers Observe huge CPU load and flood to DNS server for a long time for me it eaten over h of CPU time already Context Environment How has this issue affected you What are you trying to accomplish Providing context helps us come up with a solution that is most useful in the real world proxy version is commercial full command is proxy socks lbmethodroundrobin p system is linux x full log is not required as it can be miles long and issue is easy to reproduce Provide a general summary of the issue in the Title above Expected Behavior Tell us what should happen Current Behavior Tell us what happens instead of the expected behavior Possible Solution Not obligatory but suggest a fixreason for the bug Steps to Reproduce Provide a link to a live example or an unambiguous set of steps to reproduce this bug Include code to reproduce if relevant Context Environment How has this issue affected you What are you trying to accomplish Providing context helps us come up with a solution that is most useful in the real world proxy version is v full command is system is full log is Provide a general summary of the issue in the Title above Detailed Description Provide a detailed description of the change or addition you are proposing Possible Implementation Not obligatory but suggest an idea for implementing addition or change SwitchyOmega https proxy protool https server wwwabcdcom port proxy SwitchyOmega proxycrt proxykey goproxy proxy IE IE abc abc func s HTTP callbackinConn netConn clientproxyserver client tcp abc binary linux amd cpu proxy version is proxydarwin commercialtargz full command is proxy system is mac os B error log bad CPU type in executable proxy heroku proxy snail Provide a general summary of the issue in the Title above proxy sps p log proxylog daemon curl vvvvvv resolve wwwoschinanet curl resolve pubsacsorg C Users LiuDHcurl vvv resolve pubsacsorg Address in pubsacsorg found illegal Rebuilt URL to Trying TCPNODELAY set Connected to pubsacsorg port schannel SSLTLS connection with pubsacsorg port step schannel checking server certificate revocation schannel sending initial handshake data sending bytes schannel sent initial handshake data sent bytes schannel SSLTLS connection with pubsacsorg port step schannel failed to receive handshake need more data schannel SSLTLS connection with pubsacsorg port step schannel failed to receive handshake SSLTLS connection failed Closing connection schannel shutting down SSLTLS connection with pubsacsorg port schannel clear security context handle curl schannel failed to receive handshake SSLTLS connection failed C Users LiuDH SNI conn connected pubsacsorg conn released pubsacsorg Expected Behavior Tell us what should happen Current Behavior Tell us what happens instead of the expected behavior Possible Solution Not obligatory but suggest a fixreason for the bug Context Environment How has this issue affected you What are you trying to accomplish Providing context helps us come up with a solution that is most useful in the real world proxy version is v full command is proxy sps p log proxylog daemon system is Ubuntu LTS Provide a general summary of the issue in the Title above Detailed Description Provide a detailed description of the change or addition you are proposing Possible Implementation Not obligatory but suggest an idea for implementing addition or change v dns vps proxy bridge p C proxycrt K proxykey proxy server udp r P C proxycrt K proxykey A proxy client P C proxycrt K proxykey server session created udp conn b fb f d fed bc f ca connected udp conn read udp packet fail err EOF udp conn b fb f d fed bc f ca released session created udp conn d bbb df e aadb be e a f b connected udp conn read udp packet fail err EOF udp conn d bbb df e aadb be e a f b released A udp conn a d aaa f f d ddf f b connected udp conn read udp packet fail err read udp read connection refused udp packet revecived from bridge fail err io readwrite on closed pipe udp conn a d aaa f f d ddf f b released worker signal revecivedserver ba a a bf fb ed cca fcd db b stream b a c adfdaeb b bd ac e bd udp udp conn b a c adfdaeb b bd ac e bd connected udp conn read udp packet fail err read udp read connection refused udp conn b a c adfdaeb b bd ac e bd released udp packet revecived from bridge fail err io readwrite on closed pipe UDP vps udp 