Hi I am having some trouble with what should be a simple thing so I suspect user error When I use plotbar to create bar plots it does not return the abundance values that I know are in the samples Below is a graph showing a simplified example of this where I plotted the sequence abundances by each individual sample The samples all have sequences in them so the total should be but that is not what shows up in the graph This data is a smaller subset of a larger data set but the issues appear no matter what version of the data I use Any help would be greatly appreciated I have attached a zip folder with all the input files and script I used in this example Abundance plotpdf PhyloseqIssuezip Major fixes were misplaced backticks which interfere with rendering Minor changes are removal of trailing space Hi Happy new year Since the relative abundance is recommended to do beta diversity analysis I used the following codes to transform our phyloseq object to relative abundance But when I check taxtab below I can still only see total abundance Do you have any ideas on it Also the braycurtis distances of using relative abundance and total abundance are exactly the same Not sure whether it s right Toad is an object that has been removed the otus counts standf functionx xsumx Toad r transformsamplecountsToad standf taxtab tabletaxtableToad r Phylum exclude NULL taxtab Thanks Jia I wonder if the myBiomFilebiom file exists on official pages I got the following error messages myphyseq importBiom BIOMfilenamemyBiomFilebiom Error in readbiombiomfile BIOMfilename Both attempts to read input file myBiomFilebiom either as JSON BIOMv or HDF BIOMv Check file path file name file itself then try again I am trying to import sampledatacsv that I have prepared as csv with location as variable I am using the command Sampledata sampledataSampledata rownamessamplenamesphyseq I receive the following error Error in if errorIfNULL isnullout argument is of length zero How can I solve it Hi I am quite new to microbiome analysis and frankly quite at a loss as to how to proceed So I apologize is my question is naive or has already been answered elsewhere I have just read a paper where they state that microbiome datasets are compositional and therefore methods usually employed for microbiome analysis are not appropriate I am particularly concerned on data normalization as the authors state that normalization methods such as those implemented in DESeq should not be used My question bluntly put is are they right Are there methods implemented in phyloseq to handle compositional data Thanks in advance for your help Hi I dont have a paired design like the examples provided above I have multiple treatmentsfactors that I would like to use with the DESeq package headsampledatadatexposuregutTreatment Levels Acclimation control Field TCS I tried the below code with my column Treatment which has levels but it didnt really like it and gave this error exposuredeseq phyloseqtodeseq datexposuregut Treatment it appears that the last variable in the design formula Treatment has a factor level control which is not the reference level we recommend to use factorlevels or relevel to set this as the reference level before proceeding for more information please see the Note on factor levels in vignetteDESeq I went on to see if I could just ignore that message exposuredeseq DESeqexposuredeseq testWald fitTypeparametric Error in estimateSizeFactorsForMatrixcountsobject locfunc locfunc every gene contains at least one zero cannot compute log geometric means I have also tried to just subset my phyloseq object to compare only two treatments at a time Im not sure if this is okay to do and I get the same error Is there anyway to do this or maybe Ive made a mistake Victoria Hi all I am hoping to create a compositional barplot for each individual sample in a study I have my data in a phyloseq and I was able to create the compositional barplot for the top taxa across all samples using the code below viewfinalvst is my normalized phyloseq object get top most abundant Families merge remaining Families into Other and glom by Family Make a compositional bar plot sorttax sorttapplytaxasumsviewfinalvst taxtableviewfinalvst Genus sum TRUE lengthsorttax toptax sorttax what are the top most abundant Families across the whole study writecsvtoptax top Taxacsv bottomtax sorttax lengthsorttax topsub subsettaxaviewfinalvst Genus in namestoptax get top most abundant Genus bottomsub subsettaxaviewfinalvst Genus in namesbottomtax get all other taxa bottomsubm mergetaxaviewfinalvst taxanamesbottomsub archetype merge all other taxa into Genus Other taxtablebottomsubm isnataxtablebottomsubm Other bottomsubm taxglombottomsubm taxrankGenus match Replace row name with genus stacked barplots to compare proportional composition bottomsubrel transformsamplecountsbottomsubm functionx xsumx dflong psmeltbottomsubrel first change to long format oldlvl levelsdflongGenus dflongGenus factordflongGenus levelscOther sortoldlvl oldlvlOther decreasingF Plot ggplotdflong aesxSamplename yAbundance fill Genus geombarstatidentity positionstack labsxSample yPercentage of Sequences scalefillmanualvaluesgenusPal navaluedarkgrey scalecolormanualvaluesgenusPal navaluedarkgrey themeaxistitleelementtextsize axistextxelementtextangle size hjust vjust legendtextelementtextsize legendkeysize unit in legendposition bottom legendtitleelementblank plottitle elementtexthjust labstitle Top Taxa However this just finds the top taxa in the phyloseq object that I created I was hoping to be able to make a loop that will run through each sample name in the phyloseq object and create an individual phyloseq object for each sample then plot that phyloseq using the code above However I have been having difficulty figuring out how this loop would work especially with phyloseq I did some searching through the previous issues and found a way to view the top in each sample but this does not allow me at least as to my knowledge to convert into a phyloseq object with abundance data I would really appreciate any help in trying pt put this loop together I would also imagine that this could be helpful for individuals in the future that want to find the top however many taxa in individual samples Thanks in advance for any help Hi there I ran into an intriguing error with different datasets For demonstration purposes Im trying to transform some abundance data with different functions When I try to use the asinteger function within the transformsamplecounts function of the phyloseq package I get the following error message euk transformsamplecountseukaryotic asinteger Error in validObjectObject invalid class phyloseq object Component taxaOTU names do not match Taxa indices are critical to analysis Try taxanames If I transform the same data using the log function I get no error at all and the transformation runs smoothly euk transformsamplecountseukaryotic log Im sure that the otu names match between the otu and taxa tables so Im not sure what the problem could be Can someone help Thanks Miguel Hey running the code below soy phyloseqASV sampledataclean TAX phytreefitGTRtree I got this output otutable OTU Table taxa and samples sampledata Sample Data samples by sample variables taxtable Taxonomy Table taxa by taxonomic ranks phytree Phylogenetic Tree tips and internal nodes But my metadata has samples and not When running sampledataclean still has samples Does anyone know why this could be happening