Avoids srcepggrabmodulexmltvc error s directive output may be truncated writing between and bytes into a region of size Werrorformattruncation snprintfbuf sizeofbuf ddprogidss modid s UpstreamStatus Pending Signedoffby Khem Raj rajkhemgmailcom Hi Jaroslav Waiting for your review St phane Duperron Unify css code spaces commas Fix multiple paddings for progress bar SNRSignal Strength Slightly increase TVadapters width design collision Slightly increase SATIP Servers width design collision ACCESS Fix width for spinner arrows image was repeated ACCESS Fix transparent line at bottom of not filled progress bar SNRSignal Strength This patch adds dropdown list to DVR profile configuration which is then used by default for newly created autorec entry Can be altered in Autorec configuration Solves issue In a mixed network environment such as DVBT and DVBS it is common to receive many of the same channels However with auto map to channels on a bouquet you could not merge the channels across the network bouquets Now we create a separate Tvheadend Network in the bouquets and allow auto map to channels on it Any other bouquets that are enabled but do not have auto map to channels enabled will be added to the enabled Tvheadend Network So if DVBT Network and DVBS Network in the bouquet tab are both enabled and their tickbox for auto map to channels is deselected then their services will be added to the Tvheadend Network That can then be enabled with merge channels to produce the merged channels We call it Tvheadend Network instead of Tvheaded Virtual Bouquet to be consistent with the other autogenerated names The new bouquet is lazily updated to ensure the CPU overhead is minimized This means that when other bouquets are scanned we wait until the system is quiet before updating the new bouquet with the new channels We do a full scan for the bouquet to ensure all the counts are correctly updated in the bouquet tab Fixes Allow user to specify the name they want for a service that is mapped by the service mapper For example the UK has numerous regional satellite channels called ITV which sometimes show different programmes such as regional news These should really be called ITV London ITV Yorkshire etc to avoid being merged together Also we have some channels we do not want mapped at all based on criteria such as regex Although we could manually deselect such channels it is easier to do it automatically So we allow user to do this via an embedded JavaScript function We embed the MIT licence duktape JavaScript The duktape webpage suggests RAM overhead is minimal at less that kb We use the default configuration from the release and use it in the service mapper to allow a user to specify their own script for performing advanced mapping of services to channels For example they might want to rename channels such as SE Fjorton to Fjorton SE or to capitalize the channel names These were examples given in the issue Although this could be possible via more tickboxes it seems sensible to allow the user to use a script But should this be JavaScript So we pass an object containing the channel name and service id to the users script If they return a name then we use it If they return null then we do not map the service at all This allows the user to exclude channels in which they are not interested such as shopping We also add a JavaScript function print to allow the user to log a single string to our logs This uses the new log level LSJS The overhead for calling JavaScript only occurs if the user specifies a script to use Currently the script is given at the UI such as javascript smMapName functionsvc printsvcname svcsid return svcname Or javascript smMapName functionsvc printsvcname svcsid var svcmap ITV HD London ITV HD Meridian Anglia var name svcmap svcsid return typeof name undefined svcname name The servicemapper looks up the function name smMapName and then calls it with the object with a name and sid property We currently dont allow the script to be given as a filename on disk nor do we attempt to optimize the compilation of such a script to only evaluate it once per mapping the overhead seems negligible However we could add a LRU cache of compiled functions in the future if necessary One gotcha from using the duktape API is that if you call duksafetostring to do debug logging of return values then it appears this coerces the return type on the stack so a subsequent get or is null check will return incorrect results So if the JS function returned null then dukisnull would return true but if you do a log of duksafetostring afterwards and then check dukisnull then it would return false Fixes Add icon mappings for category names used by tvgrabeuepgdata as given in sample file in bug This doesnt fix that bug it just adds icons from the xml file Previously we required a onetoone mapping between xmltv categories and genres So the xmltv category of Documentary is mapped to epg genre of Documentary However many mappings are not onetoone For example Opera should be mapped to Musical Opera So we now perform common mappings for SchedulesDirect and for the comments in the Kazer thread for French and Spanish and from sample guidexml for Polish webgrab in bug Currently people are running perl scripts to map category names in to English genre names prior to import and so have categories in a mixture of languages This change will remove the need for external scripts Since we have only had a couple of category mapping contributions submitted in years and since categories are a mixture of English and native languages Ive taken the easiermore performance route of just having one configuration file with all the mappings and autogenerating a C lookup array at compile time instead of having multiple configuration files per language Autogenerating should allow us in the future to also autogenerate Javascript for displaying icons for these categories using their original language instead of falling back to using genre icons At present there is no way to view the dvr disk utilisation through the HTTP API This PR allows the free and used disk space to be queried