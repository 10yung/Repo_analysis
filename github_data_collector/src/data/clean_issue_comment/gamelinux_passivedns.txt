Hi Im using passivedns on a big chunk of traffic but it only uses one core and one process Is there any way we can add threading or worker functionality to passivedns I believe the choke point would be the log file being written on from all the different processes Any ideas Cheers Can this program deals with big scale dns flow like TB per day of bro dns logs Hello Im not sure if im missing something or misunderstanding something but i have installed passivdns on an internal dns server pihole and i was hoping to see all the requests of the clients with passivedns However im only seeing the traffic the dns server itself is generating towards the upstream servers I have tried to run it with a BPF filter but then somehow nothing is being processed The bpf filter itself is correct because i have check it with tcpdump and it is generating the correct results as expected the filter used is not src host ipv addres and not src host ipv addres and dst port My theory is that the passivedns utility is only looking at outward dns request and not incomming Is there a way to force to listen to traffic coming in any help is appreciated I have an issue with failed UPD packets although the traffic looks good to me and Wireshark also Transaction IDs match requestresponse is included in the traffic passivedns is the latest code available to date Therefore I dont think this is similar to this issue The pcap has been anonymized by dnswasher however the original pcap has exactly the same results failedupdanonzip passivedns r failedudpanonpcap PassiveDNS By Edward Bjarte Fjellsk l edwardfjellskaalgmailcom Using libpcap version Using ldns version Reading from file failedudpanonpcap INgooglecomA Total DNS records allocated Total DNS assets allocated Total DNS packets over IPv TCP Total DNS packets over IPv TCP Total DNS packets over TCP decoded Total DNS packets over TCP failed Total DNS packets over IPv UDP Total DNS packets over IPv UDP Total DNS packets over UDP decoded Total DNS packets over UDP failed Total packets received from libpcap Total Ethernet packets received Total VLAN packets received passivedns ended Any idea why the packets are failing This MR adds the fields w and W for client and server hardware eg MAC addresses taken from observed packets They are added alongside the respective IPs in the output Please review carefully These fields are not enabled by default in order not to break existing pipelines Addresses Hello When sending mirrored traffic to passiveDNS it is not able to decode it All DNS UDP requests appear as failed However if I try with normal non mirrored traffic in the same machine and the same compilation it works fine You can find next an example traffic in enp s is mirrored traffic and traffic enp s is my usual network interface rootsrvcashoptpassivednssrc cat devnull varlogpassivednslog rootsrvcashoptpassivednssrc passivedns i enp s MIRRORED TRAFFIC PassiveDNS By Edward Bjarte Fjellsk l edwardfjellskaalgmailcom Using libpcap version Using ldns version Device enp s Sniffing C Total DNS records allocated Total DNS assets allocated Total DNS packets over IPv TCP Total DNS packets over IPv TCP Total DNS packets over TCP decoded Total DNS packets over TCP failed Total DNS packets over IPv UDP Total DNS packets over IPv UDP Total DNS packets over UDP decoded Total DNS packets over UDP failed Total packets received from libpcap Total Ethernet packets received Total VLAN packets received passivedns ended rootsrvcashoptpassivednssrc cat varlogpassivednslog EMPTY rootsrvcashoptpassivednssrc passivedns i enp s NORMAL TRAFFIC PassiveDNS By Edward Bjarte Fjellsk l edwardfjellskaalgmailcom Using libpcap version Using ldns version Device enp s Sniffing C Total DNS records allocated Total DNS assets allocated Total DNS packets over IPv TCP Total DNS packets over IPv TCP Total DNS packets over TCP decoded Total DNS packets over TCP failed Total DNS packets over IPv UDP Total DNS packets over IPv UDP Total DNS packets over UDP decoded Total DNS packets over UDP failed Total packets received from libpcap Total Ethernet packets received Total VLAN packets received passivedns ended rootsrvcashoptpassivednssrc cat varlogpassivednslog INwwwgithubcomCNAMEgithubcom INgithubcomA INgithubcomA IN inaddrarpaPTRlb iadgithubcom INwwwamazoncoukCNAMEwwwcdnamazoncouk INwwwcdnamazoncoukCNAMEwwwamazoncoukedgekeynet INwwwamazoncoukedgekeynetCNAMEe ciakamaiedgenet INe ciakamaiedgenetA IN inaddrarpaPTRa deploystaticakamaitechnologiescom Do you know what could be happening It looks like it is working but it never logs anything I have a resolver running and my resolvconf has nameserver and lookups work fine but passivedns never sees anything I use tcpdump to collect the dns traffic between the local DNS server and hosts in our universitynot include the dns traffic between the local DNS server and upper DNS server and store as pcap format I use passivedns to process the dns traffic But there are some errors Why the total DNS records allocated is zero Why PassiveDNS By Edward Bjarte Fjellsk l edwardfjellskaalgmailcom Using libpcap version Using ldns version Reading from file homejackdnscapdata pcap Total DNS records allocated Total DNS assets allocated Total DNS packets over IPv TCP Total DNS packets over IPv TCP Total DNS packets over TCP decoded Total DNS packets over TCP failed Total DNS packets over IPv UDP Total DNS packets over IPv UDP Total DNS packets over UDP decoded Total DNS packets over UDP failed Total packets received from libpcap Total Ethernet packets received Total VLAN packets received passivedns ended Whats all this then passivedns has been one of my favorite tools for DNS monitoring and has been in my toolbox for a number of years Instead of maintaining this myself I figured Id give back Heres a MB alpine container for passivedns I dont really have an opinion on default runtime options I prefer to use passivedns as verbose as possible and let my logging pipeline handle any cachingduplication This also helps keep memory usage low on kubernetes deployments Implementation of this container is up to the end user unless youd like me to include a dockercomposeyaml or kubernetes deployment I havent pushed this to dockerhub because well its yours gamelinux 