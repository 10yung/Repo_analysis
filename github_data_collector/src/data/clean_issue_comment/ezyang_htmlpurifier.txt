Im currently trying to incorporate rector into my projects and it complains about Ambiguous class HTML resolution defined in vendorezyanghtmlpurifiermaintenancePH Pphp and in vendorezyanghtmlpurifierlibraryHTMLPurifierLexerPH Pphp Heres the offending code Would it be technically fine if I rename one of the class I think the lexer one would be fine since its a subclass Thanks When I send HTML containing span stylefontsize em some text span to the HTML Purifier it trims the and returns span stylefontsize em The html without the zero then does not work well with our other technologies Is this trimming a wanted behaviour Would it be possible to skip trimming of the zeros Were currently updating our app to PHP and were finding some unit test failures that dont occur on PHP Its reproducible just using this script php requireonce vendorautoloadphp sHTML pParagraph ptextareatextarea pParagraph p oPurifier new HTMLPurifier version echo oPurifierpurifysHTML On PHP we get pParagraph ppParagraph p On PHP we get pParagraph p pParagraph p There seems to be various cases where whitespace is added where it wasnt before marqueeimg srcx onerrorconfirm marqueeplaintext plaintextonmouseoverprompt scriptprompt scriptgmailcomisindex formactionjavascriptalertXSS typesubmitscript scriptalertdocumentcookiescript imgidconfirm lpar altsrconerrorevalid img src On PHP that adds a newline before the gmail which isnt there in PHP HEADMETA HTTPEQUIVCONTENTTYPE CONTENTtexthtml charsetUTF HEADADwSCRIPTAD alert XSS ADwSCRIPTAD adds a space before the beginning of the output though the HEAD etc is stripped I dont think this is an issue because whitespace doesnt normally mean anything but I dont know whether it would signify some other weirdness that people need to be aware of elsewhere Purify seems to get rid of the src attribute when using iframes Not sure why Im using HTMLSafeIFrame tried different URIsafeIframeRegexp and in HTMLallowed I have iframe src Any ideas jpeg picture generate base uri like this dataimagejpgbase xxxxxxxxxx in my iphone but it cant pass the data uri rule for example this img cant pass the rule img img srcdataimagejpgbase j AAQSkZJRgABAQAAAQABAAD wCEAAkGBwgHBhUIBwgWEBUWFxUWFxUVGBceIRsVHRciHRwdHR kICggISYxHh YITEtJSkvLi uHSAzODMtNygtLisBCgoKDQUFDgUFDisZExkrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKAABEIAJYA AMBIgACEQEDEQHxAAbAAEAAgMBAQAAAAAAAAAAAAAABgcBAgQFAEADUQAAIBAwIDBgQEBgMAAAAAAAABAgMEEQUGEiExBxNBUWFxFDKRoRUiQvEzgcHR fAWF LxAAVAQEBAAAAAAAAAAAAAAAAAAAAAfEABYRAQEBAAAAAAAAAAAAAAAAAAARAfaAAwDAQACEQMRAD AvEwZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABh iL v rp VGjVhKtXqfw FJZnJ gvX ZAlIK he qGsrvLWxtdPgiqtynj SyvshKHappsedxZ qXWmk tryTxHnMCyQRbZe bfc J KlvK uKLxWoT xfmvNepKQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARXdu N SMq efyW JZnLPRteC fpkk R MHJrpkrXsis erKvu XHXr qkYyf KcXhRXlZID ALdcHxT Ou PfR e n YOHsl de LqNnJVnVUId nSnhki uqxh l lq WMGsYRj X gbJYXINZWDIAqjfOp W O yvPghVoVoVuFZclFflbS vLil O dout cfiNJ Pc KXXjm BuPmlh LtT xo q nT LULCNWrSSUs lnK dHh k jhWMJARjaG dO M KVOdCvTAIlCqsTj V XBKSsO hoev O JcFRXFOjUaXSnnKfnhKWPf LNTSXNgbAwnlGQAAAAAAAAAAAAAAAAAAAAAAAAMNZWCqqj Lsx atcUrKVzptabqvgahNNy vthLp qhWe I d pbPdaULeFP i XhzWcRhny fXPggJntfcmnbo z Q ubcOJxNFpqSxlNfzR RyadYWmmWcbSwoRpQisRjFYSXJ TmoRy BuGfCnVecVD PpyAZMSkorMmcr uNpVH HCm tt BFO TbVuuxpUtPvY XTqxqrji m p OcdObfgQHe bfjr dv evUp LmaiqdtFxlweMpPCaSPyZYHaXrOp BtOpqWkOCnBwTc nEZSUcpZ a muxdn tOnO jdyvLqtFN ppjJZxBeC t KJTpFnH XSsu c hGHFLqFJZb g jCWEZAAAAAAAAAAAAAAAAAAAAAAAAAwhWmKF tjeEN tKtRdLubmMPmjFPMZpeSwvp lmGkoRnHEllf A LRNxaTrlsql nGon KS l OL p xbt bp LPvK rS UqMXmc Pkkl S Tn fsv lqlbv Z Un dGUocZcvsfbbvZ trb ryysnOoulSrJza s kVLIGmxt tL yoo q XKNahnnBptdHzw EmSklhTZGdy nWh eHuM av qEuCTfmBv xk vAK NLhWr h uPw iYPc VuzSdr jqX wnUafBRjznOXgklzw CAbS AHui q d feuVSq lNOlJ NOSTUVJ f Jztvs HQbn NKVxW Xlxyz rwT UspLmk zQFT hV rtLnDTrfS llY cZ atZcMqii qMYv sFq acaNJU LCSSXslhImF GQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADZ but this img can pass the rule img img srcdataimagejpegbase j AAQSkZJRgABAQAAAQABAAD wCEAAkGBwgHBhUIBwgWEBUWFxUWFxUVGBceIRsVHRciHRwdHR kICggISYxHh YITEtJSkvLi uHSAzODMtNygtLisBCgoKDQUFDgUFDisZExkrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKAABEIAJYA AMBIgACEQEDEQHxAAbAAEAAgMBAQAAAAAAAAAAAAAABgcBAgQFAEADUQAAIBAwIDBgQEBgMAAAAAAAABAgMEEQUGEiExBxNBUWFxFDKRoRUiQvEzgcHR fAWF LxAAVAQEBAAAAAAAAAAAAAAAAAAAAAfEABYRAQEBAAAAAAAAAAAAAAAAAAARAfaAAwDAQACEQMRAD AvEwZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABh iL v rp VGjVhKtXqfw FJZnJ gvX ZAlIK he qGsrvLWxtdPgiqtynj SyvshKHappsedxZ qXWmk tryTxHnMCyQRbZe bfc J KlvK uKLxWoT xfmvNepKQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARXdu N SMq efyW JZnLPRteC fpkk R MHJrpkrXsis erKvu XHXr qkYyf KcXhRXlZID ALdcHxT Ou PfR e n YOHsl de LqNnJVnVUId nSnhki uqxh l lq WMGsYRj X gbJYXINZWDIAqjfOp W O yvPghVoVoVuFZclFflbS vLil O dout cfiNJ Pc KXXjm BuPmlh LtT xo q nT LULCNWrSSUs lnK dHh k jhWMJARjaG dO M KVOdCvTAIlCqsTj V XBKSsO hoev O JcFRXFOjUaXSnnKfnhKWPf LNTSXNgbAwnlGQAAAAAAAAAAAAAAAAAAAAAAAAMNZWCqqj Lsx atcUrKVzptabqvgahNNy vthLp qhWe I d pbPdaULeFP i XhzWcRhny fXPggJntfcmnbo z Q ubcOJxNFpqSxlNfzR RyadYWmmWcbSwoRpQisRjFYSXJ TmoRy BuGfCnVecVD PpyAZMSkorMmcr uNpVH HCm tt BFO TbVuuxpUtPvY XTqxqrji m p OcdObfgQHe bfjr dv evUp LmaiqdtFxlweMpPCaSPyZYHaXrOp BtOpqWkOCnBwTc nEZSUcpZ a muxdn tOnO jdyvLqtFN ppjJZxBeC t KJTpFnH XSsu c hGHFLqFJZb g jCWEZAAAAAAAAAAAAAAAAAAAAAAAAAwhWmKF tjeEN tKtRdLubmMPmjFPMZpeSwvp lmGkoRnHEllf A LRNxaTrlsql nGon KS l OL p xbt bp LPvK rS UqMXmc Pkkl S Tn fsv lqlbv Z Un dGUocZcvsfbbvZ trb ryysnOoulSrJza s kVLIGmxt tL yoo q XKNahnnBptdHzw EmSklhTZGdy nWh eHuM av qEuCTfmBv xk vAK NLhWr h uPw iYPc VuzSdr jqX wnUafBRjznOXgklzw CAbS AHui q d feuVSq lNOlJ NOSTUVJ f Jztvs HQbn NKVxW Xlxyz rwT UspLmk zQFT hV rtLnDTrfS llY cZ atZcMqii qMYv sFq acaNJU LCSSXslhImF GQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADZ Hi We had a fortify scan on our code base to check for possible security vulnerabilities and the following has been reported from this library request you to look into it Issue Description Allowing user input to control paths used in file system operations could enable an attacker to access or modify otherwise protected system resources Recommendation Offered The best way to prevent path manipulation is with a level of indirection create a list of legitimate resource names that a user is allowed to specify and only allow the user to select from the list With this approach the input provided by the user is never used directly to specify the resource name Occurences portalvendorezyanghtmlpurifierlibraryHTMLPurifierDefinitionCacheSerializerphp line Hi We had a fortify scan on our code base to check for possible security vulnerabilities and the following has been reported from this library request you to look into it Issue Description Processing an unvalidated XSL stylesheet can allow an attacker to change the structure and contents of the resultant XML include arbitrary files from the file system or execute arbitrary PHP code Recommendation Offered When writing user supplied data to XSL stylesheets some guidelines should be followed Validate input and whitelist to known good values XML entity encodes user input before writing to XML Occurrences portalvendorezyanghtmlpurifierextrasConfigDocHTMLXSLTProcessorphp line portalvendorezyanghtmlpurifierextrasConfigDocHTMLXSLTProcessorphp Hi We had a fortify scan on our code base to check for possible security vulnerabilities and the following has been reported from this library request you to look into it Issue Description Allowing user input to control paths used in file system operations could enable an attacker to access or modify otherwise protected system resources Recommendation Offered The best way to prevent path manipulation is with a level of indirection create a list of legitimate resource names that a user is allowed to specify and only allow the user to select from the list With this approach the input provided by the user is never used directly to specify the resource name Occurrences portalvendorezyanghtmlpurifierlibraryHTMLPurifierStringHashParserphp line portalvendorezyanghtmlpurifiermaintenancerenameconfigphp line portalvendorezyanghtmlpurifiermaintenanceflushdefinitioncachephp line portalvendorezyanghtmlpurifiermaintenancerenameconfigphp line portalvendorezyanghtmlpurifierlibraryHTMLPurifierDefinitionCacheSerializerphp line portalvendorezyanghtmlpurifierlibraryHTMLPurifierDefinitionCache Serializerphp line portalvendorezyanghtmlpurifierlibraryHTMLPurifierDefinitionCache Serializerphp line portalvendorezyanghtmlpurifierlibraryHTMLPurifierDefinitionCacheSerializerphp line portalvendorezyanghtmlpurifiermaintenancerenameconfigphp line portalvendorezyanghtmlpurifiermaintenancerenameconfigphp line portalvendorezyanghtmlpurifiermaintenancerenameconfigphp line portalvendorezyanghtmlpurifiermaintenancerenameconfigphp line portalvendorezyanghtmlpurifiermaintenancerenameconfigphp line portalvendorezyanghtmlpurifiermaintenancerenameconfigphp line Hi We had a fortify scan on our code base to check for possible security vulnerabilities and the following has been reported from this library request you to look into it Issue Description Writing unvalidated user input to log files can allow an attacker to forge log entries or inject malicious content into the logs Recommendation Offered Prevent log forging attacks with indirection create a set of legitimate log entries that correspond to different events that must be logged and only log entries from this set To capture dynamic content such as users logging out of the system always use servercontrolled values rather than usersupplied data This ensures that the input provided by the user is never used directly in a log entry Occurences portalvendorezyanghtmlpurifierpluginsphorumsettingssavephp line portalvendorezyanghtmlpurifierlibraryHTMLPurifierConfigphp line portalvendorezyanghtmlpurifierlibraryHTMLPurifierDefinitionCacheSerializerphp line portalvendorezyanghtmlpurifiermaintenanceflushdefinitioncachephp line portalvendorezyanghtmlpurifierlibraryHTMLPurifierDefinitionCache Serializerphp line portalvendorezyanghtmlpurifiermaintenanceflushdefinitioncachephp line portalvendorezyanghtmlpurifierlibraryHTMLPurifierDefinitionCache Serializerphp line portalvendorezyanghtmlpurifiermaintenanceflushdefinitioncachephp line portalvendorezyanghtmlpurifiermaintenanceflushdefinitioncachephp line Hi We had a fortify scan on our code base to check for possible security vulnerabilities and the following has been reported from this library request you to look into it Issue Description Including unvalidated data in an HTTP response header can enable cachepoisoning crosssite scripting crossuser defacement page hijacking cookie manipulation or open redirect Recommendation Offered The solution to Header Manipulation is to ensure that input validation occurs in the correct places and checks for the correct properties Since Header Manipulation vulnerabilities occur when an application includes malicious data in its output one logical approach is to validate data immediately before it leaves the application Occurences portalvendorezyanghtmlpurifierpluginsphorumsettingsmigratesigsphp line portalvendorezyanghtmlpurifierpluginsphorumsettingsmigratesigsphp line portalvendorezyanghtmlpurifierpluginsphorumsettingsmigratesigsphp line 