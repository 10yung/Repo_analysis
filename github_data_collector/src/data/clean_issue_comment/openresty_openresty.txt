rootlocalhosthomedwfopenresty configure platform linux linux cp rp bundle build cd build cd LuaJIT cc error unrecognized command line option msse WARNING msse not supported in cc make TARGETSTRIP CCDEBUGg XCFLAGSDLUAJITENABLELUA COMPAT CCcc PREFIXusrlocalopenrestyluajit Building LuaJIT beta make C src make Entering directory homedwfopenresty buildLuaJIT src HOSTCC hostminiluao i try to install openresty on my fedora and follow the command sudo dnf install y dnfpluginscore sudo dnf configmanager addrepo sudo dnf install y openresty but i got an error Failed to download metadata for repo openresty I has search on the internet but cannot resolve this issue OpenSSL was implemented in There is a comment that it should be a new ticket to create the CentOS repo packages However I cannot find such a ticket So here it is Please let us know what we can do to help If there is any documentationguidelines on doing the actual packaging we would be willing to contribute Tagging agentzh just in case I am Testing the Performance of openresty lua on own server location defaulttype texthtml contentbyluablock ngxheader ContentLength ngxsay not sure why got a very bad QPS rootclient wrk t c d s Running m test threads and connections Thread Stats Avg Stdev Max Stdev Latency us us ms ReqSec k k k requests in m MB read Socket errors connect read write timeout Requestssec Transfersec KB My server and client are two separate servers and using Gbps link between two servers Server configuration IntelR XeonR CPU D GHz GB RAM without ngx LUA I got Requestssec wrk t c d s Running m test threads and connections Thread Stats Avg Stdev Max Stdev Latency us ms ms ReqSec k k requests in m GB read Requestssec I see a strange problem here when I start test from client using wrk nginx server got cpu usage but after about seconds nginx server stay at x cpu usage Until the end of the test it remained at x cpu usage So I suspect that nginx may be dead but I tested nginx from another client and returned normal content and the response was very fast If without ngx LUA test I can see the whole process nginx server stays at cpu usage Life cycle Is this due a wrk problem but with out ngxLUA wrk tool test results are normal OpenResty version stretch We are running openresty in fargate Fargate has a limitation of GB per task We received the below error pwritev usrlocalopenrestynginxproxytempxxxxxxxxxxxxxxxx failed No space left on device while reading upstream Is there a way to mitigate this issue by setting a max space or something else Thanks Regards Sunil cat lua local r n err ngxregsub s jo printr resty lua cat lua local r n err ngxregsub s jo printr resty lua resty v resty nginx version openresty built by gcc Red Hat GCC built with OpenSSL h Mar Im trying to modify proxypass upstream servers with accessbyluablock and balancerbyluablock but it seems it has no effect to upstream itself I can modify headers from variables but not upstream servers itself looks like it is done when nginx starts and never changes nginxconftxt originally i wanted to Import data When Lua programs and Mysql are on the same server use LOAD DATA FILE no problem But When Lua programs and Mysql Not on the same server use LOAD DATA LOCAL FILE Encounter a mistake FILE resty mysqllua ROW ERROR lua entry thread aborted runtime error restymysqllua attempt to concatenate local typ a nil value I use the systemd service Unit Descriptionopenresty Afterauditdservice systemdusersessionsservice timesynctarget networktarget Service Typeforking PIDFiledatalocalopenresty nginxlogsnginxpid ExecStartPreusrsbinopenresty t ExecStartusrsbinopenresty ExecReloadusrsbinopenresty s reload ExecStopusrsbinopenresty s stop PrivateTmptrue Install WantedBymultiusertarget when I do systemctl start openresty it tell me rootnode nginx systemctl start openresty Job for openrestyservice failed because a timeout was exceeded See systemctl status openrestyservice and journalctl xe for details rootnode nginx journalctl xe The result is RESULT Dec node groupadd group added to etcgroup namewww GID Dec node groupadd group added to etcgshadow namewww Dec node groupadd new group namewww GID Dec node systemd Starting openresty Subject Unit openrestyservice has begun startup DefinedBy systemd Support Unit openrestyservice has begun starting up Dec node openresty nginx the configuration file datalocalopenresty nginxconfnginxconf syntax is ok Dec node openresty nginx configuration file datalocalopenresty nginxconfnginxconf test is successful Dec node systemd openrestyservice Cant convert PID files datalocalopenresty nginxlogsnginxpid OPATH file descriptor to proper file descriptor Permiss Deny Dec node systemd openrestyservice Cant convert PID files datalocalopenresty nginxlogsnginxpid OPATH file descriptor to proper file descriptor Permiss Deny Dec node CROND root CMD runparts etccronhourly Dec node runparts etccronhourly starting anacron Dec node anacron Anacron started on Dec node anacron Will run job crondaily in min Dec node anacron Will run job cronweekly in min Dec node anacron Will run job cronmonthly in min Dec node anacron Jobs will be executed sequentially Dec node runparts etccronhourly finished anacron Dec node systemd openrestyservice Start operation timed out Terminating Dec node systemd openrestyservice Failed with result timeout Dec node systemd Failed to start openresty Subject Unit openrestyservice has failed DefinedBy systemd Support Unit openrestyservice has failed The result is RESULT rootnode nginx Hi We recently deployed a node app in production that talks to a API endpoint over https Of late we started noticing that the call to the API was failing with error as Parser Error Duplicate ContentLength and there were a minimum of occurrences daily Though the error message clearly indicates that the API is sending multiple contentlength header in the response we couldnt log these headers in the node app as the call were failing in the underlying node module before reaching our code Below are the open issues related to this in nodejs GitHub page nodejshttpparser nodejshttpparser In order to troubleshoot the issue better we decided to introduce a nginx proxy between the node app and the API endpoint We decided to use OpenResty as it allows us to use lua language and provides the ability to log the entire request and response including the headers in JSON format Once we capture the error condition we were planning to share it with the API team and press them for a fix To our surprise the error that used to occur at least times a day stopped altogether The log entries were all clean with only one contentlength header and no failures in the app as such We are pretty sure that the API team didnt fix their code as they are waiting on us to capture the error scenario My queries here are as below Does OpenResty or nginx or luajson that we are using is removing the duplicate contentlength header if the values are same If the above is true can you please point me to the docs Also is there a way for us to log the headers before it gets removed Are we inadvertently removing it as part of the lua script We are logging the entire request and response as JSON via this script Please refer attachment The docker image we are using is openrestyopenrestyjessie version is and we are using luajson package I have attached the docker file nginxconf and lua script as a zip file Please clarify as we are lost on what exactly is happening here Below are the version information nginx version openresty built by gcc Debian deb u built with OpenSSL k Jan TLS SNI support enabled configure arguments prefixusrlocalopenrestynginx withccoptO addmodulengxdevelkit addmoduleechonginxmodule addmodulexssnginxmodule addmodulengxcoolkit rc addmodulesetmiscnginxmodule addmoduleforminputnginxmodule addmoduleencryptedsessionnginxmodule addmodulesrcachenginxmodule addmodulengxlua addmodulengxluaupstream addmoduleheadersmorenginxmodule addmodulearrayvarnginxmodule addmodulememcnginxmodule addmoduleredis nginxmodule addmoduleredisnginxmodule addmodulerdsjsonnginxmodule addmodulerdscsvnginxmodule addmodulengxstreamlua withldoptWlrpathusrlocalopenrestyluajitlib withopenssltmpopenssl k withpcretmppcre withfileaio withhttpadditionmodule withhttpauthrequestmodule withhttpdavmodule withhttpflvmodule withhttpgeoipmoduledynamic withhttpgunzipmodule withhttpgzipstaticmodule withhttpimagefiltermoduledynamic withhttpmp module withhttprandomindexmodule withhttprealipmodule withhttpsecurelinkmodule withhttpslicemodule withhttpsslmodule withhttpstubstatusmodule withhttpsubmodule withhttpv module withhttpxsltmoduledynamic withipv withmail withmailsslmodule withmd asm withpcrejit withsha asm withstream withstreamsslmodule withthreads withstream withstreamsslmodule OS information Linux c fdf a d linuxkitaufs SMP Wed Mar UTC x GNULinux Thanks Sudharsan N Archivezip 