 I am trying to test this model with OpenCV through the method cv dnnreadNetFromCaffe import cv import os import argparse from matplotlib import pyplot as plt import numpy as np net cv dnnreadNetFromCaffedeployvggprototxt FTtid caffemodel NumPatch imagetotest i bmp image cv imreadimagetotest resized cv resizeimage blob cv dnnblobFromImageresized printblobshape netsetInputblob preds netforward printpreds For some reason the network does not recognize the blob of the image and I get the following error error OpenCV C projects opencvpython opencv modules dnn src layers fullyconnectedlayercpp error Assertion failed blobssize blobssize in function cvdnnFullyConnectedLayerImplFullyConnectedLayerImpl Is there a way to do this I layerfactoryhpp Creating layer data ImportError No module named srcdatalayerranklayerlive terminate called after throwing an instance of boostpythonerroralreadyset Aborted at unix time try date d if you are using GNU date PC x f c f f GIraise SIGABRT x dcde received by PID TID x f f c from PID stack trace x f c f unknown x f c f f GIraise x f c ce GIabort x f df gnucxxverboseterminatehandler x f b cxxabiv terminate x f b c stdterminate x f d cxarethrow x f d a caffeGetPythonLayer x f f caffeNetInit x f e caffeNetNet x f c f caffeSolverInitTrainNet x f cd caffeSolverInit x f d f caffeSolverSolver x f b a caffeCreatorSGDSolver x ba f train x ce main x f c bb libcstartmain x a unknown conda install caffe mobileNet VGG loss pearsonr loss test pearsonr rank trainprototxt BN I upgradeprotocpp Successfully upgraded file specified using deprecated V LayerParameter I upgradeprotocpp Attempting to upgrade input file specified using deprecated input fields modelsrankliveVGGILSVRC layerscaffemodel I upgradeprotocpp Successfully upgraded file specified using deprecated input fields W upgradeprotocpp Note that future Caffe releases will only support input layers and not input fields I netcpp Ignoring source layer fc I netcpp Ignoring source layer prob libprotobuf WARNING googleprotobufiocodedstreamcc Reading dangerously large protocol message If the message turns out to be larger than bytes parsing will be halted for security reasons To increase the limit or to disable these warnings see CodedInputStreamSetTotalBytesLimit in googleprotobufiocodedstreamh libprotobuf WARNING googleprotobufiocodedstreamcc The total number of bytes read was I upgradeprotocpp Attempting to upgrade input file specified using deprecated V LayerParameter modelsrankliveVGGILSVRC layerscaffemodel I upgradeprotocpp Successfully upgraded file specified using deprecated V LayerParameter I upgradeprotocpp Attempting to upgrade input file specified using deprecated input fields modelsrankliveVGGILSVRC layerscaffemodel I upgradeprotocpp Successfully upgraded file specified using deprecated input fields W upgradeprotocpp Note that future Caffe releases will only support input layers and not input fields I netcpp Ignoring source layer fc I netcpp Ignoring source layer prob I caffecpp Starting Optimization I solvercpp Solving RankIQAsiamesetraintest I solvercpp Learning Rate Policy step I solvercpp Iteration Testing net terminate called after throwing an instance of boostpythonerroralreadyset SETTING UP Aborted at unix time try date d if you are using GNU date PC x fbdedee gsignal SIGABRT xb d received by PID TID x fbdf a ac from PID stack trace x fbdedee b unknown x fbdedee gsignal x fbdedeeb a abort x fbdee d gnucxxverboseterminatehandler x fbdee b unknown x fbdee stdterminate x fbdee cxathrow x fbdd a b c boostpythonthrowerroralreadyset x fbd b eeb caffePythonLayerForwardcpu x fbdef b caffeNetForwardFromTo x fbdef bab caffeNetForward x fbdef ebaa caffeSolverTest x fbdef f e caffeSolverTestAll x fbdef d caffeSolverStep x fbdef ea caffeSolverSolve x ee a train x b a main x fbdeded libcstartmain x c start x unknown Aborted core dumped BN bn losspy The GNC function fails due to YCBCR image is out of the Valid range caused by b ycbcr sqrtlevelrandnsizeA and fails at the next step bycbcr rgbb error ycbcr rgb input must be a colormap Nx or RGB image NxMx error called from ycbcrfunc at line column ycbcr rgb at line column gnc at line column tid generator at line column tid main at line column LIVE TID in loss layer what the meaning of selfmargin is in the Eq in the paper 