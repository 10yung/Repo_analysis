First of all I would like to thank you Browsing around the net could not find a seq seq model as clear as yours Nonetheless I believe there is a minor issue in ipythonnotebookstfTF tutorialipynb In the line decinp tfzeroslikeencinp dtypenpint nameGO encinp Should be decinp tfzeroslikelabels dtypenpint nameGO labels This will enable you to have different sequence lengths and vocab sizes for decinp and encinp Would you have any ideas on what could be causing this magnitude tfsqrttfreducesumtfsquaredecmemory tfscalarsummarymagnitude at t magnitude Truncated Traceback Use Cc Cx to view full TB usrlocallibpython sitepackagestensorflowpythonframeworktensorshapepyc in asserthasrankself rank if selfndims not in None rank raise ValueErrorShape s must have rank d self rank def withrankself rank ValueError Shape must have rank 