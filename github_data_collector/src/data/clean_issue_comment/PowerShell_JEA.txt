As far as I can see there is no versioning in the configuration It would be nice if we could add some versioning to the configuration and then GetPSSessionConfiguration should also output the version Im not sure this is the correct repo for this I have a MOF file which has RoleDefinitions hashtable as string The hashtable itself is not sorted RoleDefinitions test svilent RoleCapabilities Role test TestGroup RoleCapabilities Role test svilen RoleCapabilities Role When I do test I get the following powershell VERBOSE TESTSERVER WACJeaEndpoint Endpoint Argument test TestGroup RoleCapabilities Role test svilen RoleCapabilities Role test svilent RoleCapabilities Role VERBOSE TESTSERVER WACJeaEndpoint Endpoint Argument test svilen RoleCapabilities Role test TestGroup RoleCapabilities Role test svilent RoleCapabilities Role VERBOSE TESTSERVER WACJeaEndpoint Endpoint RoleDfinitions not equal test svilen RoleCapabilities Role test svilent RoleCapabilities Role test TestGroup RoleCapabilities Role The both hashtables are obviously equal Expected is powershell VERBOSE TestServer WACJeaEndpoint Endpoint string VERBOSE TestServer WACJeaEndpoint Endpoint Argument Test TestGroup RoleCapabilities Role Test svilen RoleCapabilities Role Test svilent RoleCapabilities Role VERBOSE TestServer WACJeaEndpoint Endpoint Argument Test TestGroup RoleCapabilities Role Test svilen RoleCapabilities Role Test svilent RoleCapabilities Role To me it looks like SafeGetValue works different on both ASTs the one from the current PSSC file and the one from the MOF file Im ready to open PR for that if you belive that this is really an issue Whether I explicitly add Domain Admins group in the RunAsVirtualAccountsGroups parameter or not it seems that I am not being given domain access right when running cmdlets like NewADusers or NewADComputer Whether to run this session configuration as the machines virtual administrator account RunAsVirtualAccount true RunAsVirtualAccountGroups mesa Domain Admins Access is denied CategoryInfo PermissionDenied CNjeauser CNUsersDCmesaDCinternalString NewADUser Unauth orizedAccessException FullyQualifiedErrorId ActiveDirectoryCmdletSystemUnauthorizedAccessExceptionMicrosoftActiveDirectoryManag ementCommandsNewADUser Fix the DSC Resource links Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend GitHub doesnt seem to like the space in the paths for repo links Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend When running the resource using powershell InvokeDscResource ModuleName JustEnoughAdministration Name JeaEndpoint Method Set Verbose Property EndpointName MicrosoftPowerShell RoleDefinitions CONTOSO DnsAdmins RoleCapabilities DnsAdmin TranscriptDirectory C ProgramData JeaEndpoint Transcripts ScriptsToProcess C ProgramData JeaEndpoint startupps VisibleCmdlets DnsServer Name RestartService Parameters Name Name ValidateSet Dns At one point it restarts the WinRM service which then fails the DSC run VERBOSE SQLTEST JeaEndpoint DirectResourceAccess Restarting WinRM service WARNING WSManNetworkFailureDetected The network connection to localhost has been interrupted Attempting to reconnect for up to minutes WARNING WSManConnectionRetryAttempt Attempting to reconnect to localhost WARNING WSManConnectionRetrySucceeded The network connection to localhost has been restored The WSManagement service cannot process the operation The operation is being attempted on a client session that is unusable This may be related to a recent restart of the WSManagement service Please create a new client ses sion and retry the operation if reexecuting the operation does not have undesired behavior CategoryInfo InvalidOperation rootMicrosoftgurationManagerString CimException FullyQualifiedErrorId HRESULT x fa PSComputerName localhost Would it be better to override the restart the service and instead allow the resource to restart the node using globalDSCMachineStatus The example in DemoConfigps has a problem with the property ScriptsToProcess It is assigned a string but it expects a string array Running the example gives this error Convert property ScriptsToProcess value from type STRING to type STRING failed At line char Buffer irectResourceAccess insta CategoryInfo SyntaxError rootMicrosoftgurationManagerString CimException FullyQualifiedErrorId MiClientApiErrorFailed PSComputerName localhost I suggest to change the property ScriptsToProcess to this ScriptsToProcess C ProgramData JeaEndpoint startupps For example when running this on a node not part of the CONTOSO domain powershell InvokeDscResource ModuleName JustEnoughAdministration Name JeaEndpoint Method Set Verbose Property EndpointName MicrosoftPowerShell RoleDefinitions CONTOSO DnsAdmins RoleCapabilities DnsAdmin TranscriptDirectory C ProgramData JeaEndpoint Transcripts ScriptsToProcess C ProgramData JeaEndpoint startupps VisibleCmdlets DnsServer Name RestartService Parameters Name Name ValidateSet Dns Its reporting this error but continue to process without failing plaintext Could not grant remote access to CONTOSO DnsAdmins Some or all identity references could not be translated I suggest adding ErrorAction to the calls to RegisterPSSessionConfiguration and maybe also UnregisterPSSessionConfiguration This adds the correct folder structure for classbased resources This will make sure the resource is found when running GetDscResource This PR just renames the folders and adds a main module manifest with new unique guid that loads nested all classbased resource although there is only one today Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend 