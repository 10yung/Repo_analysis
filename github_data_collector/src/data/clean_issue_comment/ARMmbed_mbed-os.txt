 Summary of changes Required adds the missing PinMap definitions for UART UART LEUART and LEUART corrects a misplaced endif for if DEVICESPI which included UARTTX all according to Impact of changes Optional None Migration actions required Optional None Documentation Required None Pull request type Required x Patch update Bug fix Target update Docs update Test update Refactor Feature update New feature Functionality change New API Major update Breaking change Eg Return code change API behaviour change Test results Required x No Tests required for this change Eg docs only update Covered by existing mbedos tests Greentea or Unittest Tests results supplied as part of this PR Reviewers Optional stevew Description of defect SPIFBlockDevice loses blockcount when another thread that use spi causes a interruption This cause an error on the mbedos and the program crash Add detailed description of what you are reporting Good example Targets affected by this defect Tested in the NUCLEOWB RG Toolchains name and version displaying this defect Tested in GCCARM version What version of Mbedos are you using tag or sha Tested in version For a released version please provide the release tag this can be found as per the instructions below mbedos version can be found in platformmbedversionh The tag can be reconstructed as follows mbedosMBEDMAJORVERSIONMBEDMINORVERSIONMBEDPATCHVERSION Master branch is indicated by mbedos For an issue found on Master please provide the sha being used What versions of tools are you using List all that apply Eg mbedcli Tested in mbedcli version How is this defect reproduced This can be reproduced using a shared spi bus and when using a operation with the spif blockdevice cause a interruption in the spi bus using the other device conectado to it What was the used solution The solution found was insert lock and unlock in the SPIFBlockDevices spi object operations spifblockdevicesolutionzip For more information on the requirements for pull requests please see the contributing guidelines NOTE Do not remove any of the template headings even for optional sections as this template is automatically parsed Summary of changes Required Rename targetdefaultlib to targetclib as it is more meaningful These changes are done only for MBED OS targets and in the build tool Note Mbed OS targets targetdefaultlib remains unchangedNo rename to targetclib Please provide the following information Description of the the change what is this fixing adding removing Why the change is needed if this is fixing a reported issue please summarize what the issue is and add the reference Eg Fixes NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Impact of changes Optional With these changes targetdefaultlib attribute is no longer being supported If there are any implications for users taking this change then they must be provided here For Major PR types this field is MANDATORY NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Migration actions required Optional The targetclib is the new attribute used for C library selection The choice remains unchangedstd or small This should only be applicable in Major PR types for which this field is MANDATORY NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Documentation Required Refer Docs Please provide details of any document updates required including links to any related PRs against the docs repository If no document updates are required please specify None this at least tells us that this has been considered Pull request type Required Please add only one X to one of the following types Do not fill multiple types split the pull request otherwise Please note this is not a GitHub task list indenting the boxes or changing the format to add a or in front of them would change the meaning incorrectly Patch update Bug fix Target update Docs update Test update Refactor x Feature update New feature Functionality change New API Major update Breaking change Eg Return code change API behaviour change Test results Required Provide all the information required listing all the testing performed For new targets please attach full test results for all supported compilers No Tests required for this change Eg docs only update x Covered by existing mbedos tests Greentea or Unittest Tests results supplied as part of this PR Reviewers Optional evedon bulislaw madchutney Request additional reviewers with username or team I am able to establish a PPP connection with the SaraR modem but attempts to create and use a TCP socket connection supplying an actual IP address to an echo test server always fail with Attempting to use a hostname and DNS also fails although I was successful once or twice by supplying a hostname but could never reproduce it I am able to successfully Connect and transmit to test Servers brokerhivemqcom or testmosquittoorg using AT socket commands This seems to be the same exact problem described here with similar PPP problems reported for the SaraR Generally it looks like the recommended fix for this problem has been to send AT S before establishing the PPP connection but I do that and in fact I dont have any problem establishing the PPP connection just trying to use it I have also tried this with a simpler application mbedosexamplecellularmaster modified for my target with the same results Additionally exiting PPP mode is never successful using the or DTR via GPIO control methods described in the SaraR AT command manual Per the SARAR AT command documentation The data session is terminated by one of the following events sending via a DTR transition from ON to OFF sending an LCP Terminate Request My target board uses an MTQNMNG B modem firmware as follows Manufacturer ublox Model SARAR M B Revision L Apr mbedos PPPFailslog Description of defect Im trying to test the LoRaWAN feature branch While the code compiles fine the LoRaWAN example code prints Connection error code I have traced this back to Which returns MBEDTLSERRCIPHERALLOCFAILED Im following these steps When compiling without lorawanversion set thus using LoRaWAN x I still see the same error When switching the mbedos to the master branch the error is gone and the device joins fine Targets affected by this defect I have tested with DISCOL CZLRWAN and NUCLEOL RZ with SX shield with the same result Toolchains name and version displaying this defect gccarmnoneeabi package from Debian Buster q gccarmnoneeabi q majorx linuxtarbz downloaded from What version of Mbedos are you using tag or sha master fc f ee c a d e cfcf works fine featurelorawan bbf e b f e a dd a d b a c b results in the error What versions of tools are you using List all that apply Eg mbedcli mbedcli How is this defect reproduced mbed import mbedosexamplelorawan cd mbedosexamplelorawanmbedos Update mbedappjson to set DevEUI AppEUI and AppKey Compile mbed compile m DISCOL CZLRWAN t GCCARM Confirm that device joins fine cd mbedos git checkout featurelorawan cd mbed compile m DISCOL CZLRWAN t GCCARM At this point I get Connection error code caused by mbedtlsciphersetup returning MBEDTLSERRCIPHERALLOCFAILED It doesnt matter if loraversion loranetworkkey are set or not Summary of changes This is a fix to the tools for running under Python This call to sorted does nothing in Python as there is no way to sort a list of Exceptions without providing a key It will simply return the evaluated generator as a list In Python this call fails with TypeError not supported between instances of ValidationError and ValidationError as there is no comparison implemented for the jsonschemaexceptionsValidationError Exception This is fixed by providing the key str which sorts by the string representation of the Exception Documentation Required None Pull request type Required Please add only one X to one of the following types Do not fill multiple types split the pull request otherwise Please note this is not a GitHub task list indenting the boxes or changing the format to add a or in front of them would change the meaning incorrectly X Patch update Bug fix Target update Docs update Test update Refactor Feature update New feature Functionality change New API Major update Breaking change Eg Return code change API behaviour change Test results Required Provide all the information required listing all the testing performed For new targets please attach full test results for all supported compilers No Tests required for this change Eg docs only update Covered by existing mbedos tests Greentea or Unittest Tests results supplied as part of this PR Reviewers Optional madchutney markedgeworth Request additional reviewers with username or team For more information on the requirements for pull requests please see the contributing guidelines NOTE Do not remove any of the template headings even for optional sections as this template is automatically parsed Summary of changes Required Please provide the following information Description of the the change what is this fixing adding removing Why the change is needed if this is fixing a reported issue please summarize what the issue is and add the reference Eg Fixes NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Add mergify bot to all PRs all branches The configuration already resides on master but not yet enabled only been enabled for featuremergify to test it Docs The configuration should follow our workflow If it does not we should fix via new pull request anytime note one drawback the config is fetched from the default branch in our case master So even rules for non master need to be in the config there The auto merge is disabled the bot does not have write access to any of the branches anyway This bot can move labels post comments To verify for each PR use Checks where you can review Mergify conditions To disable just revert this comment to have all rules only on featuremergify for instance Hopefully this wont be necessary and we tune the rules once we get more PRs involved compare to few testing we did Impact of changes Optional If there are any implications for users taking this change then they must be provided here For Major PR types this field is MANDATORY NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Migration actions required Optional This should only be applicable in Major PR types for which this field is MANDATORY NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Documentation Required Please provide details of any document updates required including links to any related PRs against the docs repository If no document updates are required please specify None this at least tells us that this has been considered Pull request type Required Please add only one X to one of the following types Do not fill multiple types split the pull request otherwise Please note this is not a GitHub task list indenting the boxes or changing the format to add a or in front of them would change the meaning incorrectly X Patch update Bug fix Target update Docs update Test update Refactor Feature update New feature Functionality change New API Major update Breaking change Eg Return code change API behaviour change Test results Required Provide all the information required listing all the testing performed For new targets please attach full test results for all supported compilers X No Tests required for this change Eg docs only update Covered by existing mbedos tests Greentea or Unittest Tests results supplied as part of this PR Reviewers Optional Request additional reviewers with username or team bulislaw Summary of changes Required Disable coverage report filtering because of poor results eg mbed test unittests r Socket coverage htmlg This command will run all unittests with names containing Socket and then create coverage report with the same scheme filtering all source files with names containing Socket The problem is that coverage report will be correct only when filtered test name will be the same as corresponding source file name to be covered the same r pattern is used to filter both test names and source file names used in coverage report Due to described problems it was decided to disable coverage report filtering r will only filter test names and pattern wont be passed to coverage report generator Impact of changes Optional If there are any implications for users taking this change then they must be provided here For Major PR types this field is MANDATORY NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Migration actions required Optional This should only be applicable in Major PR types for which this field is MANDATORY NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Documentation Required Please provide details of any document updates required including links to any related PRs against the docs repository If no document updates are required please specify None this at least tells us that this has been considered Pull request type Required Please add only one X to one of the following types Do not fill multiple types split the pull request otherwise Please note this is not a GitHub task list indenting the boxes or changing the format to add a or in front of them would change the meaning incorrectly Patch update Bug fix Target update Docs update Test update Refactor X Feature update New feature Functionality change New API Major update Breaking change Eg Return code change API behaviour change Test results Required Provide all the information required listing all the testing performed For new targets please attach full test results for all supported compilers No Tests required for this change Eg docs only update X Covered by existing mbedos tests Greentea or Unittest Tests results supplied as part of this PR Reviewers Optional jamesbeyond michalpasztamobica For more information on the requirements for pull requests please see the contributing guidelines NOTE Do not remove any of the template headings even for optional sections as this template is automatically parsed Summary of changes Required Nonsecure core IPC Mailbox and Interface init for TFMTWINCPU CY CPROTO SB target These changes concentrate on getting mbedosNonsecure M working with TFMsecure M Changes reflect towards any Cypress based TFMTWINCPU targets at the moment and making it more generic in the near future Key changes Override CY CPROTO SB target serial baud to aid debugging Init IPC Mailbox and Nonsecure Interface These changes specifically target TFMTWINCPU platforms We are initializing the following IPC Interrupts for syncing multicore platforms NS Mailbox to receive messages NS interface Add Objectspecific memory allocation This will enable all Cypress targets to use an Objectspecific memory allocation for mutex creation in an efficient way handled by the RTX The mutex is required by the tfmnsinterfaceinit for any TFMTWINCPU based platform Please provide the following information Description of the the change what is this fixing adding removing Why the change is needed if this is fixing a reported issue please summarize what the issue is and add the reference Eg Fixes NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Impact of changes Optional This impacts Cypress and TFMTWINCPU targets If there are any implications for users taking this change then they must be provided here For Major PR types this field is MANDATORY NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Migration actions required Optional This should only be applicable in Major PR types for which this field is MANDATORY NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Documentation Required Please provide details of any document updates required including links to any related PRs against the docs repository If no document updates are required please specify None this at least tells us that this has been considered Pull request type Required Please add only one X to one of the following types Do not fill multiple types split the pull request otherwise Please note this is not a GitHub task list indenting the boxes or changing the format to add a or in front of them would change the meaning incorrectly x Patch update Bug fix Target update Docs update Test update Refactor Feature update New feature Functionality change New API Major update Breaking change Eg Return code change API behavior change Test results Required These changes are tested on CY CPROTO SB with M running TFM Secure binary and M running blinky example with mbedos nonsecure binary The TFM secure binary is tested from The blinky example is tested with both compilers mbed compile t ARMC m CY CPROTO SB mbed compile t GCCARM m CY CPROTO SB Further a patch is required to fix the semaphore issue to make the testing pass which is ought to be upstreamed to TFMMbedos A temporary fix is attached mbedosipcsematxt Provide all the information required listing all the testing performed For new targets please attach full test results for all supported compilers No Tests required for this change Eg docs only update x Covered by existing mbedos tests Greentea or Unittest Tests results supplied as part of this PR Reviewers Optional Patater devran Request additional reviewers with username or team For more information on the requirements for pull requests please see the contributing guidelines NOTE Do not remove any of the template headings even for optional sections as this template is automatically parsed Summary of changes Required Fixes first of the issues mentioned in Value of the SFDP Sector Map Table Parameter ID LSB is x not in decimal Starts also the work where SFDP specific functionality is split from the SPIF and QSPIF Blockdevices to a separate file Please provide the following information Description of the the change what is this fixing adding removing Why the change is needed if this is fixing a reported issue please summarize what the issue is and add the reference Eg Fixes NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Impact of changes Optional If there are any implications for users taking this change then they must be provided here For Major PR types this field is MANDATORY NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Migration actions required Optional This should only be applicable in Major PR types for which this field is MANDATORY NOTE This section is automatically written to release notes for Feature and Major releases and should contain enough details for a user Documentation Required Please provide details of any document updates required including links to any related PRs against the docs repository If no document updates are required please specify None this at least tells us that this has been considered Pull request type Required Please add only one X to one of the following types Do not fill multiple types split the pull request otherwise Please note this is not a GitHub task list indenting the boxes or changing the format to add a or in front of them would change the meaning incorrectly X Patch update Bug fix Target update Docs update Test update Refactor Feature update New feature Functionality change New API Major update Breaking change Eg Return code change API behaviour change Test results Required SPIF compilation mbed test compile t ARM m NRF DK n featuresstoragefilesystemlittlefs appconfig toolstestconfigsSPIFBlockDeviceAndHeapBlockDevicejson QSPIF compilation mbed test compile t GCCARM m NRF DK n featuresstoragefilesystemlittlefs appconfig toolstestconfigsQSPIFBlockDeviceAndHeapBlockDevicejson target platformname test suite result elapsedtime sec copymethod NRF DKARMC NRF DK featuresstoragefilesystemlittlefstestsfilesystemdirs OK default NRF DKARMC NRF DK featuresstoragefilesystemlittlefstestsfilesystemfiles OK default NRF DKARMC NRF DK featuresstoragefilesystemlittlefstestsfilesysteminterspersed OK default NRF DKARMC NRF DK featuresstoragefilesystemlittlefstestsfilesystemseek OK default NRF DKARMC NRF DK featuresstoragefilesystemlittlefstestsfilesystemintegrationformat OK default NRF DKARMC NRF DK featuresstoragefilesystemlittlefstestsfilesystemrecoveryresilience OK default NRF DKARMC NRF DK featuresstoragefilesystemlittlefstestsfilesystemrecoveryresiliencefunctional OK default NRF DKARMC NRF DK featuresstoragefilesystemlittlefstestsfilesystemrecoverywearleveling OK default NRF DKARMC NRF DK featuresstoragefilesystemlittlefstestsfilesystemretargetdirs OK default NRF DKARMC NRF DK featuresstoragefilesystemlittlefstestsfilesystemretargetfiles OK default NRF DKARMC NRF DK featuresstoragefilesystemlittlefstestsfilesystemretargetinterspersed OK default NRF DKARMC NRF DK featuresstoragefilesystemlittlefstestsfilesystemretargetseek OK default NRF DKGCCARM NRF DK featuresstoragefilesystemlittlefstestsfilesystemdirs OK default NRF DKGCCARM NRF DK featuresstoragefilesystemlittlefstestsfilesystemfiles OK default NRF DKGCCARM NRF DK featuresstoragefilesystemlittlefstestsfilesysteminterspersed OK default NRF DKGCCARM NRF DK featuresstoragefilesystemlittlefstestsfilesystemseek OK default NRF DKGCCARM NRF DK featuresstoragefilesystemlittlefstestsfilesystemintegrationformat OK default NRF DKGCCARM NRF DK featuresstoragefilesystemlittlefstestsfilesystemrecoveryresilience OK default NRF DKGCCARM NRF DK featuresstoragefilesystemlittlefstestsfilesystemrecoveryresiliencefunctional OK default NRF DKGCCARM NRF DK featuresstoragefilesystemlittlefstestsfilesystemrecoverywearleveling OK default NRF DKGCCARM NRF DK featuresstoragefilesystemlittlefstestsfilesystemretargetdirs OK default NRF DKGCCARM NRF DK featuresstoragefilesystemlittlefstestsfilesystemretargetfiles OK default NRF DKGCCARM NRF DK featuresstoragefilesystemlittlefstestsfilesystemretargetinterspersed OK default NRF DKGCCARM NRF DK featuresstoragefilesystemlittlefstestsfilesystemretargetseek OK default mbedgt test suite results OK Provide all the information required listing all the testing performed For new targets please attach full test results for all supported compilers No Tests required for this change Eg docs only update X Covered by existing mbedos tests Greentea or Unittest Tests results supplied as part of this PR Reviewers Optional SeppoTakalo Request additional reviewers with username or team 