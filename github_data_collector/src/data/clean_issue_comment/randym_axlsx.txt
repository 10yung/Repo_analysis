I am using this gem for generating the excel charts on ruby on rails My requirement is to generate a stacked bar chart but it is generating in a staircase format refer the image here To generate the chart I have used the following code sheetaddchartAxlsxBarChart startat B endat I title Test Title grouping stacked do chart chartbarDir col chartaddseriesdata sheet C E labels sheet C E title sheet C chartaddseriesdata sheet F H labels sheet C E title sheet F end When I manually edit the generated chart in Microsoft Excel and set Series Overlap to Im getting the desired output refer the image here Hello I make the filter outlinelevelrows everything works well except for the display it does not work correctly it stands in the position this is not the problem of sheetproutlineprsummarybelow examine the image err row row ERR there should be row ERR there should be Changing nametoindices regex to ignore case Occasion I was adding some comments to an sheet through a job and i didnt pay attention to upcase This took me some debugging to find why it threw errors so it could be a plus to ignore case on this method or raise an descriptive error maybe Could you please unlock rubyzip version to use newest version Hello i cant have a background color when i make a conditionalformatting on a text styleok wbstylesaddstylebgcolor fgcolor FF type dxf styleko wbstylesaddstylebgcolor ffe fgcolor FF type dxf sheetaddconditionalformattingA B type containsText operator equal text A dxfId styleok priority sheetaddconditionalformattingA B type containsText operator equal text B dxfId styleko priority Do i something bad or is it an issue Thanks for ur help I am unable to set the Title field in LineChart row number is picked by default packageworkbookaddworksheetname sheetname do sheet sheetaddchartAxlsxLineChart do chart chartstartat M chartendat X charttitle Engagement per week chartdlblsshowval true chartaddseries data packageworkbookworksheetsfirst A G labels packageworkbookworksheetsfirst A G title packageworkbookworksheetsfirst B color e end This fixes colOff and rowOff for embedded images I am adding this formula to my xlsx BUSCARVG CategoriasA C I add it this way to my worksheet sheetaddrow BUSCARVG CategoriasA C when I check my xlsx in the cell I have this error NOMBRE and in the entry line I have this buscarvF B C I understand that this error NOMBRE is because the formula is misspelled but I cannot understand why the formula changes when you added it to the cell How could I solve this Hi were using Axlsx for generating rather large sheets k rows columns I think that there could be some quick wins by by applying frozenstringliteral true to the CellSerializer class and adjust some of its methods to not modify frozen strings Some local profiling showed that this could safe object allocations for big sheets What do you think about it If youre open to that I could prepare a PR Best Alex Added the option to pass in formuladefense true into the addrow method In John Legrands words from this issue It would be nice to be able to pass an option to block formula injection We use this Gem to let clients export tables to excel sheets This is an unsafe practice because a formula could be injected There should be an ability to block these injections to OWASP standards prepending to anything that starts with something possibly malicious 