Changes summary When executing a tool check if runtime is net core and if it is return the first resolvable tools dll If no dlls are provided by the tool or there were but are unresolvable then the behavior continues exactly as it was prior to this PR In ProcessRunner if running under net core and file to run is a dll then we use net cli to execute it Fixes Ifwhen this is merged we will need to make sure to switch to the CAKEGITHUBTOKEN environment variable What You Are Seeing CakeIssuesReportingGeneric addin expects NewtonsoftJsondll to be loaded into AppDomain and uses it to compile Razor templates When all addins used in the script are pinned this is not the case As soon as at least one addin is not pinned NewtonsoftJsondll is loaded into the app domain The CakeIssuesReportingGeneric addin uses RazorEngine compiling a Razor template which uses JSONNET For this it looks in the current AppDomain for NewtonsoftJsondll see this line in CakeIssuesReportingGeneric and this line in RazorEngine Originally reporting in What is Expected NewtonsoftJsondll should always be loaded into the AppDomain by Cake What version of Cake are you using Cake on NET Framework Are you running on a or bit system Bit What environment are you running on Windows Linux Mac Windows Are you running on a CI Server If so which one How Did You Get This To Happen Steps to Reproduce Fails addin CakeIssues version addin CakeIssuesReporting version addin CakeIssuesReportingGeneric version Works as soon as one of the lines above is replaced with any of those lines addin CakeIssues addin nugetpackageCakeIssues addin CakeIssuesReporting addin nugetpackageCakeIssuesReporting addin CakeIssuesReportingGeneric addin nugetpackageCakeIssuesReportingGeneric TaskDefault Does var repoRootFolder MakeAbsoluteDirectory var issues new ListIIssue var settings GenericIssueReportFormatSettings FromEmbeddedTemplateGenericIssueReportTemplateHtmlDxDataGrid CreateIssueReport issues GenericIssueReportFormatsettings repoRootFolder repoRootFolderCombineWithFilePathreporthtml RunTargetDefault Output Log sh Preparing to run build script Addin compatibility check is disabled Running build script Default Creating report Ctemp toolsreporthtml Could not find loaded assembly NewtonsoftJsondll An error occurred when executing task Default Error One or more errors occurred Could not find loaded assembly NewtonsoftJsondll This will allow us to take advantage of a couple of new GitReleaseManager features including Ability to add SHA hashes to release notes for all assets added to the release To automatically update closed issues as part of the milestone with an information comment that this issue has been fixedreleased With the release of version x of GitReleaseManager some new commands were created discard open And it would be good to have support for these commands via Cake Aliases In addition a number of new base options were added which should also be supported via the base Settings class Debug NoLogo Verbose And finally support for Username and Password authentication has been deprecated in this release of GitReleaseManager and the Cake Aliases should also be updated to reflect this What You Are Seeing Cake fails to compile and run build script The error message is Error The assembly name is invalid The problem appears to be related to Mono a temporary workaround that has fixed the issue for me was to add the line mono into the below travisyml What is Expected Cake compiles and runs build script What version of Cake are you using The below log was generated using Cake but as part of diagnosing the issue I updated to and it didnt make a difference I also created a hello world Cake script Are you running on a or bit system What environment are you running on Windows Linux Mac travis linux csharp environment as below Are you running on a CI Server If so which one travis yml language csharp dotnet sudo required services docker beforeinstall export PATHbinPATH script chmod x buildsh buildsh Cake script var target Argumenttarget Default TaskDefault Does InformationHello World RunTargettarget How Did You Get This To Happen Steps to Reproduce A hello world cake script in conjunction with the above travisyml should be enough to repro this issue Output Log sh s buildsh t Build Downloading NuGet Restoring NuGet package Cake GET OK ms Installing Cake Adding package Cake to folder hometravisbuildlinnmylinntools Added package Cake to folder hometravisbuildlinnmylinntools Analyzing build script Processing build script Installing addins Compiling build script Error The assembly name is invalid The command buildsh t Build failed and exited with during Right now there is a way to get all of the Environment Variables using the EnvironmentVariables alias It returns an IDictionarystring string However there does not seem to be one to get all of the arguments unless I am missing something in which case I apologize If the alias is to be consistent with EnvironmentVariables it should probably return a copy of a dictionary not a direct reference to the underlying dictionary Cake uses Example Use Case The use case for this could be if one wants to call CakeExecuteScript and passthrough the current processs arguments to it or append arguments of its own theres no way to do this right now C Arguments does not exist right now To be consistent with EnvironmentVariables it should probably a new dictionary that is safe to be modified not a reference to Cakes underlying one IDictionarystring string currentArgs Arguments currentArgs additionalArg myOtherArg CakeSettings settings new CakeSettings Arguments currentArgs EnvironmentVariables EnvironmentVariables CakeExecuteScript somewhereElsebuildcake settings It would be great to have better dotnet tool integration especially now that we have local tools in NET Core Ive been pondering what a minimal Cake build could look like My BoardGameGeekDungeon repo can serve as the use case Current Cake related files cakeps bootstraps Cake on Windows cakesh bootstraps Cake on Linux toolspackagesconfig locks Cake version For Azure Pipelines and GitHub Actions builds I avoid the Cake bootstrap by using a Docker image with the Cake tool already installed However all builds still have to bootstrap Cake modules in order to use dotnet tools in the Cake build itself one of the most common being GitVersion BoardGameGeekDungeon is built using CakeDungeon and in the depths lives the bootstrapcake script with the following c module nugetpackageCakeDotNetToolModule version tool dotnetpackageGitVersionTool version This is the first barrier to diet Cake nirvana as it requires Cake to be invoked twice first to install the CakeDotNetToolModule to extend Cake to support tool then again for the actual build using something like the following cake bootstrap cake Not too bad although more verbose in PowerShell until v drops next year with long overdue support for pipeline chain operators but really its surely about time this module moved into Cake core and when it does well want it to play nice with dotnet local tools The two step bootstrap will still be required if youre using other Cake modules but Id argue thats much less common and using dotnet local tools is standard now especially if writing crossplatform builds Anyway given support for dotnet local tools I would be able to delete the above Cake related files and replace them with a single dotnettoolsjson manifest file json version isRoot true tools caketool version commands dotnetcake Then to invoke the build on a clean machine Id use the following dotnet tool restore dotnet cake bootstrap dotnet cake or when the dotnet tool module is moved to Cake core dotnet tool restore dotnet cake and when the Cake dotnet tool is already installed on a local dev machine dotnet cake Also for this to integrate better with dotnet local tools the tool directive should use the local tool directly presumably invoking dotnet tool rather than extracting and copying what was previously a global tool into the Cake tools directory alongside addins and modules Im hoping such a change would also avoid the quirk resulting from building the same directory in Windows and then WSL or Docker with a host mount or vice versa where you first need to explicitly delete any such copied dotnet tools which would be for the wrong platform So in summary a minimal Cake build would simply leverage dotnet local tools to bootstrap Cake itself and given the dotnet tool module was moved to Cake core a common case requiring an extra module bootstrap step could most likely be avoided and the tool directive would use the dotnet local tool directly rather than copying a platform specific executable into its own tools directory What You Are Seeing When building a cake file that references NuGets that include dependencies that cake itself uses I get a bunch of CS warnings warning CS Assuming assembly reference NewtonsoftJson Version Cultureneutral PublicKeyToken ad fe b a aeed used by CakeJson matches identity NewtonsoftJson Version Cultureneutral PublicKeyToken ad fe b a aeed of NewtonsoftJson you may need to supply runtime policy warning CS Assuming assembly reference NuGetVersioning Version Cultureneutral PublicKeyToken bf ad e used by MonoApiToolsNuGetDiff matches identity NuGetVersioning Version Cultureneutral PublicKeyToken bf ad e of NuGetVersioning you may need to supply runtime policy What is Expected A way to hide these warnings What version of Cake are you using Are you running on a or bit system bit What environment are you running on Windows Linux Mac Windows Linux and Mac Are you running on a CI Server If so which one Local and DevOps How Did You Get This To Happen Steps to Reproduce Just run a cake file with addin nugetpackageCakeJson version addin nugetpackageMonoApiToolsNuGetDiff version loaddependenciestrue Output Log sh warning CS Assuming assembly reference NewtonsoftJson Version Cultureneutral PublicKeyToken ad fe b a aeed used by CakeJson matches identity NewtonsoftJson Version Cultureneutral PublicKeyToken ad fe b a aeed of NewtonsoftJson you may need to supply runtime policy warning CS Assuming assembly reference NuGetVersioning Version Cultureneutral PublicKeyToken bf ad e used by MonoApiToolsNuGetDiff matches identity NuGetVersioning Version Cultureneutral PublicKeyToken bf ad e of NuGetVersioning you may need to supply runtime policy What You Are Seeing Cant use glob curly braces as the first logical expression of a subfolder when copying files var directory Directorytemp CopyFilesDirectoryNameAppjsjsmap directory true Fails with error Error One or more errors occurred parsing jsjsmap Quantifier xy following nothing However the following expression works var directory Directorytemp CopyFilesDirectoryNameAppjsjsmap directory true What is Expected Files should be able to be copied in the above stated failed expression What version of Cake are you using Are you running on a or bit system What environment are you running on Windows Linux Mac Windows Are you running on a CI Server If so which one No How Did You Get This To Happen Steps to Reproduce See above Output Log sh Error SystemAggregateException One or more errors occurred SystemArgumentException parsing jsjsmap Quantifier xy following nothing at SystemTextRegularExpressionsRegexParserScanRegex at SystemTextRegularExpressionsRegexParserParseString re RegexOptions op at SystemTextRegularExpressionsRegexctorString pattern RegexOptions options TimeSpan matchTimeout Boolean useCache at SystemTextRegularExpressionsRegexctorString pattern RegexOptions options at CakeCoreIOGlobbingNodesPathNodeCreateRegexList tokens RegexOptions options at CakeCoreIOGlobbingNodesPathNodectorList tokens RegexOptions options at CakeCoreIOGlobbingGlobParserParseNodeGlobParserContext context at CakeCoreIOGlobbingGlobParserParseGlobParserContext context at CakeCoreIOGlobbingGlobParserParseString pattern GlobberSettings settings at CakeCoreIOGlobberMatchString pattern GlobberSettings settings at CakeCommonIOGlobbingAliasesGetFilesICakeContext context String pattern at CakeCommonIOFileCopierCopyFilesICakeContext context String pattern DirectoryPath targetDirectoryPath Boolean preserverFolderStructure at Submission CopyFilesString pattern DirectoryPath targetDirectoryPath Boolean preserveFolderStructure at Submission Initializeb at CakeCoreCakeTaskBuilderExtensionscDisplayClass Doesb ICakeContext x at CakeCoreCakeTaskExecuted MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at CakeCoreDefaultExecutionStrategyExecuteAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at CakeCoreCakeEngineExecuteTaskAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at CakeCoreCakeEngineRunTaskd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at CakeCoreCakeEngineRunTargetAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at CakeScriptingBuildScriptHostRunTargetAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at CakeCoreScriptingScriptHostRunTargetString target at Submission Initialized MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at MicrosoftCodeAnalysisScriptingScriptExecutionStateRunSubmissionsAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at MicrosoftCodeAnalysisScriptingScript RunSubmissionsAsyncd MoveNext End of inner exception stack trace at SystemThreadingTasksTaskThrowIfExceptionalBoolean includeTaskCanceledExceptions at SystemThreadingTasksTaskWaitInt millisecondsTimeout CancellationToken cancellationToken at CakeScriptingRoslynRoslynScriptSessionExecuteScript script at CakeCoreScriptingScriptRunnerRunIScriptHost host FilePath scriptPath IDictionary arguments at CakeCommandsBuildCommandExecuteCakeOptions options at CakeCakeApplicationRunCakeOptions options at CakeProgramMain Inner Exception SystemArgumentException parsing jsjsmap Quantifier xy following nothing at SystemTextRegularExpressionsRegexParserScanRegex at SystemTextRegularExpressionsRegexParserParseString re RegexOptions op at SystemTextRegularExpressionsRegexctorString pattern RegexOptions options TimeSpan matchTimeout Boolean useCache at SystemTextRegularExpressionsRegexctorString pattern RegexOptions options at CakeCoreIOGlobbingNodesPathNodeCreateRegexList tokens RegexOptions options at CakeCoreIOGlobbingNodesPathNodectorList tokens RegexOptions options at CakeCoreIOGlobbingGlobParserParseNodeGlobParserContext context at CakeCoreIOGlobbingGlobParserParseGlobParserContext context at CakeCoreIOGlobbingGlobParserParseString pattern GlobberSettings settings at CakeCoreIOGlobberMatchString pattern GlobberSettings settings at CakeCommonIOGlobbingAliasesGetFilesICakeContext context String pattern at CakeCommonIOFileCopierCopyFilesICakeContext context String pattern DirectoryPath targetDirectoryPath Boolean preserverFolderStructure at Submission CopyFilesString pattern DirectoryPath targetDirectoryPath Boolean preserveFolderStructure at Submission Initializeb at CakeCoreCakeTaskBuilderExtensionscDisplayClass Doesb ICakeContext x at CakeCoreCakeTaskExecuted MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at CakeCoreDefaultExecutionStrategyExecuteAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at CakeCoreCakeEngineExecuteTaskAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at CakeCoreCakeEngineRunTaskd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at CakeCoreCakeEngineRunTargetAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at CakeScriptingBuildScriptHostRunTargetAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at CakeCoreScriptingScriptHostRunTargetString target at Submission Initialized MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at MicrosoftCodeAnalysisScriptingScriptExecutionStateRunSubmissionsAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at MicrosoftCodeAnalysisScriptingScript RunSubmissionsAsyncd MoveNext 