Hello I noticed when running in a loop with multiple domains it will fail I solved this by commenting out the lines below as they will change the context from the provided domain variable to actually pulling the current domain in the context of the powershellexe window DirEntry NewObject SystemDirectoryServicesDirectoryEntry UserSearcherSearchRoot DirEntry The title is a presumption of what the issue is based on my results below It appears that when you have a password file and a password within that file contains spaces it does not return proper results false negative In this sample Im using a PasswordList containing a single line a soapsud Touts the climber Note that there is no success message PS C Users USER Desktop DomainPasswordSpraymaster InvokeDomainPasswordSpray UserList C Users USER Desktop singleusertxt PasswordList C Users USER Desktop singlepasstxt OutFile C Users USER Desktop resultstxt Debug Using C Users USER Desktop singleusertxt as userlist to spray with Warning Users will not be checked for lockout threshold The domain password policy observation window is set to minutes Setting a minute wait in between sprays Confirm Password Spray Are you sure you want to perform a password spray against accounts Y Yes N No Help default is Y y Password spraying has begun with passwords This might take a while depending on the total number of users Now trying password against users Current time is AM Writing successes to C Users USER Desktop resultstxt Password spraying is complete Any passwords that were successfully sprayed have been output to C Users USER Desktop resultstxt In this sample Ive tried the same user and same password but now Im using the password inline and enclosed in quotes This time there is a success message PS C Users USER Desktop DomainPasswordSpraymaster InvokeDomainPasswordSpray UserList C Users USER Desktop singleusertxt Password a soapsud Touts the climber OutFile C Users USER Desktop resultstxt Using C Users USER Desktop singleusertxt as userlist to spray with Warning Users will not be checked for lockout threshold The domain password policy observation window is set to minutes Setting a minute wait in between sprays Confirm Password Spray Are you sure you want to perform a password spray against accounts Y Yes N No Help default is Y y Password spraying has begun with passwords This might take a while depending on the total number of users Now trying password a soapsud Touts the climber against users Current time is AM Writing successes to C Users USER Desktop resultstxt SUCCESS UserUSER Passworda soapsud Touts the climber Password spraying is complete Any passwords that were successfully sprayed have been output to C Users USER Desktop resultstxt Change GetObservationWindow to grab the lockoutObservationWindow value directly from AD in order to avoid commandlinebased detections of net accounts domain being run Im pretty sure this is my bug Sorry pwdLastSet date Added several parameters to handle generation of passwords based on the pwdLastSet active directory attribute Guess formats include SeasonYY SeasonYYYY MonYY MonYYYY MonthYY MonthYYYY Optional switch parameters include functionality to formulate the password as lower case initial caps is the default and append characters to the end of the guess for guesses like Fall 