Is it possible to add an option to add ranks labels to plotEnrichment Currently it is not possible to determine the ranks order from the plot without some additional information For example if you are comparing KO to WT it would be helpful add KO and WT to opposite ends of the X ranks axis Here is an example from limmabarcodeplot to illustrate what I am trying convey If that is outside the scope of this package do you have any suggestions on how to best add something like that with least interference with other elements Hi Would it be possible to add arguments to modify plots Especially the output of the function plotGseaTable is a bit limited and changing fonts and colors of signaling pathways and bars could be nice Maybe that would be possible by altering the source code but was not able to do that Nonetheless this is a very nice and efficient package This may be outside of the desired scope of your software but it would be quite useful if fgsea could be extended to support onetailed GSEA tests This way fgsea could be used to analyze other nonexpression singletailed gene statistics and could also be used to look absfold change rankings Here is an example of another package which implements such an approach Hello First of all thanks for writingmaintaining such a fantastic package I have recently encountered an issue with the collapsePathways function in fgsea in which I get the following error after a successful fgsea run Error in FUNX i GSEA statistic is not defined when all genes are selected I am running collapsePathways as described in the vignette see below though filtering my input fgseaRes df such that padj rather than On some datasets this has worked fine but on others I get the above error Interestingly lowering the padj threshold down to alleviates the problem Any help understanding this would be much appreciated Ive added some code below showing my calls error messages and sessionInfo The gmt file was downloaded from MSigDB Id also be happy to email a file containing the gene ranking for proper reproducibility if that would be helpful Thanks again Andrew headrankedgenes KLHL SLC A LBX LRP B GLRA TRIM bpgo gmtPathwayshomeandrewprojectsdailylog c bpv symbolsgmt fgseaRes fgseapathways bpgo stats rankedgenes minSize maxSize nperm fgsea runs normally as far as I can tell only warning me about some ties Warning message In fgseapathways bpgo stats rankedgenes minSize maxSize There are ties in the preranked stats of the list The order of those tied genes will be arbitrary which may produce unexpected results The results are expected for my data and give a number of significant categories fgseaRes arrangepval selectpathway pval padj ES NES nMoreExtreme size head pathway pval padj ES NES nMoreExtreme size GONEUROGENESIS E GOCENTRALNERVOUSSYSTEMDEVELOPMENT E GOREGULATIONOFNERVOUSSYSTEMDEVELOPMENT E GOHEADDEVELOPMENT E GOCELLCELLSIGNALING E GOSYNAPTICSIGNALING E collapsedPathways collapsePathwaysfgseaRes orderpval padj bpgo rankedgenes Running collapsePathways as above though gives the below error Running it with padj instead eliminates the error and returns a result though still producing the tie warnings Error in FUNX i GSEA statistic is not defined when all genes are selected In addition Warning messages In fgseapathways pathways pathwaysToCheck stats stats u There are ties in the preranked stats of the list The order of those tied genes will be arbitrary which may produce unexpected results In fgseapathways pathways pathwaysToCheck stats stats u There are ties in the preranked stats of the list The order of those tied genes will be arbitrary which may produce unexpected results In fgseapathways pathways pathwaysToCheck stats stats u There are ties in the preranked stats of the list The order of those tied genes will be arbitrary which may produce unexpected results In fgseapathways pathways pathwaysToCheck stats stats u There are ties in the preranked stats of the list The order of those tied genes will be arbitrary which may produce unexpected results In fgseapathways pathways pathwaysToCheck stats stats u There are ties in the preranked stats of the list The order of those tied genes will be arbitrary which may produce unexpected results In fgseapathways pathways pathwaysToCheck stats stats u There are ties in the preranked stats of the list The order of those tied genes will be arbitrary which may produce unexpected results In fgseapathways pathways pathwaysToCheck stats stats u There are ties in the preranked stats of the list The order of those tied genes will be arbitrary which may produce unexpected results In fgseapathways pathways pathwaysToCheck stats stats u There are ties in the preranked stats of the list The order of those tied genes will be arbitrary which may produce unexpected results In fgseapathways pathways pathwaysToCheck stats stats u There are ties in the preranked stats of the list The order of those tied genes will be arbitrary which may produce unexpected results sessionInfo R version Platform x pclinuxgnu bit Running under Ubuntu LTS Matrix products default BLAS usrliblibblaslibblasso LAPACK usrliblapackliblapackso locale LCCTYPEenUSUTF LCNUMERICC LCTIMEenUSUTF LCCOLLATEenUSUTF LCMONETARYenUSUTF LCMESSAGESenUSUTF LCPAPERenUSUTF LCNAMEC LCADDRESSC LCTELEPHONEC LCMEASUREMENTenUSUTF LCIDENTIFICATIONC attached base packages parallel stats stats graphics grDevices utils datasets methods base other attached packages bindrcpp fgsea Rcpp DESeq SummarizedExperiment DelayedArray BiocParallel Biobase GenomicRanges GenomeInfoDb IRanges S Vectors BiocGenerics tximport matrixStats genefilter ballgown forcats stringr dplyr purrr readr tidyr tibble ggplot tidyverse loaded via a namespace and not attached nlme bitops lubridate bit RColorBrewer httr tools backports R rpart Hmisc DBI lazyeval mgcv colorspace nnet withr gridExtra tidyselect bit compiler cli rvest htmlTable xml labeling rtracklayer checkmate scales digest Rsamtools foreign XVector htmltools base enc pkgconfig limma htmlwidgets rlang readxl rstudioapi RSQLite bindr jsonlite acepack RCurl magrittr GenomeInfoDbData Formula Matrix munsell stringi zlibbioc plyr grid blob crayon lattice Biostrings haven splines annotate hms locfit knitr pillar geneplotter fastmatch XML glue latticeExtra datatable modelr cellranger gtable assertthat xtable broom survival GenomicAlignments AnnotationDbi memoise cluster sva rankedgenestsvgz c bpv symbolsgmtgz I found that this error occurs when the input named vector of scores contain NA values plotEnrichmentzebrafishGO extracellularmatrix rankedvec Error in if NR missing value where TRUEFALSE needed traceback calcGseaStatstatsAdj selectedStats pathway returnAllExtremes TRUE plotEnrichmentzebrafishGO extracellularmatrix rankedvec It might be nice to check for NAs in the input and give a more informative error By the way fgsea does not give an error given the same NAcontaining input Hi great package I am wondering how it is manage when the metric of the ranked genes it is a tie this for values not equal to The Broad Institute java software has a warning about this but I did not find any information about it in the preprint nor the vignette Should ties be solve with jittering the duplicated values or a warning be printed when there are ties in the ranked gene list