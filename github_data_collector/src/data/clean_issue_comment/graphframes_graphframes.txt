I am trying to use the bfs function inside pyspark However passing a column to fromExpr and toExpr results in TypeError Column is not iterable My python code looks like this python from pysparksql import SparkSession from graphframes import GraphFrame spark SparkSessionbuilderappNamegraphgetOrCreate sparkread parquetdataparquet createOrReplaceTempViewdata data sparktabledata scsetCheckpointDirtmpchk vertices dataselectid type edges dataselect dataidaliassrc dataparentidaliasdst graph GraphFramevertices edges start somevertex paths graphbfsverticesid start verticestype which results in Traceback most recent call last File stdin line in module File tmpspark abced ac f fc a userFiles b e b eb fb b ae graphframesgraphframes spark s jargraphframesgraphframepy line in bfs File usrhdpcurrentspark clientpythonlibpy j srczippy jjavagatewaypy line in call File usrhdpcurrentspark clientpythonlibpy j srczippy jjavagatewaypy line in buildargs File usrhdpcurrentspark clientpythonlibpy j srczippy jjavagatewaypy line in getargs File usrhdpcurrentspark clientpythonlibpy j srczippy jjavacollectionspy line in convert File usrhdpcurrentspark clientpythonpysparksqlcolumnpy line in iter raise TypeErrorColumn is not iterable TypeError Column is not iterable However the following code in scala works fine scala import orggraphframes import orggraphframesGraphFrame sparkreadparquetdataparquetcreateOrReplaceTempViewdata data sparktabledata scsetCheckpointDirtmpchk val vertices dataselectid type val edges dataselectdataidaliassrc dataparentidaliasdst val graph GraphFramevertices edges val start somevertex val paths graphbfsfromExprverticesid starttoExprverticestype run It looks to me like the python types are not correctly translated to java types System Information spark version scala version Java HotSpotTM Bit Server VM Java python version graphframes spark s os CentOS Linux release Core Fix downloadtravisdependencies We should enter cache dir first and then remove old tarballsparkhomedir Build against spark Preview release Removes a count and log statement that have negative performance impacts and result only in some logging These lines in Connected Components are only used for logging and the computation of the count can be rather expensive val numEdges eecount logInfoslogPrefix Found numEdges edges after preparation Id like to use GraphFrames with java in my maven project in the official documentation they said that APIs are provided for scala python and JAVA but in real I find only APIs for scala and python so my question is can I realy use GraphFrames with java We have to update Spark patch version since there are no and at mirror site In the meantime I update sbt and sbtplugins patch version Id like to install graphframes via pip but looks like that version isnt up on pypi Is that going to happen So I followed the instructions of downloading the jar file extracting then zipping and adding the zip file to the PYTHONPATH as I can import graphframes without issue both from PySpark REPL and within iPython But the minute I try to call GraphFramevertices edges I get the following error from iPython when going through this script python from functools import reduce from pysparksqlfunctions import col lit when from graphframes import from pyspark import SparkConf SparkContext from pysparksql import SQLContext conf SparkConfsetAppNameLog Analyzer sc SparkContextconfconf sqlContext SQLContextsc vertices sqlContextcreateDataFrame a Alice b Bob c Charlie d David e Esther f Fanny g Gabby id name age edges sqlContextcreateDataFrame a b friend b c follow c b follow f c follow e f follow e d friend d a friend a e friend src dst relationship g GraphFramevertices edges printg python Py JJavaError Traceback most recent call last ipythoninput baffb in module g GraphFrameve Downloadsgraphframeszipgraphframesgraphframepy in initself v e selfsqlContext vsqlctx selfsc selfsqlContextsc selfjvmgfapi javaapiselfsc selfID selfjvmgfapiID Downloadsgraphframeszipgraphframesgraphframepy in javaapijsc def javaapijsc javaClassName orggraphframesGraphFramePythonAPI return jscjvmThreadcurrentThreadgetContextClassLoaderloadClassjavaClassName newInstance usrlocallibpython sitepackagespy jjavagatewaypy in callself args answer selfgatewayclientsendcommandcommand returnvalue getreturnvalue answer selfgatewayclient selftargetid selfname for temparg in tempargs usrlocallibpython sitepackagespysparksqlutilspy in decoa kw def decoa kw try return fa kw except py jprotocolPy JJavaError as e s ejavaexceptiontoString usrlocallibpython sitepackagespy jprotocolpy in getreturnvalueanswer gatewayclient targetid name raise Py JJavaError An error occurred while calling n formattargetid name value else raise Py JError Py JJavaError An error occurred while calling o loadClass javalangClassNotFoundException orggraphframesGraphFramePythonAPI at javabasejavanetURLClassLoaderfindClassURLClassLoaderjava at javabasejavalangClassLoaderloadClassClassLoaderjava at javabasejavalangClassLoaderloadClassClassLoaderjava at javabasejdkinternalreflectNativeMethodAccessorImplinvoke Native Method at javabasejdkinternalreflectNativeMethodAccessorImplinvokeNativeMethodAccessorImpljava at javabasejdkinternalreflectDelegatingMethodAccessorImplinvokeDelegatingMethodAccessorImpljava at javabasejavalangreflectMethodinvokeMethodjava at py jreflectionMethodInvokerinvokeMethodInvokerjava at py jreflectionReflectionEngineinvokeReflectionEnginejava at py jGatewayinvokeGatewayjava at py jcommandsAbstractCommandinvokeMethodAbstractCommandjava at py jcommandsCallCommandexecuteCallCommandjava at py jGatewayConnectionrunGatewayConnectionjava at javabasejavalangThreadrunThreadjava So it looks like this is an issue loading a java class Probably has to do with path However when I go through the steps of the quickstart after running pyspark packages graphframesgraphframes spark s Ive got the same zip file added to PYTHONPATH for both I get the following error java Traceback most recent call last File stdin line in module File privatevarfoldersff psxrlmd w ggbm vngf xw gnTspark b b fbd c userFiles dd b e a f eb graphframesgraphframes spark s jargraphframesgraphframepy line in init File Userstwoo Downloadsspark binhadoop pythonlibpy j srczippy jjavagatewaypy line in call File Userstwoo Downloadsspark binhadoop pythonpysparksqlutilspy line in deco return fa kw File Userstwoo Downloadsspark binhadoop pythonlibpy j srczippy jprotocolpy line in getreturnvalue py jprotocolPy JJavaError An error occurred while calling o createGraph javalangNoSuchMethodError scalaPredefrefArrayOps LjavalangObjectLscalacollectionmutableArrayOps at orggraphframesGraphFrameapplyGraphFramescala at orggraphframesGraphFramePythonAPIcreateGraphGraphFramePythonAPIscala at javabasejdkinternalreflectNativeMethodAccessorImplinvoke Native Method at javabasejdkinternalreflectNativeMethodAccessorImplinvokeNativeMethodAccessorImpljava at javabasejdkinternalreflectDelegatingMethodAccessorImplinvokeDelegatingMethodAccessorImpljava at javabasejavalangreflectMethodinvokeMethodjava at py jreflectionMethodInvokerinvokeMethodInvokerjava at py jreflectionReflectionEngineinvokeReflectionEnginejava at py jGatewayinvokeGatewayjava at py jcommandsAbstractCommandinvokeMethodAbstractCommandjava at py jcommandsCallCommandexecuteCallCommandjava at py jGatewayConnectionrunGatewayConnectionjava at javabasejavalangThreadrunThreadjava 