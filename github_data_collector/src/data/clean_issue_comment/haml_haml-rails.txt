Hi I have a simple haml file in rails haml title bThe dogb ate her cats lunch jstooltiptitle title Dog jstooltiptitle titlehtmlsafe Dog When observing the source code the first div gets transformed and escaped properly and behaves as expected html div classjstooltip title ltb gtThe dog ltb gt ate her cat s lunch Dog div However the second div gets transformed and escaped poorly leading to an unfortunate accident that could have been avoided html div classjstooltip titlebThe dogb ate her cats lunch Dog div It seems that hamlrails doesnt properly deal with ActiveSupportSafeBuffer in element attributes this bug doesnt occur when using title Let me know if I can provide more info or examples Maybe this is better reported here than in hamlhaml On haml and hamlrails all text in texthaml files is html escaped Using escapefilterinterpolations doesnt seem to help This seems to be related railsrails Is there any way to disable escaping on texthaml files altogether h Foos erb test erb test Expected Result test is printed twice Actual Result test is printed three times The more times you use the ERB filter the more times it repeats all previous erb filter content Running this view through haml on the command line produces the intended result so I believe this is an issue with the way haml interacts with rails Produced this result by using only rails new railstest and then adding the hamlrails and haml gems to the Gemfile and scaffolding a fooscontroller From Gemfilelock haml temple tilt hamlrails actionpack activesupport haml html haml railties rails actioncable actionmailer actionpack actionview activejob activemodel activerecord activestorage activesupport I was trying to use the hamlerb haml task inside a Rails Application Template and the task was not recognizing or honoring my ENV vars set on the CLI This PR changes the ENV checks a little bit to make it compatible with executing inside a Rails App Template I also added a new ENV var for HAMLRAILSOVERWRITEHAML to control the other user prompt of asking wether to overwrite existing haml files Im using it like this from inside a rails app template HAMLRAILSDELETEERBtrue HAMLRAILSOVERWRITEHAMLfalse rails hamlerb haml Pipes on converted Devise views How can I prevent this Or is there some reason Im not understanding Because I have to go through and delete them every time img width altscreen shot at am src Followed the installation guide for hamlrails bundle exec rails generate hamlapplicationlayout convert Running via Spring preloader in process Could not find generator hamlapplicationlayout Maybe you meant applicationrecord integrationtest or migration Run rails generate help for more options Took a while to sort this out so it would be nice to add something to the read me In a Rails project I previously had just gem hamlrails in my Gemfile it was happily generating haml for new views But I didnt have the erb to haml converter so I upgraded to gem hamlrails Which provided the utililty to convert my application layout to haml But it also completely busted view generation so that when I scaffold a new model I now get this error Could not load generator generatorshamlscaffoldscaffoldgenerator Error uninitialized constant HamlRailsGenerators I commented out the line in configapplicationrb configgenerators do g gtemplateengine haml which was there before when I was just using gem hamlrails as the newer gem hamlrails shouldnt need it thats the main point of the updated gem But was still broken Finally after a lot of head scratching and wasted time I realised that hamlrails might not be a direct descendent of hamlrails and simply doesnt upgrade cleanly So I had to remove hamlrails from my installed gems and remove the libgenerators directory which had haml templates and generators in it It now works but that libgenerators was incredibly useful because it had templates I could edit to get new views as I wanted them eg formwith or boostrapformwith It would be nice to take the code for templates from hamlrails an old dead project and use it in hamlrails so that users could have editable templates Can we please start using a changelog Working through commits is a difficult way to review changes Having a changelog with a concise list of updates will be very helpful in updating the gem I am in the process of upgrading an old applications base libraries Currently I am at Rails hamlrails has been constrained to version which works However when I take the version constraint off and let bundler bring in the latest version I get the error NameError undefined method precompiledmethodreturnvalue for class HamlCompiler when I run my test suite Am I stuck on version until I get to a newer rails If so what version of rails can I start letting hamlrails version float to the latest Making scaffold generate formwith if Rails Please reference this post Thanks