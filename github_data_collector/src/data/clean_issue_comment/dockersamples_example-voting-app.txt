Got error when trying to reproduce the dockercompose up Output of docker version Client Docker Engine Community Version API version Go version go Git commit a ea Built Wed Nov OSArch darwinamd Experimental false Server Docker Engine Community Engine Version API version minimum version Go version go Git commit a ea Built Wed Nov OSArch linuxamd Experimental false containerd Version v GitCommit b a c af e c db c f fa runc Version rc dev GitCommit e f a c f e d a c b d aa dockerinit Version GitCommit fec output of running dockercompose up Building worker Step FROM microsoftdotnet sdk fde d f Step WORKDIR code Using cache d fbc d Step ADD srcWorker codesrcWorker Using cache a dd Step RUN dotnet restore v minimal srcWorker dotnet publish c Release o srcWorker Running in f dd f c MSBUILD error MSB Specify which project or solution file to use because the folder srcWorker contains more than one project or solution file ERROR Service worker failed to build The command binsh c dotnet restore v minimal srcWorker dotnet publish c Release o srcWorker returned a nonzero code Docker for mac Missing namespace PLEASE ONLY USE THIS ISSUE TRACKER TO SUBMIT ISSUES WITH THE EXAMPLE VOTING APP If you have a bug working with Docker itself not related to these labs please file the bug on the Docker repo If you would like general support figuring out how to do something with Docker please use the Docker Slack channel If youre not on that channel sign up for the Docker Community and youll get an invite Or go to the Docker Forums Please provide the following information so we can assess the issue youre having Description Briefly describe the problem you are having in a few paragraphs When running docker build t votingapp command execution goes fine until attempting to install Flask Steps to reproduce the issue if relevant navigate to vote directory execute docker build t votingapp Describe the results you received Describe the results you expected Additional information you deem important eg issue happens only occasionally Output of docker version rootdkrn CentOs vote docker build t votingapp Sending build context to Docker daemon kB Step FROM python alpine alpine Pulling from librarypython d c c d Pull complete dfb e fe Pull complete e f b Pull complete a f Pull complete Digest sha b c bb b d f f c c c fa bce ad f b fe Status Downloaded newer image for python alpine ede fb a Step WORKDIR app Running in e b ea f Removing intermediate container e b ea f d b bf e Step ADD requirementstxt apprequirementstxt ddfe d ba Step RUN pip install r requirementstxt Running in c e c DEPRECATION Python will reach the end of its life on January st Please upgrade your Python as Python wont be maintained after that date A future version of pip will drop support for Python More details about Python support in pip can be found at WARNING Retrying Retrytotal connectNone readNone redirectNone statusNone after connection broken by NewConnectionErrorpipvendorurllib connectionVerifiedHTTPSConnection object at x f b cd Failed to establish a new connection Errno Try again simpleflaskOutput of docker info paste your output here Additional environment details AWS Docker for Mac Docker for Windows VirtualBox physical etc The worker app uses NET Core which reached end of support at October according to Microsofts NET Core Support Policy NET Core is an LTS version which will be supported until at least August This PR updates the worker NET Core project to version of the framework and the latest stable versions of its required NuGet packages The updates to the Worker Dockerfile are based on Microsofts NET Core Docker tutorial The worker container builds and runs as expected on Docker Desktop for Windows removed volume mounts per issue PLEASE ONLY USE THIS ISSUE TRACKER TO SUBMIT ISSUES WITH THE EXAMPLE VOTING APP If you have a bug working with Docker itself not related to these labs please file the bug on the Docker repo If you would like general support figuring out how to do something with Docker please use the Docker Slack channel If youre not on that channel sign up for the Docker Community and youll get an invite Or go to the Docker Forums Please provide the following information so we can assess the issue youre having Description Briefly describe the problem you are having in a few paragraphs The dockercomposeyml and dockercomposesimpleyml file use volume mounts for the vote result apps While this is something a developer might do while conducting innerloop debugging it seems unnecessary and poor practice to have as part of an example of real code It also assumes that the source code is on the same machine as the compose file which really should not be a prereq Note that the containers build and execute perfectly fine without the volume mounts Steps to reproduce the issue if relevant see this code services vote build vote command python apppy volumes voteapp ports networks fronttier backtier result build result command nodemon serverjs volumes resultapp ports networks fronttier backtier Updates all the NET Core components to and uses the SDK and runtime images from MCR Image Problems Old Images Code has changed in this repo and images are older than the code causing old PR fixes to have no effect if youre using the official images One example dockersamplesexamplevotingappworkerlatest is two years old but I fixed a CPU issue nearly two years ago Running current image will still spike CPU Missing Images Images for alternate builds dont always exist One example This repo has a java worker as an alternative to the default dotnet worker but Hub has no image for that I recommend building it as tag java Duplicate Image Repos Images are duplicated in different Hub repos One example dockersamplesexamplevotingappworker and dockersamplesworker are the same app but different build dates The former is whats used in all yaml and in README and what weve used for many years The latter has a new build and Im guessing was created by the new Jenkinsfile added a year ago to help automate image builds which is great but that file is pushing to the wrong Hub repos and is not complete with the various tags and alt builds Doing some quick searching it looks like no one is using the new image repos so it would be OK to remove them and stick with the origionals No Image Tag Docs To help people get the most out of these images and demo it would be quite helpful to have a table in the READMEmd listing all the images their tags and the reason for those tags One example What is the difference between latest before and after What tags are for what OSarch Suggested Solutions If the Jenkinsfile is indeed the future I think a single PR could fix all these issues by fixing the current image repotags and adding all the alt builds to it along with a README update on tag options for demos Fix current repo names for the demo apps in Jenkinsfile Add alt builds of the demo apps to Jenkinsfile Ensure all tags are covered by the pushes in Jenkinsfile Delete misnamed Hub repos Update READMEmd with a table of tags and uses Im looking for a thumbs up from maintainers that this would be the prefered resolution and Ill get started on a PR It looks like the Jenkinsfile will test the new builds in the PR but wont test the push commands until its merged to master Description Theres something with the net version of the worker app that causes it to randomly not connect to db or redis on startup which results in a crash Over the last year Ive had thousands of students use this app to learn docker and swarm and one of the most common issues is this worker failing on startup It happens on all modern docker versions across platforms and there is no common theme to why it doesnt work Today in testing we killed the broken service which was recreating the task over and over and it was failing and once the service was recreated and it worked with no changes in how we created it See log below for typical behavior The stack trace tells you it cant resolve something but doesnt show what it cant look up so I cant tell what it thinks the problem is From all the cases Ive seen and testing Ive done its not related to other services being down or general network issues This also happens for Kubernetes as seen by other issues reported in this repo Hundreds of people have reported this problem to me and deploying the java version fixes the issue Workaround Deploy the java version of the worker which I have build here bretfisherexamplevotingappworkerjava Steps to reproduce the issue if relevant In swarm deploy all voting app services except worker Ensure they work as they should deploy net version of worker using examples in this repo README random deploys will randomly fail with stack trace of no such device or address service will create a new task that may work or may not Describe the results you received Notice below that we created a worker service with two replicas and youll see one replica work and the other fail then get recreated on the same node and work the nd time Its random if it fails and which one would fail vote gitmaster docker service logs rw tamzd voteworker itk wfpt ghnode Waiting for db voteworker itk wfpt ghnode Connected to db voteworker itk wfpt ghnode Found redis at voteworker itk wfpt ghnode Connecting to redis voteworker itk wfpt ghnode Processing vote for a by fb d d b voteworker tv i viknli node SystemAggregateException One or more errors occurred No such device or address SystemNetInternalsSocketExceptionFactoryExtendedSocketException No such device or address voteworker tv i viknli node at SystemNetDnsInternalGetHostByNameString hostName Boolean includeIPv voteworker tv i viknli node at SystemNetDnsResolveCallbackObject context voteworker tv i viknli node End of stack trace from previous location where exception was thrown voteworker tv i viknli node at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow voteworker tv i viknli node at SystemNetDnsHostResolutionEndHelperIAsyncResult asyncResult voteworker tv i viknli node at SystemNetDnsEndGetHostAddressesIAsyncResult asyncResult voteworker tv i viknli node at SystemNetDnscGetHostAddressesAsyncb IAsyncResult asyncResult voteworker tv i viknli node at SystemThreadingTasksTaskFactory FromAsyncCoreLogicIAsyncResult iar Func endFunction Action endAction Task promise Boolean requiresSynchronization voteworker tv i viknli node End of inner exception stack trace voteworker tv i viknli node at SystemThreadingTasksTask GetResultCoreBoolean waitCompletionNotification voteworker tv i viknli node at NpgsqlNpgsqlConnectorConnectNpgsqlTimeout timeout voteworker tv i viknli node at NpgsqlNpgsqlConnectorRawOpenNpgsqlTimeout timeout voteworker tv i viknli node at NpgsqlNpgsqlConnectorOpenNpgsqlTimeout timeout voteworker tv i viknli node at NpgsqlConnectorPoolAllocateNpgsqlConnection conn NpgsqlTimeout timeout voteworker tv i viknli node at NpgsqlNpgsqlConnectionOpenInternal voteworker tv i viknli node at WorkerProgramOpenDbConnectionString connectionString in codesrcWorkerProgramcsline voteworker tv i viknli node at WorkerProgramMainString args in codesrcWorkerProgramcsline voteworker tv i viknli node Inner Exception SystemNetInternalsSocketExceptionFactoryExtendedSocketException x No such device or address voteworker tv i viknli node at SystemNetDnsInternalGetHostByNameString hostName Boolean includeIPv voteworker tv i viknli node at SystemNetDnsResolveCallbackObject context voteworker tv i viknli node End of stack trace from previous location where exception was thrown voteworker tv i viknli node at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow voteworker tv i viknli node at SystemNetDnsHostResolutionEndHelperIAsyncResult asyncResult voteworker tv i viknli node at SystemNetDnsEndGetHostAddressesIAsyncResult asyncResult voteworker tv i viknli node at SystemNetDnscGetHostAddressesAsyncb IAsyncResult asyncResult voteworker tv i viknli node at SystemThreadingTasksTaskFactory FromAsyncCoreLogicIAsyncResult iar Func endFunction Action endAction Task promise Boolean requiresSynchronization voteworker tv i viknli node voteworker hjt aigtbwqnode Waiting for db voteworker hjt aigtbwqnode Waiting for db voteworker hjt aigtbwqnode Waiting for db voteworker hjt aigtbwqnode Waiting for db voteworker hjt aigtbwqnode Waiting for db voteworker hjt aigtbwqnode Connected to db voteworker hjt aigtbwqnode Found redis at voteworker hjt aigtbwqnode Connecting to redis voteworker hjt aigtbwqnode Processing vote for b by fb d d b Describe the results you expected Worker always works Additional information you deem important eg issue happens only occasionally Output of docker version rootnode docker version Client Version API version Go version go Git commit e ff Built Thu Apr OSArch linuxamd Experimental false Server Docker Engine Community Engine Version API version minimum version Go version go Git commit e ff Built Thu Apr OSArch linuxamd Experimental false Output of docker info rootnode docker info Containers Running Paused Stopped Images Server Version Storage Driver overlay Backing Filesystem extfs Supports dtype true Native Overlay Diff true Logging Driver jsonfile Cgroup Driver cgroupfs Plugins Volume local Network bridge host macvlan null overlay Log awslogs fluentd gcplogs gelf journald jsonfile local logentries splunk syslog Swarm active NodeID zyd hmid dado s tago y Is Manager true ClusterID spa crzsqgtn pix hj sac Managers Nodes Default Address Pool SubnetSize Orchestration Task History Retention Limit Raft Snapshot Interval Number of Old Snapshots to Retain Heartbeat Tick Election Tick Dispatcher Heartbeat Period seconds CA Configuration Expiry Duration months Force Rotate Autolock Managers false Root Rotation In Progress false Node Address Manager Addresses Runtimes runc Default Runtime runc Init Binary dockerinit containerd version bb b fd f ca fbb b d eea c runc version b fe d ee ef f fee b d e init version fec Security Options apparmor seccomp Profile default Kernel Version generic Operating System Ubuntu LTS OSType linux Architecture x CPUs Total Memory MiB Name node ID UA M YBEPX BKDUWMNA F AGVE X GDQ UKYKYF J HQQNC Docker Root Dir varlibdocker Debug Mode client false Debug Mode server false Registry Labels Experimental false Insecure Registries Live Restore Enabled false Product License Community Engine WARNING No swap limit support Additional environment details AWS Docker for Mac Docker for Windows VirtualBox physical etc This has happened on Docker Desktop Digital Ocean Docker Toolbox on VirtualBox and more