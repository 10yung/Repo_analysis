Expected behaviour PiHole starts to serve as a DNS server Actual behaviour I can ping traceroute access admin panel through IP and SSH into the machine but no machine in the network would use it as a DNS server BUT when inputing direct queries into SSH for DNS resolver I get instant responses and the machine is able to download its updates and resolves queries made by itself Steps to reproduce Connect the Rasp with clean Rasbian Buster Lite install PiHole restart it even for good measure after install process and set its IP as a DNS server by either router or computer directly Steps of what you have done to fix this Restarted the machine restarted resolver reinstalled pihole times tried switching onoff wonky router settings like security settings or DNS OverrrideRelay setting Rasp as a DNS in either router settings or in PC network adapter settings somewhat tested also setting raspberry as a DHCP also but for some reason the adresses didnt change FYI cmd commands or settingswhole pc restart on Win machine also doesnt make a difference and nslookup just finishes in timeout or unknown ModemRouter is an Arris TG S In raising this issue I confirm the following please fill the checkboxes eg X x I have read and understood the contributors guide x The issue I am reporting can be replicated x The issue I am reporting isnt a duplicate see FAQs closed issues and open issues How familiar are you with the the source code relevant to this issue Expected behaviour Gravity gathers domains and stores efficiently in the sqlite database with no need for duplicate entries Actual behaviour Gravity gathers domains and stores duplicate domains as they are technically unique in terms of which adlist they appear in adlistid I understand that this would be potentially a lot more involved and may affect things like joins my db knowledge isnt fantastic but would it not make sense to try storing ids in adlistid in the following format This may not be an issue so much for users with a small amount of blocklists eg the default ones but so many people seem to see bigger is better when it comes to this kind of thing and its not uncommon to see people with millions of domains across many blocklists I have seen instances of M unique domains where the gravity table grows to be in excess of M entries because of how things are currently stored This must have some form of performance impact somewhere seeing as the processing is mostly done on small devices like Raspberry Pis Steps to reproduce Have an accumulation of blocklists that have many of the same domains between them Run gravity update In raising this issue I confirm the following please fill the checkboxes eg X x I have read and understood the contributors guide x The issue I am reporting can be replicated x The issue I am reporting isnt a duplicate see FAQs closed issues and open issues How familiar are you with the the source code relevant to this issue Expected behaviour Not relevant Actual behaviour I dont think this is implemented yet although it may be possible by editing config files Steps to reproduce NA Debug token provided by uploading pihole d log NA Troubleshooting undertaken andor other relevant information NA Title is fairly self explanatory however here is a more indepth explanation I have configured PiHole to be the DHCP server for my local network It appears to be working and is assigning IPs dynamically to hosts I have several devices on this network each with a unique hostname I would like to be able to configure PiHole so that it acts as a DNS server for these local hostnames Is this possible If it is possible does this require that I configure my devices with static IP addresses or can this be done in conjunction with DHCP Possibly such a thing would require me to write some new software which sends hostnames to PiHole after an IP is obtained via DHCP I could possibly do such a thing although it may take me a while to figure out how Regarding expected behaviour from the computer I am currently using I would anticipate being able to do ssh usernamepc or possibly ssh usernamepc mydomain In raising this issue I confirm the following please fill the checkboxes eg X x I have read and understood the contributors guide x The issue I am reporting can be replicated x The issue I am reporting isnt a duplicate see FAQs closed issues and open issues How familiar are you with the the source code relevant to this issue Expected behaviour When Use DNSSEC under SettingsDNS pihole should have this feature enabled Actual behaviour Upon initially enabling Use DNSSEC pihole functions as it should logging codes like SECURE and INSECURE as queries are sent to it The bug I am seeing occurs on a reboot of the pihole box Despite the Use DNSSEC having a check mark on it I do not get the expected annotations in the log As well if I run dig dnssec debianorg on the freshly booted pihole I do not get the expected ad flag in the output Steps to reproduce To fix the behavior I need to uncheck Use DNSSEC and hit save then check it and hit save the behavior returns to normal both with respect to the query log and to assing the ad flag in the dig output Again this only happens if I reboot pihole it stays enabled for weeks until that reboot I cannot provide the debug token as this is running from the unsupported Arch Linux packages Here are some logs on a fresh boot piholelog piholeftllog The next two are after I uncheck save check save the Use DNSSEC option piholelog piholeftllog What exactly happens when a user checks the Use DNSSEC box and hits save Perhaps something in the Arch packaging is not doing all the steps In raising this issue I confirm the following please fill the checkboxes eg X X I have read and understood the contributors guide X The issue I am reporting can be replicated X The issue I am reporting isnt a duplicate see FAQs closed issues and open issues How familiar are you with the the source code relevant to this issue Expected behaviour On restarting the server pihole should resume operation and all devices will have access to the local network and internet via the pihole DNS service Actual behaviour Following any server restart forced unexpected etc pihole is started and running but no device can access any internal external resources Devices already on the network ie have IP addresses can still be reached via the IP address On SSH into the server and running a command such as sudo pihole status everything starts working again Steps to reproduce Install pihole and confirm it is running as expected Restart the server Check for network availability Debug token provided by uploading pihole d log qad l g v Troubleshooting undertaken andor other relevant information Only basic checking to discover where the problem was in terms of overall network failure following the restart and discovering the fix A cron command restart sleep usrlocalbinpihole status ensures DNS is recovered following a restart event This is a setup on Debian Not a typical PiHole setup as Im trying to remove the need to have the Raspberry Pi running I appreciate this may in itself cause issues In raising this issue I confirm the following please fill the checkboxes eg X x I have read and understood the contributors guide x The issue I am reporting can be replicated x The issue I am reporting isnt a duplicate see FAQs closed issues and open issues How familiar are you with the the source code relevant to this issue Expected behaviour The Tutorial for setting up OpenVPN in parallel suggested to switch the interfacelistening mode into all interfaces Probably so the tun interface could be listened aswell Actual behaviour However as soon as the listening interface is switched not a single DNS query could reach the pihole Its also not querylogging anything even though the device is still pingable from the network Steps to reproduce I am running OpenVpn in parallel with Pihole on a Raspberry Pi Zero Wireless The Pihole is located in a local network behind a DSLite router FritzBox and hence has ipv support enabled to be reachable The router does provide a DNS forwarding which is not used Instead Dhcp is used to directly push the pihole ipv as DNS Debug token provided by uploading pihole d log t vo y ruk NOTE the debug was created the the time of listening on interface wlan However this probably doesnt have any value at all since localhost querys never fail to resolve Its just the external ones Troubleshooting undertaken andor other relevant information tried switching interface listening to allow all origins with no success switched back to wlan interface connectivity was restored Edit I do have the usb ethernet interface enabled so I could still connect it to my pc and shh into it without Wlan Perhaps this might be causing an issue Thanks in advance Better to use command v By submitting this pull request I confirm the following please fill any appropriate checkboxes eg X x I have read and understood the contributors guide as well as this entire template x I have made only one major change in my proposed changes I have commented my proposed changes within the code x I have tested my proposed changes and have included unit tests where possible x I am willing to help maintain this change if there are issues with it later x I give this submission freely and claim no ownership x It is compatible with the EUPL license I have squashed any insignificant commits git rebase Please make sure you Sign Off all commits Pihole enforces the DCO What does this PR aim to accomplish A detailed description screenshots if necessary as well as links to any relevant GitHub issues How does this PR accomplish the above A detailed description such as a changelog and screenshots if necessary of the implemented fix What documentation changes if any are needed to support this PR A detailed list of any necessary changes You must follow the template instructions Failure to do so will result in your pull request being closed Please respect that Pihole is developed by volunteers who can only reply in their spare time Theres no way to get the actual name of the process that is holding the port Its never passed in to the checker function In raising this issue I confirm the following x I have read and understood the contributors guide x The issue I am reporting can be replicated x The issue I am reporting isnt a duplicate see FAQs closed issues and open issues How familiar are you with the the source code relevant to this issue Expected behaviour Default installation should block syoutubecom There is a record syoutubecom Blocking this will interfere with video watching history in Actual behaviour Default installation does not block syoutubecom The record is not in gravitydb sqlite etcpiholegravitydb sqlite SELECT domain FROM gravity WHERE domain LIKE syoutubecom adsyoutubecom adsyoutubecom Steps to reproduce Install Pihole using official guide pihole checkout dev curl syoutubecom dig syoutubecom check query log Debug token provided by uploading pihole d log dzt g w Troubleshooting undertaken andor other relevant information None Relevant this issue was found when looking into By submitting this pull request I confirm the following x I have read and understood the contributors guide as well as this entire template x I have made only one major change in my proposed changes x I have commented my proposed changes within the code x I have tested my proposed changes and have included unit tests where possible x I am willing to help maintain this change if there are issues with it later x I give this submission freely and claim no ownership x It is compatible with the EUPL license x I have squashed any insignificant commits git rebase What does this PR aim to accomplish Addresses issues and to allow changing the server port andor host name How does this PR accomplish the above SERVER SERVERNAME used instead of SERVER HOST host contains both host name and port causing the query ads script to result in an invalid domain error uses the VIRTUALHOST if set in the environment to determine whether to redirect to the admin page in addition to pihole This can be set with the following line in etclighttpdexternalconf setenvaddenvironment virtualhost yourfqdntld it is still assumed that lighttpd runs on localhost but the call to queryAds now includes the server port replaced use of pihole prefix in path for assets in the html of the blocking page I dont know if this addresses the issue when running under docker maybe someone else can confirm this What documentation changes if any are needed to support this PR Document setting the VIRTUALHOST in the environment when using a host name other than pihole