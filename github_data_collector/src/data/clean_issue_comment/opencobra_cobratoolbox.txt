When using printRxnFormula the function prints wrong genes without replacing andor operators Unfortunately testPrintRxnFormulam bypasses this bug because of the use of modelgrRules instead of modelrules You can reproduce the problem by using the code below the first reaction is chosen arbitrarily loadecolicoremodelmat model rmfieldmodel grRules removed to use modelrules printRxnFormulamodel rxnAbbrList modelrxns gprFlag true ACALD acald c coa c nad c accoa c h c nadh c b b modelrules ans x x modelgenes ans b b I believe the problem is caused by the lines that is rule regexprepmodelrulesrxnIDor rule regexpreprule and rule regexpreprulex id modelgenesnum str Escapes are required for the expressions in the first two lines so changing to and to solves this problem in my case For the wrong gene name output since num str converts numeric values to decimal representations the function returns modelgenes instead of modelgenes modelgenes ans b modelgenes ans b modelgenes ans b Using str num instead of num str fixes the problem To sum up possible solution is to replace the lines with the following rule regexprepmodelrulesrxnID or rule regexpreprule and rule regexpreprulex id modelgenesstr num Note that the same behavior exists in the proteinFlag section as well lines It is better to check all the uses of num str when indexing in the whole toolbox Additionally Id like to mention that I am not very familiar with the uses of regular expression functions my solutions might not be the correct solutions Hope this helps Handan X Tried to solve the issue on my own X Retried to run my code with the latest version of The COBRA Toolbox X Checked that a similar issue has not already been opened fix problem with windows I hereby confirm that I have X Tested my code on my own machine X Followed the guidelines in the Contributing Guide X Selected develop as a target branch top left dropdown menu Note You may replace with X to check the box In previous versions of the cobratoolbox I could sample the ecolicore network using the masterbranch of the cobratoolbox The model correctly had dimensions after separating out the degenerate dimensions After grabbing the latest commit in all submodules and on the master branch however the cobratoolbox finds too many degenerate equations and the ecolicore model is left with just nondegenerate dimensions I can fix my Problem by using an older version of the repository I had on a different computer I just thought Id let you know I hereby confirm that I have x Tried to solve the issue on my own x Retried to run my code with the latest version of The COBRA Toolbox x Checked that a similar issue has not already been opened A new attempt since the bug remains this time via devTools If the input file of lrsOutputReadRay is an empty file the function gets stuck in an infinite loop Personally I have never been able to run testAll successfully because of this A quick fix where an empty input file throws an error I hereby confirm that I have x Tested my code on my own machine x Followed the guidelines in the Contributing Guide x Selected develop as a target branch top left dropdown menu Note You may replace with X to check the box Hi I have ran a microbiome modeling data with samples and about taxons But its about weeks that is performing FVA with CPLEX fvatype on sample without any changing Matlab shows Busy status and CPU is working too I checked fvaCt and it shows structures for just samples I deleted that sample and ran again by another Matlab env but it happened again on another sample Is it OK Should this analyse takes long about weeks on a sample for FVA almutheinken rmtfleming I hereby confirm that I have X Tried to solve the issue on my own X Retried to run my code with the latest version of The COBRA Toolbox X Checked that a similar issue has not already been opened Note You may replace with X to check the box Please include a short description of enhancement here I hereby confirm that I have X Tested my code on my own machine X Followed the guidelines in the Contributing Guide X Selected develop as a target branch top left dropdown menu Note You may replace with X to check the box cc chaitrasarathy I am trying to use the random sampling method of cobratoolbox to obtain all possible flux distribution for the maximal growth rate condition I try to fulfill this goal by using sampleCbModel in cobratoolbox However I encountered the problem of x is not interior I have searched a lot similar issues online but no solution works for me I will really appreciate if anyone can help to fix this problem Here is how I formulate my optimization problem Step using normal FBA to obtain the maiximal growth rate under given constraint settings for substrates Step Using the same constraints settings in Step in addition fix the growth rate as the maximal growth rate obtained from Step call sampleCbModel function with parameters as below optionsnStepsPerPoint optionsnPointsReturned since my reactions number in total optionstoRound ModelSampling SampleResults sampleCbModelCobramodel options Error message Checking for width facets Currently PA Pb are in dimensions Checking for width facets Starting parallel pool parpool using the local profile connected to workers Found degenerate reactions adding them to the equality subspace In preprocess line In chrrSampler line In sampleCbModel line In runFBAureaobjCBRSGrowth line In normalizeAndRunFBAconsMassCobra line In runSimulationconsMassCobra line In FoodmaxGrowthCobra line In getDietGrowthRate line In DietRandomSampling line Warning Rank deficient rank tol e Now in dimensions after restricting Removed zero rows Preconditioning A with gmscale Rounding Error using mvesolvercobra line x not interior Error in mveruncobra line xE converged mvesolvercobraAbx maxitertol reg Ben Error in preprocess line Tshift Tmveconverged mveruncobraPAPb x reg Error in chrrSampler line roundedPolytope preprocessPoptions Error in sampleCbModel line samples modelSampling chrrSamplermodel nStepsPerPoint nPointsReturned toRound modelSampling useFastFVAoptPercentage I have checked both lower boundupper bound of the model all of them are within range of no InfInf Therefore I was really confused why this happens I will really appreciate if you can give any suggestions to fix this By the way the solver during above calculation is Gurobi I hereby confirm that I have X Tried to solve the issue on my own X Retried to run my code with the latest version of The COBRA Toolbox X Checked that a similar issue has not already been opened Note You may replace with X to check the box testQFCAm is only reliably compatible with gurobi and needs to be bypassed if gurobi is not present I tried to remove the genes from the model and want to also remove the rxn related from the model if the grrule is empty I am using the function removeGenesFromMode I tested the function using testModelManipulation Test removal of a gene modelMod removeGenesFromModelmodelModG The code above is in the line After that I run this one modelMod removeGenesFromModelmodelModb keepReactions rxn DGULRx has the grRule b but in the modelMod even though the grRule has changed to empty but the rxn is still there originalGPRs deletedReaction optional output for this function may not be assigned during the function I hereby confirm that I have X Tried to solve the issue on my own X Retried to run my code with the latest version of The COBRA Toolbox X Checked that a similar issue has not already been opened 