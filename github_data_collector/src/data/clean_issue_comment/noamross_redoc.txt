Using something like wdiff git diff worddiff or maybe postprocessing of diffObj representation see if we can convert markdown diffs to criticmarkup or pandoc track changes format so file diffs can be converted to Word track changes flextable output appears to only show up in resulting docx outputs if the chunk option is set to echo TRUE This is problematic for any sort of writing projects where the code needs to be hidden eg scientific manuscripts The same code renders acceptably using worddocument The flextable package is extremely useful for use with docx outputscollaborators and plays nice with the captioner package for crossreferencing in lieu of using bookdownworddocument so would be wonderful if supported it may be supported already and I am just missing something Rmarkdown code title Testing flextable behavior in redoc output redocredoc default worddocument default r setup libraryflextable Test The following table wont show up in redoc r echoF echoFALSE flextableheadcars But the next table will r echoT echoTRUE flextabletailcars Output renderedredocdocx renderedworddocumentdocx If this issue relates to usage of the package pleaseinclude a reproducible example consider using a reprex Please attach the associated docx file and let me know what version of Word you are using Paste your devtoolssessioninfo or sessionInfo into the code block below as well as versions of pandoc and RStudio if applicable Please take a moment and consider if the issue is actually in knitr rmarkdown officer or pandoc Thanks details summarystrongSession Infostrongsummary r R version Platform x pclinuxgnu bit Running under Ubuntu LTS Matrix products default BLAS usrlibatlasbaseatlaslibblasso LAPACK usrlibatlasbaseatlasliblapackso locale LCCTYPECUTF LCNUMERICC LCTIMECUTF LCCOLLATECUTF LCMONETARYCUTF LCMESSAGESCUTF LCPAPERCUTF LCNAMEC LCADDRESSC LCTELEPHONEC LCMEASUREMENTCUTF LCIDENTIFICATIONC attached base packages stats graphics grDevices utils datasets methods base loaded via a namespace and not attached zip Rcpp compiler base enc prettyunits redoc remotes tools uuid testthat digest pkgbuild pkgload jsonlite evaluate memoise rlang whoami cli rstudioapi diffobj curl yaml xfun httr officer withr knitr xml desc fs devtools rprojroot glue R processx fansi rmarkdown sessioninfo callr magrittr backports ps ellipsis htmltools usethis assertthat mime stringi crayon Pandoc version get with rmarkdownpandocversion RStudio version if applicable Test on RStudio Cloud and on RStudio V details Thanks for the amazing package Noam I just noticed that the default for the trackchanges argument in dedoc is commentsonly but the documentation for the function states that criticmarkup is the default I as a MS Word user appreciate this change tracking function from redoc so very much However recently I encountered troubles when writing articles with redoc in Chinese I attached a demo file based on a simplified version of Yihuis ctex template in rticle The file can be compiled by worddocument but not redoc testzip The error message was processing file testpreprocessedRmd Quitting from lines testpreprocessedRmd Error in ncharinput invalid multibyte string element Calls Anonymous processgroupinline callinline indir inlineexec In addition Warning messages In readCharx fileinfoxsize can only read in bytes in a nonUTF MBCS locale In knitrknitknitinput knitoutput envir envir quiet quiet The file testpreprocessedRmd must be encoded in UTF Please see for more info Execution halted Im using MS Word and heres the session info and yes I already set the default encoding as UTF and tried to switch Syssetlocale to Chinese and English Nothing helps r R version Platform x w mingw x bit Running under Windows x build Matrix products default locale LCCOLLATEChinese SimplifiedChina LCCTYPEChinese SimplifiedChina LCMONETARYChinese SimplifiedChina LCNUMERICC LCTIMEChinese SimplifiedChina attached base packages stats graphics grDevices utils datasets methods base loaded via a namespace and not attached Rcpp whoami digest crayon mime R jsonlite magrittr evaluate httr zip stringi rlang uuid diffobj rstudioapi xml rmarkdown tools officer xfun yaml compiler base enc htmltools knitr redoc This is my first time trying to use the package I just installed it from GitHub today Im calling it with the RStudio Addin Render and Update and I get the following error r redocroundtripactivefile Error in worddocument unused argument roundtrip TRUE I updated from rmarkdown to the latest sources on GitHub and still get the error Im not sure if this is the right way to first render a document If not Id be grateful for instructions details summarystrongSession Infostrongsummary r R version Platform x w mingw x bit Running under Windows x build Matrix products default locale LCCOLLATEEnglishUnited States LCCTYPEEnglishUnited States LCMONETARYEnglishUnited States LCNUMERICC LCTIMEEnglishUnited States attached base packages stats graphics grDevices utils datasets methods base loaded via a namespace and not attached Rcpp rstudioapi knitr xml magrittr uuid R rlang httr tools packrat xfun htmltools yaml digest crayon zip whoami officer base enc evaluate mime rmarkdown stringi compiler diffobj redoc jsonlite Pandoc version get with rmarkdownpandocversion RStudio version if applicable details Crossreference for Table is broken for the following output Please address this issue Broken Results Table span class redoc id redoccitation reftabiris Reproducible Code output bookdownmarkdowndocument baseformat redocredoc Table reftabiris r iris knitrkableheadiris caption iris Table reftabmtcars r mtcars knitrkableheadmtcars caption mtcars Figure reffighistogram r histogram figcapHistogram of Ozone histairqualityOzone colblue While looking into the package thanks for your work I fixed a few typos in READMERmd and CONTRIBUTINGmd rmflight this relates to your problem in When rendering a document with R code in YAML with quotes like this rendering YAML fails with the warning pandoc warning WARNING Could not parse YAML metadata date r SysDate output redocredoc This works if the YAML if placed in single quotes date r SysDate output redocredoc This is because prior to knitting redoc wraps R code in span tags that include a quoted class If you render the document with cleanFALSE the preprocessed file will look like this date span classredoc idredocinlinecode r SysDatespan output redocredoc Currently working on a solution I previously used pandocstyle native spans which look like this but switched to HTML style because something was conflicting with those r SysDate redoc redocinlineccode The yaml package always defaults to writing single quotes so maybe I should always rewrite header YAML as single quotes to avoid this In any case using single quotes will temporarily solve the issue For a given header how can one set the option for highlightoutputs FALSE in the YAML itself title My Title author Robert M Flight Joshua M Mitchell Hunter NB Moseley date output redocredoc highlightoutputs FALSE Doesnt seem to work Per it would be helpful to check the version of Pandoc on package load at least in interacctive mode Run rmarkdownpandocversion and give an informative message if version is One could also use rmarkdownpandocexec to figure out if the Pandoc version is the one bundled with RStudio in which case the message can recommend updating RStudio