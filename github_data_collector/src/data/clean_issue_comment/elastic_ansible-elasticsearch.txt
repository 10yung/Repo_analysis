 downloading role elasticsearch owned by elastic WARNING elasticelasticsearch was NOT installed successfully Unable to compare role versions to determine the most recent version due to incompatible version formats Please contact the role author to resolve versioning conflicts or specify an explicit role version to install In the READMEmd its not explaine that to enable auth on the API you need esenablexpack esapibasicauthusername esapibasicauthpassword So to enable auth on the API you have to set this esenablexpack true esapibasicauthusername elastic esapibasicauthpassword MyPassword It will be nice to add this block in the READMEmd to save time of Adsys Thank you I took MikeBairdRocks idea in and made it work It would be awesome to provide tasks that require some orchestration like rolling cluster upgrades adding nodes etc related to Please read the guidelines below Issues that do not follow these guidelines are likely to be closed GitHub is reserved for bug reports and feature requests The best place to ask a general question is at the Elastic forums GitHub is not the place for general questions Is this bug report or feature request for a supported OS If not it is likely to be closed See Please fill out EITHER the feature request block or the bug report block below and delete the other block Feature request Describe the feature NA Bug report Elasticsearch version In Task elasticsearchsecuritynativeyml there are several tasks using http protocol to contact newly set up ElasticSearch However if we set xpacksecurityenabled true and configure certificate properly the newly created ElasticSearch will use https to serve The url should be conditional url Error as below TASK elasticelasticsearch List Native Users fatal singlenode FAILED changed false content elapsed msg Status code was and not Connection failure connection was closed before a valid response was received redirected false status url Role version If using master please specify github sha JVM version java version NA OS version uname a if on a Unixlike system NA Description of the problem including expected versus actual behaviour NA Playbook Please specify the full playbook used to reproduce this issue NA Provide logs from Ansible NA ES Logs if relevant NA Hey guys Is there a reason to use always tag here Were rebuilding specific subsets of clusters with tagtargetting and this prevents this use case from happening with error like The error was ansibleosfamily is undefined unless we keep removingreadding ES role from playbooks constantly Bug report Attempting to install a cluster using authentication but the readme is very unclear or what to set Taking the vars listed in the readme just keeps failing Ive seen a similar issue on here but his request wasnt replied to and autoclosed Is esapibasicauthusername and esapibasicauthpassword creating credentials or does it require existing ones Its very confusing Elasticsearch version Role version df da b c e d fb a f d bf OS version Linux elastic azure Ubuntu SMP Mon Nov UTC x x x GNULinux Description of the problem including expected versus actual behaviour Playbook Please specify the full playbook used to reproduce this issue hosts masternodes roles role elasticelasticsearch vars esheapsize heapsize esconfig clustername clustername clusterinitialmasternodes elastic discoveryseedhosts elastic httpport nodedata false nodemaster true bootstrapmemorylock false networkhost somehost esplugins plugin ingestattachment esxpackfeatures alertingmonitoringgraphsecurityml esapibasicauthusername myuser esapibasicauthpassword somepassword esversion esusers native myuser password somepassword roles admin Provide logs from Ansible TASK elasticelasticsearch List Native Users fatal FAILED changed false content error rootcause type securityexception reason failed to authenticate user myuser header WWWAuthenticate Basic realm security charset UTF type securityexception reason failed to authenticate user myuser header WWWAuthenticate Basic realm security charset UTF status contentlength contenttype applicationjson charsetUTF elapsed json error header WWWAuthenticate Basic realm security charset UTF reason failed to authenticate user myuser rootcause header WWWAuthenticate Basic realm security charset UTF reason failed to authenticate user myuser type securityexception type securityexception status msg Status code was and not HTTP Error Unauthorized redirected false status url wwwauthenticate Basic realm security charset UTF OK it seems that VERSION x in the Makefile isnt forwarded to kitchen as environment variable however if you override that variable with make VERSION x it is forwarded to kitchen Ill work on a fix for that Originally posted by jmlrt in 