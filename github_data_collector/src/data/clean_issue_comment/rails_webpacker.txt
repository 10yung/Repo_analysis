Hello Everyone Im having issues pushing to Heroku As requested jakeNiemiec Im opening a new issue and posting as much code as possible Status I recently implemented webpacker into an existing older program I followed the instructions for installing webpacker installed all the dependencies I think and updated In development my code runs fine with no issues My styles JS remotes and Mapbox function properly Issue When attempting to push to Heroku my app fails to compile I have several issues within the nodemodules but this seems to be a symptom of the issue not the issue itself CODE here is the failed Heroku build log Ruby app detected Compiling RubyRails Using Ruby version ruby Removing BUNDLED WITH version in the Gemfilelock Installing dependencies using bundler Running bundle install without developmenttest path vendorbundle binstubs vendorbundlebin j deployment The dependency tzinfodata will be unused by any of the platforms Bundler is installing for Bundler is installing for ruby but the dependency is only for x mingw x mswin x mingw java To add those platforms to the bundle run bundle lock addplatform x mingw x mswin x mingw java Fetching gem metadata from Fetching gem metadata from Fetching gem metadata from Fetching rake Installing rake Fetching concurrentruby Fetching minitest Using threadsafe Fetching builder Installing builder Installing minitest Installing concurrentruby Using erubis Fetching miniportile Fetching crass Installing miniportile Installing crass Fetching rack Installing rack Using nio r Using websocketextensions Using minimime Using arel Using execjs Using awscfsigner Using bcrypt Using rbfsevent Using ffi Fetching methodsource Installing methodsource Fetching thor Installing thor Using bundler Using mimetypesdata Using unfext Using netrc Using coffeescriptsource Using ormadapter Fetching geocoder Installing geocoder Using multijson Using pg Using puma Using railsassetsplugin Using tilt Using turbolinkssource Using willpaginate Fetching tzinfo Fetching i n Using websocketdriver Using mail Using autoprefixerrails Using uglifier Using rbinotify Fetching nokogiri Installing i n Installing tzinfo Using racktest Using warden Fetching rackproxy Installing rackproxy Using sprockets Using mimetypes Using unf Using coffeescript Using figaro Using turbolinks Using sasslisten Using domainname Using sass Using httpcookie Using bootstrapsass Using fontawesomesass Using restclient Using cloudinary Using activesupport Using globalid Using activemodel Using jbuilder Using pundit Using activerecord Using carrierwave Using activejob Installing nokogiri with native extensions Fetching loofah Using railsdomtesting Installing loofah Fetching railshtmlsanitizer Installing railshtmlsanitizer Using actionview Using actionpack Using actioncable Using actionmailer Using railties Using sprocketsrails Using simpleform Using momentjsrails Using coffeerails Using responders Using jqueryrails Using rails Using sassrails Fetching webpacker Using bootstrap datetimepickerrails Using devise Using simplecalendar Installing webpacker Bundle complete Gemfile dependencies gems now installed Gems in the groups development and test were not installed Bundled gems are installed into vendorbundle Removing loofah Removing nokogiri Removing rack Removing i n Removing minitest Removing concurrentruby Removing tzinfo Removing railshtmlsanitizer Removing miniportile Removing methodsource Removing crass Removing thor Removing builder Removing rake Bundle completed s Cleaning up the bundler cache The dependency tzinfodata will be unused by any of the platforms Bundler is installing for Bundler is installing for ruby but the dependency is only for x mingw x mswin x mingw java To add those platforms to the bundle run bundle lock addplatform x mingw x mswin x mingw java Installing nodev linuxx Installing yarnv Detecting rake tasks Preparing app for Rails asset pipeline Running rake assetsprecompile I T INFO Writing tmpbuildfe e dd e e d df e a e publicassetsapplication c d eec a e fd cae a cfbc bb e c bc e b fe c d js I T INFO Writing tmpbuildfe e dd e e d df e a e publicassetsapplication c d eec a e fd cae a cfbc bb e c bc e b fe c d jsgz I T INFO Writing tmpbuildfe e dd e e d df e a e publicassetsapplication fdd b dd f a cdf f ab f a d f c bedbe b css I T INFO Writing tmpbuildfe e dd e e d df e a e publicassetsapplication fdd b dd f a cdf f ab f a d f c bedbe b cssgz yarn install v warning packagejson No license field warning No license field Resolving packages Fetching packages info fsevents The platform linux is incompatible with this module info fsevents is an optional dependency and failed compatibility check Excluding it from installation Linking dependencies warning railswebpacker postcsscssnext has unmet peer dependency caniuselite warning webpackdevserver has unmet peer dependency webpack warning webpackdevserver webpackdevmiddleware has unmet peer dependency webpack Building fresh packages Done in s Webpacker is installed Using tmpbuildfe e dd e e d df e a e configwebpackeryml file for setting up webpack paths Compiling Compilation failed Hash f e cff f d e Version webpack Time ms Asset Size Chunks Chunk Names map d ba ae jsmap kB emitted map application c e b fb djs kB emitted big application map d ba ae js bytes emitted map stylesheetsapplication a b fa c d ba c b aeb cbd css bytes emitted stylesheetsapplication application c e b fb djsmap MB emitted application stylesheetsapplicationc a edf f aa jsmap kB emitted stylesheetsapplication stylesheetsapplicationc a edf f aa js bytes emitted stylesheetsapplication manifestjson bytes emitted stylesheetsapplicationc a edf f aa jsgz bytes emitted map d ba ae jsgz bytes emitted manifestjsongz bytes emitted application c e b fb djsgz kB emitted appjavascriptpacksapplicationjs bytes built webpackbuildinglobaljs bytes built appjavascriptpluginsinitmapboxjs kB built appjavascriptpacksmapjs bytes built appjavascriptpacksstylesheetsapplicationscss bytes built nodemodulescssloaderref nodemodulespostcssloaderlibref nodemodulessassloaderlibloaderjsref appjavascriptpacksstylesheetsapplicationscss bytes built hidden modules ERROR in nodemodulesmapboxgldistmapboxglcss Module build failed ModuleBuildError Module build failed TypeError Cannot read property toFixed of undefined at strongRound tmpbuildfe e dd e e d df e a e nodemodulessvgopluginsconvertPathDatajs at tmpbuildfe e dd e e d df e a e nodemodulessvgopluginsconvertPathDatajs at Arrayfilter anonymous at filters tmpbuildfe e dd e e d df e a e nodemodulessvgopluginsconvertPathDatajs at Objectexportsfn tmpbuildfe e dd e e d df e a e nodemodulessvgopluginsconvertPathDatajs at tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at Arrayfilter anonymous at monkeys tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at Arrayfilter anonymous at monkeys tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at perItem tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at ArrayforEach anonymous at moduleexports tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgojs at SAXParsersaxonend tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgosvg jsjs at emit tmpbuildfe e dd e e d df e a e nodemodulessaxlibsaxjs at end tmpbuildfe e dd e e d df e a e nodemodulessaxlibsaxjs at SAXParserwrite tmpbuildfe e dd e e d df e a e nodemodulessaxlibsaxjs at SAXParserclose tmpbuildfe e dd e e d df e a e nodemodulessaxlibsaxjs at moduleexports tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgosvg jsjs at moduleexportsSVGOoptimizeOnce tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgojs at moduleexportsSVGOoptimize tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgojs at tmpbuildfe e dd e e d df e a e nodemodulespostcsssvgodistindexjs at new Promise anonymous at tmpbuildfe e dd e e d df e a e nodemodulespostcsssvgodistindexjs at walk tmpbuildfe e dd e e d df e a e nodemodulespostcssvalueparserlibwalkjs at ValueParserwalk tmpbuildfe e dd e e d df e a e nodemodulespostcssvalueparserlibindexjs at minifyPromise tmpbuildfe e dd e e d df e a e nodemodulespostcsssvgodistindexjs at runLoaders tmpbuildfe e dd e e d df e a e nodemoduleswebpacklibNormalModulejs at tmpbuildfe e dd e e d df e a e nodemodulesloaderrunnerlibLoaderRunnerjs at tmpbuildfe e dd e e d df e a e nodemodulesloaderrunnerlibLoaderRunnerjs at contextcallback tmpbuildfe e dd e e d df e a e nodemodulesloaderrunnerlibLoaderRunnerjs at Objectanonymous tmpbuildfe e dd e e d df e a e nodemodulescssloaderlibloaderjs at tmpbuildfe e dd e e d df e a e nodemodulescssloaderlibprocessCssjs nodemodulesmapboxgldistmapboxglcss appjavascriptpacksapplicationjs ERROR in nodemodulescssloaderref nodemodulespostcssloaderlibref nodemodulesmapboxgldistmapboxglcss Module build failed TypeError Cannot read property toFixed of undefined at strongRound tmpbuildfe e dd e e d df e a e nodemodulessvgopluginsconvertPathDatajs at tmpbuildfe e dd e e d df e a e nodemodulessvgopluginsconvertPathDatajs at Arrayfilter anonymous at filters tmpbuildfe e dd e e d df e a e nodemodulessvgopluginsconvertPathDatajs at Objectexportsfn tmpbuildfe e dd e e d df e a e nodemodulessvgopluginsconvertPathDatajs at tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at Arrayfilter anonymous at monkeys tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at Arrayfilter anonymous at monkeys tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at perItem tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at ArrayforEach anonymous at moduleexports tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgojs at SAXParsersaxonend tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgosvg jsjs at emit tmpbuildfe e dd e e d df e a e nodemodulessaxlibsaxjs at end tmpbuildfe e dd e e d df e a e nodemodulessaxlibsaxjs at SAXParserwrite tmpbuildfe e dd e e d df e a e nodemodulessaxlibsaxjs at SAXParserclose tmpbuildfe e dd e e d df e a e nodemodulessaxlibsaxjs at moduleexports tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgosvg jsjs at moduleexportsSVGOoptimizeOnce tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgojs at moduleexportsSVGOoptimize tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgojs at tmpbuildfe e dd e e d df e a e nodemodulespostcsssvgodistindexjs at new Promise anonymous at tmpbuildfe e dd e e d df e a e nodemodulespostcsssvgodistindexjs at walk tmpbuildfe e dd e e d df e a e nodemodulespostcssvalueparserlibwalkjs at ValueParserwalk tmpbuildfe e dd e e d df e a e nodemodulespostcssvalueparserlibindexjs at minifyPromise tmpbuildfe e dd e e d df e a e nodemodulespostcsssvgodistindexjs nodemodulesmapboxgldistmapboxglcss appjavascriptpacksapplicationjs Child extracttextwebpackplugin nodemodulesextracttextwebpackplugindist nodemodulescssloaderindexjsref nodemodulespostcssloaderlibindexjsref nodemodulesmapboxgldistmapboxglcss module ERROR in nodemodulescssloaderref nodemodulespostcssloaderlibref nodemodulesmapboxgldistmapboxglcss Module build failed TypeError Cannot read property toFixed of undefined at strongRound tmpbuildfe e dd e e d df e a e nodemodulessvgopluginsconvertPathDatajs at tmpbuildfe e dd e e d df e a e nodemodulessvgopluginsconvertPathDatajs at Arrayfilter anonymous at filters tmpbuildfe e dd e e d df e a e nodemodulessvgopluginsconvertPathDatajs at Objectexportsfn tmpbuildfe e dd e e d df e a e nodemodulessvgopluginsconvertPathDatajs at tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at Arrayfilter anonymous at monkeys tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at Arrayfilter anonymous at monkeys tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at perItem tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at ArrayforEach anonymous at moduleexports tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgopluginsjs at tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgojs at SAXParsersaxonend tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgosvg jsjs at emit tmpbuildfe e dd e e d df e a e nodemodulessaxlibsaxjs at end tmpbuildfe e dd e e d df e a e nodemodulessaxlibsaxjs at SAXParserwrite tmpbuildfe e dd e e d df e a e nodemodulessaxlibsaxjs at SAXParserclose tmpbuildfe e dd e e d df e a e nodemodulessaxlibsaxjs at moduleexports tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgosvg jsjs at moduleexportsSVGOoptimizeOnce tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgojs at moduleexportsSVGOoptimize tmpbuildfe e dd e e d df e a e nodemodulessvgolibsvgojs at tmpbuildfe e dd e e d df e a e nodemodulespostcsssvgodistindexjs at new Promise anonymous at tmpbuildfe e dd e e d df e a e nodemodulespostcsssvgodistindexjs at walk tmpbuildfe e dd e e d df e a e nodemodulespostcssvalueparserlibwalkjs at ValueParserwalk tmpbuildfe e dd e e d df e a e nodemodulespostcssvalueparserlibindexjs at minifyPromise tmpbuildfe e dd e e d df e a e nodemodulespostcsssvgodistindexjs Child extracttextwebpackplugin nodemodulesextracttextwebpackplugindist nodemodulescssloaderindexjsref nodemodulespostcssloaderlibindexjsref nodemodulessassloaderlibloaderjsref appjavascriptpacksstylesheetsapplicationscss nodemodulescssloaderref nodemodulespostcssloaderlibref nodemodulessassloaderlibloaderjsref appjavascriptpacksstylesheetsapplicationscss bytes built hidden module Precompiling assets failed Push rejected failed to compile Ruby app Push failed packagejson dependencies railswebpacker bootstrap jquery mapboxgl popperjs devDependencies webpackdevserver babelconfigjs moduleexports functionapi var validEnv development test production var currentEnv apienv var isDevelopmentEnv apienvdevelopment var isProductionEnv apienvproduction var isTestEnv apienvtest if validEnvincludescurrentEnv throw new Error Please specify a valid NODEENV or BABELENV environment variables Valid values are development test and production Instead received JSONstringifycurrentEnv return presets isTestEnv babelpresetenv targets node current isProductionEnv isDevelopmentEnv babelpresetenv forceAllTransforms true useBuiltIns entry corejs modules false exclude transformtypeofsymbol filterBoolean plugins babelpluginmacros babelpluginsyntaxdynamicimport isTestEnv babelplugindynamicimportnode babelplugintransformdestructuring babelpluginproposalclassproperties loose true babelpluginproposalobjectrestspread useBuiltIns true babelplugintransformruntime helpers false regenerator true corejs false babelplugintransformregenerator async false filterBoolean configwebpackenvironmentjs const environment requirerailswebpacker Bootstrap has a dependency over jQuery Popperjs const webpack requirewebpack environmentpluginsprependProvide new webpackProvidePlugin jquery jQuery jquery Popper popperjs default moduleexports environment webpackeryml Note You must restart binwebpackdevserver for changes to take effect default default sourcepath appjavascript sourceentrypath packs publicoutputpath packs cachepath tmpcachewebpacker webpackcompileoutput false Additional paths webpack should lookup modules appassets enginefooappassets resolvedpaths appassets Reload manifestjson on all requests so we reload latest compiled packs cachemanifest false extensions js sass scss css modulesass modulescss modulecss png svg gif jpeg jpg development default compile true Reference devserver https false host localhost port public localhost hmr false Inline should be set to true if using HMR inline true overlay true compress true disablehostcheck true uselocalip false quiet false headers AccessControlAllowOrigin watchoptions ignored nodemodules test default compile true Compile test packs to a separate directory publicoutputpath packstest production default Production depends on precompilation of packs prior to booting for performance compile false Cache manifestjson for performance cachemanifest true appjavascriptpacksapplicationjs import bootstrap import bootstrapdistcssbootstrapmincss import mapboxgldistmapboxglcss import initMapbox from pluginsinitmapbox initMapbox appjavascriptpluginsinitmapboxjs appjavascriptpluginsinitmapboxjs import mapboxgl from mapboxgl const mapElement documentgetElementByIdmap const buildMap mapboxglaccessToken mapElementdatasetmapboxApiKey return new mapboxglMap container map style mapboxstylesmapboxstreetsv const addMarkersToMap map markers markersforEachmarker new mapboxglMarker setLngLat markerlng markerlat addTomap const fitMapToMarkers map markers const bounds new mapboxglLngLatBounds markersforEachmarker boundsextend markerlng markerlat mapfitBoundsbounds padding maxZoom const initMapbox if mapElement const map buildMap const markers JSONparsemapElementdatasetmarkers addMarkersToMapmap markers fitMapToMarkersmap markers export initMapbox appviewlayoutsapplicationhtmlerb DOCTYPE html html head calls to appassetsstylesheetsapplicationscss stylesheetlinktag application stylesheetpacktag application script defer src integritysha slN GvtUJGnv ca v EzVaR DC QEwsIk q QXdCU Yu cktL szYlBbqmS crossoriginanonymousscript link relstylesheet href link relstylesheet href styleborder px solid red importantstyle head body render sharednavbar render sharedflashes div yield javascriptincludetag application from appassetsjavascriptsapplicationjs javascriptpacktag application from appjavascriptpacksapplicationjs div render sharedfooter body html Cheers everyone Running yarn audit fails on vulnerable nodesass Affected versions of nodesass are vulnerable to Denial of Service DoS Crafted objects passed to the renderSync function may trigger C assertions More information Environment variables such as WEBPACKERDEVSERVERHOST ie WEBPACKERDEVSERVEROPTION seems to work and be piped down to a fetch call ENV envprefixkeyupcase configdevserverfetchkey defaults key However I am attempting to turn on polling via environment variable which has extra scope on the hash it is watchoptions poll I believe fetch here would not work for fetching something like watchoptions poll Since this code would only fetch the first level option on the hash So my question is what is the most advisable way to have an env var like WEBPACKERDEVSERVERWATCHOPTIONSPOLLtrue respected as an override My suggestion is for multilevel hash getting we could use dig this would provide a way to break down the environment variable flattened key and then be able to enable a multilevel hash fetch Thoughts It appears that environmentpluginsgetManifestopts has changed to environmentpluginsgetManifestoptions This updates the testing docs to reflect this change Updates to containing this change related to this open bug Implements a new option for the yarn integrity check setting that allows users to configure webpacker to update andor install any outdated or missing packages The change is backwards compatible will the existing configuration options This PR is inspired by the fact that webpackers message upon integrity check failure tells the user what command they should run to rectify the issue Why not allow the user to set webpacker to perform the action automatically Note Ill be happy to update the documentation or tidy this up if there is interest in this feature Hot reload is not working for svelte and webpack at the time of writing It causes Cannot read property fragment of undefined component Turning it off solves the issue References Hi Ive noticed that webpacker produces publicly accessible nonfingerprinted manifestjson in the packs folder That is acceptable in a lot of circumstances but when you do something like js requirecontextimages true as suggested here it looks to me like allowing access to the index page of packsmediaimages What do you think about this Regarding the example babel config files Is this necessary and why the setting of targetsnodecurrent for test env only This is definitely related But I think its not necessary with newer versions of babel jest node etc And simpler is better generally js return presets isTestEnv babelpresetenv targets node current isProductionEnv isDevelopmentEnv babelpresetenv forceAllTransforms true useBuiltIns entry corejs modules false exclude transformtypeofsymbol img width alt src I think just adding this plugin for the test env would do the trick pluginspushbabelplugintransformmodulescommonjs minimum required nodejs version is 