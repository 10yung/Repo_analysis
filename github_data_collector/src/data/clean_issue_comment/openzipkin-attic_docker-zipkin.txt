Work in progress A test run of Travis CI illustrating the multiarch support there In a recent pull request to zipkin devinsba noticed we are using the debug distroless image We should be aware if this is adding heft to our based image which has grown substantially since moving off JDK In other repos we are starting to add RATIONALEmd and this could be a good thing to start with Problem Dashboard is empty data from zipkin is in Prometheus Setup k s cluster with zipkin prometheus helm and grafana helm I am using zipkintransporthttp to send data to zipkin Dashboard gnetId revision Zipkin deployment config on k s with Prometheus scraping configuration annotations prometheusioscrape true prometheusioport prometheusiopath actuatorprometheus spec containers name zipkin image openzipkinzipkin Example response produces by zipkin actuatorprometheus zipkincollectormessagestotaltransporthttp Dashboard is empty img width altScreenshot at src Data is in prometheus img width altScreenshot at src Example Messages received per transport Example query from dashboard sum bytransportratezipkincollectormessagestotaljobzipkininstanceinstances interval And seems i do not have jobzipkininstanceinstances So this would work ok sum bytransportratezipkincollectormessagestotal m In table view looks like this img width altScreenshot at src Job kubernetespods Seems somehow job and instance are missed Maybe I am missing something Thanks for the help Added Works ok with different labels Looks like it is a broad question at the end For example RabbitMQ has metrics like rabbitmqnodememused prefixed with rabbitmq dashboard So we should figure out how to cut images mostly for master but possibly for feature branches also This is just a dockerfile edit but maybe helpful to start elaborating what something real might look like cc openzipkindevopstooling Thanks for providing this useful container I have a question about two cassandra configs enablematerializedviews and enabletransientreplication It seems the official document does not recommend to enable them in production but but they are set to be enabled in etccassandracassandrayaml Shall we disable them Thanks Hi This is more a new feature we have an elasticsearch as aws service and a zipkin docker as kinesis collector for security concerns we need all data encrypted in elasticsearch is possible zipkin UI Decrypt the data with a public key kms aws I think this is a possible new feature Hi I am trying to connect Zipkin with elasticcos hosted solutions with user Id and password where I can specify credentials of elasticsearch I tried to use zipkincassandra using FinancialTimeszipkinhelm in my kubernetes cluster and cassandra never startup successfully because of SocketException It seems dockerContainerIp method doesnt work properly How can I fix this if not can you add some explicit env var configuration for host ip In kubernetes pod ip can be set in environment variable yaml name MYPODIP valueFrom fieldRef fieldPath statuspodIP environment aws kubernetes kops calico networking plain CompilerOracle dontinline orgapachecassandradbColumnsSerializerdeserializeLargeSubset LorgapachecassandraioutilDataInputPlusLorgapachecassandradbColumnsILorgapachecassandradbColumns CompilerOracle dontinline orgapachecassandradbColumnsSerializerserializeLargeSubset LjavautilCollectionILorgapachecassandradbColumnsILorgapachecassandraioutilDataOutputPlusV CompilerOracle dontinline orgapachecassandradbColumnsSerializerserializeLargeSubsetSize LjavautilCollectionILorgapachecassandradbColumnsII CompilerOracle dontinline orgapachecassandradbcommitlogAbstractCommitLogSegmentManageradvanceAllocatingFrom LorgapachecassandradbcommitlogCommitLogSegmentV CompilerOracle dontinline orgapachecassandradbtransformBaseIteratortryGetMoreContents Z CompilerOracle dontinline orgapachecassandradbtransformStoppingTransformationstop V CompilerOracle dontinline orgapachecassandradbtransformStoppingTransformationstopInPartition V CompilerOracle dontinline orgapachecassandraioutilBufferedDataOutputStreamPlusdoFlush IV CompilerOracle dontinline orgapachecassandraioutilBufferedDataOutputStreamPluswriteExcessSlow V CompilerOracle dontinline orgapachecassandraioutilBufferedDataOutputStreamPluswriteSlow JIV CompilerOracle dontinline orgapachecassandraioutilRebufferingInputStreamreadPrimitiveSlowly IJ CompilerOracle inline orgapachecassandradbrowsUnfilteredSerializerserializeRowBody LorgapachecassandradbrowsRowILorgapachecassandradbSerializationHeaderLorgapachecassandraioutilDataOutputPlusV CompilerOracle inline orgapachecassandraioutilMemorycheckBounds JJV CompilerOracle inline orgapachecassandraioutilSafeMemorycheckBounds JJV CompilerOracle inline orgapachecassandrautilsAsymmetricOrderingselectBoundary LorgapachecassandrautilsAsymmetricOrderingOpIII CompilerOracle inline orgapachecassandrautilsAsymmetricOrderingstrictnessOfLessThan LorgapachecassandrautilsAsymmetricOrderingOpI CompilerOracle inline orgapachecassandrautilsBloomFilterindexes LorgapachecassandrautilsIFilterFilterKey J CompilerOracle inline orgapachecassandrautilsBloomFiltersetIndexes JJIJ JV CompilerOracle inline orgapachecassandrautilsByteBufferUtilcompare LjavanioByteBuffer BI CompilerOracle inline orgapachecassandrautilsByteBufferUtilcompare BLjavanioByteBufferI CompilerOracle inline orgapachecassandrautilsByteBufferUtilcompareUnsigned LjavanioByteBufferLjavanioByteBufferI CompilerOracle inline orgapachecassandrautilsFastByteOperationsUnsafeOperationscompareTo LjavalangObjectJILjavalangObjectJII CompilerOracle inline orgapachecassandrautilsFastByteOperationsUnsafeOperationscompareTo LjavalangObjectJILjavanioByteBufferI CompilerOracle inline orgapachecassandrautilsFastByteOperationsUnsafeOperationscompareTo LjavanioByteBufferLjavanioByteBufferI CompilerOracle inline orgapachecassandrautilsvintVIntCodingencodeVInt JI B Exception orgapachecassandraexceptionsConfigurationException encountered during startup couldnt get host ip orgapachecassandraexceptionsConfigurationException couldnt get host ip at ZipkinConfigurationLoaderloadConfigZipkinConfigurationLoaderjava at orgapachecassandraconfigDatabaseDescriptorloadConfigDatabaseDescriptorjava at orgapachecassandraconfigDatabaseDescriptordaemonInitializationDatabaseDescriptorjava at orgapachecassandraserviceCassandraDaemonapplyConfigCassandraDaemonjava at orgapachecassandraserviceCassandraDaemonactivateCassandraDaemonjava at orgapachecassandraserviceCassandraDaemonmainCassandraDaemonjava Caused by javanetSocketException at javautilOptionalorElseThrowOptionaljava at ZipkinConfigurationLoaderdockerContainerIpZipkinConfigurationLoaderjava at ZipkinConfigurationLoaderloadConfigZipkinConfigurationLoaderjava more ERROR main CassandraDaemonjava Exception encountered during startup orgapachecassandraexceptionsConfigurationException couldnt get host ip at ZipkinConfigurationLoaderloadConfigZipkinConfigurationLoaderjava mainna at orgapachecassandraconfigDatabaseDescriptorloadConfigDatabaseDescriptorjava apachecassandra jar at orgapachecassandraconfigDatabaseDescriptordaemonInitializationDatabaseDescriptorjava apachecassandra jar at orgapachecassandraserviceCassandraDaemonapplyConfigCassandraDaemonjava apachecassandra jar at orgapachecassandraserviceCassandraDaemonactivateCassandraDaemonjava apachecassandra jar at orgapachecassandraserviceCassandraDaemonmainCassandraDaemonjava apachecassandra jar Caused by javanetSocketException null at javautilOptionalorElseThrowOptionaljava na at ZipkinConfigurationLoaderdockerContainerIpZipkinConfigurationLoaderjava mainna at ZipkinConfigurationLoaderloadConfigZipkinConfigurationLoaderjava mainna common frames omitted According to dsyer listing config locations can speed up things that otherwise require scanning I tried this and it took off a couple hundred ms from the latest image bash docker run d p openzipkinzipkin java cp orgspringframeworkbootloaderPropertiesLauncher springconfiglocationfileBOOTINFclasseszipkinserverymlfileBOOTINFclasseszipkinserversharedyml before Started ZipkinServer in seconds JVM running for after Started ZipkinServer in seconds JVM running for Trick is that you have to list out the exact paths this would require us finding them for our modules such as scribe kafka and also layered images like zipkinaws and zipkingcp However they are in static locations so mostly this is composing env variables I suppose cc openzipkindevopstooling zipkin The issue is that related to javascript when zipkin received data from HystrixStreamTask solved by spring sleuth sampler probability scheduled skipPattern orgspringframeworkcloudnetflixhystrixstreamHystrixStreamTask But this not solved broker into zipkin img width altscreen shot at pm src trace json from localhost apiv tracesserviceNameaccountservice limit traceIdd b a b parentIdd b a b ideb d b af a kindCONSUMER timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceIdd b a b parentIdeb d b af a id d c c namehandle timestamp duration localEndpoint serviceNameaccountservice ipv traceIdd b a b idd b a b kindPRODUCER namesend timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceId c c f ac parentId c c f ac id e be d kindCONSUMER timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceId c c f ac parentId e be d id a f namehandle timestamp duration localEndpoint serviceNameaccountservice ipv traceId c c f ac id c c f ac kindPRODUCER namesend timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceIdd c c db e parentIdd c c db e id d ba fd fe b kindCONSUMER timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceIdd c c db e parentId d ba fd fe b ide ee d c namehandle timestamp duration localEndpoint serviceNameaccountservice ipv traceIdd c c db e idd c c db e kindPRODUCER namesend timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceId bb c parentId bb c id a e fba kindCONSUMER timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceId bb c parentId a e fba ida bd b a a de namehandle timestamp duration localEndpoint serviceNameaccountservice ipv traceId bb c id bb c kindPRODUCER namesend timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceIdc e a parentIdc e a id f f b f ad f kindCONSUMER timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceIdc e a parentId f f b f ad f ide a b a namehandle timestamp duration localEndpoint serviceNameaccountservice ipv traceIdc e a idc e a kindPRODUCER namesend timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceIde d fe parentIde d fe idc f e kindCONSUMER timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceIde d fe parentIdc f e idb a b be namehandle timestamp duration localEndpoint serviceNameaccountservice ipv traceIde d fe ide d fe kindPRODUCER namesend timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceIdef b d d fb parentIdef b d d fb id a df e cb kindCONSUMER timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceIdef b d d fb parentId a df e cb idfa b a cc namehandle timestamp duration localEndpoint serviceNameaccountservice ipv traceIdef b d d fb idef b d d fb kindPRODUCER namesend timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceId f f d a parentId f f d a id cbffc c ccf e kindCONSUMER timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceId f f d a parentId cbffc c ccf e idbf a ede namehandle timestamp duration localEndpoint serviceNameaccountservice ipv traceId f f d a id f f d a kindPRODUCER namesend timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceId b d a a parentId b d a a id ab ce f a kindCONSUMER timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceId b d a a parentId ab ce f a idd c d f ad namehandle timestamp duration localEndpoint serviceNameaccountservice ipv traceId b d a a id b d a a kindPRODUCER namesend timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceIdb cf e db e parentIdb cf e db e idc e f f kindCONSUMER timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput traceIdb cf e db e parentIdc e f f idc c e ed c f b namehandle timestamp duration localEndpoint serviceNameaccountservice ipv traceIdb cf e db e idb cf e db e kindPRODUCER namesend timestamp duration localEndpoint serviceNameaccountservice ipv remoteEndpoint serviceNamebroker tags channelhystrixStreamOutput 