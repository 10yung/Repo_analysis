 Pull Request PR description This PR updates the module to use the new CI process This Pull Request PR fixes the following issues Fixes Task list x Added an entry under the Unreleased section of the change log in the CHANGELOGmd Entry should say what was changed and how that affects users if applicable x Resource documentation addedupdated in READMEmd in resource folder x Resource parameter descriptions addedupdated in schemamof and commentbased help x Commentbased help addedupdated x Localization strings addedupdated in all localization files as appropriate x Examples appropriately addedupdated x Unit tests addedupdated See DSC Resource Testing Guidelines x Integration tests addedupdated where possible See DSC Resource Testing Guidelines x Newchanged code adheres to DSC Resource Style Guidelines and Best Practices johlju would you mind reviewing this one when you have time Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend Since being migrated to the DSC Community this module must be updated to use the new CI process and repository structure Details of the scenario you tried and the problem that is occurring Disabling netbios generates an error if the adapter is disabled TestDSCConfiguration determines the status appropriately but StartDSCConfiguration errors out when the adapter is disabled Verbose logs showing the problem From output when running startdscConfiguration PowerShell DSC resource MSFTNetBios failed to execute SetTargetResource functionality with error message SystemInvalidOperationException An error result of was returned when attemting to set NetBIOS configuration to Disable CategoryInfo InvalidOperation CimException FullyQualifiedErrorId ProviderOperationExecutionFailure PSComputerName localhost From Event Log Log Name MicrosoftWindowsDSCOperational Source MicrosoftWindowsDSC Date PM Event ID Task Category None Level Error Keywords User SYSTEM Computer Obfuscatedcontosocom Description Job DE EA D D A B Message SystemInvalidOperationException An error result of was returned when attemting to set NetBIOS configuration to Disable HResult StackTrack at SystemManagementAutomationRunspacesPipelineBaseInvokeIEnumerable input at SystemManagementAutomationPowerShellWorkerConstructPipelineAndDoWorkRunspace rs Boolean performSyncInvoke at SystemManagementAutomationPowerShellWorkerCreateRunspaceIfNeededAndDoWorkRunspace rsToUse Boolean isSync at SystemManagementAutomationPowerShellCoreInvokeHelper TInputTOutput PSDataCollection input PSDataCollection output PSInvocationSettings settings at SystemManagementAutomationPowerShellCoreInvoke TInputTOutput PSDataCollection input PSDataCollection output PSInvocationSettings settings at SystemManagementAutomationPowerShellInvokeIEnumerable input PSInvocationSettings settings at MicrosoftPowerShellDesiredStateConfigurationInternalResourceProviderAdapterExecuteCommandPowerShell powerShell ResourceModuleInfo resInfo String operationCmd List acceptedProperties CimInstance nonResourcePropeties CimInstance resourceConfiguration LCMDebugMode debugMode PSInvocationSettings pSInvocationSettings UInt resultStatusHandle Collection result ErrorRecord errorRecord PSModuleInfo localRunSpaceModuleInfo The DSC configuration that is used to reproduce the issue as detailed as possible powershell Configuration Test CmdletBinding ImportDSCResource ModuleName NetworkingDsc ModuleVersion NetBios Test InterfaceAlias SampleAlias Setting Disable The operating system the target node is running Server R Datacenter bit WindowsBuildLabEx amd frewinblueltsbescrow OsLanguage enUS OsMuiLanguages enUS Version and build of PowerShell the target node is running Powershell Version of the DSC module that was used dev if using current dev branch ModuleVersion Details of the scenario you tried and the problem that is occurring Enable the PolicyStore parameter to be specified to permit targeting the local group policy store of the machine as well as the default persistent store when using both the Firewall and FirewallProfile resources Verbose logs showing the problem New Feature request Suggested solution to the issue Add policystore as a DSC property for both Firewall and FirewallProfile resources Set the default value of the policystore parameter to be persistentstore to make it a nonbreaking change and accommodate all existing configurations Add policystore parameter to GetSetTestTargetResource functions in both Resources GetFirewallRule and GetFirewalRulleProperty helper functions in Firewall resource GetSetNewNetFirewallRule commands in Firewall resource GetSetNetFirewallProfile commands in FirewallProfile resource The DSC configuration that is used to reproduce the issue as detailed as possible New Feature request The operating system the target node is running Server New Feature request Version and build of PowerShell the target node is running New Feature request Version of the DSC module that was used dev if using current dev branch dev I have made and tested the required changes and can happily submit a pull request with the updates to the code and localization strings I have also added two Pester tests to the Firewall resources for the helper function GetFirewallRule when the policystore is specified and the firewall rule is presentabsent Your feedback and support is greatly appreciated thanks for contributing ISSUE TITLE Please prefix the issue title with the resource name eg ResourceName Short description of my issue ISSUE DESCRIPTION this template Please provide information regarding your issue under each header below Write NA under any headers that do not apply to your issue or if the information is not available NOTE Sensitive information should be obfuscated PLEASE KEEP THE HEADERS You may remove this comment block and the other comment blocks but please keep the headers Details of the scenario you tried and the problem that is occurring I need to ensure that the DNS client does not try to register the interface connection while having no DNS specific suffixes Verbose logs showing the problem When not providing the DnsConnectionSuffix parameter the error occurs when compiling the MOF powershell PSDesiredStateConfiguration Node At line char DnsConnectionSuffix LAN Resource DnsConnectionSuffix requires that a value of type String be provided for property ConnectionSpecificSuffix At C Program Files WindowsPowerShell DscService Scripts NewDscConfigurationps char Node AllNodesNodeName CategoryInfo ParserError PSDesiredStateConfiguration node ParentContainsErrorRecordException FullyQualifiedErrorId MissingValueForMandatoryPropertyPSDesiredStateConfiguration node When providing an empty DnsConnectionSuffix parameter an error occurs when the MOF is applied on computer powershell Could not find mandatory property ConnectionSpecificSuffix Add this property and try again CategoryInfo ObjectNotFound rootMicrosoftgurationManagerString CimException FullyQualifiedErrorId MI RESULT Suggested solution to the issue The resource should not be dependent on the connection suffix but on the interface alias With the command line the registration can be disabled whether the interface has or has not a connection specific suffix powershell GetNetIPInterface SetDnsClient RegisterThisConnectionsAddress false The DSC configuration that is used to reproduce the issue as detailed as possible YAML format for Datum powershell NetworkingDsc DnsConnectionSuffix InterfaceAlias LAN RegisterThisConnectionsAddress False UseSuffixWhenRegistering False The operating system the target node is running Please provide as much as possible about the target node for example edition version build and language On OS with WMF the following command can help get this information GetComputerInfo Property OsName OsOperatingSystemSKU OSArchitecture WindowsVersion WindowsBuildLabEx OsLanguage OsMuiLanguages powershell OsName Microsoft Windows Server Datacenter OsOperatingSystemSKU DatacenterServerEdition OsArchitecture bit WindowsBuildLabEx amd frers release OsLanguage enUS OsMuiLanguages enUS powershell OsName Microsoft Windows Server Datacenter OsOperatingSystemSKU DatacenterServerEdition OsArchitecture bit WindowsVersion WindowsBuildLabEx amd frers release OsLanguage enUS OsMuiLanguages enUS Version and build of PowerShell the target node is running To help with this information please run this command PSVersionTable powershell PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion powershell PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion Version of the DSC module that was used dev if using current dev branch powershell Name NetworkingDsc Path C Program Files WindowsPowerShell Modules NetworkingDsc NetworkingDscpsd Description Module with DSC Resources for Networking area ModuleType Manifest Version Your feedback and support is greatly appreciated thanks for contributing ISSUE TITLE Please prefix the issue title with the resource name eg ResourceName Short description of my issue ISSUE DESCRIPTION this template Please provide information regarding your issue under each header below Write NA under any headers that do not apply to your issue or if the information is not available NOTE Sensitive information should be obfuscated PLEASE KEEP THE HEADERS You may remove this comment block and the other comment blocks but please keep the headers Details of the scenario you tried and the problem that is occurring I am trying to configure an interface profile to LocalNetwork but the resource does not find the CIM object Verbose logs showing the problem TimeCreated ProviderName MicrosoftWindowsDSC Id Message Job F FF E AF A This event indicates that a nonterminating error was thrown when DSCEngine was executing SetTargetResource on MSFTNetConnectionProfile DSC resource FullyQualifiedErrorId is CmdletizationQueryNotFoundSetNetConnectionProfile Error Message is No matching MSFTNetConnectionProfile objects found by CIM query for instances of the rootStandardCimv MSFTNetConnectionProfile class on the CIM server SELECT FROM MSFTNetConnectionProfile WHERE InterfaceAlias LIKE LAN AND IPv Connectivity AND IPv Connectivity Verify query parameters and retry Suggested solution to the issue So far I understand the error message the resource is searching for an interface named LAN which has IPv and IPv set as LocalNetwork However the conectivity type LocalNetwork is not the value the resource should be searching for but instead it shoud set it Searching an interface named LAN and setting it to LocalNetwork is the goal The DSC configuration that is used to reproduce the issue as detailed as possible YAML format for Datum powershell NetworkingDsc NetConnectionProfile InterfaceAlias LAN IPv Connectivity LocalNetwork IPv Connectivity LocalNetwork NetworkCategory Private The operating system the target node is running Please provide as much as possible about the target node for example edition version build and language On OS with WMF the following command can help get this information GetComputerInfo Property OsName OsOperatingSystemSKU OSArchitecture WindowsVersion WindowsBuildLabEx OsLanguage OsMuiLanguages OsName Microsoft Windows Server Datacenter OsOperatingSystemSKU DatacenterServerEdition OsArchitecture bit WindowsVersion WindowsBuildLabEx amd frers release OsLanguage enUS OsMuiLanguages enUS Version and build of PowerShell the target node is running To help with this information please run this command PSVersionTable PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion Version of the DSC module that was used dev if using current dev branch Name NetworkingDsc Path C Program Files WindowsPowerShell Modules NetworkingDsc NetworkingDscpsd Description Module with DSC Resources for Networking area ModuleType Manifest Version Pull Request PR description Fixed Network Adapter renaming This Pull Request PR fixes the following issues Fixes Task list x Added an entry under the Unreleased section of the change log in the CHANGELOGmd Entry should say what was changed and how that affects users if applicable Resource documentation addedupdated in READMEmd in resource folder Resource parameter descriptions addedupdated in schemamof and commentbased help Commentbased help addedupdated Localization strings addedupdated in all localization files as appropriate Examples appropriately addedupdated x Unit tests addedupdated See DSC Resource Testing Guidelines Integration tests addedupdated where possible See DSC Resource Testing Guidelines Newchanged code adheres to DSC Resource Style Guidelines and Best Practices Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend Details of the scenario you tried and the problem that is occurring I apply the same configuration on Windows GUI Windows Core Windows GUI and Windows Core DSC modules like cChoco are working fine as soon as the proxy configuration has been set set via the ProxySettings resource of the NetworkingDsc module except for Core servers Suggested solution to the issue Currently the ProxySettings resource is applying proxy settings on this registry key HKLM SOFTWARE Microsoft Windows CurrentVersion Internet Settings Connections It does also apply successfully these settings on the same key on Core servers though it has no effect However when I manually apply the same values on the system account it works fine on Core servers too after a computer restart or a new DSC pull session Here is the key where I apply the configuration registryHKEYUSERS S Software Microsoft Windows CurrentVersion Internet Settings Connections The proxy configuration should be added to this registry key too in order to make it functioning on Core servers and not only GUI servers The operating system the target node is running Please provide as much as possible about the target node for example edition version build and language On OS with WMF the following command can help get this information GetComputerInfo Property OsName OsOperatingSystemSKU OSArchitecture WindowsVersion WindowsBuildLabEx OsLanguage OsMuiLanguages OsName Microsoft Windows Server Datacenter OsOperatingSystemSKU DatacenterServerEdition OsArchitecture bit WindowsVersion WindowsBuildLabEx amd frers release OsLanguage enUS OsMuiLanguages enUS OsName Microsoft Windows Server Datacenter OsOperatingSystemSKU DatacenterServerEdition OsArchitecture bit WindowsBuildLabEx amd frers release OsLanguage enUS OsMuiLanguages enUS Version and build of PowerShell the target node is running To help with this information please run this command PSVersionTable PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion Version of the DSC module that was used dev if using current dev branch Details of the scenario you tried and the problem that is occurring If you try to enable a predefined rule that does not already exist than instead you end up with a wide open rule permitting all traffic inbound This could potentially cause security holes to someone that does not notice Firewall export of the rule as CSV RemoteFwAdminInTCPAllYesAllowNoAnyAnyAnyAnyAnyAnyAnyAnyAnyAnyAnyAny Verbose logs showing the problem Suggested solution to the issue Perhaps send an error to the user indicating that the builtin rule they are trying to use does not exist and do not create a wide open rule The DSC configuration that is used to reproduce the issue as detailed as possible powershell Configuration FirewallEnableBuiltInFirewallRuleConfig ImportDSCResource ModuleName NetworkingDsc Node localhost Firewall EnableBuiltInFirewallRule Name RemoteFwAdminInTCP Ensure Present Enabled True insert configuration here instance of MSFTFirewall as MSFTFirewall ref ResourceID Firewall RemoteFwAdminInTCP Enabled True Ensure Present Name RemoteFwAdminInTCP ModuleName NetworkingDSC ModuleVersion The operating system the target node is running OsName Microsoft Windows Server Standard OsOperatingSystemSKU StandardServerEdition OsArchitecture bit WindowsBuildLabEx amd frers release OsLanguage enUS OsMuiLanguages enUS Version and build of PowerShell the target node is running Name Value PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion Version of the DSC module that was used dev if using current dev branch ModuleName NetworkingDSC ModuleVersion Details of the scenario you tried and the problem that is occurring When defining multiple entries on a single line it will write them to the host file every time the LCM kicks off Line takes in account for multiple entries per line but then a compare happens later against that array and a string that was passed into the GetHostEntry Suggested solution to the issue Change line FROM if resultHost eq HostName TO if string resultHost eq HostName The DSC configuration that is used to reproduce the issue as detailed as possible powershell HostsFile Test HostName testocspresponder testVMlablocal IPAddress Ensure Present The operating system the target node is running powershell OsName Microsoft Windows Server R Standard OsOperatingSystemSKU StandardServerEdition OsArchitecture bit WindowsBuildLabEx amd frewinblueltsbescrow OsLanguage enUS OsMuiLanguages enUS Version and build of PowerShell the target node is running powershell Name Value PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion Version of the DSC module that was used dev if using current dev branch The code for this issue looks the same 