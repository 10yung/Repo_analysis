We have ported Cilium master version on Arm server and deployed Nginx to verify and test k s cluster that composed by three Arm nodes the status of the pods and the connection between the nodes are normal I hope to contribute to cilium support for Arm and Related work includes the following aspects Fix compiling and running issue on Arm Add arm support for building ciliumrelated images Add multiarch support for ciliumrelated images Add arm support for cilium CICD Currently missing secrets cause empty TLS contexts to be sent to Envoy which will then NACK the policy Error out earlier in the Cilium endpoint regeneration logic so that Envoy is not bothered with errorneous configuration Currently this will still lead to endpoint being notready but at least the endpoint log contains the failure message pinpointing the problem eg Error regenerating endpoint unable to regenerate policy for secrets swapiserver not found Signedoffby Jarno Rajahalme jarnocovalentio Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend Cilium datapath does not support IP fragmentation and fragmented packets are usually dropped To make users aware of such cases we need to export a metric for dropped packets This requires adding return DROPFRAGNOSUPPORT to the datapath and adding an adequate reason to the ciliumdropcountbytestotal metrics Deep copy the resource before storing it This way we are not dependent on caller not using the resource after this call This may help avoid panics seen in the unit tests Fixes hopefully Signedoffby Jarno Rajahalme jarnocovalentio Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend Recently introduced tests using external sites cause intermittent CI failures Enable Envoy HTTP retries for those tests Note that the current Envoy retries do not work properly on upstream connections which reuse the original source address and port so this change alone would not fix these intermittent CI failures but will not make them any worse either Envoy side fix of retries on these cases is prepared separately Signedoffby Jarno Rajahalme jarnocovalentio Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend Generic protobuf structpb config encoding is deprecated by Envoy Change to using TypedConfig to avoid flooding the logs with deprecation warnings Signedoffby Jarno Rajahalme jarnocovalentio Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend When cilium agent in eni mode restarts ciliumnode custom resource is cleared and refilled by several updates Specifically StatusIPAMUsed map which holds all used IPs is first updated to an empty map before endpoints finish restoration This becomes critical if awsreleaseexcessips is enabled since cilium operator treats empty IPAMUsed map as no address used hence releases addresses arbitraryly causing restored endpoints disconnected This patch fixes this by combining per endpoint update requests into one update request after all endpoint restoration finishes so that StatusIPAMUsed keeps the desired state during agent restart Signedoffby Jaff Cheng jaffchengshgmailcom Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend 