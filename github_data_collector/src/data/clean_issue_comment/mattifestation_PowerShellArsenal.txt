Bad example command GetPEB Id ps RegshotIdInInitializationOrderModuleList Impossible de convertir la valeur bits en type SystemInt Erreur Le format de la cha ne dentr e est incorrect Au caract re C Program Files WindowsPowerShell Modules PowerShellArsenal WindowsInternals GetPEBps OSArchitecture Int GetWmiObject Win OperatingSystem CategoryInfo InvalidArgument RuntimeException FullyQualifiedErrorId InvalidCastFromStringToInteger On my Windows box I opened a Powershell session and a Cmd session in both of which I changed the current working directory with cd Desktop Now I do this PS C Users XXX Desktop GetPEB Id ps powershellIdProcessParametersCurrentDirectory C Users XXX PS C Users XXX Desktop GetPEB Id ps cmdIdProcessParametersCurrentDirectory C Users XXX Desktop As you can see the output is correct for Cmd but wrong for Powershell Is this a known problem Update SysInternals Process Explorer shows the same discrepancy so at least the two of them behave in the same way but still unexpectedly Update In the command line help there is a little bug in an example C PSNotepadPEB GetPEB Id ps notepad C PS NotepadPEBInInitializationOrderModuleList You forgot Id So in the first line it sould be GetPEB Id ps notepadId I added a GetPESymbols cmdlet to enable PDB symbols enumeration for PE files I know it is almost only C code but I had problems with the enumeration callback in the SymEnumSymbols using PSReflect The rest of the rules should be fulfilled I decided to use the DBGHELPPATH variable to point to a specific dbghelpdll maybe you will have a better concept for that Thanks In Line of GetLibSymbolsps the call COFFFunctions UnDecorateSymbolName should be COFF Functions UnDecorateSymbolName use COFF instead of COFF Btw thanks for making the project available Hi I execute command with Administrator privileges thanks for all My PowerShell Version in Windows bits PS C WINDOWS system AllPEBs GetProcess GetPEB GetPEB Unable to obtain a handle for PID You will likely need to run this script elevated At line char AllPEBs GetProcess GetPEB CategoryInfo NotSpecified WriteError WriteErrorException FullyQualifiedErrorId MicrosoftPowerShellCommandsWriteErrorExceptionGetPEB 