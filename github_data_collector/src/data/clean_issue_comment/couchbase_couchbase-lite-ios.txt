Unable to include Couchbase Lite iOS via Carthage with Xcode Incompatible Swift version framework was built with swiftlang clang and the local version is swiftlang clang Version Client OS macOS Catalina When I lock the device before the socket has started receiving a response my app crashes The device does have a passcode So Im assuming the database is being accessed after the isProtectedDataAvailable is false Seems to be more common when network connectivity is slow Crashed DBwss CouchbaseLiteSwift x c sqlite backupinit CouchbaseLiteSwift x a sqlite backupinit CouchbaseLiteSwift x bc sqlite backupinit CouchbaseLiteSwift x ab sqlite backupstep CouchbaseLiteSwift x sqlite backupstep CouchbaseLiteSwift x a c sqlite step CouchbaseLiteSwift x b c sqlite step CouchbaseLiteSwift x bd c SQLiteStatementexecuteStep CouchbaseLiteSwift x cb litecoreSQLiteDataFileintQuerychar const CouchbaseLiteSwift x c b litecoreSQLiteDataFileoptimizeAndVacuum CouchbaseLiteSwift x b c litecoreSQLiteDataFileclose CouchbaseLiteSwift x ce litecoreSQLiteDataFileSQLiteDataFile CouchbaseLiteSwift x b e litecoreSQLiteDataFileSQLiteDataFile CouchbaseLiteSwift x b f c InternalDatabaseDatabase CouchbaseLiteSwift x c Databasec Database CouchbaseLiteSwift x dc litecorereplDBWorkercomputeActivityLevel const CouchbaseLiteSwift x c socketreceived libdispatchdylib x cb aa dispatchcallblockandrelease libdispatchdylib x cb a dispatchclientcallout libdispatchdylib x cba b dispatchqueueserialdrainVARIANTmp libdispatchdylib x cbb fc dispatchqueueinvokeVARIANTmp libdispatchdylib x cbbcc dispatchrootqueuedraindeferredwlhVARIANTmp libdispatchdylib x cc dispatchworkloopworkerthreadVARIANTmp libsystempthreaddylib x fe e pthreadwqthread libsystempthreaddylib x fe b startwqthread Create database and start replication is crashing on pull only some users not all Version CouchbaseLite Swift Enterprise Client OS iOS Server Couchbase Sync Gateway Enterprise Source Code let config ReplicatorConfiguration let config ReplicatorConfigurationdatabase database target URLEndpointurl url configreplicatorType ReplicatorTypepull configauthenticator SessionAuthenticatorsessionID sessionId cookieName cookieName configcontinuous true return config let replicator Replicatorconfig config replicatorstart Crash Log Exception Type SIGSEGV Exception Codes SEGVMAPERR at x Crashed Thread Thread Crashed CouchbaseLiteSwift x dae std functionfunclitecorereplReplicatorgetRemoteCheckpoint std allocatorlitecorereplReplicatorgetRemoteCheckpoint void litecoreblipMessageProgress const operatorlitecoreblipMessageProgress const atomic CouchbaseLiteSwift x dd aec std functionfunclitecorereplWorkersendRequestlitecoreblipMessageBuilder std functionvoid litecoreblipMessageProgress const std allocatorlitecorereplWorkersendRequestlitecoreblipMessageBuilder std functionvoid litecoreblipMessageProgress const void litecoreblipMessageProgressoperatorlitecoreblipMessageProgress Workercc CouchbaseLiteSwift x dd ZZN litecore actor Actor asynchronizeIJNS blip MessageProgressEEEENSt functionIFvDpTEEESAENUlS EclES blockinvoke Actorhh CouchbaseLiteSwift x e litecoreactorGCDMailboxsafelyCallvoid blockpointer const GCDMailboxcc CouchbaseLiteSwift x e c ZN litecore actor GCDMailbox enqueueEU blockpointerFvvEblockinvoke GCDMailboxcc libdispatchdylib x a f dispatchcallblockandrelease libdispatchdylib x a dispatchclientcallout libdispatchdylib x a c dispatchlaneserialdrainVARIANTmp libdispatchdylib x a ce dispatchlaneinvokeVARIANTmp libdispatchdylib x a dispatchworkloopworkerthread libsystempthreaddylib x aaffa pthreadwqthread libsystempthreaddylib x ab ae startwqthread From CBSE the CBLDynamicObjects propertyNames could be called from multiple threads and could cause EXEBADACCESS to the classToNames dictionary Version x Steps App with DB in the shared container also it should be encrypted When the app is send to background the app crashes with console message CBLiteTaskExten Forcing crash report with description CBLiteTaskExten was suspended with locked system files privatevarmobileContainersSharedAppGroupFCDB D B C CBLitedemocblite dbsqlite Only happens in device SQLCipherVsSharedData explained in detail how this issue happens with SQLCipher Easily replicated with adding an encryptionKey to this extension project and run on device Will get the log from device console log SQLCipher team has analyzed and shared what really happens and how iOS cant identify it as a sqlite file comment from Stephen Link Is it possible to include the type property value of a document as part of a database change notification This would circumvent the need to load each changed document to see if its of a type I might be interested in I had started implementing this as part of a new feature but the functionality was moved to the server and synced to the device via a document We are create replication like this CBLReplication pull database createPullReplicationurl CBLReplication push database createPushReplicationurl NSDictionary auth Authorization pull setHeadersauth push setHeadersauth pullcontinuous YES pushcontinuous YES pull start push start In logs ChangeTracker CBLSocketChangeTracker x c d plrestiksjapxviwg Start timeout will timeout in sec ChangeTracker CBLSocketChangeTracker x c d plrestiksjapxviwg Started ChangeTracker CBLSocketChangeTracker x c d plrestiksjapxviwg Timeout CBLSocketChangeTracker x c d plrestiksjapxviwg Connection error retrying in sec NSURLError Timeout Then interval between request increases retrying in retrying in retrying in What we are doing wrong Thank you Version Client OS iOS Server Apache CouchDB I have a situation in a customers database where he has a basically empty record that cant be deleted I traced through the code and found that CBL is returning kCBLStatusNotFound when trying to delete or even modify the document Heres the relevant code being executed in CBLSQLiteStoragem in CBLRevision addDocID NSStringinDocID prevRevID CBLRevIDinPrevRevID properties NSMutableDictionaryproperties deleting BOOLdeleting allowConflict BOOLallowConflict validationBlock CBLStorageValidationBlockvalidationBlock status CBLStatusoutStatus error NSErroroutError SequenceNumber parentSequence if prevRevID Replacing make sure given prevRevID is current find its sequence number if isNewDoc return kCBLStatusNotFound parentSequence self getSequenceOfDocument docNumericID revision prevRevID onlyCurrent allowConflict if parentSequence Not found kCBLStatusNotFound or a kCBLStatusConflict depending on whether there is any current revision if allowConflict self existsDocumentWithID docID revisionID nil return kCBLStatusConflict else return kCBLStatusNotFound The last return kCBLStatusNotFound bit is whats being executed when this code runs Is there any way that I can get rid of this document even though the parentSequence is and it falls through to the else statement I just want to be able to delete it and move on But its preventing any documents in a batch transactions from being saved if this document appears in the transaction block being saved Version Client OS macOS Server na This happens rarely on our iOS app Seems like the changeTracker is either not cleared on stop or startChangeTracker is called in succession Version Client OS iOS G Server custom reverse proxy couchbasesyncgatewaycommunity couchbaseservercommunity Exception Terminating app due to uncaught exception NSInternalInconsistencyException reason changeTracker Call stack as follows Thread name CouchbaseLite Thread Crashed CoreFoundation x c efe x c f redacted libobjcAdylib x ac x ac objcexceptionthrow CoreFoundation x c eeb x c f redacted Foundation x ccb cc x cc redacted KetoDiet x dfe x AssertFailed KetoDiet x aa x CBLRestPuller startChangeTracker KetoDiet x a ce x CBLRestPuller beginReplicating KetoDiet x a f x CBLRestReplicator fetchRemoteCheckpointDoc blockinvoke KetoDiet x c cb x CBLRemoteRequest respondWithResulterror KetoDiet x c x CBLRemoteJSONRequest didFinishLoading KetoDiet x ee c x CBLRemoteSession URLSessiontaskdidCompleteWithError blockinvoke Foundation x cd c x cc redacted CoreFoundation x c cd c x c f redacted CoreFoundation x c ccd c x c f redacted CoreFoundation x c ca a x c f redacted CoreFoundation x c fada x c f CFRunLoopRunSpecific Foundation x cc db x cc redacted KetoDiet x a x CBLRunLoopServer runServerThread Foundation x cd x cc redacted libsystempthreaddylib x b e c x b de redacted libsystempthreaddylib x b e c x b de pthreadstart libsystempthreaddylib x b decb x b de threadstart 