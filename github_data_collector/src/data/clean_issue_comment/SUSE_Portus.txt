 Summary Some various hardening small changes that I would like to have for my Portus instance Summary HttpHelpers adds Accept applicationvnddockerdistributionmanifestv json header for every outgoing HTTP request This header is only required for manifests API endpoints Description bash cannot find initrb I guess fix is to use bundle exec rails runner srvPortusexamplesdevelopmentcomposeinitrb To reproduce this fix first Steps to reproduce cp examplespostgresqldockercomposeyml dockercomposepostgresyml dockercompose f dockercomposepostgresyml up Expected behavior All services starting Actual behavior portus service not starting Attaching to portusdb portusportus portuswebpack portusregistry portus bash srvPortusexamplesdevelopmentcomposeinit No such file or directory db db PostgreSQL Database directory appears to contain a database Skipping initialization db db UTC LOG listening on IPv address port db UTC LOG listening on IPv address port db UTC LOG listening on Unix socket varrunpostgresqlsPGSQL db UTC LOG database system was shut down at UTC db UTC LOG database system is ready to accept connections portusportus exited with code Deployment information Deployment method With dockercomposepostgresyml at the repo root Configuration In a container Using the development dockercomposepostgresyml Portus version Description error webpack The engine node is incompatible with this module Expected version This relates to Steps to reproduce cp examplespostgresqldockercomposeyml dockercomposepostgresyml dockercompose f dockercomposepostgresyml up Expected behavior All services starting Actual behavior Webpack service crashing webpack Installing dependencies webpack yarn install v webpack Resolving packages webpack Fetching packages webpack info fsevents The platform linux is incompatible with this module webpack info fsevents is an optional dependency and failed compatibility check Excluding it from installation webpack error webpack The engine node is incompatible with this module Expected version webpack info Visit for documentation about this command webpack error Found incompatible module webpack yarn run v webpack webpack watch config configwebpackjs webpack binsh webpack not found webpack error Command failed with exit code webpack info Visit for documentation about this command portuswebpack exited with code Deployment information Deployment method With dockercomposepostgresyml at the repo root Configuration In a container Using the development dockercomposepostgresyml Portus version i push alpine images ok for register ok for portus UI i push my build images with Dockerfile FROM docker RUN apk add nocache upgrade bash jq git docker build nocache pull t dockerdockerdind docker tag dockerdockerdind srvportus dockerdockerdind KO for UI ok for registry i push docker docker tag docker srvportus docker ok for registry ok for UI could you help me please Bumps handlebars from to details summaryChangelogsummary Sourced from handlebarss changelog v November th Bugfixes fix add noprototypebuiltins eslintrule and fix all occurences f f d fix add more properties required to be enumerable Chores Build fix use instead of c b f add chai and dirtychai and sinon for cleaner testassertions and spies deprecate old assertionmethods e e ba dad a Security The properties proto defineGetter defineSetter and lookupGetter have been added to the list of properties that must be enumerable If a property by that name is found and not enumerable on its parent it will silently evaluate to undefined This is done in both the compiled template and the lookuphelper This will prevent new RemoteCodeExecution exploits that have been published recently Compatibility notes Due to the securityfixes The semantics of the templates using proto defineGetter defineSetter and lookupGetter in the respect that those expression now return undefined rather than their actual value from the proto The semantics have not changed in cases where the properties are enumerable as in js proto some string The change may be breaking in that respect but we still only increase the patchversion because the incompatible usecases are not intended undocumented and far less important than fixing RemoteCodeExecution exploits on existing systems Commits v November th Bugfixes fix use Stringfield in lookup when checking for constructor d test add fluent API for testing Handlebars c ac c Compatibility notes no incompatibility are to be expected trtable truncated details details summaryCommitssummary c c b v c d Update release notes f f d fix add noprototypebuiltins eslintrule and fix all occurences fix add more properties required to be enumerable ba testchore add chaiexpect and sinon to runtimeenvironment dad test add sinon as global variable to eslint in the specs a test add sinonjs for spies deprecate current assertions e e chore add chai and dirtychai for better test assertions c b f fix use instead of de d v Additional commits viewable in compare view details br Dependabot compatibility score Dependabot will resolve any conflicts with this PR as long as you dont alter it yourself You can also trigger a rebase manually by commenting dependabot rebase dependabotautomergestart dependabotautomergeend details summaryDependabot commands and optionssummary br You can trigger Dependabot actions by commenting on this PR dependabot rebase will rebase this PR dependabot recreate will recreate this PR overwriting any edits that have been made to it dependabot merge will merge this PR after your CI passes on it dependabot squash and merge will squash and merge this PR after your CI passes on it dependabot cancel merge will cancel a previously requested merge and block automerging dependabot reopen will reopen this PR if it is closed dependabot ignore this patchminormajor version will close this PR and stop Dependabot creating any more for this minormajor version unless you reopen the PR or upgrade to it yourself dependabot ignore this dependency will close this PR and stop Dependabot creating any more for this dependency unless you reopen the PR or upgrade to it yourself dependabot use these labels will set the current labels as the default for future PRs for this repo and language dependabot use these reviewers will set the current reviewers as the default for future PRs for this repo and language dependabot use these assignees will set the current assignees as the default for future PRs for this repo and language dependabot use this milestone will set the current milestone as the default for future PRs for this repo and language You can disable automated security fix PRs for this repo from the Security Alerts page details Bumps rack from to details summaryChangelogsummary Sourced from racks changelog Changelog All notable changes to this project will be documented in this file For info on how to format all future additions to this file please reference Keep A Changelog Unreleased Note There are many unreleased changes in Rack master is around commits ahead of stable and below is not an exhaustive list If you would like to help out and document some of the unreleased changes PRs are welcome Added Changed Use Timehttpdate format for Expires as proposed by RFC nanaya Make Utilsstatuscode raise an error when the status symbol is invalid instead of Rename RequestSCHEMEWHITELIST to RequestALLOWEDSCHEMES Make MultipartParsergetfilename accept files with in their name Add Falcon to the default handler fallbacks ioquatix Update codebase to avoid string mutations in preparation for frozenstringliterals pat Change MockRequestenvfor to rely on the input optionally responding to size instead of length janko Rename RackFile RackFiles and add deprecation notice postmodern Removed Documentation Update broken example in SessionAbstractID documentation tonytonyjan Add Padrino to the list of frameworks implmenting Rack wikimatze Remove Mongrel from the suggested server options in the help output tricknotes Replace HISTORYmd and NEWSmd with CHANGELOGmd twitnithegirl Backfill CHANGELOGmd from to releases drenmi details details summaryCommitssummary e ee Bumping version f a b Introduce a new base class to avoid breaking when upgrading b cab Add a version prefix to the private id to make easier to migrate old values e e f Fallback to the public id when reading the session in the pool adapter ba d Also drop the session with the public id when destroying sessions a bbf Fallback to the legacy id when the new id is not found dc a Add the private id a f revert conditionals to master e remove NullSession c e b remove raise and get closer to master Additional commits viewable in compare view details br Dependabot compatibility score Dependabot will resolve any conflicts with this PR as long as you dont alter it yourself You can also trigger a rebase manually by commenting dependabot rebase dependabotautomergestart dependabotautomergeend details summaryDependabot commands and optionssummary br You can trigger Dependabot actions by commenting on this PR dependabot rebase will rebase this PR dependabot recreate will recreate this PR overwriting any edits that have been made to it dependabot merge will merge this PR after your CI passes on it dependabot squash and merge will squash and merge this PR after your CI passes on it dependabot cancel merge will cancel a previously requested merge and block automerging dependabot reopen will reopen this PR if it is closed dependabot ignore this patchminormajor version will close this PR and stop Dependabot creating any more for this minormajor version unless you reopen the PR or upgrade to it yourself dependabot ignore this dependency will close this PR and stop Dependabot creating any more for this dependency unless you reopen the PR or upgrade to it yourself dependabot use these labels will set the current labels as the default for future PRs for this repo and language dependabot use these reviewers will set the current reviewers as the default for future PRs for this repo and language dependabot use these assignees will set the current assignees as the default for future PRs for this repo and language dependabot use this milestone will set the current milestone as the default for future PRs for this repo and language You can disable automated security fix PRs for this repo from the Security Alerts page details Bumps excon from to details summaryChangelogsummary Sourced from excons changelog fix for leftover data with interrupted persistent connections Update bundled certificates Fix mistake in proxy connection error handling Raise better proxy connection errors Updated bundled certs Properly redact userpass info from proxy credentials Update bundled certs Add remoteip to datum enabling usage in middleware redirect follower now raises after following too many redirects default fixed stub clearing in tests to avoid race conditions fix yardoc formatting fix creating Proc without a block reducerefine gem file contents update bundled certs readd bundled certs to gem file contents trtable truncated details details summaryCommitssummary d v ccb d fix for leftover data with interrupted persistent connections f de cf v f a v e bbb Merge pull request from jasquatfixresponsestatuscheck fixed response status check when making a request with a valid proxy is set f v c define ProxyConnectionError f a raise on failed proxy connect d ed fe be thorough in unsubscribing to notifications in instrumentation tests Additional commits viewable in compare view details br Dependabot compatibility score Dependabot will resolve any conflicts with this PR as long as you dont alter it yourself You can also trigger a rebase manually by commenting dependabot rebase dependabotautomergestart dependabotautomergeend details summaryDependabot commands and optionssummary br You can trigger Dependabot actions by commenting on this PR dependabot rebase will rebase this PR dependabot recreate will recreate this PR overwriting any edits that have been made to it dependabot merge will merge this PR after your CI passes on it dependabot squash and merge will squash and merge this PR after your CI passes on it dependabot cancel merge will cancel a previously requested merge and block automerging dependabot reopen will reopen this PR if it is closed dependabot ignore this patchminormajor version will close this PR and stop Dependabot creating any more for this minormajor version unless you reopen the PR or upgrade to it yourself dependabot ignore this dependency will close this PR and stop Dependabot creating any more for this dependency unless you reopen the PR or upgrade to it yourself dependabot use these labels will set the current labels as the default for future PRs for this repo and language dependabot use these reviewers will set the current reviewers as the default for future PRs for this repo and language dependabot use these assignees will set the current assignees as the default for future PRs for this repo and language dependabot use this milestone will set the current milestone as the default for future PRs for this repo and language You can disable automated security fix PRs for this repo from the Security Alerts page details Bumps puma from to details summaryChangelogsummary Sourced from pumas changelog and Security Fix a poorlybehaved client could use keepalive requests to monopolize Pumas reactor and create a denial of service attack CVE Features Strip whitespace at end of HTTP headers Optimize HTTP parser for JRuby Add SSL support for the control app and cli Bugfixes Fix ErrnoEINVAL when SSL is enabled and browser rejects cert Fix pumactl defaulting puma to development if an environment was not specified Fix closing file stream when reading pid from pidfile Fix a typo in configuration option extraruntimedependencies bugfixes Fix socket activation of systemd preexisting unix binder files Deal with multiple calls to bind correctly Accepts symbols for verifymode features Pumactl has a new e environment option and reads configpumaenvironmentrb config files Semicolons are now allowed in URL paths MRI only useful for Angular or Redmine Allow extra dependencies to be defined when using prunebundler Puma now reports the correct port when binding to port also reports other listeners when binding to localhost Sending SIGINFO to any Puma worker now prints currently active threads and their backtraces Puma threads all now have their name set on Ruby bugfixes Fix some misbehavior with phased restart and externally SIGTERMed workers Fix socket closing on error Removed unnecessary SIGINT trap for JRuby that caused some race conditions Fix socket files being left around after process stopped Absolutely thousands of lines of test improvements and fixes thanks to MSPGreg bugfixes Revert our attempt to not dup STDOUTSTDERR Fix socket close on error Fix workers not shutting down correctly trtable truncated details details summaryCommitssummary bb fc df and release notes e Merge pull request from GHSA xx m x c e Docs files e c d v ec Merge pull request from schneemsschneemsfixpumarackhandlerconfig See full diff in compare view details br Dependabot compatibility score Dependabot will resolve any conflicts with this PR as long as you dont alter it yourself You can also trigger a rebase manually by commenting dependabot rebase dependabotautomergestart dependabotautomergeend details summaryDependabot commands and optionssummary br You can trigger Dependabot actions by commenting on this PR dependabot rebase will rebase this PR dependabot recreate will recreate this PR overwriting any edits that have been made to it dependabot merge will merge this PR after your CI passes on it dependabot squash and merge will squash and merge this PR after your CI passes on it dependabot cancel merge will cancel a previously requested merge and block automerging dependabot reopen will reopen this PR if it is closed dependabot ignore this patchminormajor version will close this PR and stop Dependabot creating any more for this minormajor version unless you reopen the PR or upgrade to it yourself dependabot ignore this dependency will close this PR and stop Dependabot creating any more for this dependency unless you reopen the PR or upgrade to it yourself dependabot use these labels will set the current labels as the default for future PRs for this repo and language dependabot use these reviewers will set the current reviewers as the default for future PRs for this repo and language dependabot use these assignees will set the current assignees as the default for future PRs for this repo and language dependabot use this milestone will set the current milestone as the default for future PRs for this repo and language You can disable automated security fix PRs for this repo from the Security Alerts page details Description Steps to reproduce I attempted to spin up portus and push an image The registry is setup via traefik at and portus is available The registry logs show errors about invalid scope Im assuming something with oauth but I cant figure out what any help would be appreciated Deployment information Deployment method docker Configuration yml version services portus image opensuseportus envfile portusenv environment PORTUSMACHINEFQDNVALUEportusmysitecom PORTUSDBHOSTdb PORTUSDBDATABASEportusproduction PORTUSDBPASSWORDDATABASEPASSWORD PORTUSDBPOOL PORTUSSECRETKEYBASESECRETKEYBASE PORTUSKEYPATHcertificatesportuskey PORTUSPASSWORDPORTUSPASSWORD PORTUSCHECKSSLUSAGEENABLEDfalse RAILSSERVESTATICFILEStrue ports dependson db links db volumes secretscertificatesro networks portus public labels traefikenable true traefikdockernetwork public traefikbackend portus traefikfrontendrule Hostportusmysitecom traefikport traefikprotocol http deploy labels traefikenable true traefikdockernetwork public traefikbackend portus traefikfrontendrule Hostportusmysitecom traefikport traefikprotocol http background image opensuseportus dependson portus db environment Theoretically not needed but cconfigs been buggy on this CCONFIGPREFIXPORTUS PORTUSMACHINEFQDNVALUEportusmysitecom DB The password for the database should definitely not be here You are probably better off with Docker Swarm secrets PORTUSDBHOSTdb PORTUSDBDATABASEportusproduction PORTUSDBPASSWORDDATABASEPASSWORD PORTUSDBPOOL Secrets It can possibly be handled better with Swarms secrets PORTUSSECRETKEYBASESECRETKEYBASE PORTUSKEYPATHcertificatesportuskey PORTUSPASSWORDPORTUSPASSWORD PORTUSBACKGROUNDtrue links db envfile portusenv volumes secretscertificatesro networks portus db image librarymariadb command mysqld charactersetserverutf collationserverutf unicodeci initconnectSET NAMES UTF innodbflushlogattrxcommit envfile portusenv environment MYSQLDATABASEportusproduction MYSQLROOTPASSWORDDATABASEPASSWORD volumes mariadbvarlibmysql networks portus registry image libraryregistry envfile portusenv environment REGISTRYHTTPADDR registrymysitecom Authentication REGISTRYAUTHTOKENREALM REGISTRYAUTHTOKENSERVICE registrymysitecom REGISTRYAUTHTOKENISSUER portusmysitecom REGISTRYAUTHTOKENROOTCERTBUNDLE secretsportuscrt Portus endpoint REGISTRYNOTIFICATIONSENDPOINTS name portus url timeout ms threshold backoff s volumes registryvarlibregistry secretssecretsro configymletcdockerregistryconfigymlro ports required to access debug service links portusportus networks portus public labels traefikenable true traefikdockernetwork public traefikbackend registry traefikfrontendrule Hostregistrymysitecom traefikport traefikprotocol http deploy labels traefikenable true traefikdockernetwork public traefikbackend registry traefikfrontendrule Hostregistrymysitecom traefikport traefikprotocol http volumes secrets driver local driveropts type none o bindrw device mntworkspaceportussecrets mariadb registry networks public external true portus 