We have tried to use tideways xhprof on one of our servers which for reasons outside our immediate control still runs on PHP The extension runs but on every third request as far as we could determine we get a segfault PHP is setup with FPM and as far as I can see we had two children running So every third request could well be the second request to a given FPM child Apparently it doesnt matter which script we are calling the same script can run fine and produce a profile and then segfault the next time We tried with version from ubuntu PPA of Ondrej Sury and downloaded from github release page Both result in a segfault although with different stack traces Stack trace from x c c in zendhashdestroy x ff bf f in from usrlibphp tidewaysso x ff bf cad in ziftidewaysenable from usrlibphp tidewaysso x cd ba in x c c b in executeex x cd a in zendexecute x c in zendexecutescripts x bce in phpexecutescript x aac in main Stack trace from x f c c cb in tidewaysxhprofexecuteex from usrlibtidewaysxhproftidewaysxhprof so x bc e ecb in zendcallfunction x bc a in zendcallmethod x bc f e in zifsplautoloadcall x f c d in tidewaysxhprofexecuteinternal from usrlibtidewaysxhproftidewaysxhprof so x bc e d in zendcallfunction x bc e in zendlookupclassex x bc e e in zendfetchclassbyname x bc d in x bc f b in executeex x f c c in tidewaysxhprofexecuteex from usrlibtidewaysxhproftidewaysxhprof so x bc dc in x bc f b in executeex x f c c in tidewaysxhprofexecuteex from usrlibtidewaysxhproftidewaysxhprof so x bc a in x bc f b in executeex x f c c in tidewaysxhprofexecuteex from usrlibtidewaysxhproftidewaysxhprof so x bc dae in x bc f b in executeex x f c c in tidewaysxhprofexecuteex from usrlibtidewaysxhproftidewaysxhprof so x bc eac in x bc f b in executeex x f c c in tidewaysxhprofexecuteex from usrlibtidewaysxhproftidewaysxhprof so x bc eac in x bc f b in executeex x f c c in tidewaysxhprofexecuteex from usrlibtidewaysxhproftidewaysxhprof so x bc a a in zendexecute x bc f in zendexecutescripts x bc in phpexecutescript x bc f in main As the stack traces are quite different I am not entirely sure it is the same issue or not but from the outside view it shows the exact same symptoms My knowledge of gdb is pretty much exhausted at this point so if we can provide more useful details please advice us I will leave the relevant stack traces lying around for the time being Ive upgraded my desktop from Windows to without any changes to my portable ApacheMySQLPHP web stack After the update having tidewaysxhprof binary enabled started to crash Apache on general browsing of PHP pages not trying to profile with following message AH Parent child process exited with status Restarting Binary version phptidewaysxhprof master cc vc x dll Any pointers how can I try tweak or troubleshoot this helps getting started on macOS using brew I pushed upgrade to beta for php But build for x not bit fails log In file included from homebuildozeraportstestingphp tidewaysxhprofsrcphpxhprofextension beta tracingh from homebuildozeraportstestingphp tidewaysxhprofsrcphpxhprofextension beta tidewaysxhprofc homebuildozeraportstestingphp tidewaysxhprofsrcphpxhprofextension beta timerh In function timemilliseconds homebuildozeraportstestingphp tidewaysxhprofsrcphpxhprofextension beta timerh error a label can only be part of a statement and a declaration is not a statement int t ret In file included from homebuildozeraportstestingphp tidewaysxhprofsrcphpxhprofextension beta tracingh from homebuildozeraportstestingphp tidewaysxhprofsrcphpxhprofextension beta tracingc homebuildozeraportstestingphp tidewaysxhprofsrcphpxhprofextension beta timerh In function timemilliseconds homebuildozeraportstestingphp tidewaysxhprofsrcphpxhprofextension beta timerh error a label can only be part of a statement and a declaration is not a statement int t ret make Makefile tracinglo Error make Waiting for unfinished jobs make Makefile tidewaysxhproflo Error Any idea whats wrong