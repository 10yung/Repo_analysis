Seems to me that you have redirect loop in issues regarding ability to connect to on premises installed Microsoft Exchange The thing is Microsoft disabled POP and IMAP by default and now offers web API Exchange web api services EWS as default way to access it not using even MAPI any longer Im not able to add those features myself but here are two links that can help C library for accessing EWS created for Thunderbird Libews Microsoft official stuff Exchange developer content Microsofts officila EWS support by Exchange server versions what is the exact code to load the new message using mailcore When using Swift MCOAttachments filename property inherited from MCOAbstractPart API doc here is declared as an implicitly unwrapped optional But Im encountering an email where the attachments are unnamed and attempting to access the property causes a crash with the message Fatal error Unexpectedly found nil while implicitly unwrapping an Optional value Looking at the plain text rendering of the message it lists the attachments like this Untitled bytes Untitled KB How do I handle this without a crash I see a lot of EXCBADACCESS KERNINVALIDADDRESS crashes on iOS when running IMAP operations I have sessions being called from background operation queues Based on the issues I have gone through it seems likely there is a threading issue here My question is What is expected when accessingupdating a property or calling an operation on IMAPSession I set the session dispatch queue explicitly to DispatchQueueglobalqos DispatchQoSQoSClassutility when I initialize it Does that mean any and all references to that session HAVE to be only from the sessions dispatch queue like the following sessiondispatchQueueasync sessionpassword some password sessiondispatchQueueasync sessionfetchMessageOperationwithFolder currFolder uid currUIDstart Here are some crash reports for the crashes that happen all the time Crashed comapplerootdefaultqos libsystemplatformdylib x oslockcorruptionabort libsystemplatformdylib x c OSSpinLockLockYield MyApp x fe mailcoreObjectrelease MyApp x d c mailcoreIMAPAsyncConnectionsetLastFoldermailcoreString MyApp x dcffc mailcoreIMAPAsyncSessionsessionForFoldermailcoreString bool MyApp x c mailcoreIMAPOperationstart MyApp x ff dc MCOOperation start MyApp x MCOIMAPFetchContentOperation start MyApp x cfb MCOIMAPSessionfetchContentcarrierFolderUIDsaveToDirdispatchCompletionOnQueuecompletionBlock ExtensionsSharedswift MyApp x d eca MessageFragmentDownloadOperationdownloadMessageFragmentmessageIDTokenmessageStatusuidToFetchfromFoldercompletionBlock MessageFragmentDownloadOperationswift MyApp x d c closure in closure in closure in closure in MessageFragmentDownloadOperationexecute MessageFragmentDownloadOperationswift MyApp x b thunk for escaping calleeguaranteed compilergenerated libdispatchdylib x f dispatchcallblockandrelease libdispatchdylib x f dispatchclientcallout libdispatchdylib x cfb c dispatchqueueoverrideinvoke libdispatchdylib x dc dispatchrootqueuedrain libdispatchdylib x dc b dispatchworkerthread libsystempthreaddylib x f pthreadwqthread libsystempthreaddylib x ae startwqthread Crashed comapplerootutilityqos MyApp x mailcoreIMAPAsyncConnectionoperationsCount MyApp x a mailcoreIMAPAsyncSessionsessionWithMinQueuebool mailcoreString MyApp x bc mailcoreIMAPAsyncSessionsessionForFoldermailcoreString bool MyApp x c mailcoreIMAPOperationstart MyApp x bfe MCOOperation start MyApp x e MCOIMAPFetchContentOperation start MyApp x b d MCOIMAPSessionfetchContentcarrierFolderUIDsaveToDirdispatchCompletionOnQueuecompletionBlock ExtensionsSharedswift MyApp x ebc d closure in MessageFragmentDownloadOperationdownloadMessageFragmentmessageIDTokenmessageStatusuidToFetchfromFoldercompletionBlock MessageFragmentDownloadOperationswift MyApp x ebc f partial apply for closure in MessageFragmentDownloadOperationdownloadMessageFragmentmessageIDTokenmessageStatusuidToFetchfromFoldercompletionBlock compilergenerated MyApp x db thunk for escaping calleeguaranteed compilergenerated libdispatchdylib x a d dispatchcallblockandrelease libdispatchdylib x a d dispatchclientcallout libdispatchdylib x a dispatchrootqueuedrain libdispatchdylib x a c dispatchworkerthread libsystempthreaddylib x a f pthreadwqthread libsystempthreaddylib x a ae startwqthread Crashed comapplerootdefaultqos libsystemkerneldylib x ebc pthreadkill libsystempthreaddylib x c c pthreadkillVARIANTarmv libsystemcdylib x abort MyApp x d c MCONNTPGroupInfo load MyApp x c mailcoreObjectrelease MyApp x c mailcoreIMAPAsyncConnectionsetLastFoldermailcoreString MyApp x a mailcoreIMAPAsyncSessionsessionForFoldermailcoreString bool MyApp x f mailcoreIMAPOperationstart MyApp x bb dc MCOOperation start MyApp x cd MCOIMAPFetchContentOperation start MyApp x bb MCOIMAPSessionfetchContentcarrierFolderUIDsaveToDirdispatchCompletionOnQueuecompletionBlock ExtensionsSharedswift MyApp x c aca MessageFragmentDownloadOperationdownloadMessageFragmentmessageIDTokenmessageStatusuidToFetchfromFoldercompletionBlock MessageFragmentDownloadOperationswift MyApp x c closure in closure in closure in closure in MessageFragmentDownloadOperationexecute MessageFragmentDownloadOperationswift MyApp x c thunk for escaping calleeguaranteed compilergenerated libdispatchdylib x f dispatchcallblockandrelease libdispatchdylib x f dispatchclientcallout libdispatchdylib x cfb c dispatchqueueoverrideinvoke libdispatchdylib x dc dispatchrootqueuedrain libdispatchdylib x dc b dispatchworkerthread libsystempthreaddylib x f pthreadwqthread libsystempthreaddylib x ae startwqthread Crashed Thread libsystempthreaddylib x d pthreadmutexlockVARIANTarmv CoreFoundation x a d CFRunLoopRemoveSource MyApp x b waitrunloop mailstreamcfstreamc MyApp x b mailstreamlowcfstreamread mailstreamcfstreamc MyApp x af mailstreamlowread mailstreamlowc MyApp x af f mailstreamfeedreadbuffer mailstreamc MyApp x af c mailstreamreadlineappend mailstreamhelperc MyApp x b mailimapuidfetchqresyncvanished qresyncc MyApp x b d c fetchimapmailimap bool unsigned int mailimapfetchtype char unsigned long MyApp x b d fetchrfc mailimap bool unsigned int char unsigned long MyApp x b cf mailcoreIMAPSessionfetchMessagemailcoreString bool unsigned int mailcoreIMAPProgressCallback mailcoreErrorCode MyApp x b ce c mailcoreIMAPSessionfetchMessageByUIDmailcoreString unsigned int mailcoreIMAPProgressCallback mailcoreErrorCode MyApp x b f mailcoreIMAPFetchContentOperationmain MyApp x b dc mailcoreOperationQueuerunOperations MyApp x b mailcoreOperationQueuerunOperationsOnThreadmailcoreOperationQueue libsystempthreaddylib x ec pthreadstart libsystempthreaddylib x aec threadstart The following crash happens when it tries to update the password property of an IMAPSession after checking locally from keychain in NSManagedObjectContext with privateQueueConcurrencyType Crashed NSManagedObjectContext x bb MyApp x fba MCOIMAPSession password MyApp x a AccountSettingsupdateCredentialscompletionBlock AccountSettingsswift MyApp x c f c closure in closure in closure in GetMessageSummariesOperationexecute GetMessageSummariesOperationswift MyApp x c thunk for escaping calleeguaranteed compilergenerated CoreData x b developerSubmittedBlockToNSManagedObjectContextPerform libdispatchdylib x f dispatchclientcallout libdispatchdylib x d c dispatchlaneserialdrainVARIANTarmv libdispatchdylib x d dispatchlaneinvokeVARIANTarmv libdispatchdylib x dd c dispatchworkloopworkerthread libsystempthreaddylib x fa pthreadwqthread libsystempthreaddylib x ae startwqthread Error DomainMCOErrorDomain Code The requested folder does not exist Folder selection failed Hello how to solve this problem thank you very much I have Lakh mails in my Gmail account but I want only the latest days message or latest mails only How can I do it function getMails IndexSet indexSet IndexSetindexSetWithRangenew Range LongMAXVALUE final IMAPFetchMessagesOperation messagesOperation imapSessionfetchMessagesByUIDOperationfolder requestKind indexSet I want only mails to get IndexSet indexSet IndexSetindexSetWithRangenew RangeLongMAXVALUE LongMAXVALUE final IMAPFetchMessagesOperation messagesOperation imapSessionfetchMessagesByUIDOperationfolder requestKind indexSet But its not working I use spark uses Mailcore for my email Recently I started having problems with syncing my folders for my iCloud account and thought it might be specific to this app but then I noticed the same exact issue with MailSpring also using Mailcore This happens on multiple devices as well iphone and mac I think there might be an issue with mailcore connecting to iCloud right now Both Apple Mail and Thunderbird work perfectly fine I am using an app specific password with fa turned on I do not see the issue with other mail providers Can anyone else confirm issues with connecting to iCloud accounts recently using a mailcore integrated app MCOAttachment a MCOAttachment alloc init The Xcode compile error init is unavailable