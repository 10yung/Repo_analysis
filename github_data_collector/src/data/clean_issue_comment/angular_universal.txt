Im trying to provide X within serverts providers appenginehtml options callback const engine ngExpressEngine bootstrap AppServerModuleNgFactory providers provideModuleMapLAZYMODULEMAP provide env useFactory environment deps provide host useFactory options req gethost deps engine options callback the value host is provided injected successfully However env isnt it says NullInjectorError No provider for env only in the browser Im using version with nguniversalexpressengine Bug report What modules are related to this issue edit aspnetcoreengine builders common x expressengine hapiengine modulemapngfactoryloader Is this a regression No localize is new to Angular Description The distFolder is hardcoded in serverts When the browser server assets are built with localize true the assets are placed in a subfolder with the locale name eg distappNamebrowserlocale and distappNameserverlocale Now the server can no longer find the correct directory for the browser assets and fails to render Is there any way serverts can know location of the browser assets without hardcoding the path Thanks Minimal Reproduction Simple steps to reproduce this bug Please include commands run including args packages added related code changes If reproduction steps are not enough for reproduction of your issue please create a minimal GitHub repository with the reproduction of the issue A good way to make a minimal reproduction is to create a new app via ng new reproapp and add the minimum possible code to show the problem Share the link to the repo below along with stepbystep instructions to reproduce the problem as well as expected and actual behavior Issues that dont have enough info and cant be reproduced will be closed You can read more about issue submission guidelines here precodeng new ngsample ng add angularlocalizenext ng add nguniversalexpressenginenext add localize true to the options of the build and server architect ng build prod ng run ngsampleserverproduction node distngsampleserverenUSmainjs browser to codepre Exception or Error precodeError Failed to lookup view index in views directory codengsampledistngsamplebrowser at Functionrender codengsampledistngsampleserverenUSmainjs at ServerResponserender codengsampledistngsampleserverenUSmainjs at serverget codengsampledistngsampleserverenUSmainjs at Layerhandle as handlerequest codengsampledistngsampleserverenUSmainjs at next codengsampledistngsampleserverenUSmainjs at Routedispatch codengsampledistngsampleserverenUSmainjs at Layerhandle as handlerequest codengsampledistngsampleserverenUSmainjs at codengsampledistngsampleserverenUSmainjs at param codengsampledistngsampleserverenUSmainjs at param codengsampledistngsampleserverenUSmainjs codepre Your Environment precodeAngular CLI rc Node OS darwin x Angular rc animations cli common compiler compilercli core forms languageservice localize platformbrowser platformbrowserdynamic platformserver router Ivy Workspace Yes Package Version angulardevkitarchitect rc angulardevkitbuildangular rc angulardevkitbuildoptimizer rc angulardevkitbuildwebpack rc angulardevkitcore rc angulardevkitschematics rc ngtoolswebpack rc nguniversalbuilders rc nguniversalcommon rc nguniversalexpressengine rc schematicsangular rc schematicsupdate rc rxjs typescript webpack codepre Bug report What modules are related to this issue aspnetcoreengine x builders common expressengine hapiengine modulemapngfactoryloader Is this a regression No Description Hi I noticed something that I feel confusing about prerendering My Angular application needs one single route so Im not using the RouterModule I want to prerender the application using the new prerender command bash ng run myappprerender Which get me the following error An unhandled exception occurred No routes found To make this work I need to specify an empty routes argument in the command bash ng run myappprerender routes This argument is required even if I have no RouterModule declared Is it a desired behavior Your Environment nguniversalbuilders rc nguniversalcommon rc nguniversalexpressengine rc This PR contains the following updates Package Type Update Change typeshapihapi devDependencies major Renovate configuration date Schedule after pm every weekdaybefore am every weekdayevery weekend in timezone AmericaTijuana verticaltrafficlight Automerge Disabled by config Please merge this manually once you are satisfied recycle Rebasing Whenever PR becomes conflicted or if you modify the PR title to begin with rebase nobell Ignore Close this PR and you wont be reminded about this update again rebasecheck If you want to rebaseretry this PR check this box This PR has been generated by WhiteSource Renovate View repository job log here Google Pagespeed Insights reveals a very poor score on performance for pages that are served with SSR via Angular Universal The app is built on top of the ngxadmin Angular template where weve tried implementing universal SSR Most of the performance alerts are attributed to the category of Main Thread Work which means that there is javascript css execution happening after the page is rendered Screen Shot at PM Screen Shot at PM We do not see this recommendation for our current SSR solution an inhouse Prerenderio hosting which internally uses a headless chrome to serve the rendered page Also Pagespeed reports a higher performance score for Prerender based SSR even though it has higher network latency involved One reason for this could be that Prerender has a mechanism to strip out script tags from the html which ensures that no javascript gets executed from the client browser accidentally How do we optimize the Universal implementation for a good performance score This PR contains the following updates Package Type Update Change hapihapi source devDependencies major Release Notes details summaryhapijshapisummary v Compare Source v Compare Source v Compare Source v Compare Source v Compare Source v Compare Source details Renovate configuration date Schedule after pm every weekdaybefore am every weekdayevery weekend in timezone AmericaTijuana verticaltrafficlight Automerge Disabled by config Please merge this manually once you are satisfied recycle Rebasing Whenever PR becomes conflicted or if you modify the PR title to begin with rebase nobell Ignore Close this PR and you wont be reminded about this update again rebasecheck If you want to rebaseretry this PR check this box This PR has been generated by WhiteSource Renovate View repository job log here after enabling ssrangular universal on my Angular project when I click on every link it refreshes the whole pagereload that page again or when I click on submit button for example a routerLinkauthregistercareworkerregister CareWorker a or a routerLink authregistercareworkerregister CareWorker a both of them refresh the whole page packagejson name startng version license MIT scripts ng ng start ng serve build ng build test ng test lint ng lint develop node maxoldspacesize nodemodulesangularclibinng build prod prod node maxoldspacesize nodemodulesangularclibinng build prod configurationproduction stage node maxoldspacesize nodemodulesangularclibinng build prod configurationstaging e e ng e e compileserver webpack config webpackserverconfigjs progress colors servessr node distserver buildssr npm run buildclientandserverbundles npm run compileserver buildclientandserverbundles ng build prod ng run careandcarersserverproduction bundleDependencies all private true dependencies agmcore angularanimations angularcdk angularcommon angularcompiler angularcore angularforms angularplatformbrowser angularplatformbrowserdynamic angularplatformserver angularrouter aspnetsignalr fullcalendarangular fullcalendarcore fullcalendardaygrid fullcalendarinteraction fullcalendartimegrid nguniversalexpressengine nguniversalmodulemapngfactoryloader v ngxprogressbarcore ngxprogressbarhttp ngxprogressbarrouter progresskendoangularbuttons progresskendoangularcommon progresskendoangulardateinputs progresskendoangulardropdowns progresskendoangularexcelexport progresskendoangulargrid progresskendoangularinputs progresskendoangularintl progresskendoangularl n progresskendoangularpdfexport progresskendoangularpopup progresskendoangularupload progresskendodataquery progresskendodrawing progresskendothemedefault latest swimlanengxcharts agmdirection angularl n bootstrap classlistjs corejs coreutilis domino express filesaver fontawesome intl jquery jwtdecode moment ngblockui ngcircleprogress ng ckeditor ngxbarrating ngxbootstrap ngxchips ngxcontextmenu ngxinfinitescroll ngxperfectscrollbar ngxtoastr npmcheckupdates opencollectivepostinstall reflectmetadata rxjs rxjscompat sweetalert tslib undefined webanimationsjs githubangularwebanimationsjsreleasepr ws xmlhttprequest zonejs devDependencies angulardevkitbuildangular angulardevkitbuildngpackagr angularcli angularcompilercli angularlanguageservice typesexpress typesgooglemaps typesjasmine typesjasminewd typesnode codelyzer jasminecore jasminespecreporter karma karmachromelauncher karmacoverageistanbulreporter karmajasmine karmajasminehtmlreporter ngpackagr nodesass protractor tsloader tsnode tsickle tslib tslint typescript uglifyjs webpack webpackcli This PR contains the following updates Package Type Update Change hapiinert dependencies major Release Notes details summaryhapijsinertsummary v Compare Source v Compare Source details Renovate configuration date Schedule after pm every weekdaybefore am every weekdayevery weekend in timezone AmericaTijuana verticaltrafficlight Automerge Disabled by config Please merge this manually once you are satisfied recycle Rebasing Whenever PR becomes conflicted or if you modify the PR title to begin with rebase nobell Ignore Close this PR and you wont be reminded about this update again rebasecheck If you want to rebaseretry this PR check this box This PR has been generated by WhiteSource Renovate View repository job log here The server runs on localhost when I type localhost in browser nothing happens But if I put localhost indexhtml It starting to load fine and return to base localhost Then every angular route works fine But if I try to refresh any page it doesnt load anything This is probably because I havent been able to configure my serverts file properly packagejson angularanimations angularcommon angularcompiler angularcore angularforms angularhttp angularplatformbrowser angularplatformbrowserdynamic angularplatformserver angularrouter ngbootstrapngbootstrap nguniversalexpressengine next approutingmodulets path client loadChildren importclientclientmodulethenm mClientModule path loadChildren importhomehomemodulethenm mHomeModule resolve settings HomeResoveService cartCheckL CartTokenService canActivate AppGuardService path notfound loadChildren importnotfoundnotfoundmodulethenm mNotFoundModule data titleNot Found path redirectTo notfound serverts file import zonejsdistzonenode import join from path import existsSync from fs ssr DOM const domino requiredomino const fs requirefs const template fsreadFileSyncpathjoindistbrowser indexhtmltoString const distFolder joinprocesscwd distbrowser const indexHtml existsSyncjoindistFolder indexoriginalhtml indexoriginalhtml index const win dominocreateWindowindexHtml global window win ObjectdefinePropertywindocumentbodystyle transform value return enumerable true configurable true global document windocument global CSS null global Prism null import ngExpressEngine from nguniversalexpressengine import as express from express import AppServerModule from srcmainserver import APPBASEHREF from angularcommon export function app const server express serverenginehtml ngExpressEngine bootstrap AppServerModule serversetview engine html serversetviews distFolder serverget expressstaticdistFolder maxAge y serverget req res resrenderindexHtml req providers provide APPBASEHREF useValue reqbaseUrl return server function run const port processenvPORT Start up the Node server const server app serverlistenport consolelogNode Express server listening on Webpack will replace require with webpackrequire nonwebpackrequire is a proxy to Node require The below code is to ensure that the server is run only when not requiring the bundle declare const nonwebpackrequire NodeRequire const mainModule nonwebpackrequiremain if mainModule mainModulefilename filename run export from srcmainserver dist folder has browser and projectnameserver folder Indexhtml and other static files are in distbrowser folder Feature Request What is the desired behavior documentation request for use cases and applications for universalmodulessocketengine What is the usecase or motivation for the desired behavior im currently using express engine for SSR and I dont really understand application or use of socket engine Is there anything else we should know thanks