The branch uses IO for mmap on all data files if enabled with the mmap option To enable set the environment as follows export WIREDTIGERCONFIGmmaptrue The mmap option in WiredTiger was used to enable mmap on readonly checkpoints I renamed that option to mmapcheckpoint If you enable the mmap option in this branch all data files will be accessed via mmap As we are writing the most recent version to the data store it is required to scan all the objects for rollback to stable fix up We need to read all the internal pages of the objects to fix up History store inmemory pages are not referenced by any session in WT evicting them in this checkpoint let them to be cleaned in the next checkpoint Store all the inmemory obsolete pages and add them to the urgent eviction queue at the end of the checkpoint of history store All the interesting work is in d cd the other two commits are just cleaning up comment formatting agorrod youre not going to like this much but absent a real project to fix the problem its the only idea I have Can you please approve or disapprove the approach before we do a real review Changed the array accessing logic as requested Had to change potentially fixed honestly the conditional logic to be an or instead of an and as accessing the diff properly was impossible when i was Initial pr curious as to what people think about not using hs as a shortening and using historystore Still have some conflicts to clean up One of the more annoying changes here is fixing grammar of comments this backports wt cherry picked from commit da bb c f f ab e 