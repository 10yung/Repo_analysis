Added datatype decimal to the function to avoid error when running job dbareports Disk Usage Error from pshell logging is ERROR Bulk insert failed Exception calling ExecuteNonQuery with arguments Error converting data type nvarchar to numeric The data for tablevalued parameter TVP doesnt conform to the table type of the parameter SQL Server error is state The statement has been terminated In the background a conversion error nvarchar to numeric is thrown Fixes Changes proposed in this pull request How to test this code Has been tested on remove any that dont apply Casesensitive SQL Server instance SQL Server SQL Server R SQL Server SQL Server SQL Server Amazon RDS Azure SQL DB Feature What is the current behavior The info is not available What is the expected behavior Id like to see it In info Databases Id like some info about query store eg if its enabled as a minimum What do people think This is happening on multiple reports but a specific example is the Disk Space report it assumes that the instance id and the server id will always be the same This is not the cause with a server that has multiple instances installed Im trying to install DBAReports on SQL Server R and keep getting errors during the process Im pretty new to powershell so please bare with me Im trying to install dbareports with the below parameters InstallDbaReports SqlServer SERVER InstallDatabase ServerAdminRepo InstallPath C DBAReports Powershell JobPrefix DBA LogFileFolder C DBAReports Log ReportsFolder C DBAReports Reports JobCategory Database Maintenance Im getting the errors below Ive used the TestdbrSqlPath on both the module directory and the destination directories for the scripts logs and reports and all are showing to be accessible Any help is greatly appreciated As an additional lessimportant question if I want the prefix to my jobs to be DBA do I need to specify JobPrefix DBA or just JobPrefix DBA Changes proposed in this pull request Removed unused files Changed DiskSpaceps to use dbatools instead of WMI Has been tested on remove any that dont apply SQL Server SQL Server R SQL Server SQL Server SQL Server Do you want to request a feature or report a bug bug missing feature What is the current behavior SSRS sample report DiskInformation relies on a sproc which is not in the code base and SSRS Error is An error has occurred during report processing rsProcessingAborted The execution failed for the shared data set GetDisksLessThan Percent rsDataSetExecutionError Query execution failed for dataset DataSet rsErrorExecutingCommand For more information about this error navigate to the report server on the local server machine or enable remote errors What is the expected behaviour that sproc would be found in Which versions of SQL Server and which OS are affected by this issue Did this work in previous versions of our procedures all versions Do you want to request a feature or report a bug bug What is the current behavior On installation agent job creation fails with the message WARNING FAILED To Create Agent Job Category dbareports collection jobs Aborting Exception setting Parent Cannot convert the HOSTNAME value of type MicrosoftSqlServerManagementSmoAgentJobServer to type MicrosoftSqlServerManagementSmoAgentJobServer WARNING FAILED To Create Agent Job Category dbareports collection jobs Aborting Exception setting Parent Cannot convert the HOSTNAME value of type MicrosoftSqlServerManagementSmoAgentJobServer to type MicrosoftSqlServerManagementSmoAgentJobServer WARNING FAILED To Create Agent Job Category dbareports collection jobs Aborting Exception setting Parent Cannot convert the HOSTNAME value of type MicrosoftSqlServerManagementSmoAgentJobServer to type MicrosoftSqlServerManagementSmoAgentJobServer WARNING FAILED To Create Agent Job Category dbareports collection jobs Aborting Exception setting Parent Cannot convert the HOSTNAME value of type MicrosoftSqlServerManagementSmoAgentJobServer to type MicrosoftSqlServerManagementSmoAgentJobServer WARNING FAILED To Create Agent Job Category dbareports collection jobs Aborting Exception setting Parent Cannot convert the HOSTNAME value of type MicrosoftSqlServerManagementSmoAgentJobServer to type MicrosoftSqlServerManagementSmoAgentJobServer WARNING FAILED To Create Agent Job Category dbareports collection jobs Aborting Exception setting Parent Cannot convert the HOSTNAME value of type MicrosoftSqlServerManagementSmoAgentJobServer to type MicrosoftSqlServerManagementSmoAgentJobServer WARNING FAILED To Create Agent Job Category dbareports collection jobs Aborting Exception setting Parent Cannot convert the HOSTNAME value of type MicrosoftSqlServerManagementSmoAgentJobServer to type MicrosoftSqlServerManagementSmoAgentJobServer WARNING FAILED To Create Agent Job Category dbareports collection jobs Aborting Exception setting Parent Cannot convert the HOSTNAME value of type MicrosoftSqlServerManagementSmoAgentJobServer to type MicrosoftSqlServerManagementSmoAgentJobServer WARNING FAILED To Create Agent Job Category dbareports collection jobs Aborting Exception setting Parent Cannot convert the HOSTNAME value of type MicrosoftSqlServerManagementSmoAgentJobServer to type MicrosoftSqlServerManagementSmoAgentJobServer WARNING FAILED To Create Agent Job Category dbareports collection jobs Aborting Exception setting Parent Cannot convert the HOSTNAME value of type MicrosoftSqlServerManagementSmoAgentJobServer to type MicrosoftSqlServerManagementSmoAgentJobServer WARNING FAILED To Create Agent Job Category dbareports collection jobs Aborting Exception setting Parent Cannot convert the HOSTNAME value of type MicrosoftSqlServerManagementSmoAgentJobServer to type MicrosoftSqlServerManagementSmoAgentJobServer WARNING FAILED To Create Agent Job Category dbareports collection jobs Aborting Exception setting Parent Cannot convert the HOSTNAME value of type MicrosoftSqlServerManagementSmoAgentJobServer to type MicrosoftSqlServerManagementSmoAgentJobServer Creatingupdating alias for localhost for bit Creatingupdating alias for localhost for bit You should now be able to connect to localhost as dbareports Cannot index into a null array At C Program Files WindowsPowerShell Modules dbareports functions GetDbrConfigps char proxy samplejobJobSteps ProxyName CategoryInfo InvalidOperation RuntimeException FullyQualifiedErrorId NullArray If the current behavior is a bug please provide the steps to reproduce and if possible a minimal demo of the problem via InstallDBAReports SqlServer localhost What is the expected behavior Agent jobs are created Which versions of SQL Server and which OS are affected by this issue Did this work in previous versions of our procedures Microsoft SQL Server SP KB X Windows Enterprise LTSB X Build Hypervisor Do you want to request a feature or report a bug bug What is the current behavior Inserting records into the SQLInfo table fails due to the tinyint Error Arithmetic overflow error for data type tinyint value If the current behavior is a bug please provide the steps to reproduce and if possible a minimal demo of the problem via Set the cost threshold for parrallelism to a high number on your server such as Dont ask I have just started at this company and there are some weird settings on some of the servers What is the expected behavior Data should be inserted correctly Which versions of SQL Server and which OS are affected by this issue Did this work in previous versions of our procedures All versions of SQL Server will be affected Do you want to request a feature or report a bug feature What is the current behavior The dbareports server must have SQL level and WMI level access to the SQL instance being monitored If the current behavior is a bug please provide the steps to reproduce and if possible a minimal demo of the problem via If the dbareports server cannot connect to the server it cannot be added to the inventory What is the expected behavior I have a closed network containing card holder data I need to be able to monitor the SQL Servers in this network but they are on their own domain with a trust and protected via a firewall I am allowed to make an outgoing controlled connection from inside this network to my monitoring server outside but cannot make the connection the other way due to company policy and PCI requirements I would like to create a job on my island server to push the data via service broker to the monitor server The monitor server then needs to add the sender to the inventory and store its data into the repository Which versions of SQL Server and which OS are affected by this issue Did this work in previous versions of our procedures All supported versions Do you want to request a feature or report a bug feature What is the current behavior All data collection occurs using the same proxy account If the current behavior is a bug please provide the steps to reproduce and if possible a minimal demo of the problem via What is the expected behavior I would like to be able to specify a different connection credential for a specific instance If the credential does not exist then the AddDbr command should create the credential proxy combination and create alternative steps in the job to use that credential The step should be intelligent enough to know not to pickup the servers that its current credential does not have access to something maybe SecurityPrincipalWindowsIdentity GetCurrentName could help with this Which versions of SQL Server and which OS are affected by this issue Did this work in previous versions of our procedures All supported 