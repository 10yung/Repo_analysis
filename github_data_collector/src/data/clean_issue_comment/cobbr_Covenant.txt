Feature Request or Bug It seems that using mimikatz kills the listener Describe the feature request or bug Using mimikatz with some dumping options like sekurlsalogonpassword and others make the Grunt tested only with HTTP one crashdie Once thing ive noticed is that on normal Windows it works elvated but on Windows Server XX it doesnt and crashes Note that if i wrote a command in a wrong way the task became complete and i have the output of mimikats To Reproduce Getting a new Grunt by GruntHTTP Interact with him Run whoami everything fine Run Mimikats sekurlsalogonpasswords or start it from tasks Grunt just dies On own machine with powershell payload and windows it works without problems Expected behavior I would expect Mimikats to work and to have the output into the task window Screenshots Died grunts img Grunt task tasked forever img Grunt tasking img Grunt output empty img Covenant Server Information OS Vagrant with Ubuntu Docker or Native Native with dotnet core installed Browser Information Browser Chrome from Windows machine Version Latest Target Information System that implant is running on OS Windows Microsoft Windows NT Additional context Idk honestly maybe well get more after Adds the task BypassUACRegistry to use either the fodhelper or eventvwr UAC bypasses to execute a command Unhandled exception NullReferenceException on some endpoints of the panel Describe the feature request or bug Exception on Dashboard and Taskings page To Reproduce Steps to reproduce the behavior Go to main page of the panel port Error SystemNullReferenceException Object reference not set to an instance of an object at CovenantViewsGruntTaskingViewsGruntTaskingGruntTaskingTableExecuteAsync in optCovenantCovenantViewsGruntTaskingGruntTaskingTablecshtmlline at MicrosoftAspNetCoreMvcRazorRazorViewRenderPageCoreAsyncIRazorPage page ViewContext context at MicrosoftAspNetCoreMvcRazorRazorViewRenderPageAsyncIRazorPage page ViewContext context Boolean invokeViewStarts at MicrosoftAspNetCoreMvcRazorRazorViewRenderAsyncViewContext context at MicrosoftAspNetCoreMvcViewFeaturesHtmlHelperRenderPartialCoreAsyncString partialViewName Object model ViewDataDictionary viewData TextWriter writer at CovenantViewsHomeViewsHomeIndexExecuteAsync in optCovenantCovenantViewsHomeIndexcshtmlline at MicrosoftAspNetCoreMvcRazorRazorViewRenderPageCoreAsyncIRazorPage page ViewContext context at MicrosoftAspNetCoreMvcRazorRazorViewRenderPageAsyncIRazorPage page ViewContext context Boolean invokeViewStarts at MicrosoftAspNetCoreMvcRazorRazorViewRenderAsyncViewContext context at MicrosoftAspNetCoreMvcViewFeaturesViewExecutorExecuteAsyncViewContext viewContext String contentType Nullable statusCode at MicrosoftAspNetCoreMvcViewFeaturesViewExecutorExecuteAsyncActionContext actionContext IView view ViewDataDictionary viewData ITempDataDictionary tempData String contentType Nullable statusCode at MicrosoftAspNetCoreMvcViewFeaturesViewResultExecutorExecuteAsyncActionContext context ViewResult result at MicrosoftAspNetCoreMvcViewResultExecuteResultAsyncActionContext context at MicrosoftAspNetCoreMvcInternalResourceInvokerInvokeResultAsyncIActionResult result at MicrosoftAspNetCoreMvcInternalResourceInvokerInvokeNextResultFilterAsync TFilterTFilterAsync at MicrosoftAspNetCoreMvcInternalResourceInvokerRethrowResultExecutedContext context at MicrosoftAspNetCoreMvcInternalResourceInvokerResultNext TFilterTFilterAsync State next Scope scope Object state Boolean isCompleted at MicrosoftAspNetCoreMvcInternalResourceInvokerInvokeResultFilters at MicrosoftAspNetCoreMvcInternalResourceInvokerInvokeNextResourceFilter at MicrosoftAspNetCoreMvcInternalResourceInvokerRethrowResourceExecutedContext context at MicrosoftAspNetCoreMvcInternalResourceInvokerNextState next Scope scope Object state Boolean isCompleted at MicrosoftAspNetCoreMvcInternalResourceInvokerInvokeFilterPipelineAsync at MicrosoftAspNetCoreMvcInternalResourceInvokerInvokeAsync at MicrosoftAspNetCoreRoutingEndpointMiddlewareInvokeHttpContext httpContext at MicrosoftAspNetCoreRoutingEndpointRoutingMiddlewareInvokeHttpContext httpContext at MicrosoftAspNetCoreStaticFilesStaticFileMiddlewareInvokeHttpContext context at MicrosoftAspNetCoreAuthenticationAuthenticationMiddlewareInvokeHttpContext context at MicrosoftAspNetCoreStaticFilesStaticFileMiddlewareInvokeHttpContext context at SwashbuckleAspNetCoreSwaggerSwaggerMiddlewareInvokeHttpContext httpContext at MicrosoftAspNetCoreDiagnosticsDeveloperExceptionPageMiddlewareInvokeHttpContext context Covenant Server Information OS Ubuntu Docker or Native Native Browser Information Browser Chrome Firefox Version Target Information System that implant is running on OS NA Version NA Additional context All other pages work as expected grunt data etc A simple update to the PowerShellRemoting Task to reflect the new output provided by SharpSploit v Feature Request or Bug Feature Request Describe the feature request or bug The compiler will not currently allow the inclusion of additional libraries within an ImplantTemplate My use case was to include a reference to SystemServiceProcess to create a Service Binary capable of being used with PsExec Of course there are lots of other useful possibilities such as UnmanagedExports ConfuserEx Obfuscar and more to create more exoteric templates I created dark mode for covenant This should cover the most minimal requirements to implement a Dark Mode toggle There is room to grow with this code also I tried to follow patterns within Covenant I tested this and should be checked again with standardadmin users pulled multiple times to make sure data was recreated correctly in database updated all colors and custom css fields tested creation deletion and selection of active themes Feature Request or Bug Bug Describe the feature request or bug When defining multiple Connect Addresses for the Listener only one gets saved in the listener configuration To Reproduce Add a new Listener Specify multiple ConnectAddress fields Create the listener Select the newly created listener only one IP address is visible Expected behavior There should be multiple connect addresses present in the listener properties as well as in the launcher code Screenshots IP addresses are removed from the screenshots c Covenant Server Information OS Ubuntu LTS Docker or Native Native Browser Information Browser Firefox Version bit Target Information System that implant is running on OS Windows bit Additional context NA Feature Request or Bug Bug Describe the feature request or bug some Launcher views seems to not care about user edit To Reproduce Powershell Steps to reproduce the behavior Go to Launchers Click on Powershell Edit ParameterString Click on Generate See both Launcher and EncodedLauncher dont contain user input To Reproduce MSBuild Steps to reproduce the behavior Go to Launchers Click on MSBuild Edit TargetName andor Taskname Click on Generate See xml file doesnt contain user input Expected behavior Click on generate should consider input field edit Screenshots powershellbug and msbuildbugcrop Covenant Server Information OS WINDOWS Docker or Native Native Browser Information Browser Firefox Version Latest Additional context May Other launcher type could be affected too Feature Request or Bug Bug Describe the feature request or bug Loading SharpSploit and Sharpup Reference Libraries in the same custom task generates an error Syntax Tree already Present To Reproduce Steps to reproduce the behavior Create a new task called MyTask with SharpUp and Sharpsploit reference libraries Add the attached code below to the custom task this is just some test code but the issue is likely to occur with any other code too using System using SystemIO using SystemLinq using SharpUp using SharpSploit public static class Task public static bool shouldExecModulestring userInput string moduleId Function to validate whether the module should be executed or not return userInputContainsall userInputContainsmoduleId public static string Execute string output string command string serverip string modulesToExec sharpup string moduleId string title try moduleId sharpup title Running SharpUp Privilege Escalation Checks if shouldExecModulemodulesToExec moduleId ConsoleWriteLine title ProgramPrivescCheckstrue catch Exception e output eGetTypeFullName eMessage EnvironmentNewLine eStackTrace return output Go to a grunt and type in the task name MyTask See error Syntax Tree Already Found in Interact tab Expected behavior The task should work and SharpUp must execute when MyTask is launched Screenshots Screenshot from Covenant Server Information OS Kali Linux Rolling Docker or Native Docker Browser Information Browser Firefox Version esr Target Information System that implant is running on OS Windows Feature Request or Bug Bug Describe the feature request or bug I created a Task which had some bugs in it due to which C compilation failed on the Grunt when I ran it Now when I attempt to execute any other task including a valid shellCmd on a grunt I am stuck with CompilerException CompilationErrors errors and the previous C compilation errors are shown Is there a way to reset the Grunt so it does not attempt to compile the old task and just executes the specified command To Reproduce Steps to reproduce the behavior Go to Tasks Click on Create Create the task below which has C bugs in it with a single optional param called serverIP using SharpUp using SharpSploitExecution public static class Task public static string Executestring serverIp string output string command try output n output n output Get hostname via hostname command output n output n command hostname output ShellShellCmdExecutecommand output n output n output Get current user and permissions via whoami command output n output n command whoami all output ShellShellCmdExecutecommand output n output n output SharpUp Running Privilege Escalation Checks similar to PowerUp from Powersploit output n output n TextWriter realStdOut ConsoleOut TextWriter realStdErr ConsoleError TextWriter stdOutWriter new StringWriter TextWriter stdErrWriter new StringWriter ConsoleSetOutstdOutWriter ConsoleSetErrorstdErrWriter bool auditMode argsContainsaudit StringComparerCurrentCultureIgnoreCase ProgramPrivescChecksauditMode ConsoleOutFlush ConsoleErrorFlush ConsoleSetOutrealStdOut ConsoleSetErrorrealStdErr output stdOutWriterToString output stdErrWriterToString catch Exception e output eGetTypeFullName eMessage EnvironmentNewLine eStackTrace return output Now go to interact for a Grunt and run the task above a couple of times Subsequent execution of any other task including WhoAmI show the compilation errors for the task above Expected behavior The task should abort if it has bugs in it and other tasks should not be affected Screenshots Attached below Covenant Server Information OS Kali Linux Rolling Docker or Native Docker Browser Information Browser Firefox Version esr bit Target Information System that implant is running on OS Windows SP Version eg 