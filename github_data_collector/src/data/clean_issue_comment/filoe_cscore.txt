I have an mp file which i load into a memorystream and then after some code i play it How can i change the playback speed to x Current code DirectSoundOut SoundOut new DirectSoundOut byte TargetFile FileReadAllBytesPathToFile MemoryStream ms new MemoryStreamTargetFile SoundOutInitializenew CSCoreCodecsMP DmoMp Decoderms SoundOutVolume SoundOutPlay Main readme says CSCoreFfmpeg project which is licensed under the LGPL This file in CSCoreFfmpeg says GNU GENERAL PUBLIC LICENSE And in general I found out that The combination of GPL code and LGPL code must be licensed under the GPL This means that CSCoreFfmpeg cant use LGPL license If FFmpeg is built for LGPL all GPL licenses should be deleted in as those featureslibraries are not used Hello it might be a bit of a stupid question but I cant seem to figure out how to specify an audio inputoutput device for a WaveCapture or WasapiCapture WasapiCapture input new WasapiCapture inputDevice This has to be an MMDevice The problem is I dont know where can I get an MMDevice from I tried enumerating them but I got to a dead end What I could achieve is enumerating all the WaveInDevices and WaveOutDevices Is there any way to convert a WaveInDevice to a MMDevice or somehow get a list of all input MMDevices This class enables the programmer to manipulate Windows settings for audio devices such as the default device for each role Its rather messy due to the fact that the COM Interface IID changes with a considerable frequency hence we need to try to support every possibility falling back to an unknown interface as a last resort This class is basically a mashup of many different implementations of the same feature across public repositories extracting to my best judgment the best of each Its most probably not following the project code standards so Im kinda expecting for someone to help me on that Sorry for any inconvenience As stated in the title DirectSoundOut seems to be throwing a NullReferenceException on Finalize if its been initialized before closing the app No exceptions if it hasnt been initialized yet It seems to be a DirectSound issue specifically because I switched to Wasapi and it didnt throw any exceptions Im using v from NuGet Heres the error I got SystemNullReferenceException HResult x MessageObject reference not set to an instance of an object SourceCSCore StackTrace at CSCoreDirectSoundDirectSoundBufferStopNative at CSCoreDirectSoundDirectSoundBufferStop at CSCoreSoundOutDirectSoundOutCleanupResources at CSCoreSoundOutDirectSoundOutDisposeBoolean disposing at CSCoreSoundOutDirectSoundOutFinalize Today i updated from V to the latest version I noticed that the output volume when playing MP s got way more silent Didnt found a changelog The volume property description says that it has a range from to I was able to set a maximum of now Could not do it in the older version Now in the latest version is the same as in the older version Is this correct and an intended behaviour If it is intended maybe update the description of the property Second question If i start my application from a folder which isnt named Debug then volume sounds like When i just rename the folder back to Debug then volume sounds like Why does the behaviour change if i rename the folder Also if i start the application as release from visual studio volume is super loud If i start it as debug volume is quiet If i rename this debug folder and just start the exe volume is super loud again Now i dont know what to ship to my customers Going back to V isnt rlly an option Thank you for helping This is a codesnipped how i play MP files Using Windows NET Framework WaveSource CodecFactoryInstanceGetCodecfilenameToSampleSourceToMonoToWaveSource SoundOut New WasapiOut With Latency Device MeDevice SoundOutInitializeWaveSource SoundOutVolume SoundOutPlay I am trying to use this library to constantly record the currect audio and adjust the output audio based on the input volume level While using this library on a Windows machine I found that sometimes the WaveIn object will unexpected call the Stopped event call back with an error condition Below is the stack trace along with the Exceptions information Received MM Exception from recording stopped event call back FunctionwaveInUnprepareHeader ResultStillPlaying ExceptionCSCoreMmException Exception of type CSCoreMmException was thrown at CSCoreMmExceptionTryMmResult result String function at CSCoreSoundInWaveInBufferAddBufferToQueue at CSCoreSoundInWaveInFireUpBufferWaveInBuffer buffer After this occurs the object will also throw the same exception when I try to dispose of it Below is s an example of this Received MM Exception while disposing AGC meter FunctionwaveInUnprepareHeader ResultStillPlaying ExceptionCSCoreMmException Exception of type CSCoreMmException was thrown at CSCoreMmExceptionTryMmResult result String function at CSCoreSoundInWaveInBufferDisposeBoolean disposing at CSCoreSoundInWaveInBufferDispose at CSCoreSoundInWaveInDisposeBuffers at CSCoreSoundInWaveInCleanupResources at CSCoreSoundInWaveInDisposeBoolean disposing at CSCoreSoundInWaveInDispose This is generally OK Technically this would cause a small memory leak since I need to create a new object to start recording again but that is not a huge deal What is a big deal is that the Garbage Collector will still try to Finalize the WaveIn and WaveInBuffer objects The finalization of these objects causes the same MMException to be thrown causing my entire application to crash Below are the Net Runtime logs form Windows Event Viewer GC Crashing on WaveIn Finalization Application myAppexe Framework Version v Description The process was terminated due to an unhandled exception Exception Info CSCoreMmException at CSCoreMmExceptionTryCSCoreMmResult SystemString at CSCoreSoundInWaveInBufferDisposeBoolean at CSCoreSoundInWaveInBufferDispose at CSCoreSoundInWaveInDisposeBuffers at CSCoreSoundInWaveInCleanupResources at CSCoreSoundInWaveInDisposeBoolean at CSCoreSoundInWaveInFinalize GC Crashing on WaveInBufferFinalization Application myAppexe Framework Version v Description The process was terminated due to an unhandled exception Exception Info CSCoreMmException at CSCoreMmExceptionTryCSCoreMmResult SystemString at CSCoreSoundInWaveInBufferDisposeBoolean at CSCoreSoundInWaveInBufferFinalize I was able to get around this a little bit by calling GCSuppressFinalization on the WaveIn object However the library does not expose the WaveInBuffer to my application So that situation will still crash my application Is there any way I can prevent these MMExceptions from being thrown Could we change the logic so that the MMExceptions are never thrown from the Finalization method Obviously with the understanding there would be a memory leak I use CSCoreFFmpeg FfmpegDecoder as waveSource to open media file playing is fine but cannot get the playing time length TimeSpan waveSourceGetLength return Then I went down codes and found the streamduration was a very big negative value so the property LengthInSeconds of class AvFormatContext in AvFormatContextcs returned public double LengthInSeconds get if SelectedStream null SelectedStreamStreamduration return var timebase SelectedStreamStreamtimebase if timebaseden return return SelectedStreamStreamduration timebasenum double timebaseden So how to get the real duration of a media file in CSCoreFFmpeg Thank you very much Does CScore support recording X frames at a time Similar to pyaudio open where you can specify the frames per buffer then call read to get those buffers Thanks I tried to write samples of different wave format When i am using WaveWriterWrite I got clear audio but WaveWriterWrite does not take float values So I had to use the WaveWriterWriteSamples but this time i got a different audio I have to do this because I want to reduce the size of the audio captured by the wasapi loopback capture Is there any way by which I can write samples with different format Here is my code var soundIn new WasapiLoopbackCapture soundInInitialize var soundInSource new SoundInSourcesoundIn IWaveSource convertedSource soundInSource ChangeSampleRate sample rate ToSampleSource ToWaveSource var notificationSource new NotificationSourcesoundInSourceToSampleSource notificationSourceInterval notificationSourceBlockRead s e string directory SystemIODirectoryGetCurrentDirectory string filename DateTimeNowTicksToString sample wav directory directory Cache string fileName SystemIOPathCombinedirectory filename using var intercepts new WaveWriterfileName convertedSourceWaveFormat DebugAsserteDataLength eLength interceptsWriteSampleseData eLength int length TimeConverterFactoryInstanceGetTimeConverterForSourcenotificationSource ToTimeSpanconvertedSourceWaveFormat eLengthSeconds var waveSource notificationSourceToWaveSource var writer new WaveWriteroutwav waveSourceWaveFormat byte buffer new byte waveSourceWaveFormatBytesPerSecond soundInSourceDataAvailable s e int read while read waveSourceReadbuffer bufferLength writerWriteeData read soundInStart