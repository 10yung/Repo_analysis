 Description Im trying to include third level entities and its throwing exception Code return contextLesson IncludeFilterx xLessonTime IncludeFilterx xGrades IncludeFilterx xTopicsWherey yIsValid IncludeFilterx xHomeWorksWherey yIsValidSelectq qTaskFiles FirstOrDefaultAsyncx xId lessonId Exception An unhandled exception has occurred while executing the request SystemInvalidOperationException Processing of the LINQ expression source IEnumerableLessonTimesource by NavigationExpandingExpressionVisitor failed This may indicate either a bug or a limitation in EF Core See klinkid for more detailed information at MicrosoftEntityFrameworkCoreQueryInternalNavigationExpandingExpressionVisitorProcessSelectManyNavigationExpansionExpression source LambdaExpression collectionSelector LambdaExpression resultSelector at MicrosoftEntityFrameworkCoreQueryInternalNavigationExpandingExpressionVisitorVisitMethodCallMethodCallExpression methodCallExpression at SystemLinqExpressionsMethodCallExpressionAcceptExpressionVisitor visitor at SystemLinqExpressionsExpressionVisitorVisitExpression node at MicrosoftEntityFrameworkCoreQueryInternalNavigationExpandingExpressionVisitorExpandAndReduceExpression query Boolean applyInclude at MicrosoftEntityFrameworkCoreQueryInternalNavigationExpandingExpressionVisitorExpandExpression query at MicrosoftEntityFrameworkCoreQueryQueryTranslationPreprocessorProcessExpression query at IQueryable Action RelationalQueryContext Object at ZEntityFrameworkExtensionsEFPlusExtensionsEFPlusCreateCommandIQueryable source Action action RelationalQueryContext queryContext Object compiledQuery at ZEntityFrameworkPlusBaseQueryFutureCreateExecutorAndGetCommandRelationalQueryContext queryContext at ZEntityFrameworkPlusQueryFutureBatchCreateCommandCombined at ZEntityFrameworkPlusQueryFutureBatchExecuteQueries at ZEntityFrameworkPlusQueryFutureValue getValue at ZEntityFrameworkPlusQueryIncludeFilterProvider Execute TResult Expression expression at SystemLinqQueryableFirstOrDefault TSource IQueryable source Expression predicate Further technical details EF version EF Plus version Database Provider MicrosoftEntityFrameworkCoreSqlServer Version Description Batch Update in EF Core with pgsql throw exception column reference Id is ambiguous My Code await dbCustomers Wherex lstIdsContainsxId UpdateAsyncx new Customer Status CustomerStatusDeleted Sql Command UPDATE Customers SET Status WHERE EXISTS SELECT FROM SELECT xId xAddress xAffSid xApplicationUserId xAvatar xBankName xBankNumber xBigDataId xCode xCreateDate xDay xEmail xFacebookId xFax xFirstName xFullName xGender xIdCard xIdCardIssued xIdCardProvince xIsRecommender xIsStaff xLastName xMonth xNotes xPhone xPhoneOther xRate xRecommenderId xRsWifiId xStatus xSyncApiCustomerId xSyncApiDate xTaxCode xYear xZaloId xId xLocationDistrictId xLocationProvinceId xLocationWardId FROM Customers AS x WHERE xId IN B WHERE CustomersId BId Exception If you are seeing an exception include the full exceptions details message and stack trace Exception message column reference Id is ambiguous Stack trace at NpgsqlNpgsqlConnectorcDisplayClass ReadMessagegReadMessageLong dMoveNext in C projects npgsql src Npgsql NpgsqlConnectorcsline End of stack trace from previous location where exception was thrown at NpgsqlNpgsqlConnectorcDisplayClass ReadMessagegReadMessageLong dMoveNext in C projects npgsql src Npgsql NpgsqlConnectorcsline End of stack trace from previous location where exception was thrown at SystemThreadingTasksValueTask getResult at NpgsqlNpgsqlDataReaderNextResultBoolean async Boolean isConsuming in C projects npgsql src Npgsql NpgsqlDataReadercsline at NpgsqlNpgsqlDataReaderNextResult in C projects npgsql src Npgsql NpgsqlDataReadercsline at NpgsqlNpgsqlCommandExecuteDbDataReaderCommandBehavior behavior Boolean async CancellationToken cancellationToken in C projects npgsql src Npgsql NpgsqlCommandcsline at SystemThreadingTasksValueTask getResult at NpgsqlNpgsqlCommandExecuteNonQueryBoolean async CancellationToken cancellationToken in C projects npgsql src Npgsql NpgsqlCommandcsline at NpgsqlNpgsqlCommandExecuteNonQuery in C projects npgsql src Npgsql NpgsqlCommandcsline at ZEntityFrameworkExtensionsBatchUpdateExecute T IQueryable query Expression updateFactory at BatchUpdateExtensionsUpdateFromQuery T IQueryable query Expression updateFactory Action batchUpdateBuilder at ZEntityFrameworkPlusBatchUpdateExtensionsUpdate T IQueryable query Expression updateFactory Action batchUpdateBuilder at ZEntityFrameworkPlusBatchUpdateExtensionscDisplayClass UpdateAsyncb at SystemThreadingTasksTask InnerInvoke at SystemThreadingTasksTaskccctorb Object obj at SystemThreadingExecutionContextRunInternalExecutionContext executionContext ContextCallback callback Object state End of stack trace from previous location where exception was thrown at SystemThreadingExecutionContextRunInternalExecutionContext executionContext ContextCallback callback Object state at SystemThreadingTasksTaskExecuteWithThreadLocalTask currentTaskSlot End of stack trace from previous location where exception was thrown at RedsandSiteApiCustomerControllerBulkRemoveString ids in D ECRM Api Customer CustomerControllercsline Further technical details EF version EF Plus version Database Provider Postgresql Hi I am using the ZEntityFrameworkPlus with enityframework in my blazor app for audit Tracking I have one parent class Client and and onother child Address in same entity But when I change the address object value in Client and Ill try to save it its doesnt workIf I dont use below forrmt then its difficlut for me to track the enityt update because ZEntityFrameworkPlus reuireq manually update entry for audit login for every enity which i updated Only update Client object if I used below approch and only track the client modification which I did csharp using var scope ServiceScopeFactoryCreateScope var referenceContext scopeServiceProviderGetServiceApplicationDbContext Use for Audit Logging var audit new Audit auditCreatedBy clientLastModifiedBy var originalClient client clientLastModifiedAt DateTimeUtcNow referenceContextEntryoriginalClientAddressCurrentValuesSetValuesclientAddress referenceContextEntryoriginalClientCurrentValuesSetValuesclient Pass Audit Insatnce for Audit Logging referenceContextSaveChangesaudit Its work if I follow below approch but using this i dont able to track the audit of any entity csharp using var scope ServiceScopeFactoryCreateScope var referenceContext scopeServiceProviderGetServiceApplicationDbContext referenceContextEntryAddressState EntityStateModified referenceContextEntryClientState EntityStateModified referenceContextSaveChanges public class Client AuditInfo Required public int Id get set Required MaxLength ErrorMessage Sorry You are Exceeding the chracter Limit for First Name RegularExpression azAZ azAZ ErrorMessage First Name must contain charcter only public string FirstName get set MaxLength ErrorMessage Sorry You are Exceeding the chracter Limit for Middle Name RegularExpression azAZ azAZ ErrorMessage Middle Name must contain charcter only public string MiddleName get set Required MaxLength ErrorMessage Sorry You are Exceeding the chracter Limit for Last Name RegularExpression azAZ azAZ ErrorMessage Last Name must contain charcter only public string LastName get set Required MaxLength public string Gender get set Required DataTypeDataTypeDate ColumnTypeName date public DateTime DateOfBirth get set ValidateComplexType public Address Address get set public class Address AuditInfo Required public int Id get set Required MaxLength ErrorMessage Sorry You are Exceeding the chracter Limit for First Line public string FirstLine get set public string SecondLine get set RequiredErrorMessage Please select the Province MaxLength ErrorMessage Sorry You are Exceeding the chracter Limit for Province public string Province get set Required MaxLength ErrorMessage Sorry You are Exceeding the chracter Limit for City RegularExpression azAZ azAZ ErrorMessage City Name contain charcter only public string City get set Required MaxLength ErrorMessage Sorry You are Exceeding the chracter Limit for PostalCode public string PostalCode get set Required public bool IsActive get set Description In my DbContext I have entities that use Net Topology Suites Point and Polygon objects for properties When attempting to use FutureValue and probably Future to select an entity results in an exception Exception SystemInvalidCastException Unable to cast object of type ZEntityFrameworkPlusCreateEntityDataReader to type MicrosoftDataSqlClientSqlDataReader at lambdamethodClosure QueryContext DbDataReader ResultContext Int ResultCoordinator at MicrosoftEntityFrameworkCoreQueryInternalQueryingEnumerable EnumeratorMoveNext at ZEntityFrameworkPlusQueryFutureValue SetResultDbDataReader reader at ZEntityFrameworkPlusQueryFutureBatchExecuteQueries at ZEntityFrameworkPlusQueryFutureValue getValue at REMOVEDAppPortalDevicesArmCommandHandlerHandleCommand command CancellationToken cancellationToken in E Software Development REMOVED REMOVEDAppPortal Features Devices Armcsline at MediatRPipelineRequestExceptionProcessorBehavior HandleTRequest request CancellationToken cancellationToken RequestHandlerDelegate next at MediatRPipelineRequestExceptionProcessorBehavior HandleTRequest request CancellationToken cancellationToken RequestHandlerDelegate next at MediatRPipelineRequestExceptionActionProcessorBehavior HandleTRequest request CancellationToken cancellationToken RequestHandlerDelegate next at MediatRPipelineRequestExceptionActionProcessorBehavior HandleTRequest request CancellationToken cancellationToken RequestHandlerDelegate next at MediatRPipelineRequestPostProcessorBehavior HandleTRequest request CancellationToken cancellationToken RequestHandlerDelegate next at MediatRPipelineRequestPreProcessorBehavior HandleTRequest request CancellationToken cancellationToken RequestHandlerDelegate next at REMOVEDAppPortalDevicesDevicesControllerArmInt id in E Software Development REMOVED REMOVEDAppPortal Features Devices DevicesControllercsline at MicrosoftAspNetCoreMvcInfrastructureActionMethodExecutorTaskOfIActionResultExecutorExecuteIActionResultTypeMapper mapper ObjectMethodExecutor executor Object controller Object arguments at MicrosoftAspNetCoreMvcInfrastructureControllerActionInvokerInvokeActionMethodAsyncgAwaited ControllerActionInvoker invoker ValueTask actionResultValueTask at MicrosoftAspNetCoreMvcInfrastructureControllerActionInvokerInvokeNextActionFilterAsyncgAwaited ControllerActionInvoker invoker Task lastTask State next Scope scope Object state Boolean isCompleted at MicrosoftAspNetCoreMvcInfrastructureControllerActionInvokerRethrowActionExecutedContextSealed context at MicrosoftAspNetCoreMvcInfrastructureControllerActionInvokerNextState next Scope scope Object state Boolean isCompleted at MicrosoftAspNetCoreMvcInfrastructureControllerActionInvokerInvokeInnerFilterAsync End of stack trace from previous location where exception was thrown at MicrosoftAspNetCoreMvcInfrastructureResourceInvokerInvokeNextResourceFiltergAwaited ResourceInvoker invoker Task lastTask State next Scope scope Object state Boolean isCompleted at MicrosoftAspNetCoreMvcInfrastructureResourceInvokerRethrowResourceExecutedContextSealed context at MicrosoftAspNetCoreMvcInfrastructureResourceInvokerNextState next Scope scope Object state Boolean isCompleted at MicrosoftAspNetCoreMvcInfrastructureResourceInvokerInvokeFilterPipelineAsync End of stack trace from previous location where exception was thrown at MicrosoftAspNetCoreMvcInfrastructureResourceInvokerInvokeAsyncgLogged ResourceInvoker invoker at MicrosoftAspNetCoreRoutingEndpointMiddlewareInvokegAwaitRequestTask Endpoint endpoint Task requestTask ILogger logger at REMOVEDAppApplicationUserMiddlewareInvokeAsyncHttpContext context ApplicationUserServices services in E Software Development REMOVED REMOVEDApp Middlewares ApplicationUserMiddlewarecsline at MicrosoftAspNetCoreAuthorizationAuthorizationMiddlewareInvokeHttpContext context at MicrosoftAspNetCoreAuthenticationAuthenticationMiddlewareInvokeHttpContext context at Arex AspNetCoreHtmlMinifierMiddlewareInvokeAsyncHttpContext context at Arex AspNetCoreAntiFaviconMiddlewareInvokeAsyncHttpContext context at StackExchangeProfilingMiniProfilerMiddlewareInvokeHttpContext context in C projects dotnet src MiniProfilerAspNetCore MiniProfilerMiddlewarecsline at MicrosoftAspNetCoreDiagnosticsEntityFrameworkCoreMigrationsEndPointMiddlewareInvokeHttpContext context at MicrosoftAspNetCoreDiagnosticsEntityFrameworkCoreDatabaseErrorPageMiddlewareInvokeHttpContext httpContext at MicrosoftAspNetCoreDiagnosticsEntityFrameworkCoreDatabaseErrorPageMiddlewareInvokeHttpContext httpContext at MicrosoftAspNetCoreDiagnosticsDeveloperExceptionPageMiddlewareInvokeHttpContext context EF Plus seems to be having a hard time with NTS but it is the officially recommended library for geospatial data with SQL Server so Im kind of stuck Further technical details EF version EF Plus version Database Provider SQL Server Description We are using IncludeFilter to get elements filtering by some property In our example we have one entity called Tariff wich has childs called SubElement When we try to get a set of elements of Tariff with some of the SubElements using IncludeFilter it throws an exception The code that throws the exception using var ctx new MyDbContextoptionsBuilderOptions PrepareDatabasectx try var set ctxTariffsIncludeFilterf fSubElementsWheres sIsSoftDeleted trueToList catch Exception ex ConsoleWriteLineexMessage throw ex Exception Exception message Cannot set MySqlCommandCommandText when there is an open DataReader for this command it must be closed first Stack trace at MySqlDataMySqlClientMySqlCommandsetCommandTextString value in C projects mysqlconnector src MySqlConnector MySqlDataMySqlClient MySqlCommandcsline at MicrosoftEntityFrameworkCoreStorageInternalRelationalCommandCreateCommandIRelationalConnection connection IReadOnlyDictionary parameterValues at PomeloEntityFrameworkCoreMySqlStorageInternalMySqlConverterCommandBuilderFactoryMySqlConverterRelationalCommandBuilderMySqlConverterRelationalCommandExecuteIRelationalConnection connection DbCommandMethod executeMethod IReadOnlyDictionary parameterValues at MicrosoftEntityFrameworkCoreStorageInternalRelationalCommandExecuteReaderIRelationalConnection connection IReadOnlyDictionary parameterValues at MicrosoftEntityFrameworkCoreQueryInternalQueryingEnumerable EnumeratorBufferlessMoveNextDbContext Boolean buffer at PomeloEntityFrameworkCoreMySqlStorageInternalMySqlExecutionStrategyExecute TStateTResult TState state Func operation Func verifySucceeded at MicrosoftEntityFrameworkCoreQueryInternalQueryingEnumerable EnumeratorMoveNext at MicrosoftEntityFrameworkCoreQueryInternalLinqOperatorProviderTrackEntities TOutTIn IEnumerable results QueryContext queryContext IList entityTrackingInfos IList entityAccessorsMoveNext at MicrosoftEntityFrameworkCoreQueryInternalLinqOperatorProviderExceptionInterceptor EnumeratorExceptionInterceptorMoveNext at ZEntityFrameworkPlusQueryFutureEnumerable SetResultIEnumerator enumerator at ZEntityFrameworkPlusQueryFutureEnumerable SetResultDbDataReader reader at ZEntityFrameworkPlusQueryFutureBatchExecuteQueries at ZEntityFrameworkPlusQueryFutureEnumerable GetEnumerator at SystemCollectionsGenericList AddEnumerableIEnumerable enumerable at SystemLinqEnumerableToList TSource IEnumerable source at ZEntityFrameworkPlusQueryIncludeFilterParentQueryable CreateEnumerable at ZEntityFrameworkPlusQueryIncludeFilterParentQueryable GetEnumerator at SystemCollectionsGenericList AddEnumerableIEnumerable enumerable at SystemLinqEnumerableToList TSource IEnumerable source at EfPlusPomeloProgramMainString args in C proyectos EfPlusPomelo Programcsline Fiddle or Project EfPlusPomelozip Further technical details EF version EF Plus version Database Provider PomeloEntityFrameworkCoreMySql Description Attempting to call Update on a query for a table with HasNoKey set on its model builder throws an exception here I have a keyless table for holding app config values that has only one row I would like to run a statement like sql UPDATE Configuration SET SomeConfigValue Ive tried several variations of EF queries csharp await contextConfiguration UpdateAsyncc new Configuration SomeConfigValue await contextConfigurationWherex true UpdateAsyncc new Configuration SomeConfigValue Exception SystemArgumentOutOfRangeException Index was out of range Must be nonnegative and less than the size of the collection Parameter index at SystemCollectionsGenericList getItemInt index at ZEntityFrameworkPlusBatchUpdateCreateCommandIQueryable query IEntityType entity List values at ZEntityFrameworkPlusBatchUpdateExecute T IQueryable query Expression updateFactory at ZEntityFrameworkPlusBatchUpdateExtensionsUpdate T IQueryable query Expression updateFactory Action batchUpdateBuilder at ZEntityFrameworkPlusBatchUpdateExtensionscDisplayClass UpdateAsyncb Further technical details EF version EF Core EF Plus version Database Provider Postgres I have a problem with this code using var context new DataContext contextOrder Whereorder orderOrderId Updatex new Order Comment xComment null xComment r n TEST public partial class Order public int OrderId get set public string Comment get set Exception SqlException x The multipart identifier orderComment could not be bound The multipart identifier orderComment could not be bound SystemDataSqlClientSqlConnectionOnErrorSqlException exception Boolean breakConnection Action wrapCloseInAction SystemDataSqlClientSqlInternalConnectionOnErrorSqlException exception Boolean breakConnection Action wrapCloseInAction SystemDataSqlClientTdsParserThrowExceptionAndWarningTdsParserStateObject stateObj Boolean callerHasConnectionLock Boolean asyncClose SystemDataSqlClientTdsParserTryRunRunBehavior runBehavior SqlCommand cmdHandler SqlDataReader dataStream BulkCopySimpleResultSet bulkCopyHandler TdsParserStateObject stateObj Boolean dataReady SystemDataSqlClientSqlCommandRunExecuteNonQueryTdsString methodName Boolean async Int timeout Boolean asyncWrite SystemDataSqlClientSqlCommandInternalExecuteNonQueryTaskCompletionSource completion String methodName Boolean sendToPipe Int timeout Boolean usedCache Boolean asyncWrite Boolean inRetry SystemDataSqlClientSqlCommandExecuteNonQuery ZEntityFrameworkPlusBatchUpdateExecuteIQueryable query Expression updateFactory ZEntityFrameworkPlusBatchUpdateExtensionsUpdateIQueryable query Expression updateFactory Action batchUpdateBuilder ZEntityFrameworkPlusBatchUpdateExtensionsUpdateIQueryable query Expression updateFactory Generated SQL UPDATE A SET A Comment CASE WHEN order Comment IS NOT NULL THEN order Comment N ELSE N END N TEST FROM Order AS A INNER JOIN SELECT order OrderId order AccessOpenCode FROM Order AS order WHERE order OrderId AS B ON A OrderId B OrderId Further technical details ZEntityFrameworkExtensionsEFCore version ZEntityFrameworkPlusEFCore version ZExpressionsEval version MicrosoftEntityFrameworkCore version Database Provider MSSQL NET Description Id like to do an update that translates roughly to the following SQL in Postgres flavor update Foo f set Rank select count from Foo f where f GroupId fGroupId and f Score fScore Status where fStatus In C Id expect it to look something like await dbFooWheref fStatus UpdateAsyncf new Foo Rank dbFoosCountf f GroupId fGroupId f Score fScore Exception This is what happens when I execute the code above SystemInvalidOperationException variable f of type Foo referenced from scope but it is not defined at SystemLinqExpressionsCompilerVariableBinderReferenceParameterExpression node VariableStorageKind storage at SystemLinqExpressionsCompilerVariableBinderVisitParameterParameterExpression node at SystemLinqExpressionsParameterExpressionAcceptExpressionVisitor visitor at SystemLinqExpressionsCompilerVariableBinderVisitExpression node at SystemLinqExpressionsExpressionVisitorVisitMemberMemberExpression node at SystemLinqExpressionsMemberExpressionAcceptExpressionVisitor visitor at SystemLinqExpressionsCompilerVariableBinderVisitExpression node at SystemLinqExpressionsExpressionVisitorVisitBinaryBinaryExpression node at SystemLinqExpressionsBinaryExpressionAcceptExpressionVisitor visitor at SystemLinqExpressionsCompilerVariableBinderVisitExpression node at SystemLinqExpressionsExpressionVisitorVisitBinaryBinaryExpression node at SystemLinqExpressionsBinaryExpressionAcceptExpressionVisitor visitor at SystemLinqExpressionsCompilerVariableBinderVisitExpression node at SystemLinqExpressionsExpressionVisitorVisitReadOnlyCollection nodes at SystemLinqExpressionsCompilerVariableBinderVisitLambda T Expression node at SystemLinqExpressionsExpression AcceptExpressionVisitor visitor at SystemLinqExpressionsCompilerVariableBinderVisitExpression node at SystemLinqExpressionsCompilerVariableBinderVisitUnaryUnaryExpression node at SystemLinqExpressionsUnaryExpressionAcceptExpressionVisitor visitor at SystemLinqExpressionsCompilerVariableBinderVisitExpression node at SystemDynamicUtilsExpressionVisitorUtilsVisitArgumentsExpressionVisitor visitor IArgumentProvider nodes at SystemLinqExpressionsExpressionVisitorVisitMethodCallMethodCallExpression node at SystemLinqExpressionsMethodCallExpressionAcceptExpressionVisitor visitor at SystemLinqExpressionsCompilerVariableBinderVisitExpression node at SystemLinqExpressionsExpressionVisitorVisitBinaryBinaryExpression node at SystemLinqExpressionsBinaryExpressionAcceptExpressionVisitor visitor at SystemLinqExpressionsCompilerVariableBinderVisitExpression node at SystemLinqExpressionsExpressionVisitorVisitReadOnlyCollection nodes at SystemLinqExpressionsCompilerVariableBinderVisitLambda T Expression node at SystemLinqExpressionsExpression AcceptExpressionVisitor visitor at SystemLinqExpressionsCompilerVariableBinderVisitExpression node at SystemLinqExpressionsCompilerVariableBinderVisitUnaryUnaryExpression node at SystemLinqExpressionsUnaryExpressionAcceptExpressionVisitor visitor at SystemLinqExpressionsCompilerVariableBinderVisitExpression node at SystemDynamicUtilsExpressionVisitorUtilsVisitArgumentsExpressionVisitor visitor IArgumentProvider nodes at SystemLinqExpressionsExpressionVisitorVisitMethodCallMethodCallExpression node at SystemLinqExpressionsMethodCallExpressionAcceptExpressionVisitor visitor at SystemLinqExpressionsCompilerVariableBinderVisitExpression node at SystemLinqExpressionsExpressionVisitorVisitReadOnlyCollection nodes at SystemLinqExpressionsCompilerVariableBinderVisitLambda T Expression node at SystemLinqExpressionsExpression AcceptExpressionVisitor visitor at SystemLinqExpressionsCompilerVariableBinderVisitExpression node at SystemLinqExpressionsCompilerLambdaCompilerCompileLambdaExpression lambda at ZEntityFrameworkPlusBatchUpdateGetInnerValues T IQueryable query Expression updateFactory IEntityType entity at ZEntityFrameworkPlusBatchUpdateExecute T IQueryable query Expression updateFactory at ZEntityFrameworkPlusBatchUpdateExtensionsUpdate T IQueryable query Expression updateFactory Action batchUpdateBuilder at ZEntityFrameworkPlusBatchUpdateExtensionscDisplayClass UpdateAsyncb Further technical details EF version preview EF Plus version Database Provider Npgsql Reference Description when use ZEntityFrameworkPlusEFCore how to log sql script to terminal in development environment in development environment when I use MicrosoftEntityFrameworkCore I can find sql script in terminal Further technical details EF Core version EF Plus version 