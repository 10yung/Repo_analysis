Id suggest to change typedef enum FALSE TRUE NBBOOL to sth like typedef enum FALSE TRUE NBBOOL and all corresponding occurrences the problem with the first one is that you cant include machodyldh it would see it as redeclaration of TRUEFALSE So problems would occur when integrating the code in other projects Hello I have trying out dnscat in a lab environment and have observed when an iterative query is performed by bind installed from Alpine the client will fail to establish a tunnel After looking into the problem it appears that bind ships with Query Name Minimisation feature as defined by RFC enabled by default More information Essentially bind is making a number of A queries of the form examplecom where dnscat server it authoritative for examplecom Eg if the client wants examplecom bind will make the following requests for A and AAAA RRs com examplecom examplecom etc Sadly dnscat does not expect this and results only rejecting the first query that it is authoritative for examplecom as not found and ignoring later requests A non invasive workaround to the problem is adding a dummy dns server that is authoritative for the same domain as dnscat but with no RRs and configuring dnscat to proxy requests to it ie it will reject anything that dnscat can process Alternatively disabling qname minimisation on the server would be acceptable Im on an AWS Lightsail Ubuntu VPS Ive tried running ruby dnscat rb to get the dnscat prompt However I keep getting the following errors Security policy changed All connections must be encrypted Traceback most recent call last from dnscat rb in main from rootdnscat servertunneldriverstunneldriversrb in start from rootdnscat servertunneldriverstunneldriversrb in new from rootdnscat servertunneldriversdriverdnsrb in initialize from rootdnscat servertunneldriversdriverdnsrb in new from rootdnscat serverlibsdnserrb in initialize rootdnscat serverlibsdnserrb in bind Address already in use bind for port ErrnoEADDRINUSE Ive used netstat to see that I have a systemdresolve process listening on port However Ive tried editing the resolvedconf to DNSStubListenerno and I still get the exact same errors Ive been wracking my brain trying to figure this out for the better part of a day and Im not sure what to do Any ideas i have a problem in running ruby dnscat Traceback most recent call last from dnscat rb in main from usrlocallibruby rubygemscoreextkernelrequirerb in require from usrlocallibruby rubygemscoreextkernelrequirerb in require from rootdnscat serverlibsswindowrb in top required from usrlocallibruby rubygemscoreextkernelrequirerb in require usrlocallibruby rubygemscoreextkernelrequirerb in require cannot load such file readline LoadError Windows Microsoft Visual Studio Community Version VisualStudio Release Microsoft NET Framework Version Installed Version Community Visual C AA Microsoft Visual C ASPNET and Web Tools ASPNET and Web Tools C Tools beta b fb c cccc ceb a dba a e c a C components used in the IDE Depending on your project type and settings a different version of the compiler may be used Common Azure Tools Provides common services for use by Azure Mobile Services and Microsoft Azure Tools JavaScript Language Service JavaScript Language Service Microsoft JVM Debugger Provides support for connecting the Visual Studio debugger to JDWP compatible Java Virtual Machines Microsoft MIBased Debugger Provides support for connecting Visual Studio to MI compatible debuggers Microsoft Visual C Wizards Microsoft Visual C Wizards Microsoft Visual Studio VC Package Microsoft Visual Studio VC Package MLGen Package Extension MLGen Package Visual Studio Extension Detailed Info NuGet Package Manager NuGet Package Manager in Visual Studio For more information about NuGet visit ProjectServicesPackage Extension ProjectServicesPackage Visual Studio Extension Detailed Info ResourcePackage Extension ResourcePackage Visual Studio Extension Detailed Info ResourcePackage Extension ResourcePackage Visual Studio Extension Detailed Info Test Adapter for BoostTest Enables Visual Studios testing tools with unit tests written for BoostTest The use terms and Third Party Notices are available in the extension installation directory Test Adapter for Google Test Enables Visual Studios testing tools with unit tests written for Google Test The use terms and Third Party Notices are available in the extension installation directory Visual Basic Tools beta b fb c cccc ceb a dba a e c a Visual Basic components used in the IDE Depending on your project type and settings a different version of the compiler may be used Visual C for Linux Development Visual C for Linux Development Visual Studio Code Debug Adapter Host Package Interop layer for hosting Visual Studio Code debug adapters in Visual Studio Visual Studio Tools for CMake Visual Studio Tools for CMake Build started Project dnscat Configuration Debug Win cl Command line warning D option Gm has been deprecated and will be removed in a future release driverdnsc e downloads dnscat master client tunneldrivers driverdnsc fatal error C Cannot open include file asserth No such file or directory udpc e downloads dnscat master client libs udpc fatal error C Cannot open include file stdioh No such file or directory typesc e downloads dnscat master client libs typesc fatal error C Cannot open include file ctypeh No such file or directory tcpc e downloads dnscat master client libs tcpc fatal error C Cannot open include file stdioh No such file or directory selectgroupc e downloads dnscat master client libs selectgroupc fatal error C Cannot open include file asserth No such file or directory mygetoptc e downloads dnscat master client libs mygetoptc fatal error C Cannot open include file systypesh No such file or directory memoryc e downloads dnscat master client libs memoryc fatal error C Cannot open include file ctypeh No such file or directory logc e downloads dnscat master client libs logc fatal error C Cannot open include file stdioh No such file or directory llc e downloads dnscat master client libs llc fatal error C Cannot open include file stdioh No such file or directory dnsc e downloads dnscat master client libs dnsc fatal error C Cannot open include file asserth No such file or directory sha c e downloads dnscat master client libs crypto sha c fatal error C Cannot open include file asserth No such file or directory salsa c e downloads dnscat master client libs crypto salsa c fatal error C Cannot open include file stddefh No such file or directory uECCc e downloads dnscat master client libs pstdinth fatal error C Cannot open include file stddefh No such file or directory encryptorc e downloads dnscat master client libs crypto encryptorc fatal error C Cannot open include file stdioh No such file or directory bufferc e downloads dnscat master client libs bufferc fatal error C Cannot open include file asserth No such file or directory driverpingc e downloads dnscat master client drivers driverpingc fatal error C Cannot open include file asserth No such file or directory driverexecc e downloads dnscat master client drivers driverexecc fatal error C Cannot open include file asserth No such file or directory driverconsolec e downloads dnscat master client drivers driverconsolec fatal error C Cannot open include file asserth No such file or directory driverc e downloads dnscat master client drivers driverc fatal error C Cannot open include file asserth No such file or directory drivercommandc e downloads dnscat master client drivers command drivercommandc fatal error C Cannot open include file asserth No such file or directory Generating Code Compiling commandpacketc e downloads dnscat master client drivers command commandpacketc fatal error C Cannot open include file stdioh No such file or directory dnscatc e downloads dnscat master client dnscatc fatal error C Cannot open include file asserth No such file or directory sessionc e downloads dnscat master client controller sessionc fatal error C Cannot open include file asserth No such file or directory packetc e downloads dnscat master client controller packetc fatal error C Cannot open include file asserth No such file or directory controllerc e downloads dnscat master client controller controllerc fatal error C Cannot open include file asserth No such file or directory Generating Code Done building project dnscat vcxproj FAILED Build succeeded failed uptodate skipped If server side is not available for some time client will disconnect and quit That means losing shell This is bit hackish implementation of reconnectrebeacon Also implemented hardcoding of the most needed parameters As I told you it is not perfect but it works Feel free to decide what you want with it Implemented initial mingw support So it is possible to compile from Mac or Linux Display stack trace but do not fail and exit losing shells can be nightmare For example dnscat server fails with following error messages on long running servers Caught an error DNS packet was truncated or we messed up parsing it pentestdnscat serverlibsdnserrb in unpack pentestdnscat serverlibsdnserrb in parse pentestdnscat serverlibsdnserrb in block levels in onrequest pentestdnscat serverlibsdnserrb in loop pentestdnscat serverlibsdnserrb in block in onrequest Protocol exception caught in dnscat DNS module for more information check window dns DnscatException Received a packet with no questions Caught an error undefined method serialize for nilNilClass pentestdnscat serverlibsdnserrb in block in serialize pentestdnscat serverlibsdnserrb in each pentestdnscat serverlibsdnserrb in serialize pentestdnscat serverlibsdnserrb in reply pentestdnscat serverlibsdnserrb in error pentestdnscat servertunneldriversdriverdnsrb in rescue in block in initialize pentestdnscat servertunneldriversdriverdnsrb in block in initialize pentestdnscat serverlibsdnserrb in block levels in onrequest pentestdnscat serverlibsdnserrb in loop pentestdnscat serverlibsdnserrb in block in onrequest pentestdnscat serverlibsdnserrb in rescue in block levels in onrequest undefined method responsetemplate for DNSerTransaction x dd a NoMethodError Did you mean respondto from pentestdnscat serverlibsdnserrb in block levels in onrequest from pentestdnscat serverlibsdnserrb in loop from pentestdnscat serverlibsdnserrb in block in onrequest Google and Cloudfare both have implementation of DNS over HTTPS and was wondering if it can be used as an implementation to this tool This tool can be leveraged using the running cloudflared proxydns then dnscat dns server domainskullseclabsorg ping Client Encrypted DNS over HTTPS to Cloudflare The Skullseclabs DNS Server Requesting for this method to simulate the traffic as HTTPS Traffic This should also bypass corporate that uses solely internal DNS Server When try to connect the session is reset With other types of requests the session is established and stable dns serveripadresstypeA d Creating DNS driver domain null host port type A server ipadress INFO Setting sessionname to command HOST INFO Sending DNS query for dnscatblablabla to ipadress NOT IMPLEMENTED WARNING Terminating Server domainname e open f f shows dnscat Received dnscatblablablaA Creating Encryptor with secret secret New window created historysize session Not decrypting data incoming data seemed to be cleartext cleartext Setting their public key public key Setting my public key public key Returning an unencrypted response Sending i will to hide queryes and adresses Please help in solving 