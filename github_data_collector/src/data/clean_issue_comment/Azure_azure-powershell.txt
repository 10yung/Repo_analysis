 DO NOT DELETE THIS TEMPLATE Description Adding tests cases for previous PR Checklist I have read the Submitting Changes blobmasterCONTRIBUTINGmdsubmittingchanges section of CONTRIBUTINGmd blobmasterCONTRIBUTINGmd The title of the PR is clear and informative The appropriate ChangeLogmd files has been updated For any service the ChangeLogmd file can be found at srcSERVICESERVICEChangeLogmd A snippet outlining the changes made in the PR should be written under the Upcoming Release header no new version header should be added The PR does not introduce breaking changes blobmasterdocumentationbreakingchangesbreakingchangesdefinitionmd If applicable the changes made in the PR have proper test coverage For public API changes to cmdlets a cmdlet design review was approved for the changes in this repository Microsoft internal only the markdown help files have been regenerated using the commands listed here blobmasterdocumentationdevelopmentdocshelpgenerationmdupdatingallmarkdownfilesinamodule to avoid throttling when GetAzVM Status is performed without VM name DO NOT DELETE THIS TEMPLATE Description Please add a brief description of the changes made in this PR Checklist x I have read the Submitting Changes blobmasterCONTRIBUTINGmdsubmittingchanges section of CONTRIBUTINGmd blobmasterCONTRIBUTINGmd x The title of the PR is clear and informative x The appropriate ChangeLogmd files has been updated For any service the ChangeLogmd file can be found at srcSERVICESERVICEChangeLogmd A snippet outlining the changes made in the PR should be written under the Upcoming Release header no new version header should be added x The PR does not introduce breaking changes blobmasterdocumentationbreakingchangesbreakingchangesdefinitionmd x If applicable the changes made in the PR have proper test coverage x For public API changes to cmdlets x a cmdlet design review was approved for the changes in this repository Microsoft internal only x the markdown help files have been regenerated using the commands listed here blobmasterdocumentationdevelopmentdocshelpgenerationmdupdatingallmarkdownfilesinamodule DO NOT DELETE THIS TEMPLATE Description To support forced tunneling scenarios we need to be able to assign a separate subnet and public IP address to Azure Firewall that it will use for control plane traffic This PR introduces changes to support this functionality Original PR Reopened PR against master branch instead of December branch Checklist x I have read the Submitting Changes blobmasterCONTRIBUTINGmdsubmittingchanges section of CONTRIBUTINGmd blobmasterCONTRIBUTINGmd x The title of the PR is clear and informative x The appropriate ChangeLogmd files has been updated For any service the ChangeLogmd file can be found at srcSERVICESERVICEChangeLogmd A snippet outlining the changes made in the PR should be written under the Upcoming Release header no new version header should be added x The PR does not introduce breaking changes blobmasterdocumentationbreakingchangesbreakingchangesdefinitionmd x If applicable the changes made in the PR have proper test coverage For public API changes to cmdlets a cmdlet design review was approved for the changes in this repository Microsoft internal only x the markdown help files have been regenerated using the commands listed here blobmasterdocumentationdevelopmentdocshelpgenerationmdupdatingallmarkdownfilesinamodule I have recently added AzureAttestationServiceEndpointResourceId and AzureAttestationServiceEndpointSuffix to AzAccount and the current AzAccount version should have contained the changes I am developing new powershell cmdlets for attestation and need to query the serviceClientCredientials from AzureAttestationServiceEndpointResourceId But I am getting the error Your Azure credentials have not been set up or have expired please run ConnectAzAccount to set up your Azure credentials After further debug I found that AzureAttestationServiceEndpointResourceIdis is not defined in either Environment or ExtendedProperties dictinary Here is the version it refers to region Assembly MicrosoftAzurePowerShellAuthenticationAbstractions Version Cultureneutral PublicKeyToken bf ad e C Users shlei nuget packages microsoftazurepowershellauthenticationabstractions preview lib netstandard MicrosoftAzurePowerShellAuthenticationAbstractionsdll PS C myWorkingDirectory azurepowershell artifacts Debug AzAttestation module ModuleType Version Name ExportedCommands Manifest AzAccounts AddAzEnvironment ClearAzContext ClearAzDefault Connec PS C myWorkingDirectory azurepowershell artifacts Debug AzAttestation GetAzEnvironment Name AzureCloud fl Name AzureCloud EnableAdfsAuthentication False OnPremise False ActiveDirectoryServiceEndpointResourceId AdTenant Common GalleryUrl ManagementPortalUrl ServiceManagementUrl PublishSettingsFileUrl ResourceManagerUrl SqlDatabaseDnsSuffix databasewindowsnet StorageEndpointSuffix corewindowsnet ActiveDirectoryAuthority GraphUrl GraphEndpointResourceId TrafficManagerDnsSuffix trafficmanagernet AzureKeyVaultDnsSuffix vaultazurenet DataLakeEndpointResourceId AzureDataLakeStoreFileSystemEndpointSuffix azuredatalakestorenet AzureDataLakeAnalyticsCatalogAndJobEndpointSuffix azuredatalakeanalyticsnet AzureKeyVaultServiceEndpointResourceId AzureOperationalInsightsEndpointResourceId AzureOperationalInsightsEndpoint AzureAnalysisServicesEndpointSuffix asazurewindowsnet AnalysisServicesEndpointResourceId AzureAttestationServiceEndpointSuffix attestazurenet AzureAttestationServiceEndpointResourceId VersionProfiles ExtendedProperties OperationalInsightsEndpoint OperationalInsightsEndpointResourceId AzureAnalysisServicesEndpointSuffix asazurewindowsnet AnalysisServicesEndpointResourceId BatchEndpointResourceId Cost Added allowed values for the MetricTriggerType parameter DO NOT DELETE THIS TEMPLATE Description Please add a brief description of the changes made in this PR Checklist x I have read the Submitting Changes blobmasterCONTRIBUTINGmdsubmittingchanges section of CONTRIBUTINGmd blobmasterCONTRIBUTINGmd x The title of the PR is clear and informative x The appropriate ChangeLogmd files has been updated For any service the ChangeLogmd file can be found at srcSERVICESERVICEChangeLogmd A snippet outlining the changes made in the PR should be written under the Upcoming Release header no new version header should be added x The PR does not introduce breaking changes blobmasterdocumentationbreakingchangesbreakingchangesdefinitionmd If applicable the changes made in the PR have proper test coverage For public API changes to cmdlets a cmdlet design review was approved for the changes in this repository Microsoft internal only the markdown help files have been regenerated using the commands listed here blobmasterdocumentationdevelopmentdocshelpgenerationmdupdatingallmarkdownfilesinamodule Added valid range for FrequencyInMinutes and TimeWindowInMinutes DO NOT DELETE THIS TEMPLATE Description Please add a brief description of the changes made in this PR Checklist x I have read the Submitting Changes blobmasterCONTRIBUTINGmdsubmittingchanges section of CONTRIBUTINGmd blobmasterCONTRIBUTINGmd x The title of the PR is clear and informative x The appropriate ChangeLogmd files has been updated For any service the ChangeLogmd file can be found at srcSERVICESERVICEChangeLogmd A snippet outlining the changes made in the PR should be written under the Upcoming Release header no new version header should be added x The PR does not introduce breaking changes blobmasterdocumentationbreakingchangesbreakingchangesdefinitionmd If applicable the changes made in the PR have proper test coverage For public API changes to cmdlets a cmdlet design review was approved for the changes in this repository Microsoft internal only the markdown help files have been regenerated using the commands listed here blobmasterdocumentationdevelopmentdocshelpgenerationmdupdatingallmarkdownfilesinamodule Description NewAzScheduledQueryRuleSchedule does not do any input validation of the FrequencyInMinutes and TimeWindowInMinutes parameters If you use invalid parameter values you will first get an error when you try to create the rule via NewAzScheduledQueryRule Steps to reproduce Example powershell NewAzScheduledQueryRuleSchedule FrequencyInMinutes TimeWindowInMinutes When you try to create the rule via NewAzScheduledQueryRule you will get an error propertiesscheduletimeWindowInMinutes was specified as it should be a value between and Example powershell NewAzScheduledQueryRuleSchedule FrequencyInMinutes TimeWindowInMinutes When you try to create the rule via NewAzScheduledQueryRule you will get an error The subscription is not whitelisted for using minute frequency Environment data Please run PSVersionTable and paste the output in the below code block PSVersionTable Name Value PSVersion PSEdition Core GitCommitId OS Microsoft Windows Platform Win NT PSCompatibleVersions PSRemotingProtocolVersion SerializationVersion WSManStackVersion Module versions Please run GetModule ListAvailable and paste the output in the below code block powershell GetModule ListAvailable Directory C Users lorenzenp Documents PowerShell Modules ModuleType Version Name PSEdition ExportedCommands Script Az CoreDesk Script AzAccounts CoreDesk DisableAzDataCollection DisableAzContextAutosave EnableAzData Script AzAdvisor CoreDesk GetAzAdvisorRecommendation EnableAzAdvisorRecommendation Disab Script AzAks CoreDesk GetAzAks NewAzAks RemoveAzAks ImportAzAksCredential Script AzAnalysisServices CoreDesk ResumeAzAnalysisServicesServer SuspendAzAnalysisServicesServer Script AzApiManagement CoreDesk AddAzApiManagementApiToProduct AddAzApiManagementProductToGroup Script AzApplicationInsights CoreDesk GetAzApplicationInsights NewAzApplicationInsights RemoveAzApp Script AzAutomation CoreDesk GetAzAutomationHybridWorkerGroup RemoveAzAutomationHybridWorker Script AzBatch CoreDesk RemoveAzBatchAccount GetAzBatchAccount GetAzBatchAccountKey Script AzBilling CoreDesk GetAzBillingInvoice GetAzBillingPeriod GetAzEnrollmentAccount Script AzCdn CoreDesk GetAzCdnProfile GetAzCdnProfileSsoUrl NewAzCdnProfile Remove Script AzCognitiveServices CoreDesk GetAzCognitiveServicesAccount GetAzCognitiveServicesAccountKey Script AzCompute CoreDesk RemoveAzAvailabilitySet GetAzAvailabilitySet NewAzAvailabilit Script AzContainerInstance CoreDesk NewAzContainerGroup GetAzContainerGroup RemoveAzContainerGrou Script AzContainerRegistry CoreDesk NewAzContainerRegistry GetAzContainerRegistry UpdateAzContain Script AzDataBoxEdge CoreDesk GetAzDataBoxEdgeJob GetAzDataBoxEdgeDevice InvokeAzDataBoxEdg Script AzDataFactory CoreDesk SetAzDataFactoryV UpdateAzDataFactoryV GetAzDataFactoryV Script AzDataLakeAnalytics CoreDesk GetAzDataLakeAnalyticsDataSource NewAzDataLakeAnalyticsCatalogC Script AzDataLakeStore CoreDesk GetAzDataLakeStoreTrustedIdProvider RemoveAzDataLakeStoreTruste Script AzDeploymentManager CoreDesk GetAzDeploymentManagerArtifactSource NewAzDeploymentManagerArti Script AzDevTestLabs CoreDesk GetAzDtlAllowedVMSizesPolicy GetAzDtlAutoShutdownPolicy GetAz Script AzDns CoreDesk GetAzDnsRecordSet NewAzDnsRecordConfig RemoveAzDnsRecordSet Script AzEventGrid CoreDesk NewAzEventGridTopic GetAzEventGridTopic SetAzEventGridTopic Script AzEventHub CoreDesk NewAzEventHubNamespace GetAzEventHubNamespace SetAzEventHubNa Script AzFrontDoor CoreDesk NewAzFrontDoor GetAzFrontDoor SetAzFrontDoor RemoveAzFrontD Script AzHDInsight CoreDesk GetAzHDInsightJob NewAzHDInsightSqoopJobDefinition WaitAzHDIn Script AzHealthcareApis CoreDesk NewAzHealthcareApisService RemoveAzHealthcareApisService SetA Script AzIotHub CoreDesk AddAzIotHubKey GetAzIotHubEventHubConsumerGroup GetAzIotHubCo Script AzKeyVault CoreDesk AddAzKeyVaultCertificate UpdateAzKeyVaultCertificate StopAzKe Script AzLogicApp CoreDesk GetAzIntegrationAccountAgreement GetAzIntegrationAccountAssembl Script AzMachineLearning CoreDesk MoveAzMlCommitmentAssociation GetAzMlCommitmentAssociation Get Script AzManagedServices CoreDesk GetAzManagedServicesAssignment NewAzManagedServicesAssignment Script AzMarketplaceOrdering CoreDesk GetAzMarketplaceTerms SetAzMarketplaceTerms Script AzMedia CoreDesk SyncAzMediaServiceStorageKey SetAzMediaServiceKey GetAzMediaS Script AzMonitor CoreDesk GetAzMetricDefinition GetAzMetric RemoveAzLogProfile GetAzL Script AzNetwork CoreDesk AddAzApplicationGatewayAuthenticationCertificate GetAzApplicati Script AzNotificationHubs CoreDesk GetAzNotificationHub GetAzNotificationHubAuthorizationRule Get Script AzOperationalInsights CoreDesk NewAzOperationalInsightsAzureActivityLogDataSource NewAzOperati Script AzPolicyInsights CoreDesk GetAzPolicyEvent GetAzPolicyState GetAzPolicyStateSummary Ge Script AzPowerBIEmbedded CoreDesk RemoveAzPowerBIWorkspaceCollection GetAzPowerBIWorkspaceCollect Script AzPrivateDns CoreDesk GetAzPrivateDnsZone RemoveAzPrivateDnsZone SetAzPrivateDnsZon Script AzRecoveryServices CoreDesk GetAzRecoveryServicesBackupProperty GetAzRecoveryServicesVault Script AzRedisCache CoreDesk RemoveAzRedisCachePatchSchedule NewAzRedisCacheScheduleEntry G Script AzRelay CoreDesk NewAzRelayNamespace GetAzRelayNamespace SetAzRelayNamespace Script AzResources CoreDesk GetAzProviderOperation RemoveAzRoleAssignment GetAzRoleAssign Script AzServiceBus CoreDesk NewAzServiceBusNamespace GetAzServiceBusNamespace SetAzServic Script AzServiceFabric CoreDesk AddAzServiceFabricClientCertificate AddAzServiceFabricClusterCe Script AzSignalR CoreDesk NewAzSignalR GetAzSignalR GetAzSignalRKey NewAzSignalRKey Script AzSql CoreDesk GetAzSqlDatabaseTransparentDataEncryption GetAzSqlDatabaseTrans Script AzSqlVirtualMachine CoreDesk NewAzSqlVM GetAzSqlVM UpdateAzSqlVM RemoveAzSqlVM Script AzStorage CoreDesk GetAzStorageAccount GetAzStorageAccountKey NewAzStorageAccoun Script AzStorageSync CoreDesk InvokeAzStorageSyncCompatibilityCheck NewAzStorageSyncService Script AzStreamAnalytics CoreDesk GetAzStreamAnalyticsFunction GetAzStreamAnalyticsDefaultFunctio Script AzTrafficManager CoreDesk AddAzTrafficManagerCustomHeaderToEndpoint RemoveAzTrafficManage Script AzWebsites CoreDesk GetAzAppServicePlan SetAzAppServicePlan NewAzAppServicePlan Directory C program files powershell Modules ModuleType Version Name PSEdition ExportedCommands Manifest CimCmdlets Core GetCimAssociatedInstance GetCimClass GetCimInstance GetCimS Manifest MicrosoftPowerShellArchive Desk CompressArchive ExpandArchive Manifest MicrosoftPowerShellDiagnostics Core GetWinEvent NewWinEvent Manifest MicrosoftPowerShellHost Core StartTranscript StopTranscript Manifest MicrosoftPowerShellManagement Core AddContent ClearContent ClearItemProperty JoinPath Manifest MicrosoftPowerShellSecurity Core GetAcl SetAcl GetPfxCertificate GetCredential Manifest MicrosoftPowerShellUtility Core ExportAlias GetAlias ImportAlias NewAlias Manifest MicrosoftWSManManagement Core DisableWSManCredSSP EnableWSManCredSSP GetWSManCredSSP SetW Script PackageManagement Desk FindPackage GetPackage GetPackageProvider GetPackageSource Script PowerShellGet Desk FindCommand FindDSCResource FindModule FindRoleCapability Script PSDesiredStateConfiguration Desk GetConfigurationErrorCount ValidateNodeExclusiveResources GetIm Script PSDiagnostics Core DisablePSTrace DisablePSWSManCombinedTrace DisableWSManTrace Script PSReadLine Desk GetPSReadLineKeyHandler SetPSReadLineKeyHandler RemovePSReadL Binary ThreadJob Desk StartThreadJob Directory C WINDOWS system WindowsPowerShell v Modules ModuleType Version Name PSEdition ExportedCommands Manifest Appx CoreDesk AddAppxPackage GetAppxPackage GetAppxPackageManifest Remove Script AssignedAccess CoreDesk ClearAssignedAccess GetAssignedAccess SetAssignedAccess Manifest BitLocker CoreDesk UnlockBitLocker SuspendBitLocker ResumeBitLocker RemoveBitL Manifest BranchCache CoreDesk AddBCDataCacheExtension ClearBCCache DisableBC DisableBCDow Manifest Defender CoreDesk GetMpPreference SetMpPreference AddMpPreference RemoveMpPre Manifest DirectAccessClientComponents CoreDesk DisableDAManualEntryPointSelection EnableDAManualEntryPointSele Manifest DnsClient CoreDesk ResolveDnsName ClearDnsClientCache GetDnsClient GetDnsClien Manifest EventTracingManagement CoreDesk StartEtwTraceSession NewEtwTraceSession GetEtwTraceSession U Manifest MicrosoftPowerShellDiagnostics CoreDesk GetWinEvent GetCounter ImportCounter ExportCounter Manifest MicrosoftPowerShellLocalAccounts CoreDesk AddLocalGroupMember DisableLocalUser EnableLocalUser GetLoc Manifest MicrosoftPowerShellManagement CoreDesk AddContent ClearContent ClearItemProperty JoinPath Manifest MMAgent CoreDesk DisableMMAgent EnableMMAgent SetMMAgent GetMMAgent Manifest NetAdapter CoreDesk DisableNetAdapter DisableNetAdapterBinding DisableNetAdapterC Manifest NetConnection CoreDesk GetNetConnectionProfile SetNetConnectionProfile Manifest NetEventPacketCapture CoreDesk NewNetEventSession RemoveNetEventSession GetNetEventSession Manifest NetLbfo CoreDesk AddNetLbfoTeamMember AddNetLbfoTeamNic GetNetLbfoTeam GetNe Manifest NetNat CoreDesk GetNetNat GetNetNatExternalAddress GetNetNatStaticMapping Ge Manifest NetQos CoreDesk GetNetQosPolicy SetNetQosPolicy RemoveNetQosPolicy NewNetQo Manifest NetSecurity CoreDesk GetDAPolicyChange NewNetIPsecAuthProposal NewNetIPsecMainMode Manifest NetSwitchTeam CoreDesk NewNetSwitchTeam RemoveNetSwitchTeam GetNetSwitchTeam Rename Manifest NetTCPIP CoreDesk GetNetIPAddress GetNetIPInterface GetNetIPv Protocol GetNet Manifest NetworkConnectivityStatus CoreDesk GetDAConnectionStatus GetNCSIPolicyConfiguration ResetNCSIPol Manifest NetworkSwitchManager CoreDesk DisableNetworkSwitchEthernetPort EnableNetworkSwitchEthernetPor Manifest NetworkTransition CoreDesk AddNetIPHttpsCertBinding DisableNetDnsTransitionConfiguration Manifest PcsvDevice CoreDesk GetPcsvDevice StartPcsvDevice StopPcsvDevice RestartPcsvDev Manifest PnpDevice CoreDesk GetPnpDevice GetPnpDeviceProperty EnablePnpDevice DisablePn Manifest ScheduledTasks CoreDesk GetScheduledTask SetScheduledTask RegisterScheduledTask Unre Manifest SecureBoot CoreDesk ConfirmSecureBootUEFI SetSecureBootUEFI GetSecureBootUEFI Fo Manifest SmbShare CoreDesk GetSmbShare RemoveSmbShare SetSmbShare BlockSmbShareAccess Manifest SmbWitness CoreDesk GetSmbWitnessClient MoveSmbWitnessClient gsmbw msmbw Manifest StartLayout CoreDesk ExportStartLayout ImportStartLayout ExportStartLayoutEdgeAsse Manifest Storage CoreDesk AddInitiatorIdToMaskingSet AddPartitionAccessPath AddPhysical Manifest TrustedPlatformModule CoreDesk GetTpm InitializeTpm ClearTpm UnblockTpm Manifest VpnClient CoreDesk AddVpnConnection SetVpnConnection RemoveVpnConnection GetVp Manifest Wdac CoreDesk GetOdbcDriver SetOdbcDriver GetOdbcDsn AddOdbcDsn Manifest WindowsDeveloperLicense CoreDesk GetWindowsDeveloperLicense UnregisterWindowsDeveloperLicense S Script WindowsErrorReporting CoreDesk EnableWindowsErrorReporting DisableWindowsErrorReporting GetW Manifest WindowsUpdate CoreDesk GetWindowsUpdateLog Manifest WindowsUpdateProvider CoreDesk GetWUAVersion GetWULastInstallationDate GetWULastScanSuccessD Debug output Set DebugPreferenceContinue before running the repro and paste the resulting debug stream in the below code block Error output Please run ResolveAzError and paste the output in the below code block DO NOT DELETE THIS TEMPLATE Description Please add a brief description of the changes made in this PR Checklist I have read the Submitting Changes blobmasterCONTRIBUTINGmdsubmittingchanges section of CONTRIBUTINGmd blobmasterCONTRIBUTINGmd The title of the PR is clear and informative The appropriate ChangeLogmd files has been updated For any service the ChangeLogmd file can be found at srcSERVICESERVICEChangeLogmd A snippet outlining the changes made in the PR should be written under the Upcoming Release header no new version header should be added The PR does not introduce breaking changes blobmasterdocumentationbreakingchangesbreakingchangesdefinitionmd If applicable the changes made in the PR have proper test coverage For public API changes to cmdlets a cmdlet design review was approved for the changes in this repository Microsoft internal only the markdown help files have been regenerated using the commands listed here blobmasterdocumentationdevelopmentdocshelpgenerationmdupdatingallmarkdownfilesinamodule DO NOT DELETE THIS TEMPLATE Description Please add a brief description of the changes made in this PR Checklist I have read the Submitting Changes blobmasterCONTRIBUTINGmdsubmittingchanges section of CONTRIBUTINGmd blobmasterCONTRIBUTINGmd The title of the PR is clear and informative The appropriate ChangeLogmd files has been updated For any service the ChangeLogmd file can be found at srcSERVICESERVICEChangeLogmd A snippet outlining the changes made in the PR should be written under the Upcoming Release header no new version header should be added The PR does not introduce breaking changes blobmasterdocumentationbreakingchangesbreakingchangesdefinitionmd If applicable the changes made in the PR have proper test coverage For public API changes to cmdlets a cmdlet design review was approved for the changes in this repository Microsoft internal only the markdown help files have been regenerated using the commands listed here blobmasterdocumentationdevelopmentdocshelpgenerationmdupdatingallmarkdownfilesinamodule Description NewAzScheduledQueryRuleLogMetricTrigger does not do any input validation You can write whatever you want For ThresholdOperator and MetricTriggerType this is not ideal It makes it pretty difficult to use especially since the documentation does not list the allowed values for MetricTriggerType Steps to reproduce powershell NewAzScheduledQueryRuleLogMetricTrigger ThresholdOperator q Threshold MetricTriggerType q MetricColumn q Environment data Please run PSVersionTable and paste the output in the below code block PSVersionTable Name Value PSVersion PSEdition Core GitCommitId OS Microsoft Windows Platform Win NT PSCompatibleVersions PSRemotingProtocolVersion SerializationVersion WSManStackVersion Module versions Please run GetModule ListAvailable and paste the output in the below code block powershell GetModule ListAvailable Directory C Users lorenzenp Documents PowerShell Modules ModuleType Version Name PSEdition ExportedCommands Script Az CoreDesk Script AzAccounts CoreDesk DisableAzDataCollection DisableAzContextAutosave Enable Script AzAdvisor CoreDesk GetAzAdvisorRecommendation EnableAzAdvisorRecommendation Script AzAks CoreDesk GetAzAks NewAzAks RemoveAzAks ImportAzAksCredential Script AzAnalysisServices CoreDesk ResumeAzAnalysisServicesServer SuspendAzAnalysisServices Script AzApiManagement CoreDesk AddAzApiManagementApiToProduct AddAzApiManagementProduct Script AzApplicationInsights CoreDesk GetAzApplicationInsights NewAzApplicationInsights Remov Script AzAutomation CoreDesk GetAzAutomationHybridWorkerGroup RemoveAzAutomationHybri Script AzBatch CoreDesk RemoveAzBatchAccount GetAzBatchAccount GetAzBatchAccou Script AzBilling CoreDesk GetAzBillingInvoice GetAzBillingPeriod GetAzEnrollment Script AzCdn CoreDesk GetAzCdnProfile GetAzCdnProfileSsoUrl NewAzCdnProfile Script AzCognitiveServices CoreDesk GetAzCognitiveServicesAccount GetAzCognitiveServicesAcco Script AzCompute CoreDesk RemoveAzAvailabilitySet GetAzAvailabilitySet NewAzAvai Script AzContainerInstance CoreDesk NewAzContainerGroup GetAzContainerGroup RemoveAzContai Script AzContainerRegistry CoreDesk NewAzContainerRegistry GetAzContainerRegistry UpdateAz Script AzDataBoxEdge CoreDesk GetAzDataBoxEdgeJob GetAzDataBoxEdgeDevice InvokeAzDat Script AzDataFactory CoreDesk SetAzDataFactoryV UpdateAzDataFactoryV GetAzDataFact Script AzDataLakeAnalytics CoreDesk GetAzDataLakeAnalyticsDataSource NewAzDataLakeAnalyticsC Script AzDataLakeStore CoreDesk GetAzDataLakeStoreTrustedIdProvider RemoveAzDataLakeStor Script AzDeploymentManager CoreDesk GetAzDeploymentManagerArtifactSource NewAzDeploymentMana Script AzDevTestLabs CoreDesk GetAzDtlAllowedVMSizesPolicy GetAzDtlAutoShutdownPolicy Script AzDns CoreDesk GetAzDnsRecordSet NewAzDnsRecordConfig RemoveAzDnsReco Script AzEventGrid CoreDesk NewAzEventGridTopic GetAzEventGridTopic SetAzEventGrid Script AzEventHub CoreDesk NewAzEventHubNamespace GetAzEventHubNamespace SetAzEve Script AzFrontDoor CoreDesk NewAzFrontDoor GetAzFrontDoor SetAzFrontDoor RemoveA Script AzHDInsight CoreDesk GetAzHDInsightJob NewAzHDInsightSqoopJobDefinition Wait Script AzHealthcareApis CoreDesk NewAzHealthcareApisService RemoveAzHealthcareApisService Script AzIotHub CoreDesk AddAzIotHubKey GetAzIotHubEventHubConsumerGroup GetAzI Script AzKeyVault CoreDesk AddAzKeyVaultCertificate UpdateAzKeyVaultCertificate St Script AzLogicApp CoreDesk GetAzIntegrationAccountAgreement GetAzIntegrationAccount Script AzMachineLearning CoreDesk MoveAzMlCommitmentAssociation GetAzMlCommitmentAssociati Script AzManagedServices CoreDesk GetAzManagedServicesAssignment NewAzManagedServicesAssig Script AzMarketplaceOrdering CoreDesk GetAzMarketplaceTerms SetAzMarketplaceTerms Script AzMedia CoreDesk SyncAzMediaServiceStorageKey SetAzMediaServiceKey GetA Script AzMonitor CoreDesk GetAzMetricDefinition GetAzMetric RemoveAzLogProfile Script AzNetwork CoreDesk AddAzApplicationGatewayAuthenticationCertificate GetAzAp Script AzNotificationHubs CoreDesk GetAzNotificationHub GetAzNotificationHubAuthorizationRu Script AzOperationalInsights CoreDesk NewAzOperationalInsightsAzureActivityLogDataSource NewAz Script AzPolicyInsights CoreDesk GetAzPolicyEvent GetAzPolicyState GetAzPolicyStateSumm Script AzPowerBIEmbedded CoreDesk RemoveAzPowerBIWorkspaceCollection GetAzPowerBIWorkspace Script AzPrivateDns CoreDesk GetAzPrivateDnsZone RemoveAzPrivateDnsZone SetAzPrivat Script AzRecoveryServices CoreDesk GetAzRecoveryServicesBackupProperty GetAzRecoveryService Script AzRedisCache CoreDesk RemoveAzRedisCachePatchSchedule NewAzRedisCacheScheduleE Script AzRelay CoreDesk NewAzRelayNamespace GetAzRelayNamespace SetAzRelayName Script AzResources CoreDesk GetAzProviderOperation RemoveAzRoleAssignment GetAzRol Script AzServiceBus CoreDesk NewAzServiceBusNamespace GetAzServiceBusNamespace SetA Script AzServiceFabric CoreDesk AddAzServiceFabricClientCertificate AddAzServiceFabricCl Script AzSignalR CoreDesk NewAzSignalR GetAzSignalR GetAzSignalRKey NewAzSigna Script AzSql CoreDesk GetAzSqlDatabaseTransparentDataEncryption GetAzSqlDataba Script AzSqlVirtualMachine CoreDesk NewAzSqlVM GetAzSqlVM UpdateAzSqlVM RemoveAzSqlVM Script AzStorage CoreDesk GetAzStorageAccount GetAzStorageAccountKey NewAzStorag Script AzStorageSync CoreDesk InvokeAzStorageSyncCompatibilityCheck NewAzStorageSyncSe Script AzStreamAnalytics CoreDesk GetAzStreamAnalyticsFunction GetAzStreamAnalyticsDefault Script AzTrafficManager CoreDesk AddAzTrafficManagerCustomHeaderToEndpoint RemoveAzTraffi Script AzWebsites CoreDesk GetAzAppServicePlan SetAzAppServicePlan NewAzAppServic Directory C program files powershell Modules ModuleType Version Name PSEdition ExportedCommands Manifest CimCmdlets Core GetCimAssociatedInstance GetCimClass GetCimInstance G Manifest MicrosoftPowerShellArchive Desk CompressArchive ExpandArchive Manifest MicrosoftPowerShellDiagnostics Core GetWinEvent NewWinEvent Manifest MicrosoftPowerShellHost Core StartTranscript StopTranscript Manifest MicrosoftPowerShellManagement Core AddContent ClearContent ClearItemProperty JoinPath Manifest MicrosoftPowerShellSecurity Core GetAcl SetAcl GetPfxCertificate GetCredential Manifest MicrosoftPowerShellUtility Core ExportAlias GetAlias ImportAlias NewAlias Manifest MicrosoftWSManManagement Core DisableWSManCredSSP EnableWSManCredSSP GetWSManCredSSP Script PackageManagement Desk FindPackage GetPackage GetPackageProvider GetPackage Script PowerShellGet Desk FindCommand FindDSCResource FindModule FindRoleCapab Script PSDesiredStateConfiguration Desk UpdateDependsOn GetPositionInfo TestModuleReloadRequir Script PSDiagnostics Core DisablePSTrace DisablePSWSManCombinedTrace DisableWSMa Script PSReadLine Desk GetPSReadLineKeyHandler SetPSReadLineKeyHandler Remove Binary ThreadJob Desk StartThreadJob Directory C WINDOWS system WindowsPowerShell v Modules ModuleType Version Name PSEdition ExportedCommands Manifest Appx CoreDesk AddAppxPackage GetAppxPackage GetAppxPackageManifest Script AssignedAccess CoreDesk ClearAssignedAccess GetAssignedAccess SetAssignedAcces Manifest BitLocker CoreDesk UnlockBitLocker SuspendBitLocker ResumeBitLocker Remo Manifest BranchCache CoreDesk AddBCDataCacheExtension ClearBCCache DisableBC Disabl Manifest Defender CoreDesk GetMpPreference SetMpPreference AddMpPreference Remov Manifest DirectAccessClientComponents CoreDesk DisableDAManualEntryPointSelection EnableDAManualEntryPo Manifest DnsClient CoreDesk ResolveDnsName ClearDnsClientCache GetDnsClient GetD Manifest EventTracingManagement CoreDesk StartEtwTraceSession NewEtwTraceSession GetEtwTraceSes Manifest MicrosoftPowerShellDiagnostics CoreDesk GetWinEvent GetCounter ImportCounter ExportCounter Manifest MicrosoftPowerShellLocalAccounts CoreDesk AddLocalGroupMember DisableLocalUser EnableLocalUser Manifest MicrosoftPowerShellManagement CoreDesk AddContent ClearContent ClearItemProperty JoinPath Manifest MMAgent CoreDesk DisableMMAgent EnableMMAgent SetMMAgent GetMMAgent Manifest NetAdapter CoreDesk DisableNetAdapter DisableNetAdapterBinding DisableNetA Manifest NetConnection CoreDesk GetNetConnectionProfile SetNetConnectionProfile Manifest NetEventPacketCapture CoreDesk NewNetEventSession RemoveNetEventSession GetNetEventSe Manifest NetLbfo CoreDesk AddNetLbfoTeamMember AddNetLbfoTeamNic GetNetLbfoTeam Manifest NetNat CoreDesk GetNetNat GetNetNatExternalAddress GetNetNatStaticMapp Manifest NetQos CoreDesk GetNetQosPolicy SetNetQosPolicy RemoveNetQosPolicy Ne Manifest NetSecurity CoreDesk GetDAPolicyChange NewNetIPsecAuthProposal NewNetIPsecM Manifest NetSwitchTeam CoreDesk NewNetSwitchTeam RemoveNetSwitchTeam GetNetSwitchTeam Manifest NetTCPIP CoreDesk GetNetIPAddress GetNetIPInterface GetNetIPv Protocol Manifest NetworkConnectivityStatus CoreDesk GetDAConnectionStatus GetNCSIPolicyConfiguration Reset Manifest NetworkSwitchManager CoreDesk DisableNetworkSwitchEthernetPort EnableNetworkSwitchEthe Manifest NetworkTransition CoreDesk AddNetIPHttpsCertBinding DisableNetDnsTransitionConfigur Manifest PcsvDevice CoreDesk GetPcsvDevice StartPcsvDevice StopPcsvDevice Restart Manifest PnpDevice CoreDesk GetPnpDevice GetPnpDeviceProperty EnablePnpDevice Dis Manifest ScheduledTasks CoreDesk GetScheduledTask SetScheduledTask RegisterScheduledTas Manifest SecureBoot CoreDesk ConfirmSecureBootUEFI SetSecureBootUEFI GetSecureBootU Manifest SmbShare CoreDesk GetSmbShare RemoveSmbShare SetSmbShare BlockSmbShare Manifest SmbWitness CoreDesk GetSmbWitnessClient MoveSmbWitnessClient gsmbw msmbw Manifest StartLayout CoreDesk ExportStartLayout ImportStartLayout ExportStartLayoutE Manifest Storage CoreDesk AddInitiatorIdToMaskingSet AddPartitionAccessPath AddP Manifest TrustedPlatformModule CoreDesk GetTpm InitializeTpm ClearTpm UnblockTpm Manifest VpnClient CoreDesk AddVpnConnection SetVpnConnection RemoveVpnConnection Manifest Wdac CoreDesk GetOdbcDriver SetOdbcDriver GetOdbcDsn AddOdbcDsn Manifest WindowsDeveloperLicense CoreDesk GetWindowsDeveloperLicense UnregisterWindowsDeveloperLic Script WindowsErrorReporting CoreDesk EnableWindowsErrorReporting DisableWindowsErrorReporting Manifest WindowsUpdate CoreDesk GetWindowsUpdateLog Manifest WindowsUpdateProvider CoreDesk GetWUAVersion GetWULastInstallationDate GetWULastScanS Debug output Set DebugPreferenceContinue before running the repro and paste the resulting debug stream in the below code block Error output Please run ResolveAzError and paste the output in the below code block 