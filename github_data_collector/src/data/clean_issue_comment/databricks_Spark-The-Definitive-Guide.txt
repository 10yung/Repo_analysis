Created a scala program and trying to run the streaming code it is filing with below error ERROR StreamExecution Query customerpurchases id c d fd c eba f d runId adbd e e b fad f e terminated with error javalangIllegalStateException Cannot call methods on a stopped SparkContext This stopped SparkContext was created at orgapachesparksqlSparkSessionBuildergetOrCreateSparkSessionscala sparkguidechapter StructuredStreamingdelayedEndpointsparkguidechapter StructuredStreaming StructuredStreamingscala sparkguidechapter StructuredStreamingdelayedInitbodyapplyStructuredStreamingscala scalaFunction classapplymcVspFunction scala scalaruntimeAbstractFunction applymcVspAbstractFunction scala scalaAppanonfunmain applyAppscala scalaAppanonfunmain applyAppscala scalacollectionimmutableListforeachListscala scalacollectiongenericTraversableForwarderclassforeachTraversableForwarderscala scalaAppclassmainAppscala sparkguidechapter StructuredStreamingmainStructuredStreamingscala sparkguidechapter StructuredStreamingmainStructuredStreamingscala alyticsandMachineLearningpy fix print and add some missing code lines Value format is not a member of orgapachesparksqlDataFrame Im studying spark advanced RDD API and got a little bit confused by one example in Scala import orgapachesparkPartitioner class DomainPartitioner extends Partitioner def numPartitions def getPartitionkey Any Int val customerId keyasInstanceOf Double toInt if customerId customerId return else return new javautilRandomnextInt As far as I can see in code documentation partitioner must return the same partition id given the same partition key That is not true for the example in the code above Isnt random id for key break the Partitioner interface It seems SCALA version same as L First the column Quantity is parsed as String It should be IntegerType Second orderByCustomerId should be orderBydescQuantity Hi Im really stuck with this section of Spark book staticDataFrame sparkreadformatcsv optionheader true optioninferSchema true loadmntdefgretaildatabydaycsv Im not able to understand the loadmnt section I have downloaded the data to my local drive But now the issue is on loading the data How to load the data Is the mntdefg being done via S or by any other method Hi I start learning Apache Spark by reading that book Im now at chapter Streaming part For snippet code I choose python My problem is that nothing is displayed in console as said in the book from that code python purchaseByCustomerPerHourwriteStream formatconsole queryNamecustomerpurchases outputModecomplete start show I dont know if Im doing something wrong but tell me how to display result in console at start and at every update too Hello I tried to follow the Transfer learning example in pyspark on page However when I try to do pmodel pfittraindf I get a Number of source Raster bands and source color space components do not match I tried googling what to do but i wasnt sure what to do The trace includes references to javaawtimageColorConvertOpfilter comsunimageiopluginsjpegJPEGImageReader and javaximageioImageIOread Note that I used Spark mls ImageSchema read function because the sparkdl readImages function seems to be deprecated Thanks in advance Nick