 The upcsh type all command leads to the following output unixprivesccheck v libchecksenabledallcredentials credentials not found upcsh credentialsinit not found upcsh credentialsmain not found upcsh credentialsfini not found libchecksenabledallgpgagent gpgagent not found upcsh gpgagentinit not found upcsh gpgagentmain not found upcsh gpgagentfini not found libchecksenabledallgroupwritable groupwritable not found upcsh groupwritableinit not found upcsh groupwritablemain not found upcsh groupwritablefini not found libchecksenabledallhistoryreadable historyreadable not found upcsh historyreadableinit not found upcsh historyreadablemain not found upcsh historyreadablefini not found libchecksenabledallhomedirsexecutable homedirsexecutable not found upcsh homedirsexecutableinit not found upcsh homedirsexecutablemain not found upcsh homedirsexecutablefini not found libchecksenabledallhomedirswritable homedirswritable not found upcsh homedirswritableinit not found upcsh homedirswritablemain not found upcsh homedirswritablefini not found libchecksenabledalljar jar not found upcsh jarinit not found upcsh jarmain not found upcsh jarfini not found libchecksenabledallkeymaterial keymaterial not found upcsh keymaterialinit not found upcsh keymaterialmain not found upcsh keymaterialfini not found libchecksenabledallpasswdhashes passwdhashes not found upcsh passwdhashesinit not found upcsh passwdhashesmain not found upcsh passwdhashesfini not found libchecksenabledallprivilegedbanned privilegedbanned not found upcsh privilegedbannedinit not found upcsh privilegedbannedmain not found upcsh privilegedbannedfini not found libchecksenabledallprivilegedchangeprivileges privilegedchangeprivileges not found upcsh privilegedchangeprivilegesinit not found upcsh privilegedchangeprivilegesmain not found upcsh privilegedchangeprivilegesfini not found libchecksenabledallprivilegedchroot privilegedchroot not found upcsh privilegedchrootinit not found upcsh privilegedchrootmain not found upcsh privilegedchrootfini not found libchecksenabledallprivilegeddependency privilegeddependency not found upcsh privilegeddependencyinit not found upcsh privilegeddependencymain not found upcsh privilegeddependencyfini not found libchecksenabledallprivilegednx privilegednx not found upcsh privilegednxinit not found upcsh privilegednxmain not found upcsh privilegednxfini not found libchecksenabledallprivilegedpath privilegedpath not found upcsh privilegedpathinit not found upcsh privilegedpathmain not found upcsh privilegedpathfini not found libchecksenabledallprivilegedpie privilegedpie not found upcsh privilegedpieinit not found upcsh privilegedpiemain not found upcsh privilegedpiefini not found libchecksenabledallprivilegedrandom privilegedrandom not found upcsh privilegedrandominit not found upcsh privilegedrandommain not found upcsh privilegedrandomfini not found libchecksenabledallprivilegedrelro privilegedrelro not found upcsh privilegedrelroinit not found upcsh privilegedrelromain not found upcsh privilegedrelrofini not found libchecksenabledallprivilegedrpath privilegedrpath not found upcsh privilegedrpathinit not found upcsh privilegedrpathmain not found upcsh privilegedrpathfini not found libchecksenabledallprivilegedssp privilegedssp not found upcsh privilegedsspinit not found upcsh privilegedsspmain not found upcsh privilegedsspfini not found libchecksenabledallprivilegedtmp privilegedtmp not found upcsh privilegedtmpinit not found upcsh privilegedtmpmain not found upcsh privilegedtmpfini not found libchecksenabledallprivilegedwritable privilegedwritable not found upcsh privilegedwritableinit not found upcsh privilegedwritablemain not found upcsh privilegedwritablefini not found libchecksenabledallsetgid setgid not found upcsh setgidinit not found upcsh setgidmain not found upcsh setgidfini not found libchecksenabledallsetuid setuid not found upcsh setuidinit not found upcsh setuidmain not found upcsh setuidfini not found libchecksenabledallshadowhashes shadowhashes not found upcsh shadowhashesinit not found upcsh shadowhashesmain not found upcsh shadowhashesfini not found libchecksenabledallsshagent sshagent not found upcsh sshagentinit not found upcsh sshagentmain not found upcsh sshagentfini not found libchecksenabledallsshkey sshkey not found upcsh sshkeyinit not found upcsh sshkeymain not found upcsh sshkeyfini not found libchecksenabledallsystemaslr systemaslr not found upcsh systemaslrinit not found upcsh systemaslrmain not found upcsh systemaslrfini not found libchecksenabledallsystemconfiguration systemconfiguration not found upcsh systemconfigurationinit not found upcsh systemconfigurationmain not found upcsh systemconfigurationfini not found libchecksenabledallsystemlibraries systemlibraries not found upcsh systemlibrariesinit not found upcsh systemlibrariesmain not found upcsh systemlibrariesfini not found libchecksenabledallsystemmmap systemmmap not found upcsh systemmmapinit not found upcsh systemmmapmain not found upcsh systemmmapfini not found libchecksenabledallsystemnx systemnx not found upcsh systemnxinit not found upcsh systemnxmain not found upcsh systemnxfini not found libchecksenabledallsystemselinux systemselinux not found upcsh systemselinuxinit not found upcsh systemselinuxmain not found upcsh systemselinuxfini not found libchecksenabledallworldwritable worldwritable not found upcsh worldwritableinit not found upcsh worldwritablemain not found upcsh worldwritablefini not found Im receiving syntax errors in some of the checks which use binarymatchesstringgrep For example running a check from libchecksprivilegedarguments manually sh ybinarymatchesstringgrep tmpfoo digit sh syntax error operand expected error token is Patch attached It seems to me that the privilegedenvironmentvariables check will alert for any script using style variables not necessarily environment variables So Im a bit concerned as to how noisy it will be Original issue reported on codegooglecom by JJCgooglemailcom on Mar at Attachments binarygrepsyntaxdiff I believe there are a couple of deficiencies in the current implementation of the privilegedwritable check I think files writable by a low privileged owner should always be a warning not just if YOU are the current owner If Im running the tool as the root user for auditing purposes then I want to know if a standard user owns a script theyre permitted to run as root via sudo Furthermore if a low privileged user owns a privileged file then it should be reported no matter what the current permissions are This is because the owner can just set it to writable if necessary Similarly to if an untrusted group can write to a privileged file then it should be a warning even if the current user isnt a member of the group The attached patch will make these changes In its current form it only trusts the user with ID zero and the main group of the user with ID zero Hopefully this can be improved with configurable trusts in future see I also modified some user and group utilities to support the changes Implemented the groupisroot function by checking against id g n Switched userisroot and userisuserroot to match other userisuser functions which check the current user rather than a supplied user Implemented userisroot Original issue reported on codegooglecom by JJCgooglemailcom on Feb at Attachments privilegedwritablelogicdiff The first argument to printf is often passed directly from the sudoers file This can cause problems because this file commonly contains characters for group definitions This is noted in the comment in libmiscsudo FIXME this printf fails when the an entry starts with percentage character which is common for sudoers group Fixed this by using a simple format string s as the first argument In the particular case after the comment I also added a new line to the string to fix a bug which leaves the final sudoers entry unprocessed Similar fixes should be done throughout the code base but I just targeted code affected by the sudoers file here privilegedwritable really Original issue reported on codegooglecom by JJCgooglemailcom on Feb at Attachments printfdiff I cant see any mention of crond within the code so I am assuming that the etccrond folder isnt inspected for Cron related issues Original issue reported on codegooglecom by abencagmailcom on Dec at Download unixprivseccheck version and open the file with an editor Go to the line worldcanread OMESSAGESTACK OFILE Pls lLd OFILE cut c if P w then echo WARNING OMESSAGESTACK World read is set for OFILE fi The worldcanread function check for the bit w and not the bit r This is wrong because in this function we are checking for world readable and not world writeable files or directories Regards R Roberto Martelloni boos Original issue reported on codegooglecom by rmartellgmailcom on Mar at What steps will reproduce the problem chmod or etcshadow run unixprivesccheck Expect warning but nothing is noticed by tool but only following output I get Checking if etcshadow is readable Checking if anyone except root can read file etcshadow unixprivesccheck CentOS Original issue reported on codegooglecom by adegmailcom on Dec at Add Samba library and security check eg check permissions on AD file Original issue reported on codegooglecom by bernardodamele on Nov at Add Oracle library and security check Original issue reported on codegooglecom by bernardodamele on Nov at 