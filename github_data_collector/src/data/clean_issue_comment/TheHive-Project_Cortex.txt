 Work Environment Question Answer OS version server Ubuntu OS version client Cortex version git hash Fresh install from DEB Package Type DEB Browser type version Firefox Problem Description After updating database in Cortex when the create administrator account pages comes up nothing happens when I press create after filling up the credentials I tried refreshing the page but then Error user init not found comes up The logs show that there is a version conflict document already exists so tried deleting the Cortex instance and elasticsearch to reinitiate Cortex but still unable to create administrator account Also tried starting over from the very beginning by installing everything again but still facing the same issue Had done this before and everything was working fine until recently Steps to Reproduce Install the new instance of Cortex and ElasticSearch Complementary information INFO from orgthpcortexservicesErrorHandler in applicationakkaactordefaultdispatcher POST apiuser returned orgelastic playConflictError doc cortex version conflict document already exists current version at orgelastic playdatabaseDBConfigurationanonfunexecute DBConfigurationscala at scalaconcurrentFutureanonfunflatMap Futurescala at scalaconcurrentimplPromiseanonfuntransformWith Promisescala at scalaconcurrentimplCallbackRunnablerunPromisescala at akkadispatchBatchingExecutorAbstractBatchprocessBatchBatchingExecutorscala at akkadispatchBatchingExecutorBlockableBatchanonfunrun BatchingExecutorscala at scalaruntimejava JFunction mcVspapplyJFunction mcVspjava at scalaconcurrentBlockContextwithBlockContextBlockContextscala at akkadispatchBatchingExecutorBlockableBatchrunBatchingExecutorscala at akkadispatchTaskInvocationrunAbstractDispatcherscala at akkadispatchForkJoinExecutorConfiguratorAkkaForkJoinTaskexecForkJoinExecutorConfiguratorscala at akkadispatchforkjoinForkJoinTaskdoExecForkJoinTaskjava at akkadispatchforkjoinForkJoinPoolWorkQueuerunTaskForkJoinPooljava at akkadispatchforkjoinForkJoinPoolrunWorkerForkJoinPooljava at akkadispatchforkjoinForkJoinWorkerThreadrunForkJoinWorkerThreadjava Request Type Bug Work Environment Question Answer OS version server Debian Problem Description I cant use any analyser for any of them I try to use Im geeting errorMessage javautilconcurrentExecutionException javaxwsrsProcessingException javaioIOException No such file or directory Steps to Reproduce Configure any analyzer Request some data Request Type Feature Request Work Environment Question Answer OS version server Ubuntu OS version client Ubuntu Cortex version git hash x Package Type From source Browser type version Problem Description At the moment all jobs are being run through a single queue If one user eg a machine account of some tool runs a lot of jobs no other user will be able to run something in parallel Steps to Reproduce Have a one user continuously run a constant amount of jobs Have other users also wanting to run jobs on demand The other users will have to wait a long time Possible Solutions My proposal is to have one job queue per user account and instead of just draining one queue the job scheduler could go through all queues in a roundrobin fashion so that all users handled equally Complementary information We are using Cortex as a central API gateway for observable enhancement and therefore could really make good use of a better queuing system Analyzer EMLParser doesnt work with Cortex Docker version Request Type Bug Work Environment Question Answer OS version server Docker Cortex version git hash Package Type Docker Problem Description Docker Cortex is build from a Debian whereas Docker Cortex is build from Debian In Debian the last python version is analyzer EMLParser doesnt work with this version Steps to Reproduce Install Cortex with Docker Enable EMLParser Execute several times the analyzer on an eml with as another eml in attachment Note that the body result is random because the list order is random Reproduce those step on Docker Cortex and it works Possible Solutions Use a Debian to build the Cortex container as before Request Type Bug Work Environment Question Answer OS version server Ubuntu Cortex version git hash Package Type Binary ElasticSearch version Browser type version Chrome Problem Description After updating Cortex and TheHive to the latest versions respectively and I have noticed a drop in performance in the execution of Cortex analyzers mainly when I launch several in block from Thehive In the Cortex log I receive the following message info otcsErrorHandler GET apijobXq zYm Bdo YIo dnA waitreportatMost minute returned akkapatternAskTimeoutException Ask timed out on Actor akkaapplicationuseraudit after ms Message of type orgthpcortexservicesAuditActorRegister A typical reason for AskTimeoutException is that the recipient actor didnt send a reply at akkapatternPromiseActorRefanonfundefaultOnTimeout AskSupportscala at akkapatternPromiseActorRefanonfunapply AskSupportscala at akkaactorScheduleranon runSchedulerscala at scalaconcurrentFutureInternalCallbackExecutorunbatchedExecuteFuturescala at scalaconcurrentBatchingExecutorexecuteBatchingExecutorscala at scalaconcurrentBatchingExecutorexecuteBatchingExecutorscala at scalaconcurrentFutureInternalCallbackExecutorexecuteFuturescala And then the next one error oedDBConfiguration ElasticSearch request failure DELETEsearchscroll StringEntityscrollid DnF ZXJ VGhlbkZldGNoBQAAAAAAAIrlFjdzaTEtXzY UVgyZFN SGdqTnBKVncAAAAAAACK BY c kxLV NVFYMmRTekhnak wSlZ AAAAAAAAiuYWN NpMS fNjVRWDJkU pIZ pOcEpWdwAAAAAAAIrnFjdzaTEtXzY UVgyZFN SGdqTnBKVncAAAAAAACK BY c kxLV NVFYMmRTekhnak wSlZ Someapplicationjson ElasticError NoneNoneNoneListNone I have noticed that this problem I receive it when having activated in several analyzers the AutoExtract flag when I deactivate it does not fail Also I dont know if it has to see when this happens the website is inaccessible and you cant navigate through it Steps to Reproduce enable the auto extract flag in the Shodan and VirusTotal analyzers Run this analyzers over several ips in my case Wait Try to access the website in previous versions this worked like a lightning for me Thank you for all your efforts Feature Request Work Environment Question Answer OS version server CentOS OS version client Cortex version git hash cortex RC noarch Package Type Binary Browser type version Problem Description Cortex cant sent appliaction logs to the logstash because some dependencie is missing Steps to Reproduce Modify logbackxml Add xml appender nameSTASH classnetlogstashlogbackappenderLogstashTcpSocketAppender destination destination appender and append the root section with this xml appenderref refLOGSTASH start cortex read the log ERROR in chqoslogbackcorejoranactionAppenderAction Could not create an Appender of type netlogstashlogbackappenderLogstashTcpSocketAppender chqoslogbackcoreutilDynamicClassLoadingException Failed to instantiate type netlogstashlogbackappenderLogstashTcpSocketAppender at chqoslogbackcoreutilDynamicClassLoadingException Failed to instantiate type netlogstashlogbackappenderLogstashTcpSocketAppender Caused by javalangClassNotFoundException netlogstashlogbackappenderLogstashTcpSocketAppender Possible Solutions Maybe this Cortex try to execute with incorrect Analyzer path Request Type Bug Work Environment Question Answer OS version server Ubuntu OS version client Windows Cortex version git hash Package Type Binary Browser type version Chrome Edge Chromium Problem Description The Path of Analyzer that Cortex try to execute is difference with real Analyzer Path Cortex Execute optCortexAnalyzersanalyzersMcAfeeTIEmcafeetiepy Analyzer Path optCortexAnalyzersanalyzersMcAfeeTIEAnalyzermcafeetiepy Please see some image bellow to get the detail It was a Bug or I miss some config in somewhere Complementary information Cortex Result Analyzer Location Analyzer config Cortex Applicationlog Request Type Bug Work Environment Question Answer OS version server Ubuntu OS version client macOS Cortex version git hash Package Type Binary Browser type version NA Problem Description For some reason Cortex appears to be expecting to use Docker by default Ive recently upgraded to and had manually upgrade cortexutils from to Im not entirely sure why this is happening but obviously when we run analysers Cortex attempts to push jobs to a Docker service that doesnt exist Steps to Reproduce Start up Cortex service Submit job to Analyser any analyser Review logs for errors Complementary information Cortex Application Log INFO from orgapachehttpimplexecchainRetryExec in jerseyclientasyncexecutor IO exception javaioIOException caught when processing request to unixlocalhost No such file or directory INFO from orgapachehttpimplexecchainRetryExec in jerseyclientasyncexecutor Retrying request to unixlocalhost INFO from orgapachehttpimplexecchainRetryExec in jerseyclientasyncexecutor IO exception javaioIOException caught when processing request to unixlocalhost No such file or directory INFO from orgapachehttpimplexecchainRetryExec in jerseyclientasyncexecutor Retrying request to unixlocalhost INFO from orgapachehttpimplexecchainRetryExec in jerseyclientasyncexecutor IO exception javaioIOException caught when processing request to unixlocalhost No such file or directory INFO from orgapachehttpimplexecchainRetryExec in jerseyclientasyncexecutor Retrying request to unixlocalhost INFO from orgthpcortexservicesDockerJobRunnerSrv in applicationakkaactordefaultdispatcher Docker is not available comspotifydockerclientexceptionsDockerException javautilconcurrentExecutionException javaxwsrsProcessingException javaioIOException No such file or directory Add a mintlp value in Cortex alongside maxtlp to control what the minimum tlp level is for an analyzer to run Request Type Feature Request Work Environment Question Answer OS version server Ubuntu OS version client Cortex version git hash Package Type Binary Browser type version NA Problem Description We have internal Cortex instances and external Cortex instances When we add external observables we want those to be sent to the external Cortex instance for analysis by rd party threat Intel providers When we add an internal IP we want that to be sent to the internal Cortex instance and not to external Weve set the TLP values on the observables as per the guidance An external IP is set to tlpgreen An internal IP seen is set to tlpred When we set the SecurityCenter maxtlp to red external IPs get accepted by the analyzer When we set the maxtlp on the analyzer to white external IPs arent accepted but also internal IPs arent accepted either What we want to do is set the mintlp of the SecurityCenter analyzer and other internal analyzers too to have a mintlpred so that it will only accept observables with a tlpred essentially internal observables we dont want to share Steps to Reproduce Enable SecurityCenter Analyzer Create a case and an an external IP as an observable Set the TLP to red as you dont want to share this externally Run the SecurityCenter analyzer It attempts to scan the external target Possible Solutions Create a mintlp value for analyzers get the analyzers to respect that Cuckoo Analyser reports unexpected error when job is complete Report exists in Cuckoo and has run successfully with a score of Request Type Bug Work Environment Question Answer OS version server Ubuntu OS version client Ubuntu Cuckoo Cortex version git hash Package Type Binary Browser type version NA Problem Description When uploading a file as an observable to Hive and running the Cuckoo analyser after analysis Cortex reports Unexpected Error Steps to Reproduce Open a case Add an observable Choose File as type and upload file for analysis Select to added observable and Choo Cuckoo Sandbox Complementary information img width altScreenshot at src 