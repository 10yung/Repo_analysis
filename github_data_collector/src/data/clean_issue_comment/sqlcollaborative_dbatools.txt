 Below information IS REQUIRED with every PR Type of Change What type of change does your code introduce x Bug fix nonbreaking change fixes New feature nonbreaking change adds functionality fixes issue number Breaking change effects multiple commands or functionality fixes issue number x Ran manual Pester test and has passed tests manualpesterps Adding code coverage to existing functionality Pester test is included If new file reference added for test has is been added to githubcomsqlcollaborativeappveyorlab Nunit test is included Documentation Build system Below this line you can erase anything that is not applicable Purpose Ignore PowerBI service during runtime as the ManagedComputer WMI object does not have an instance of PowerBI service Approach compare service name Below information IS REQUIRED with every PR Type of Change What type of change does your code introduce x Bug fix nonbreaking change fixes fixes New feature nonbreaking change adds functionality fixes issue number Breaking change effects multiple commands or functionality fixes issue number x Ran manual Pester test and has passed tests manualpesterps Adding code coverage to existing functionality Pester test is included If new file reference added for test has is been added to githubcomsqlcollaborativeappveyorlab Nunit test is included Documentation Build system Below this line you can erase anything that is not applicable Purpose Fixing bugs Approach Moving code around need to fix credential and reg server ms C github StartDbaMigration Source sql Destination sql Exclude Databases WhatIf What if Performing the operation Updating RecoveryInterval recovery interval min on target sql What if Performing the operation Updating AllowUpdates allow updates on target sql What if Performing the operation Updating UserConnections user connections on target sql What if Performing the operation Updating Locks locks on target sql What if Performing the operation Updating OpenObjects open objects on target sql What if Performing the operation Updating FillFactor fill factor on target sql What if Performing the operation Updating DisallowResultsFromTriggers disallow results from triggers on target sql What if Performing the operation Updating NestedTriggers nested triggers on target sql What if Performing the operation Updating ServerTriggerRecursionEnabled server trigger recursion on target sql What if Performing the operation Updating RemoteAccess remote access on target sql What if Performing the operation Updating DefaultLanguage default language on target sql What if Performing the operation Updating CrossDBOwnershipChaining cross db ownership chaining on target sql What if Performing the operation Updating MaxWorkerThreads max worker threads on target sql What if Performing the operation Updating NetworkPacketSize network packet size B on target sql What if Performing the operation Updating ShowAdvancedOptions show advanced options on target sql What if Performing the operation Updating RemoteProcTrans remote proc trans on target sql What if Performing the operation Updating C AuditMode c audit mode on target sql What if Performing the operation Updating DefaultFullTextLanguage default fulltext language on target sql What if Performing the operation Updating TwoDigitYearCutoff two digit year cutoff on target sql What if Performing the operation Updating IndexCreateMemory index create memory KB on target sql What if Performing the operation Updating PriorityBoost priority boost on target sql What if Performing the operation Updating RemoteLoginTimeout remote login timeout s on target sql What if Performing the operation Updating RemoteQueryTimeout remote query timeout s on target sql What if Performing the operation Updating CursorThreshold cursor threshold on target sql What if Performing the operation Updating SetWorkingSetSize set working set size on target sql What if Performing the operation Updating UserOptions user options on target sql What if Performing the operation Updating AffinityMask affinity mask on target sql What if Performing the operation Updating ReplicationMaxTextSize max text repl size B on target sql What if Performing the operation Updating MediaRetention media retention on target sql What if Performing the operation Updating CostThresholdForParallelism cost threshold for parallelism on target sql What if Performing the operation Updating MaxDegreeOfParallelism max degree of parallelism on target sql What if Performing the operation Updating MinMemoryPerQuery min memory per query KB on target sql What if Performing the operation Updating QueryWait query wait s on target sql What if Performing the operation Updating MinServerMemory min server memory MB on target sql What if Performing the operation Updating MaxServerMemory max server memory MB on target sql What if Performing the operation Updating QueryGovernorCostLimit query governor cost limit on target sql What if Performing the operation Updating LightweightPooling lightweight pooling on target sql What if Performing the operation Updating ScanForStartupProcedures scan for startup procs on target sql What if Performing the operation Updating Affinity Mask affinity mask on target sql What if Performing the operation Updating AffinityIOMask affinity IO mask on target sql What if Performing the operation Updating Affinity IOMask affinity IO mask on target sql What if Performing the operation Updating TransformNoiseWords transform noise words on target sql What if Performing the operation Updating PrecomputeRank precompute rank on target sql What if Performing the operation Updating ProtocolHandlerTimeout PH timeout s on target sql What if Performing the operation Updating IsSqlClrEnabled clr enabled on target sql What if Performing the operation Updating FullTextCrawlRangeMax max fulltext crawl range on target sql What if Performing the operation Updating FullTextNotifyBandwidthMin ft notify bandwidth min on target sql What if Performing the operation Updating FullTextNotifyBandwidthMax ft notify bandwidth max on target sql What if Performing the operation Updating FullTextCrawlBandwidthMin ft crawl bandwidth min on target sql What if Performing the operation Updating FullTextCrawlBandwidthMax ft crawl bandwidth max on target sql What if Performing the operation Updating DefaultTraceEnabled default trace enabled on target sql What if Performing the operation Updating BlockedProcessThreshold blocked process threshold s on target sql What if Performing the operation Updating InDoubtTransactionResolution indoubt xact resolution on target sql What if Performing the operation Updating RemoteDacConnectionsEnabled remote admin connections on target sql What if Performing the operation Updating DefaultBackupCompression backup compression default on target sql What if Performing the operation Updating FilestreamAccessLevel filestream access level on target sql What if Performing the operation Updating OptimizeAdhocWorkloads optimize for ad hoc workloads on target sql What if Performing the operation Updating AccessCheckCacheBucketCount access check cache bucket count on target sql What if Performing the operation Updating AccessCheckCacheQuota access check cache quota on target sql What if Performing the operation Updating BackupChecksumDefault backup checksum default on target sql What if Performing the operation Updating AutomaticSoftnumaDisabled automatic softNUMA disabled on target sql What if Performing the operation Updating ExternalScriptsEnabled external scripts enabled on target sql What if Performing the operation Updating AgentXPsEnabled Agent XPs on target sql What if Performing the operation Updating DatabaseMailEnabled Database Mail XPs on target sql What if Performing the operation Updating SmoAndDmoXPsEnabled SMO and DMO XPs on target sql What if Performing the operation Updating OleAutomationProceduresEnabled Ole Automation Procedures on target sql What if Performing the operation Updating XPCmdShellEnabled xpcmdshell on target sql What if Performing the operation Updating AdHocDistributedQueriesEnabled Ad Hoc Distributed Queries on target sql What if Performing the operation Updating ReplicationXPsEnabled Replication XPs on target sql What if Performing the operation Updating ContainmentEnabled contained database authentication on target sql What if Performing the operation Updating HadoopConnectivity hadoop connectivity on target sql What if Performing the operation Updating PolybaseNetworkEncryption polybase network encryption on target sql What if Performing the operation Updating RemoteDataArchiveEnabled remote data archive on target sql What if Performing the operation Updating AllowPolybaseExport allow polybase export on target sql What if Performing the operation Creating custom error usenglish on target sql What if Performing the operation Creating custom error Fran ais on target sql What if Performing the operation Copying abc on target DateTime SourceServer sql DestinationServer sql Name abc Type Credential Status Successful Notes What if Performing the operation Copying SHARED ACCESS SIGNATURE on target DateTime SourceServer sql DestinationServer sql Name azureblob Type Credential Status Successful Notes What if Performing the operation Copying dbatools on target DateTime SourceServer sql DestinationServer sql Name AzureCredential Type Credential Status Successful Notes What if Performing the operation Copying base sharepoint on target DateTime SourceServer sql DestinationServer sql Name BackupCopyUser Type Credential Status Successful Notes What if Performing the operation Copying storageaccountname on target DateTime SourceServer sql DestinationServer sql Name mycredential Type Credential Status Successful Notes What if Performing the operation Copying base powershell on target DateTime SourceServer sql DestinationServer sql Name PowerShell Proxy Account Type Credential Status Successful Notes What if Performing the operation Copying base ctrlb on target DateTime SourceServer sql DestinationServer sql Name PowerShell Service Account Type Credential Status Successful Notes What if Performing the operation Migrating all mail server configuration values on target sql What if Performing the operation Migrating account dbatoolsscidbatoolsio on target sql What if Performing the operation Migrating account The DBA Team on target sql What if Performing the operation Migrating mail profile The DBA Team on target sql What if Performing the operation Migrating account mail server smtpadlocal on target sql What if Performing the operation Migrating account mail server SQL on target sql What if Performing the operation Creating group Prod on target sql What if Performing the operation Copying SQL Server Cluster on target sql What if Performing the operation Creating group Test on target sql Cannot index into a null array At C github dbatools functions CopyDbaRegServerps char toSubGroup destinationGroupServerGroups fromSubGrou CategoryInfo InvalidOperation RuntimeException FullyQualifiedErrorId NullArray What if Performing the operation Creating group Dev on target sql What if Performing the operation Checking to see if server is the CMS equals current server name on target sql What if Performing the operation Copying SQL Server on target sql What if Performing the operation Copying SQL Server on target sql What if Performing the operation Generating SQL code for sup baw on target sql What if Performing the operation Stating that the actual file copy is about to occur on target console What if Performing the operation Updating create code to use new path on target sql What if Performing the operation Copying SQL C Program Files Microsoft SQL Server MSSQL MSSQLSERVER MSSQL Backup sup bawbak to sql C Program Files Microsoft SQL Server MSSQL MSSQLSERVER MSSQL Backup using BITSTransfer on target sql What if Performing the operation Adding backup device sup baw on target sql What if Performing the operation Creating server trigger trMScdcdbddlevent on target sql What if Performing the operation Adding SQL login app on target sql What if Performing the operation Updating SQL login app permissions on target sql What if Performing the operation Adding SQL login appAdmin on target sql What if Performing the operation Updating SQL login appAdmin permissions on target sql What if Performing the operation Adding SQL login auto on target sql What if Performing the operation Updating SQL login auto permissions on target sql What if Performing the operation Adding SQL login BASE Administrator on target sql What if Performing the operation Updating SQL login BASE Administrator permissions on target sql What if Performing the operation Stating BASE ctrlb is skipped because it exists at destination on target console What if Performing the operation Adding SQL login BASE Developers on target sql What if Performing the operation Updating SQL login BASE Developers permissions on target sql What if Performing the operation Adding SQL login BASE domain admins on target sql What if Performing the operation Updating SQL login BASE domain admins permissions on target sql What if Performing the operation Adding SQL login BASE fred on target sql What if Performing the operation Updating SQL login BASE fred permissions on target sql What if Performing the operation Adding SQL login BASE powershell on target sql What if Performing the operation Updating SQL login BASE powershell permissions on target sql What if Performing the operation Adding SQL login base sharepoint on target sql What if Performing the operation Updating SQL login base sharepoint permissions on target sql What if Performing the operation Adding SQL login BASE sql on target sql What if Performing the operation Updating SQL login BASE sql permissions on target sql What if Performing the operation Adding SQL login BASE sqlserver on target sql What if Performing the operation Updating SQL login BASE sqlserver permissions on target sql What if Performing the operation Adding SQL login BASE test on target sql What if Performing the operation Updating SQL login BASE test permissions on target sql What if Performing the operation Adding SQL login BUILTIN Administrators on target sql What if Performing the operation Updating SQL login BUILTIN Administrators permissions on target sql What if Performing the operation Adding SQL login BUILTIN Users on target sql What if Performing the operation Updating SQL login BUILTIN Users permissions on target sql What if Performing the operation Adding SQL login claudio on target sql What if Performing the operation Updating SQL login claudio permissions on target sql What if Performing the operation Adding SQL login dbatoolsciexportdbauserlogin on target sql What if Performing the operation Updating SQL login dbatoolsciexportdbauserlogin permissions on target sql What if Performing the operation Adding SQL login dbatoolsuser on target sql What if Performing the operation Updating SQL login dbatoolsuser permissions on target sql What if Performing the operation Adding SQL login dbcollectionlogin on target sql What if Performing the operation Updating SQL login dbcollectionlogin permissions on target sql What if Performing the operation Adding SQL login distributoradmin on target sql What if Performing the operation Updating SQL login distributoradmin permissions on target sql What if Performing the operation Adding SQL login exportsqllogintest on target sql What if Performing the operation Updating SQL login exportsqllogintest permissions on target sql What if Performing the operation Adding SQL login heman on target sql What if Performing the operation Updating SQL login heman permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Adding SQL login login on target sql What if Performing the operation Updating SQL login login permissions on target sql What if Performing the operation Stating NT AUTHORITY SYSTEM was skipped because it is a local machine name on target console What if Performing the operation Stating NT SERVICE MSSQLSERVER was skipped because it is a local machine name on target console What if Performing the operation Stating NT SERVICE SQLSERVERAGENT was skipped because it is a local machine name on target console What if Performing the operation Stating NT SERVICE SQLTELEMETRY was skipped because it is a local machine name on target console What if Performing the operation Stating NT SERVICE SQLWriter was skipped because it is a local machine name on target console What if Performing the operation Stating NT SERVICE Winmgmt was skipped because it is a local machine name on target console What if Performing the operation Adding SQL login securityadmintest on target sql What if Performing the operation Updating SQL login securityadmintest permissions on target sql What if Performing the operation Stating SQL winLogin was skipped because it is a local machine name on target console What if Performing the operation Adding SQL login sqladmin on target sql What if Performing the operation Updating SQL login sqladmin permissions on target sql What if Performing the operation Adding SQL login SQLCMDUser on target sql What if Performing the operation Updating SQL login SQLCMDUser permissions on target sql What if Performing the operation Adding SQL login storageuser on target sql What if Performing the operation Updating SQL login storageuser permissions on target sql What if Performing the operation Adding SQL login TestDba on target sql What if Performing the operation Updating SQL login TestDba permissions on target sql What if Performing the operation Stating testlogin is skipped because it exists at destination on target console What if Performing the operation Adding SQL login TestOrphan on target sql What if Performing the operation Updating SQL login TestOrphan permissions on target sql What if Performing the operation Adding SQL login TestOrphan on target sql What if Performing the operation Updating SQL login TestOrphan permissions on target sql What if Performing the operation Adding SQL login TestRenamed on target sql What if Performing the operation Updating SQL login TestRenamed permissions on target sql What if Performing the operation Adding SQL login testuser on target sql What if Performing the operation Updating SQL login testuser permissions on target sql What if Performing the operation Adding SQL login testuser on target sql What if Performing the operation Updating SQL login testuser permissions on target sql What if Performing the operation Adding SQL login testuserkey on target sql What if Performing the operation Updating SQL login testuserkey permissions on target sql What if Performing the operation Adding SQL login TestWithoutOwner on target sql What if Performing the operation Updating SQL login TestWithoutOwner permissions on target sql What if Performing the operation Adding SQL login ToMigrate on target sql What if Performing the operation Updating SQL login ToMigrate permissions on target sql What if Performing the operation Adding SQL login UserNOTOrphan on target sql What if Performing the operation Updating SQL login UserNOTOrphan permissions on target sql What if Performing the operation Adding SQL login webuser on target sql What if Performing the operation Updating SQL login webuser permissions on target sql What if Performing the operation Migrating localhost on target sql What if Performing the operation Migrating repldistributor on target sql What if Performing the operation Migrating on target sql What if Performing the operation Migrating SQL on target sql What if Performing the operation Migrating SQL on target sql What if Performing the operation Migrating on target sql What if Performing the operation Migrating TEST on target sql What if Performing the operation Migrating on target sql What if Performing the operation Migrating on target sql What if Performing the operation Migrating on target sql What if Performing the operation Server reconfiguration not yet supported Only Collection Set migration will be migrated at this time on target sql What if Performing the operation Attempting to modify Data Collector configuration on target sql What if Performing the operation C Program Files Microsoft SQL Server MSSQL MSSQLSERVER MSSQL DATA does not exist on sql Skipping Audit Specify Force to create the directory on target sql What if Performing the operation Creating server audit Audit on target sql What if Performing the operation C Program Files Microsoft SQL Server MSSQL MSSQLSERVER MSSQL DATA STIG does not exist on sql Skipping DISASTIG Specify Force to create the directory on target sql What if Performing the operation Audit DISASTIG does not exist on sql Skipping DISASTIGSERVERSPECIFICATION on target sql What if Performing the operation Audit does not exist on sql Skipping DISASTIGSpecs on target sql What if Performing the operation Audit Audit does not exist on sql Skipping ServerAuditSpecification on target sql What if Performing the operation Creating server endpoint Mirroring on target sql What if Performing the operation Migrating condition aaa on target sql What if Performing the operation Migrating policy xpcmdshell must be disabled on target sql What if Performing the operation Updating Resource Governor settings on target sql What if Performing the operation Migrating pool pOffHoursProcessing on target sql What if Performing the operation Migrating pool pProductionProcessing on target sql What if Performing the operation Reconfiguring on target sql What if Performing the operation Copying user objects on target sql What if Performing the operation Migrating session AlwaysOn Autoseed on target sql What if Performing the operation Migrating session Login Tracker on target sql What if Performing the operation Migrating session Profiler TSQL Duration on target sql What if Performing the operation Migrating session QuickSessionStandard on target sql What if Performing the operation Migrating session QuickSessionTSQL on target sql What if Performing the operation Extended Event Session telemetryxevents was skipped because it already exists on sql on target sql What if Performing the operation Creating Operator category OPZ on target sql What if Performing the operation Creating Alert category ALERTZ on target sql What if Performing the operation Creating Job category AdminJobs on target sql What if Performing the operation Creating Job category DB Helth Monitoring on target sql What if Performing the operation Creating Job category Event Cleanup on target sql What if Performing the operation Creating Job category Rationalisation on target sql What if Performing the operation Creating Job category Stats Rollup on target sql What if Performing the operation Creating Job category Topn past day on target sql What if Performing the operation Creating Job category Topn past month on target sql What if Performing the operation Creating Job category Topn past week on target sql What if Performing the operation Creating Job category Topn past year on target sql What if Performing the operation Creating Operator MSXOperator on target sql What if Performing the operation Creating Operator poobutt on target sql What if Performing the operation Creating Operator Teste on target sql What if Performing the operation Creating Operator The DBA Team on target sql What if Performing the operation Creating Alert Defaults on target sql What if Performing the operation Creating Alert adf on target sql What if Performing the operation Moving Notifications adf on target sql What if Performing the operation Creating Alert Error on target sql What if Performing the operation Moving Notifications Error on target sql What if Performing the operation Creating Alert Error on target sql What if Performing the operation Moving Notifications Error on target sql What if Performing the operation Missing operators at destination on target sql What if Performing the operation Creating Alert Error Number on target sql What if Performing the operation Moving Notifications Error Number on target sql What if Performing the operation Missing operators at destination on target sql What if Performing the operation Creating Alert Error Number on target sql What if Performing the operation Moving Notifications Error Number on target sql What if Performing the operation Missing operators at destination on target sql What if Performing the operation Creating Alert Error Number on target sql What if Performing the operation Moving Notifications Error Number on target sql What if Performing the operation Creating Alert Replication Warning Long merge over dialup connection Threshold mergeslowrunduration on target sql What if Performing the operation Moving Notifications Replication Warning Long merge over dialup connection Threshold mergeslowrunduration on target sql What if Performing the operation Creating Alert Replication Warning Long merge over LAN connection Threshold mergefastrunduration on target sql What if Performing the operation Moving Notifications Replication Warning Long merge over LAN connection Threshold mergefastrunduration on target sql What if Performing the operation Creating Alert Replication Warning Slow merge over dialup connection Threshold mergeslowrunspeed on target sql What if Performing the operation Moving Notifications Replication Warning Slow merge over dialup connection Threshold mergeslowrunspeed on target sql What if Performing the operation Creating Alert Replication Warning Slow merge over LAN connection Threshold mergefastrunspeed on target sql What if Performing the operation Moving Notifications Replication Warning Slow merge over LAN connection Threshold mergefastrunspeed on target sql What if Performing the operation Creating Alert Replication Warning Subscription expiration Threshold expiration on target sql What if Performing the operation Moving Notifications Replication Warning Subscription expiration Threshold expiration on target sql What if Performing the operation Creating Alert Replication Warning Transactional replication latency Threshold latency on target sql What if Performing the operation Moving Notifications Replication Warning Transactional replication latency Threshold latency on target sql What if Performing the operation Creating Alert Replication agent custom shutdown on target sql What if Performing the operation Moving Notifications Replication agent custom shutdown on target sql What if Performing the operation Creating Alert Replication agent failure on target sql What if Performing the operation Moving Notifications Replication agent failure on target sql What if Performing the operation Creating Alert Replication agent retry on target sql What if Performing the operation Moving Notifications Replication agent retry on target sql What if Performing the operation Creating Alert Replication agent success on target sql What if Performing the operation Moving Notifications Replication agent success on target sql What if Performing the operation Creating Alert Replication Subscriber has failed data validation on target sql What if Performing the operation Moving Notifications Replication Subscriber has failed data validation on target sql What if Performing the operation Creating Alert Replication Subscriber has passed data validation on target sql What if Performing the operation Moving Notifications Replication Subscriber has passed data validation on target sql What if Performing the operation Creating Alert Replication Subscription reinitialized after validation failure on target sql What if Performing the operation Moving Notifications Replication Subscription reinitialized after validation failure on target sql What if Performing the operation Missing operators at destination on target sql What if Performing the operation Creating Alert Severity on target sql What if Performing the operation Moving Notifications Severity on target sql What if Performing the operation Missing operators at destination on target sql What if Performing the operation Creating Alert Severity on target sql What if Performing the operation Moving Notifications Severity on target sql What if Performing the operation Missing operators at destination on target sql What if Performing the operation Creating Alert Severity on target sql What if Performing the operation Moving Notifications Severity on target sql What if Performing the operation Missing operators at destination on target sql What if Performing the operation Creating Alert Severity on target sql What if Performing the operation Moving Notifications Severity on target sql What if Performing the operation Missing operators at destination on target sql What if Performing the operation Creating Alert Severity on target sql What if Performing the operation Moving Notifications Severity on target sql What if Performing the operation Missing operators at destination on target sql What if Performing the operation Creating Alert Severity on target sql What if Performing the operation Moving Notifications Severity on target sql What if Performing the operation Missing operators at destination on target sql What if Performing the operation Creating Alert Severity on target sql What if Performing the operation Moving Notifications Severity on target sql What if Performing the operation Missing operators at destination on target sql What if Performing the operation Creating Alert Severity on target sql What if Performing the operation Moving Notifications Severity on target sql What if Performing the operation Missing operators at destination on target sql What if Performing the operation Creating Alert Severity on target sql What if Performing the operation Moving Notifications Severity on target sql What if Performing the operation Missing operators at destination on target sql What if Performing the operation Creating Alert Severity on target sql What if Performing the operation Moving Notifications Severity on target sql DateTime SourceServer sql DestinationServer sql Name CopyBackupProxy Type Credential Status Skipped Notes Associated credential account BackupCopyUser does not exist on sql DateTime SourceServer sql DestinationServer sql Name PowerShell Proxy Type Credential Status Skipped Notes Skipping migration of PowerShell Proxy due to misconfigured empty credential name What if Performing the operation Creating schedule CDC capture agent schedule on target sql What if Performing the operation Creating schedule CDC cleanup agent schedule on target sql What if Performing the operation Shared job schedule CollectorScheduleEvery min exists at destination Use Force to drop and migrate on target sql What if Performing the operation Creating schedule CollectorScheduleEvery min on target sql What if Performing the operation Shared job schedule CollectorScheduleEvery min exists at destination Use Force to drop and migrate on target sql What if Performing the operation Creating schedule CollectorScheduleEvery min on target sql What if Performing the operation Shared job schedule CollectorScheduleEvery min exists at destination Use Force to drop and migrate on target sql What if Performing the operation Creating schedule CollectorScheduleEvery min on target sql What if Performing the operation Shared job schedule CollectorScheduleEvery min exists at destination Use Force to drop and migrate on target sql What if Performing the operation Creating schedule CollectorScheduleEvery min on target sql What if Performing the operation Shared job schedule CollectorScheduleEvery min exists at destination Use Force to drop and migrate on target sql What if Performing the operation Creating schedule CollectorScheduleEvery min on target sql What if Performing the operation Shared job schedule CollectorScheduleEvery h exists at destination Use Force to drop and migrate on target sql What if Performing the operation Creating schedule CollectorScheduleEvery h on target sql What if Performing the operation Creating schedule daily on target sql What if Performing the operation Creating schedule daily on target sql What if Performing the operation Creating schedule Database Mirroring Monitor Schedule on target sql What if Performing the operation Creating schedule mdwpurgedataschedule on target sql What if Performing the operation Creating schedule mdwpurgedataschedule on target sql What if Performing the operation Creating schedule OccursEvery Minutes on target sql What if Performing the operation Creating schedule OccursEveryOneHour on target sql What if Performing the operation Creating schedule OccursOnceADayAt AM on target sql What if Performing the operation Creating schedule Replication agent schedule on target sql What if Performing the operation Creating schedule Replication agent schedule on target sql What if Performing the operation Creating schedule Replication agent schedule on target sql What if Performing the operation Creating schedule Replication agent schedule on target sql What if Performing the operation Shared job schedule RunAsSQLAgentServiceStartSchedule exists at destination Use Force to drop and migrate on target sql What if Performing the operation Creating schedule RunAsSQLAgentServiceStartSchedule on target sql What if Performing the operation Creating schedule SQLWATCHLOGGERDISKUTILISATION on target sql What if Performing the operation Creating schedule SQLWATCHLOGGERMISSINGINDEXES on target sql What if Performing the operation Shared job schedule syspolicypurgehistoryschedule exists at destination Use Force to drop and migrate on target sql What if Performing the operation Creating schedule syspolicypurgehistoryschedule on target sql What if Performing the operation Databases DBWithCDC DBWithCDC doesnt exist on destination Skipping job cdcDBWithCDCcapture on target sql What if Performing the operation Databases DBWithCDC doesnt exist on destination Skipping job cdcDBWithCDCcleanup on target sql What if Performing the operation Creating Job CommandLog Cleanup on target sql What if Performing the operation Reporting status of migration for CommandLog Cleanup on target sql What if Performing the operation Creating Job Daily Full Backups on target sql What if Performing the operation Reporting status of migration for Daily Full Backups on target sql What if Performing the operation Creating Job Database Mirroring Monitor Job on target sql What if Performing the operation Reporting status of migration for Database Mirroring Monitor Job on target sql What if Performing the operation Creating Job DatabaseBackup SYSTEMDATABASES FULL on target sql What if Performing the operation Reporting status of migration for DatabaseBackup SYSTEMDATABASES FULL on target sql What if Performing the operation Creating Job DatabaseBackup USERDATABASES DIFF on target sql What if Performing the operation Reporting status of migration for DatabaseBackup USERDATABASES DIFF on target sql What if Performing the operation Creating Job DatabaseBackup USERDATABASES FULL on target sql What if Performing the operation Reporting status of migration for DatabaseBackup USERDATABASES FULL on target sql What if Performing the operation Creating Job DatabaseBackup USERDATABASES LOG on target sql What if Performing the operation Reporting status of migration for DatabaseBackup USERDATABASES LOG on target sql What if Performing the operation Creating Job DatabaseIntegrityCheck SYSTEMDATABASES on target sql What if Performing the operation Reporting status of migration for DatabaseIntegrityCheck SYSTEMDATABASES on target sql What if Performing the operation Creating Job DatabaseIntegrityCheck USERDATABASES on target sql What if Performing the operation Reporting status of migration for DatabaseIntegrityCheck USERDATABASES on target sql What if Performing the operation Creating Job Hourly Log Backups on target sql What if Performing the operation Reporting status of migration for Hourly Log Backups on target sql What if Performing the operation Creating Job IndexOptimize USERDATABASES on target sql What if Performing the operation Reporting status of migration for IndexOptimize USERDATABASES on target sql What if Performing the operation Creating Job Output File Cleanup on target sql What if Performing the operation Reporting status of migration for Output File Cleanup on target sql What if Performing the operation Creating Job Replication agents checkup on target sql What if Performing the operation Reporting status of migration for Replication agents checkup on target sql What if Performing the operation Creating Job spdeletebackuphistory on target sql What if Performing the operation Reporting status of migration for spdeletebackuphistory on target sql What if Performing the operation Creating Job sppurgejobhistory on target sql What if Performing the operation Reporting status of migration for sppurgejobhistory on target sql What if Performing the operation Creating Job SQLWATCHLOGGERDISKUTILISATION on target sql What if Performing the operation Reporting status of migration for SQLWATCHLOGGERDISKUTILISATION on target sql What if Performing the operation Creating Job SQLWATCHLOGGERMISSINGINDEXES on target sql What if Performing the operation Reporting status of migration for SQLWATCHLOGGERMISSINGINDEXES on target sql What if Performing the operation Job syspolicypurgehistory exists at destination Use Force to drop and migrate on target sql What if Performing the operation Creating Job test on target sql What if Performing the operation Reporting status of migration for test on target sql What if Performing the operation Copying Agent Properties on target sql What if Performing the operation Creating startup procedure dboSTIGTrace on target sql What if Performing the operation Creating startup procedure dboOpenQueryStoreStartup on target sql Environmental information Name Value PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion Name dbatools Path C Program Files WindowsPowerShell Modules dbatools dbatoolspsd Version Name dbatools Path C Program Files WindowsPowerShell Modules dbatools dbatoolspsd Version SQL Server Microsoft SQL Server SP CU GDR KB X Jun Copyright c Microsoft Corporation Enterprise Edition Corebased Licensing bit on Windows Server Datacenter X Build Hypervisor Report When using a CDL of servers only the last one passed in gets executed StartDbaAgentJob sqlinstance IP IP sqlcredential DCred job LSCopyQDWPreviewTest above only runs on IP StartDbaAgentJob sqlinstance IP IP sqlcredential DCred job LSCopyQDWPreviewTest above only runs on IP I have verified the job exists on both server Command can be run individually with server but not with multiple Host used XXXX ISE If anything other than powershellexe was used please confirm that you can duplicate the issue with powershellexe XXXX Still buggy in powershellexe Errors Received no errors output just shows the job successful on last server passed in Steps to Reproduce run command below adding correct info StartDbaAgentJob sqlinstance input multiple instances sqlcredential creds here job job name here Expected Behavior Job should run on all servers in the CDL Actual Behavior only runs on last server listed When running GetDbaDatabase in Azure SQL DB it fails with error InvokeQueryRawDatabases Failure SUSERSNAME cannot be invoked with parameters in this version of SQL Server This occurs at lines and Either we can igonor Azure SQL DBs for this or we can update to SELECT name databaseid ownersid SUSERSNAME AS Owner FROM sysdatabases Summary of new feature Support addremovingupdating of data classification for a table column Proposed technical details if applicable Classification Information types and Sensitivity are stored as extended properties on tables The values are GUIDs Ive found a mapping table here GUID Mapping Below is the SQL code that was added when adding a Classification to TABLE and Column EXPIRATIONTS the classfication was Information type NA and Sensitivity General sql EXEC sysspaddextendedproperty name Nsysinformationtypeid value N level type NSCHEMA level name Ndbo level type NTABLE level name NTABLE level type NCOLUMN level name NEXPIRATIONTS GO EXEC sysspaddextendedproperty name Nsysinformationtypename value N level type NSCHEMA level name Ndbo level type NTABLE level name NTABLE level type NCOLUMN level name NEXPIRATIONTS GO EXEC sysspaddextendedproperty name Nsyssensitivitylabelid value N a db d d c cdf a b eb level type NSCHEMA level name Ndbo level type NTABLE level name NTABLE level type NCOLUMN level name NEXPIRATIONTS GO EXEC sysspaddextendedproperty name Nsyssensitivitylabelname value NGeneral level type NSCHEMA level name Ndbo level type NTABLE level name NTABLE level type NCOLUMN level name NEXPIRATIONTS GO Here is the same but with the Information Type set to Other sql EXEC sysspaddextendedproperty name Nsysinformationtypeid value N C B CCC A F BB D level type NSCHEMA level name Ndbo level type NTABLE level name NTable level type NCOLUMN level name NEXPIRATIONTS GO EXEC sysspaddextendedproperty name Nsysinformationtypename value NOther level type NSCHEMA level name Ndbo level type NTABLE level name NTable level type NCOLUMN level name NEXPIRATIONTS GO EXEC sysspaddextendedproperty name Nsyssensitivitylabelid value N a db d d c cdf a b eb level type NSCHEMA level name Ndbo level type NTABLE level name NTable level type NCOLUMN level name NEXPIRATIONTS GO EXEC sysspaddextendedproperty name Nsyssensitivitylabelname value NGeneral level type NSCHEMA level name Ndbo level type NTABLE level name NTable level type NCOLUMN level name NEXPIRATIONTS GO Latest version of dbatools as of writing dbatools Came across issues using invokedbadblogshipping on version It appears that when specifying DestinationSQLCredential it does not properly identify that I passed in a SQL login it thinks its a windows login which caused the error shows since source and destination instances are on different domains second it appears that when i used whatif True it should not have tried to access the remote share from what i was told Please note effective June we will begin closing bug reports that do not follow the bug report format We ask only what is required to help us resolve the issue faster We are constantly updating dbatools so knowing what version you are using for instance saves us a ton of time dbatools has been released as of June Please ensure you are on this version before submitting an issue Environmental information Run below command paste results below PowerShell versionnPSVersionTable OutString n dbatools Module versionngmo dbatools List select name path version fl force OutString clip PowerShell version Name Value PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion dbatools Module version Name dbatools Path C Program Files WindowsPowerShell Modules dbatools dbatoolspsd Version Name dbatools Path C Program Files WindowsPowerShell Modules dbatools dbatoolspsd Version Name dbatools Path C Program Files WindowsPowerShell Modules dbatools dbatoolspsd Version Name dbatools Path C Program Files WindowsPowerShell Modules dbatools dbatoolspsd Version Only if using nonEnglish versions of Windows Paste output of GetCulture powershell Replace with output of GetCulture SQL Server Paste output of SELECT VERSION sql Microsoft SQL Server SP CU KB X Jul Copyright c Microsoft Corporation Enterprise Edition Corebased Licensing bit on Windows Server Datacenter X Build Hypervisor Only if using nonEnglish Database Engine Paste output of SELECT LANGUAGE sql REPLACE WITH output of LANGUAGE Report Things to consider Errors received are not related to permissions Have you tried the same command using powershellexe instead of a hosted powershell instance like ISE or VS Code If this refers to CopyDbaDatabase can you replace the problem with BackupDbaDatabase and RestoreDbaDatabase CopyDbaDatabase will not work in every environment and every situation Instead we try to ensure Backup Restore work in your environment Host used x powershellexe ISE VS Code Other please specify If anything other than powershellexe was used please confirm that you can duplicate the issue with powershellexe Still buggy in powershellexe Errors Received Run this command and paste below error select clip writeErrorStream True PSMessageDetails Exception SystemException Collection was modified enumeration operation may not execute SystemInvalidOperationException Collection was modified enumeration operation may not execute at SystemCollectionsSortedListSortedListEnumeratorMoveNext at lambdamethodClosure Object StrongBox InterpretedFrame End of inner exception stack trace TargetObject cdcresourcepool CategoryInfo OperationStopped cdcresourcepool ResourcePool WriteError Exception FullyQualifiedErrorId dbatoolsCopyDbaResourceGovernorStopFunction ErrorDetails Collection was modified enumeration operation may not execute InvocationInfo SystemManagementAutomationInvocationInfo ScriptStackTrace at StopFunction C Program Files WindowsPowerShell Modules dbatools allcommandsps line at CopyDbaResourceGovernorProcess C Program Files WindowsPowerShell Modules dbatools allcommandsps line at ScriptBlock No file line PipelineIterationInfo Steps to Reproduce If you have confirmed this issue can be reproduced please provide the exact steps TSQL PowerShell ext copyDbaresourceGovernor Source sourceInstance Destination destinationInstance verbose force Expected Behavior What did you expect to happen Completely drop and replace the Resource Governor on the destinationInstance Actual Behavior What happened When the destinationInstance has an existing Resource Pool with a Workload Group the Workload Group is deleted but the Resource Pool is not The failure to delete results in a Moving On and the group is not recreated The command provides two ways of passing in multiple accounts to assign SYSADMIN role at installation AdminAccount which is string Configuration which you put SQLSYSADMINACCOUNTS However the way it is parsing it is wrong and causes failure The below ini file is formatted properly with multiple admin accounts being included The command should be updated to properly populate these in the ini file or on the command line when it is running the command Using the Configuration the ini file saving with the ConfigureFile it puts the parameter in as this format SQLSYSADMINACCOUNTSLAB dabadmin LAB sql nyagent LAB sql nyengine The correct format being SQLSYSADMINACCOUNTSLAB dabadmin LAB sql nyagent LAB sql nyengine The correct ini format is below PS EnterPSSession VMName vmname Credential domainCred SQL New York PS C Users dabadmin Documents GetContent installini OPTIONS FEATURESSQLENGINEFullTextConn SQLUSERDBDIRF SQL USER DATA QUIETTrue SQLTEMPDBLOGDIRF SQL TEMPDB SQLBACKUPDIRF SQL DATA BACKUPS TCPENABLED ACTIONInstall HELPFalse AGTSVCSTARTUPTYPEAutomatic INSTALLSHAREDDIRE Programs SQL Server RSSVCSTARTUPTYPEAutomatic ERRORREPORTINGFalse SQLSVCSTARTUPTYPEAutomatic INSTALLSQLDATADIRF SQL DATA X False SQLCOLLATIONSQLLatin GeneralCP CIAS SQMREPORTINGFalse UPDATEENABLED SQLUSERDBLOGDIRF SQL USER LOG INSTANCENAMEMSSQLSERVER INSTANCEDIRE Programs SQL Server INDICATEPROGRESSFalse INSTANCEIDMSSQLSERVER INSTALLSHAREDWOWDIRE Programs x SQL Server QUIETSIMPLEFalse SQLTEMPDBDIRF SQL TEMPDB ENABLERANUFalse SQLSYSADMINACCOUNTSLAB dabadmin LAB sql nyagent LAB sql nyengine BROWSERSVCSTARTUPTYPEManual SQLTEMPDBFILECOUNT FILESTREAMLEVEL SQL New York PS C Users dabadmin Documents InstallDbaInstance Version Path D ConfigurationFile installini Confirmfalse ComputerName SQL NYlablocal InstanceName MSSQLSERVER Version Port Successful True Restarted False Installer D setupexe ExitCode LogFile C Program Files Microsoft SQL Server Setup Bootstrap Log Summarytxt Notes RSINSTALLMODEDefaultNativeMode The above is added to the ini file I save out when Im not asking or providing RS in features config powershell config UPDATEENABLED FEATURES SQLENGINEFullTextConn INSTANCEDIR E Programs SQL Server INSTALLSHAREDDIR E Programs SQL Server INSTALLSHAREDWOWDIR E Programs x SQL Server INSTALLSQLDATADIR F SQL DATA SQLBACKUPDIR F SQL DATA BACKUPS SQLTEMPDBDIR F SQL TEMPDB SQLTEMPDBLOGDIR F SQL TEMPDB SQLUSERDBDIR F SQL USER DATA SQLUSERDBLOGDIR F SQL USER LOG TCPENABLED BROWSERSVCSTARTUPTYPE Manual InstallDbaInstance Version Path D Configuration config EngineCredential credEngine AgentCredential credAgent PerformVolumeMaintenanceTask Restart The RSINSTALLMODE should not be provided on versions and above nor should it be provided if not passed in the Configuration parameter as a feature