when using adaptivelrate it runs the script candidatelrates where the variable maxiterup is not defined so an error occurs There is a small bug After a couple of hours running examplemnistmlpm it outputs Correctly classified test samples It simply predicts class for all test samples I checked it twice and the results are the same I could not figure out the problem any help is greatly appreciated in line the code should be subwindowsum fspecialgaussian Clcnneigh 