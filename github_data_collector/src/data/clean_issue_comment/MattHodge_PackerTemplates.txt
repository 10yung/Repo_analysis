Hi thanks for this project I noticed there is an unverified windows update exe being used Is there any reason for this I am trying to generate the HyperV vhdx file however getting the below error message Would you please check and advise Environment Windows Datacentre Server installed with HyperV Packer Version tried with dev ISO Windows R Error hyperviso Provisioning with Powershell hyperviso Provisioning with powershell script scriptsinstallwindowsupdatesps hyperviso Disconnecting from vmconnect hyperviso Error shutting down VM PowerShell error HyperV StopVM Failed to stop hyperviso At C Users Administrator AppData Local Temp ps ps char hyperviso HyperV StopVM VM vm Force Confirmfalse hyperviso hyperviso CategoryInfo NotSpecified StopVM VirtualizationException hyperviso FullyQualifiedErrorId OperationFailedMicrosoftHyperVPowerShellCommandsStopVM Ive modified your answer xml file to work with my Windows Pro iso and have been able to complete the first builder phase virtualbox windowsbase but the second phase virtualbox winupdateswmf fails because WUInstallAMD exe fails with various errors causing powershell to exit with meaning at least one error occurred reboot required I noticed you run scriptsinstallwindowsupdatesps several times in a loop with windows restarts each time Any reason why you shouldnt add exit code to validexitcodes in the winupdates builder so this builder will make a best effort at applying updates I have done this in my fork of your wonderful repo What I have found is that any of the various windows update errors that occur are all eliminated by the nd or rd rebootWUInstall cycle WUInstall errors Ive seen so far are x WUENOTAPPLICABLE Operation was not performed because there are no applicable updates Download failed I applaud your use of chaining phases to facilitate resumption of failed packer builds First of all thanks for all this great work your packer templates are the cleanest Ive seen I get the below error when running buildps Im running Windows Pro PS C Users tblack src PackerTemplates buildps Preparing to run build script Running build script Analyzing build script Processing build script Installing addins Error The assembly CakeYaml Version Cultureneutral PublicKeyTokennull is referencing an older version of CakeCore This assembly need to reference at least CakeCore version Another option is to downgrade Cake to an earlier version Its not recommended but you can explicitly optout of assembly verification by configuring the Skip Verification setting to true ie command line parameter settingsskipverificationtrue environment variable CAKESETTINGSSKIPVERIFICATIONtrue read more about configuration at I tried changing the version from to in toolsAddinsCakeYaml cakeyamlnuspec but that didnt help This is my first time using cake Im clueless I am able to get past the error with the suggested buildps settingsskipverificationtrue but just wanted to make a note of this on your repo Thanks again for all this good work