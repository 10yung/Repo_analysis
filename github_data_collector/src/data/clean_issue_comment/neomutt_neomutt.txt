Hi Thanks for this amazing program Im trying to determine whether to save an outgoing email by the From address For example I can send emails with both agmailcom and aexamplecom Since Gmail automatically saves outgoing mail I only want to save a copy if the mail is sent from aexamplecom What is the best way to do this I have tried the following configuration but it doesnt work the outgoing mail is not saved IMAP configuration of agmailcom omitted alias gmail User agmailcom alias group example User aexamplecom unset record fcchook f example Gmail Sent Mail Thanks in advance Add a decompression layer to the IMAP connection This feature uses zlib to compress data tofrom an IMAP server When logging is enabled at level it logs statistics on close zstrmclose read x wrote x Enable with configure zlib set imapdeflate yes default Heres the call graph img width src imapcheckmailbox can return MUTTNEWMAIL or MUTTREOPENED Despite what the function comments say these functions can also return the values above mxmboxclose mxmboxsync imapsyncmailbox Unfortunately a couple of problems prevent the values being propagated back to the index mxmboxclose A recent refactoring meant that return values werent being propagated Commit e acc fixes that in this PR imapsyncmailbox This function used to return the result of imapcheckmailbox That was changed by commit c fa imap fixing race when syncing mailbox imapcheckmailbox returns a detailed state not only imapsyncmailbox assumes that the function was returning only This change fixes that diff diff git aimapimapc bimapimapc int imapsyncmailboxstruct Mailbox m bool expunge bool close imapallowreopenm rc imapcheckmailboxm false if rc if rc return rc if we are expunging anyway we can do deleted messages very quickly I need to find out what this was fixing before I can change it back Issue Found a condition that can never be true mxmboxclose only returns or so check gets assigned or This condition can never be met as MUTTNEWMAIL has a value of and MUTTREOPENED has a value of Are we missing a check mxmboxcheck perhaps Similar situations here Hi Since a few releases sorry I can say exactly when it stopped to work mails moved by imapfilter in other folders are still visible in inbox index though not here anymore and also cant be opened They move from the index only when navigating in other folders Thanks The new nested Windows allows us to start being creative This is one possible use When set to an empty string disable the indexpager bar completely set statusformat set pagerformat When combined with these settings you can have a big view mode set help no set sidebarvisible no set pagerindexlines My mailboxes is setup like this mailboxes WorkINBOX WorkStarred WorkSent WorkDrafts WorkTrash WorkSpam tree mailWork d I ArchivecurnewtmpcertsnotmuchINBOX Gmail afin noreport awk ifNR print tr n But the output on both machines are different Broken behaviour notice the duplication also the path expansion mailWork instead of Work img width altbroken src and the sidebar no hierarchy INBOX Starred Sent Drafts Trash Spam Drafts aaaaaaaaaa bbbbbbbb Sent Spam Starred Trash cccccc company dd eeee fffff ggg CI hhh iiiiiii jjjjjjjjjjjjjj github kkkkkkkkkkkkkk llllll mmmmmmmm nnnnnnnnnnnnnn oooooooo pppp qqqqqqqqqqqqq jjj sssssssssssss Correct behavior img width altcorrect src and the sidebar INBOX Starred Sent Drafts Trash Spam aaaaaaaaaa bbbbbbbb cccccc company dd eeee fffff ggg CI hhh iiiiiii jjjjjjjjjjjjjj github kkkkkkkkkkkkkk llllll mmmmmmmm nnnnnnnnnnnnnn oooooooo pppppppppppppp qqqqqq rrrrrrrr ssssssssssssss tttttttt uuuu vvvvvvvvvvvvv www xxxxxxxxxxxxx Running this tree mailWork d I ArchivecurnewtmpcertsnotmuchINBOX Gmail afin noreport awk ifNR print tr n on the command line yields the same exact results on both machines and also both are using the same exact neomutt version NeoMutt Copyright C Michael R Elkins and others NeoMutt comes with ABSOLUTELY NO WARRANTY for details type neomutt vv NeoMutt is free software and you are welcome to redistribute it under certain conditions type neomutt vv for details System Darwin x ncurses ncurses compiled with libiconv libidn compiled with GPGme libnotmuch hcache backends tokyocabinet lmdb Configure options prefixusrlocalCellarneomutt enablegpgme withgpgmeusrlocaloptgpgme gss lmdb notmuch sasl tokyocabinet withsslusrlocaloptopenssl withuincurses Compilation CFLAGS g O stdc DALLSOURCE DGNUSOURCE DEXTENSIONS Iusrlocaloptgpgmeinclude Iusrlocaloptlibassuaninclude Iusrlocaloptlibgpgerrorinclude IusrlocalCellarneomutt include DNCURSESWIDECHAR Iusrlocaloptopenssl include Default options attachheaderscolor composetosender compress conddate debug encrypttoself forgottenattachments forwref ifdef imap indexcolor initials limitcurrentthread multiplefcc nestedif newmail nntp pop progress quasidelete regcomp replywithxorig sensiblebrowser sidebar skipquoted smtp statuscolor timeout tlssni trash Compile options autocrypt bkgdset color cursset fcntl flock fmemopen futimens getaddrinfo gnutls gpgme gss hcache homespool idn inotify localeshack lua meta mixmaster nls notmuch openssl pgp sasl smime sqlite startcolor sunattachment typeahead MAILPATHvarmail PKGDATADIRusrlocalCellarneomutt shareneomutt SENDMAILusrsbinsendmail SYSCONFDIRusrlocalCellarneomutt etc To learn more about NeoMutt visit If you find a bug in NeoMutt please raise an issue at or send an email to neomuttdevelneomuttorg Update Hold off on reviewing this Somethings not quite right details summaryObject Diagramsummary img src width details Each backend Account holds a Connection which in turn holds a ConnAccount struct Connection manages the socket handling struct ConnAccount is a cache of login credentials The cached credentials allow NeoMutt to poll all the Accounts without having to fire accounthooks every time For each credential User Password etc there is some backendspecific code that looks up which config variable to use imapuser popuser imappass poppass This brings SMTP into line with IMAP and POP cd bb e c config add missing smtpuser variable Minor tidying to make the code easier to read a d rename unify ConnAccount variables d d b initialise all ConnAccount variables dee b a b drop unused param in muttconnfind Ages ago I put a ConnAccount into the POP and IMAP Mailbox data I cant remember why This may have been causing connection problems as some code updated the wrong credentials cache c fb imap drop ConnAccount db a pop drop ConnAccount Add a callback function to the ConnAccount so that it can ask the backends for credentials c db f refactor connection service c f d refactor add getfield to Connection Finally move some dependencyfree functions to the connection library acfbcecf conn move ConnAccount functions to libconn muttaccountgetlogin muttaccountgetoauthbearer muttaccountgetpass muttaccountgetuser muttaccountunsetpass Sometimes NeoMutt can be quite confusing Were working on making it easier to understand I am new to Neomutt and was wondering if one can we use Ueberzug instead of w m to view image attachments It seems to be more robust and to be compatible with more terminal emulators yet I failed to find information on how to combine it with Neomutt or Mutt Expected Behaviour I ran entirethread on a message Actual Behaviour I sometimes get a SIGSEGV It is not always Here is the backtrace Thread neomutt received signal SIGSEGV Segmentation fault x eca in emailgetid e x a at notmuchmuttnotmuchc return e eedata struct NmEmailData eedatavirtualid NULL gdb bt x eca in emailgetid e x a at notmuchmuttnotmuchc x bf in getnmmessage db x d e x a at notmuchmuttnotmuchc x e in nmreadentirethread m x c e x a at notmuchmuttnotmuchc x a f in muttindexmenu dlg x e at indexc x b d e in main argc argv x fffffffdaa envp x fffffffdac at mainc gdb Steps to Reproduce I just ran entirethread on a message but it is not always reproducible How often does this happen Sometimes even with the same message it is not always When did it start to happen Not sure since it happens randomly NeoMutt Version mutt v NeoMutt b Copyright C Michael R Elkins and others NeoMutt comes with ABSOLUTELY NO WARRANTY for details type neomutt vv NeoMutt is free software and you are welcome to redistribute it under certain conditions type neomutt vv for details System Linux generic x ncurses ncurses compiled with libidn compiled with libnotmuch hcache backends tokyocabinet Configure options ssl sasl enablenotmuch enabledebug tokyocabinet prefixusrlocal Compilation CFLAGS g O stdc DALLSOURCE DGNUSOURCE DEXTENSIONS Iusrlocalinclude DNCURSESWIDECHAR Default options attachheaderscolor composetosender compress conddate debug encrypttoself forgottenattachments forwref ifdef imap indexcolor initials limitcurrentthread multiplefcc nestedif newmail nntp pop progress quasidelete regcomp replywithxorig sensiblebrowser sidebar skipquoted smtp statuscolor timeout tlssni trash Compile options autocrypt bkgdset color cursset fcntl flock fmemopen futimens getaddrinfo gnutls gpgme gss hcache homespool idn inotify localeshack lua meta mixmaster nls notmuch openssl pgp sasl smime sqlite startcolor sunattachment typeahead MAILPATHvarmail PKGDATADIRusrlocalshareneomutt SENDMAILusrsbinsendmail SYSCONFDIRusrlocaletc To learn more about NeoMutt visit If you find a bug in NeoMutt please raise an issue at or send an email to neomuttdevelneomuttorg Extra Info Using maildir 