Consider this simple snippet rust use thunder use clap use thunderthunderclap struct MyApp thunderclapparam String A global var impl MyApp Scan a directory fn scansourcedir String printlnparam param fn main MyAppstart returns an error when running compiling cargo run Compiling testthunder v homexxxtmptestthunder error E cannot find value param in this scope srcmainrs thunderclapparam String A global var not found in this scope or also cargo run param hey error Found argument param which wasnt expected or isnt valid in this context USAGE cargo run OPTIONS args For more information try help How are global variable supposed to be used Can you help with some more detailed examples thanks The Loki example does not compile cargo run help Compiling testthunder v homexxxtmptestthunder error custom attribute panicked srcmainrs thunderclapexample OptionString Error here anotherexample String No error here help message index out of bounds the len is but the index is Running on edition rustc version rustc nightly adbfec Hi check this code out use thunderthunderclap struct MyApp thunderclap impl MyApp fn helloname str Result str printlnHello name fn main MyApphellokat Compilation errors cargo check Checking testthunder v homexxxtmptestthunder error E mismatched types srcmainrs thunderclap expected enum stdresultResult found note expected type stdresultResult str found type error E match arms have incompatible types srcmainrs thunderclap expected enum stdresultResult found match arm with an incompatible type note expected type stdresultResult str found type error aborting due to previous errors For more information about this error try rustc explain E error Could not compile testthunder I see two issues here thunderclap is stealing the error positioning which is unfortunate because on large codebases it could make hard to understand where exactly is the error There are two errors reported instead of one Correct error expected cargocheck Checking testthunder v homexxxtmptestthunder error E mismatched types srcmainrs fn helloname str Result str printlnHello name expected enum stdresultResult found note expected type stdresultResult str found type Running on edition rustc version rustc nightly adbfec Opinions Hello After talking about thunder with spacekookie she told me about a effort to rewrite thunder to have a better usability and code Thinking about that I thought about proposing a new way to write thunder apps So far my proposal would make a simple hello world look like this rust featureuseexternmacros extern crate thunderderive extern crate thunder deriveThunderApp struct Thor Bla bla bl thundertakevalue false Default is to take value drunk bool What will be Thors age today thunderdefaultvalue Can configure flag default value age i thunderclap impl Thor This is a subcommand as before fn hello self name Option str printlnHello Nice to meet you Im Thor and Im years old nameunwraporworld selfage fn me self let drunk if selfdrunk drunk else not drunk printlnHuh me Im Thor And Im fn main Thorstart This is strongly inspired by structopt The main idea is to have global args parsing work like normal args do in structopt and subcommands work as they work right now Thus being more flexible while still being fast to iterate I couldnt think about how to make subcommand arguments as flexible but its on my list of things to improve too For example its not clear how to run app with more than one parameter rust App thunderclap impl App run fn runa btoken a str listeningaddress b str printlnHello my address is token listeningaddress error E no function or associated item named run found for type clapApp in the current scope src mainrs thunderclap function or associated item not found in clapApp error aborting due to previous error When i didnt provide a valid boolean i got a not so nice error message thor bla aged thread main panicked at Failed to parse value Double check ParseBoolError priv libcoreresultrs note Run with RUSTBACKTRACE for a backtrace Would it be possible to instead print something like Error drunk needs to be true or false or something similar thunderclapdrunk bool Thor drinks a lot hammers Optionu This isnt a joke about being drunk hmmmm thunderclapdrunk bool Thor drinks a lot hammers Optionu This isnt a joke about being drunk makes me more happy It could enable more features and make the code base easier to work with and contribute to sob Actual functionality tbd