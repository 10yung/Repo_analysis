 Both return no results Needs fixing in tests GetWinADForestReplication WarningAction SilentlyContinue repadmin showrepl csv ConvertFromCsv To make it work on nonEnglish speaking windows server these URLs contain prioritized lists of MS recommended settings yes I know This control determines if Windows will accept source routed packets How to Validate To validate this go to the registery key HKLM System CurrentControlSet Services Tcpip Parameters and look for the value named DisableIPSourceRouting check for the modifiers ErrorNotOk get the description The recommended state for this setting is Highest protection source routing is completely disabled with the priority Critical Acceptable Values Remediation Steps Remediation The GPO for this setting is located under Computer Configuration Windows Settings Security Settings Local Policies Security Options MSS DisableIPSourceRouting IPv IP source routing protection level protects against packet spoofing For all profiles the recommended state for this setting is Highest protection source routing is completely disabled NOTE For MSS prefixed settings if they are not visible in the Group Policy Editor download the Microsoft Security Compliance Manager run LocalGPOmsi and then execute the following command to make them available cscriptexe LocalGPOwsf ConfigureSCE The expected value for the PDC is currently AllSync however I cannot find anyone making this recommendation All advice I have come across has been to set the PDC to NTP Microsofts documentation seems to indicate that time drift on guests running on hosts should no longer be an issue so it may not be necessary to disable it under those conditions Link Relevant Blurb In some scenarios involving guest domain controllers HyperV TimeSync samples can disrupt domain time synchronization This should no longer be an issue for Server guests running on Server HyperV hosts The test should skip if no trusts are detected Hello I think this is a great script Really thorough checking That being said I think it should be Nagios compatible or even fork it although sync issues might occur The script should be ran from a domain controller You can read the entire documentation here but the TLDR is that your last line should be WriteHost Whatever you want Nagios to display as text exit variableholdingexitcode for OK for WARNING for CRITICAL and for UNKNOWN variableholdingexitcode should be OK WARNING CRITICAL UNKNOWN OK is obviously that all checks have gone fine I think WARNING and CRITICAL should be defined by you andor the user You can for example decide that if there are six domain controllers and two cannot be reached it is a WARNING status but if it cannot reach four it should be a CRITICAL Not being able to resolve DNS against DCs should be a CRITICAL automatically with no WARNING state possible etc etc And the user should also be able to IncludeAsWarnings and pass a string array with checks he wants to be warnings if they fail or ExcludeAsWarnings with again a string array with check he wants to ignore if they fail Same with IncludeAsCritical and ExcludeAsCritical Also CompletelyInclude and CompletelyExclude UNKNOWN is mainly if the script fails for some reason out of your controlRunning it on a DC if it isnt supported should return a UNKNOWN for example I hope this gives you some ideas and Im sure plently more with input with even better ideas Thanks 