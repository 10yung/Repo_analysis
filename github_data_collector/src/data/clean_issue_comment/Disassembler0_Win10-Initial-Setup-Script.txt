Applied your latest script with settings below Spotlight stopped working does not refresh image on lockscreen anymore I cant figure out which of these settings might have affected it Any input will be much appreciated Version v RequireAdmin DisableTelemetry EnableTelemetry DisableWiFiSense EnableWiFiSense DisableSmartScreen EnableSmartScreen DisableWebSearch EnableWebSearch DisableAppSuggestions EnableAppSuggestions DisableActivityHistory EnableActivityHistory DisableBackgroundApps EnableBackgroundApps DisableSensors EnableSensors DisableLocation EnableLocation DisableMapUpdates EnableMapUpdates DisableFeedback EnableFeedback DisableTailoredExperiences EnableTailoredExperiences DisableAdvertisingID EnableAdvertisingID DisableWebLangList EnableWebLangList DisableCortana EnableCortana DisableBiometrics EnableBiometrics DisableCamera EnableCamera DisableMicrophone EnableMicrophone DisableErrorReporting EnableErrorReporting SetP PUpdateLocal SetP PUpdateInternet SetP PUpdateDisable DisableDiagTrack EnableDiagTrack DisableWAPPush EnableWAPPush EnableClearRecentFiles DisableClearRecentFiles DisableRecentFiles EnableRecentFiles SetUACLow SetUACHigh EnableSharingMappedDrives DisableSharingMappedDrives DisableAdminShares EnableAdminShares DisableFirewall EnableFirewall HideDefenderTrayIcon ShowDefenderTrayIcon DisableDefender EnableDefender DisableDefenderCloud EnableDefenderCloud EnableCtrldFolderAccess DisableCtrldFolderAccess EnableCIMemoryIntegrity DisableCIMemoryIntegrity EnableDefenderAppGuard DisableDefenderAppGuard HideAccountProtectionWarn ShowAccountProtectionWarn DisableDownloadBlocking EnableDownloadBlocking DisableScriptHost EnableScriptHost EnableDotNetStrongCrypto DisableDotNetStrongCrypto EnableMeltdownCompatFlag DisableMeltdownCompatFlag me mouse issues EnableF BootMenu EnableF BootMenu DisableF BootMenu DisableBootRecovery EnableBootRecovery DisableRecoveryAndReset EnableRecoveryAndReset SetDEPOptOut SetDEPOptIn SetCurrentNetworkPrivate SetCurrentNetworkPublic SetUnknownNetworksPrivate SetUnknownNetworksPublic DisableNetDevicesAutoInst EnableNetDevicesAutoInst DisableHomeGroups EnableHomeGroups DisableSMB EnableSMB DisableSMBServer EnableSMBServer DisableNetBIOS EnableNetBIOS DisableLLMNR EnableLLMNR DisableLLDP EnableLLDP DisableLLTD EnableLLTD DisableMSNetClient EnableMSNetClient DisableQoS EnableQoS DisableIPv EnableIPv DisableIPv EnableIPv DisableNCSIProbe EnableNCSIProbe DisableConnectionSharing EnableConnectionSharing DisableRemoteAssistance EnableRemoteAssistance EnableRemoteDesktop DisableRemoteDesktop DisableUpdateMSRT EnableUpdateMSRT DisableUpdateDriver EnableUpdateDriver EnableUpdateMSProducts DisableUpdateMSProducts DisableUpdateAutoDownload EnableUpdateAutoDownload DisableUpdateRestart EnableUpdateRestart DisableMaintenanceWakeUp EnableMaintenanceWakeUp DisableSharedExperiences EnableSharedExperiences EnableClipboardHistory DisableClipboardHistory DisableAutoplay EnableAutoplay DisableAutorun EnableAutorun DisableRestorePoints EnableRestorePoints EnableStorageSense DisableStorageSense DisableDefragmentation EnableDefragmentation DisableSuperfetch EnableSuperfetch DisableIndexing EnableIndexing DisableSwapFile EnableSwapFile DisableRecycleBin EnableRecycleBin EnableNTFSLongPaths DisableNTFSLongPaths DisableNTFSLastAccess EnableNTFSLastAccess SetBIOSTimeUTC SetBIOSTimeLocal EnableHibernation DisableHibernation DisableSleepButton EnableSleepButton DisableSleepTimeout EnableSleepTimeout DisableFastStartup EnableFastStartup DisableAutoRebootOnCrash EnableAutoRebootOnCrash UI Tweaks DisableActionCenter EnableActionCenter DisableLockScreen EnableLockScreen DisableLockScreenRS EnableLockScreenRS HideNetworkFromLockScreen ShowNetworkOnLockScreen HideShutdownFromLockScreen ShowShutdownOnLockScreen DisableLockScreenBlur EnableLockScreenBlur DisableAeroShake EnableAeroShake DisableAccessibilityKeys EnableAccessibilityKeys ShowTaskManagerDetails HideTaskManagerDetails ShowFileOperationsDetails HideFileOperationsDetails EnableFileDeleteConfirm DisableFileDeleteConfirm HideTaskbarSearch ShowTaskbarSearchIcon ShowTaskbarSearchBox HideTaskView ShowTaskView ShowSmallTaskbarIcons ShowLargeTaskbarIcons SetTaskbarCombineWhenFull SetTaskbarCombineNever SetTaskbarCombineAlways HideTaskbarPeopleIcon ShowTaskbarPeopleIcon ShowTrayIcons HideTrayIcons ShowSecondsInTaskbar HideSecondsFromTaskbar DisableSearchAppInStore EnableSearchAppInStore DisableNewAppPrompt EnableNewAppPrompt HideRecentlyAddedApps ShowRecentlyAddedApps HideMostUsedApps ShowMostUsedApps SetControlPanelSmallIcons SetControlPanelLargeIcons SetControlPanelCategories DisableShortcutInName EnableShortcutInName HideShortcutArrow ShowShortcutArrow SetVisualFXPerformance SetVisualFXAppearance EnableTitleBarColor DisableTitleBarColor EnableDarkTheme DisableDarkTheme AddENKeyboard RemoveENKeyboard EnableNumlock DisableNumlock DisableEnhPointerPrecision EnableEnhPointerPrecision SetSoundSchemeNone SetSoundSchemeDefault DisableStartupSound EnableStartupSound DisableChangingSoundScheme EnableChangingSoundScheme EnableVerboseStatus DisableVerboseStatus DisableF HelpKey EnableF HelpKey ShowExplorerTitleFullPath HideExplorerTitleFullPath ShowKnownExtensions HideKnownExtensions ShowHiddenFiles HideHiddenFiles ShowSuperHiddenFiles HideSuperHiddenFiles ShowEmptyDrives HideEmptyDrives ShowFolderMergeConflicts HideFolderMergeConflicts EnableNavPaneExpand DisableNavPaneExpand ShowNavPaneAllFolders HideNavPaneAllFolders EnableFldrSeparateProcess DisableFldrSeparateProcess EnableRestoreFldrWindows DisableRestoreFldrWindows ShowEncCompFilesColor HideEncCompFilesColor DisableSharingWizard EnableSharingWizard HideSelectCheckboxes ShowSelectCheckboxes HideSyncNotifications ShowSyncNotifications HideRecentShortcuts ShowRecentShortcuts SetExplorerThisPC SetExplorerQuickAccess HideQuickAccess ShowQuickAccess HideRecycleBinFromDesktop ShowRecycleBinOnDesktop ShowThisPCOnDesktop HideThisPCFromDesktop ShowUserFolderOnDesktop HideUserFolderFromDesktop ShowControlPanelOnDesktop HideControlPanelFromDesktop ShowNetworkOnDesktop HideNetworkFromDesktop ShowBuildNumberOnDesktop HideBuildNumberFromDesktop HideDesktopFromThisPC ShowDesktopInThisPC HideDesktopFromExplorer ShowDesktopInExplorer HideDocumentsFromThisPC ShowDocumentsInThisPC HideDocumentsFromExplorer ShowDocumentsInExplorer HideDownloadsFromThisPC ShowDownloadsInThisPC HideDownloadsFromExplorer ShowDownloadsInExplorer HideMusicFromThisPC ShowMusicInThisPC HideMusicFromExplorer ShowMusicInExplorer HidePicturesFromThisPC ShowPicturesInThisPC HidePicturesFromExplorer ShowPicturesInExplorer HideVideosFromThisPC ShowVideosInThisPC HideVideosFromExplorer ShowVideosInExplorer Hide DObjectsFromThisPC Show DObjectsInThisPC Hide DObjectsFromExplorer Show DObjectsInExplorer HideIncludeInLibraryMenu ShowIncludeInLibraryMenu HideGiveAccessToMenu ShowGiveAccessToMenu HideShareMenu ShowShareMenu DisableThumbnails EnableThumbnails DisableThumbnailCache EnableThumbnailCache DisableThumbsDBOnNetwork EnableThumbsDBOnNetwork DisableOneDrive EnableOneDrive UninstallOneDrive InstallOneDrive UninstallMsftBloat InstallMsftBloat UninstallThirdPartyBloat InstallThirdPartyBloat UninstallWindowsStore InstallWindowsStore DisableXboxFeatures EnableXboxFeatures DisableFullscreenOptims EnableFullscreenOptims DisableAdobeFlash EnableAdobeFlash DisableEdgePreload EnableEdgePreload DisableEdgeShortcutCreation EnableEdgeShortcutCreation DisableIEFirstRun EnableIEFirstRun DisableFirstLogonAnimation EnableFirstLogonAnimation DisableMediaSharing EnableMediaSharing UninstallMediaPlayer InstallMediaPlayer UninstallInternetExplorer InstallInternetExplorer UninstallWorkFolders InstallWorkFolders UninstallPowerShellV InstallPowerShellV InstallLinuxSubsystem UninstallLinuxSubsystem InstallHyperV UninstallHyperV InstallNET UninstallNET SetPhotoViewerAssociation UnsetPhotoViewerAssociation AddPhotoViewerOpenWith RemovePhotoViewerOpenWith UninstallPDFPrinter InstallPDFPrinter UninstallXPSPrinter InstallXPSPrinter RemoveFaxPrinter AddFaxPrinter UninstallFaxAndScan InstallFaxAndScan HideServerManagerOnLogin ShowServerManagerOnLogin DisableShutdownTracker EnableShutdownTracker DisablePasswordPolicy EnablePasswordPolicy DisableCtrlAltDelLogin EnableCtrlAltDelLogin DisableIEEnhancedSecurity EnableIEEnhancedSecurity EnableAudio DisableAudio UnpinStartMenuTiles UnpinTaskbarIcons Disable the following scheduled tasks responsible for scanning and uploading user data to Microsoft Office ClickToRun Service Monitor This task monitors the state of your Microsoft Office ClickToRunSvc and sends crash and error logs to Microsoft OfficeTelemetryAgentLogOn This task initiates Office Telemetry Agent which scans and uploads usage and error information for Office solutions when a user logs on to the computer OfficeTelemetryAgentFallBack This task initiates the background task for Office Telemetry Agent which scans and uploads usage and error information for Office solutions Signedoffby Tomasz Wilczy ski twilczynskinavercom Can be useful to add functions for to handle PhonePC linking These can be the functions ps function EnablePhonePcLinking WriteOutput Enabling Phone PC linking Enable MMX regKeyPath HKLM Software Policies Microsoft Windows System if TestPath Path regKeyPath NewItem Path regKeyPath Force OutNull SetItemProperty regKeyPath Name EnableMmx Type DWord Value Enable shared experience regKeyPath HKCU Software Microsoft Windows CurrentVersion CDP if TestPath Path regKeyPath NewItem Path regKeyPath Force OutNull SetItemProperty Path regKeyPath Name RomeSdkChannelUserAuthzPolicy Type DWord Value Enable Consumer features regKeyPath HKLM SOFTWARE Policies Microsoft Windows CloudContent if TestPath Path regKeyPath NewItem Path regKeyPath Force OutNull SetItemProperty regKeyPath Name DisableWindowsConsumerFeatures Type DWord Value function DisablePhonePcLinking WriteOutput Disabling Phone PC linking Disable MMX regKeyPath HKLM Software Policies Microsoft Windows System if TestPath Path regKeyPath NewItem Path regKeyPath Force OutNull SetItemProperty regKeyPath Name EnableMmx Type DWord Value Some doubts and open questions This feature requires enabling Consumer Features this feature is instead disabled by the function DisableAppSuggestions This can be a side effect This feature requires enabling Shared Experiences this feature can be instead explicitly disabled by the function DisableSharedExperiences Also this can be a side effect The proposed DisablePhonePcLinking function from the other hand disable only the one feature that allows the PhonePC linking this means that Consumer Features and Shared Experiences keep enabled also this can be a side effect These points cause an execution affected by the order of the calls the user must be aware of this and must decide how to act What do you think about it Disassembler Hi Ive tried to use the latest version of your script on a clean install of Windows Almost everything works but when I try to disable Windows Defender Cloud the following errors come up Here are the relevant errors Disabling Windows Defender SetItemProperty Attempted to perform an unauthorized operation At C Users anon Desktop Win InitialSetupScript Win psm char SetItemProperty Path HKLM SOFTWARE Policies Microsoft Windows CategoryInfo PermissionDenied DisableAntiSpywareString SetItemProperty UnauthorizedAccessException FullyQualifiedErrorId SystemUnauthorizedAccessExceptionMicrosoftPowerShellCommandsSetItemPropertyCommand Disabling Windows Defender Cloud SetItemProperty Attempted to perform an unauthorized operation At C Users anon Desktop Win InitialSetupScript Win psm char SetItemProperty Path HKLM SOFTWARE Policies Microsoft Windows CategoryInfo PermissionDenied SpynetReportingString SetItemProperty UnauthorizedAccessException FullyQualifiedErrorId SystemUnauthorizedAccessExceptionMicrosoftPowerShellCommandsSetItemPropertyCommand Hello all I think it would be handy to have this feature with this tool Im locally running a PiHole server to block ads and trafficking However every time a new computer is joined to the network manual adjustments required to be completed so all of the traffic goes through the local DNS server I think it should be a nice feature to have where by default it is disabled but whoever finds it helpful may enable it and set the DNS address through the presets file This could possibly look something like this IPv PreferredDNSserver IPv AlternateDNSserver IPv PreferredDNSserver a c c c b IPv AlternateDNSserver Here is a further read how to do such thing through power shell For quite some time I have an idea for PowerShellbased WindowsForms GUI which would help people to create their own presets The interface itself would be generated automatically based on the tweaks in supplied tweak libraries For this purpose every tweak would need some metadata such as group There were already some mentions in and possibly earlier With the classic approach where every tweak is selfcontained in a single function and for every function there is a counterpart which reverts the behavior the GUI could be constructed pretty easily If gets implemented it would be much harder The structure of parameters would have to be homogenous and predictable so the GUIbuilding logic could place appropriate blocks The GUIgenerator code doesnt have to be as simple as the tweaks so there may be even some introspection used and no metadata would be needed as we have most of the information somewhere anyway group function name parameter names allowed types or values etc The idea is that it would look as follows form Tabs are individual groups privacy security etc The checkboxes determine if the tweak is present in the preset First column is the tweak name Second columens are params Dropdowns are the respective values of params empty value means that the param is not given Not pictured Somewhere down aside from the tabview would be controls to loadsave the preset Another approach would be to create the GUI as webbased application completely outside of scope of this project This feature was often requested from the beginning etc so it might be worth to look into it The basic idea would be to have a parameter to switch between single user and multiuser application There are bunch of problems associated with that Some tweaks target registry keys which dont exist in default account registry hive and even if they are created they will be ignored deleted or rewritten on first login Multiuser application would require iterating over HKU subkeys where all the accounts are There may be accounts for third party services auxiliary accounts eg nvidia drivers have one domain accounts roaming profiles etc Its generally users problem when something goes awry but the script should be made safe enough not to cause total mayhem If a single registry modification is to be applied several places once for each user then there needs to be some logic which makes it that way and will work only for HKCU To make this work the registry hive can be spoofed by remapping the PSDrive root to keep the tweak code clean but there still needs to be some commonshared part which will do the looping Since the conception of the script the tweaks were divided into main categories privacy services UI and applications Later security was split from privacy and services and Explorer UI tweaks were split from the rest of UI Nowadays we have much more tweaks than in the beginning and this categorization is not sufficient anymore Once the tweaks are grouped there will be less of them but there still may be need to redo the structure to make the navigation and relations between the tweaks clear Eg to split Libraries icons on Desktop and in This PC from the Explorer UI tweaks split Defender tweaks from the rest of security put networking to a separate group etc The idea Currently the tweaks are as individual unparametrized idempotent functions This was generally OK in the beginning of the project as all the tweaks were just enabledisable Then we got things like or where there were more than two possibilities how to customize one particular control or item Eg in case of HideTaskbarSearch ShowTaskbarSearchIcon ShowTaskbarSearchBox we could have something like TaskbarSearch Hide TaskbarSearch Icon TaskbarSearch Box or more PowerShelly TaskbarSearch Type Hide TaskbarSearch Type Icon TaskbarSearch Type Box Furthermore we have tweaks like HideDesktopFromThisPC ShowDesktopInThisPC HideDocumentsFromThisPC ShowDocumentsInThisPC HideDownloadsFromThisPC ShowDownloadsInThisPC HideMusicFromThisPC ShowMusicInThisPC HidePicturesFromThisPC ShowPicturesInThisPC HideVideosFromThisPC ShowVideosInThisPC Hide DObjectsFromThisPC Show DObjectsInThisPC which could also benefit from grouping and parametrization so wed have something like HideFromThisPC Desktop Documents ShowInThisPC Downloads Music or ThisPCLibraries HideDesktop HideDocuments ShowDownloads ShowMusic or ThisPCLibraries Desktop Hide Documents Hide Downloads Show Music Show or ThisPCLibraries Hide Desktop Documents Show Downloads Music This has been also proposed by r incarnat r in and possibly by others elsewhere for bloatware removal functions where this would enable use of AllUsers and exclusion lists Lastly proposals like couldnt be even done by any other way as the complexity and repetition needed for such a tweak if it would be done in the classical way would be way too large Upsides Much lower number of individual tweak functions as the tweaks would be grouped thematically Better possibilities for customization Hopefully more comprehensive tweaking as the user would see what options can one particular tweak have and wouldnt need to look up another tweaks just to get the overview Also tabcompletion would work in case of interactive scripting Downsides Absolutely all tweaks need to be renamed and rewritten Basically the project would restart from scratch and it may be extremely confusing for occasional and non techsavvy users Parametrization makes the tweaks more difficult to use as the user needs to know appropriate PowerShell syntax for appropriate data types It would be less obvious to determine what was the default value before modification and what would be the appropriate parameter to pass in order to restore the defaults For this Wiki proposed in would help One of the core rules of the project would be broken as the tweak function body couldnt be simply copypasted and run without any context anymore Though this might be downside only for me Most importantly the tweaks couldnt be passed directly from command line anymore as it would be no longer possible to properly parse all the options not to mention correctly pass them to elevated command in case of RequireAdmin Only preset files could be used These functions deprovision apps which prevents them from being installed automatically for new user accounts Commented out apps are provisioned but should probably be left untouched They are also not removed in UninstallMsftBloat by default but I wanted them to be included for reference and easy enabling in case someone wants to remove them