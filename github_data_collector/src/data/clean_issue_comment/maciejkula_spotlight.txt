I am trying to predict the implicit sequential model data useIDdocidtimestamp from sklearn import preprocessing leusr preprocessingLabelEncoder user encoder leitm preprocessingLabelEncoder item encoder shift itemids with but not userids itemids leitmfittransformdata docid astypeint userids leusrfittransformdata userID astypeint from spotlightinteractions import Interactions implicitinteractions Interactionsuserids itemids timestampsdatatimestamp from spotlightcrossvalidation import userbasedtraintestsplit randomtraintestsplit train test userbasedtraintestsplitimplicitinteractions Now I use the following code to train from spotlightsequenceimplicit import ImplicitSequenceModel sequentialinteraction traintosequence implicitsequencemodel ImplicitSequenceModelusecudaFalse niter lossbpr representationpooling implicitsequencemodelfitsequentialinteraction verboseTrue But after this lets say i want to predict for userids one hot encoded at the top I dont know how to use the predict function As per my understanding predict function should take the input of sequence for that user but how to find out that sequence for that user sequentialinteraction when used with sequences doesnt give me which row belongs to which user Can you please provide an example to use predict on this data Any example using implicit sequence model would be helpful Thanks My questions might seem dumb but I was trying to understand the project As seen in the documentation various parameters go into the model I was thinking if there is an easy way to do Hyperparameter tuning in spotlight I am wondering if Spotlight includes the iMF model proposed in Collaborative Filtering for Implicit Feedback Datasets by Yifan Hu not BPR LSTM based sequential model seems to fit data really well on first epoch but validation accuracy doesnt improve after first epoch and even loss halts improving after second epoch I tried different optimizer paramters like lr l etc but it doesnt improve beyond certain point maciejkula Any idea how can improve that Can I know why you use the last k as the target and k as the sequences When in sequence recommendation case isnt it is better to use only the last element in the sequence as the target CMIIW Tensorboard is now supported by PyTorch Does spotlight support it or will do so in the future And what is a suggested way of monitoring model training training and validation lossmetrics at step n when using spotlight models Thank you very much Im trying to download spotlight on my Mac with Python and Im getting this error bash conda install c maciejkula c pytorch spotlight Collecting package metadata currentrepodatajson done Solving environment failed with currentrepodatajson will retry with next repodata source Initial quick solve with frozen env failed Unfreezing env and trying again Solving environment failed with currentrepodatajson will retry with next repodata source Collecting package metadata repodatajson done Solving environment failed Initial quick solve with frozen env failed Unfreezing env and trying again Solving environment failed UnsatisfiableError The following specifications were found to be incompatible with the existing python installation in your environment spotlight python version a a a If python is on the leftmost side of the chain thats the version youve asked for When python appears to the right that indicates that the thing on the left is somehow not available for the python version you are constrained to Your current python version is python Note that conda will not change your python version to a different minor version unless you explicitly specify that The following specifications were found to be incompatible with each other Package wheel conflicts for spotlight scikitlearn scipy numpy version a a a mklrandom numpybase version a python version a a a pip wheel python pip wheel Package certifi conflicts for python pip wheel setuptools certifi version spotlight scikitlearn scipy numpy version a a a mklrandom numpybase version a python version a a a pip wheel setuptools certifi version Package pip conflicts for spotlight scikitlearn scipy numpy version a a a mklrandom numpybase version a python version a a a pip python pip Package setuptools conflicts for spotlight scikitlearn scipy numpy version a a a mklrandom numpybase version a python version a a a pip wheel setuptools python pip wheel setuptools Hello I just notice that you start count id from which lead to one more dimension abuse in both user and item For example the number of user and item in Movielens M is and Actually your final processed dataset including Scipy matrix is in shape This might be a tiny problem Hello I was wondering if you have any plan to refactor the code and make it more look like a framework like fastai ignite etc Right now we have to implement the training loop for each new model and this is not efficient If we could use callbacks it would be more easy to use more complicated training approacheslike anneal learning rate and at the same time use something like TensorFX and even logging without headache Hi Im trying to train an implicit sequential model on click stream data but as soon as I try to evaluate eg using MRR or Precision Recall after having trained the model it throws an error mrr spotlightevaluationmrrscoreimplicitsequencemodel test train ValueErrorTraceback most recent call last ipythoninput a e b in module mrr spotlightevaluationmrrscoreimplicitsequencemodel test train locallibpython sitepackagesspotlightevaluationpy in mrrscoremodel test train continue predictions modelpredictuserid if train is not None locallibpython sitepackagesspotlightsequenceimplicitpy in predictself sequences itemids selfcheckinputitemids selfcheckinputsequences sequences torchfromnumpysequencesastypenpint reshape locallibpython sitepackagesspotlightsequenceimplicitpy in checkinputself itemids if itemidmax selfnumitems raise ValueErrorMaximum item id greater than number of items in model ValueError Maximum item id greater than number of items in model Perhaps the error is obvious but I cant pinpoint what Im doing wrong so below Ill describe as concisely as possible what Im doing Comparison of experimental with synthetic data I tried generating synthetic data and use that instead of my experimental data and then it works This lead me to compare the data structure of the synthetic data with my experimental table border cellspacing cellpadding rulesgroups framehsides caption classtabovespan classtablenumberTable span Synthetic data with N unique users M k unique items and Q k interactionscaption colgroup col classorgleft col classorgleft col classorgleft colgroup thead tr th scopecol classorgleftuseridth th scopecol classorgleftitemidth th scopecol classorglefttimestampth tr thead tbody tr td classorgleft td td classorgleft td td classorgleft td tr tr td classorgleft td td classorgleft td td classorgleft td tr tr td classorgleft td td classorgleft td td classorgleft td tr tr td classorgleft td td classorgleft td td classorgleft td tr tr td classorgleft td td classorglefttd td classorgleft td tr tr td classorgleft td td classorglefttd td classorgleft td tr tr td classorglefttd td classorglefttd td classorglefttd tr tr td classorglefttd td classorglefttd td classorglefttd tr tr td classorglefttd td classorglefttd td classorglefttd tr tr td classorglefttd td classorglefttd td classorglefttd tr tr td classorgleftNtd td classorglefttd td classorgleftQ td tr tr td classorgleftNtd td classorglefttd td classorgleftQ td tr tr td classorgleftNtd td classorgleft td td classorgleftQtd tr tbody table table border cellspacing cellpadding rulesgroups framehsides caption classtabovespan classtablenumberTable span Experimental data N M users M k items Q M interactionscaption colgroup col classorgright col classorgright col classorgright colgroup thead tr th scopecol classorgrightuseridth th scopecol classorgrightitemidth th scopecol classorgrighttimestampth tr thead tbody tr td classorgright td td classorgright td td classorgright td tr tr td classorgright td td classorgright td td classorgright td tr tr td classorgright td td classorgright td td classorgright td tr tr td classorgright td td classorgright td td classorgright td tr tr td classorgright td td classorgright td td classorgright td tr tr td classorgright td td classorgright td td classorgright td tr tr td classorgright td td classorgright td td classorgright td tr tr td classorgright td td classorgright td td classorgrighttd tr tr td classorgright td td classorgright td td classorgrighttd tr tr td classorgright td td classorgright td td classorgrighttd tr tr td classorgrighttd td classorgrighttd td classorgrighttd tr tr td classorgrighttd td classorgrighttd td classorgrightQ td tr tr td classorgrighttd td classorgrighttd td classorgrightQtd tr tbody table Both data sets have users indexed from N but my experimental is not sorted on userids as is the case for the synthetic data Both data sets have itemids indexed from M yet it only throws the ValueError Maximum item id greater than number of items in model for my experimental data Ive reshaped my timestamps to be just the data frame index after sorting on time so this is also as in the synthetic data set Previously my timestamps were in seconds since of the event and some events were simultaneous ie order arbitrarydegenerate state Code for processing the experimental data python pandas dataframe with unique string identifier for users sessionid and Article number for itemid and timestamp for event df dfsortvaluesby timestamp resetindexdropTrue encode string identifiers for users and items to integer values from sklearn import preprocessing leusr preprocessingLabelEncoder user encoder leitm preprocessingLabelEncoder item encoder shift itemids with but not userids itemids leitmfittransformdf Article number astypeint userids leusrfittransformdf sessionid astypeint from spotlightinteractions import Interactions implicitinteractions Interactionsuserids itemids timestampsdfindexvalues from spotlightcrossvalidation import userbasedtraintestsplit randomtraintestsplit train test randomtraintestsplitimplicitinteractions Code for training the model python from spotlightsequenceimplicit import ImplicitSequenceModel sequentialinteraction traintosequence implicitsequencemodel ImplicitSequenceModelusecudaTrue niter losspointwise representationpooling implicitsequencemodelfitsequentialinteraction verboseTrue import spotlightevaluation mrr spotlightevaluationmrrscoreimplicitsequencemodel test train Questions on input format Here are some questions I thought might pinpoint the error in where my data might differ from the synthetic data set Is there any purpose or even harm to include users with only a single interaction Does the model allow a user have multiple events with the same timestampvalue As long as useriditemidtimestamp triplets pair up does rowordering matter 