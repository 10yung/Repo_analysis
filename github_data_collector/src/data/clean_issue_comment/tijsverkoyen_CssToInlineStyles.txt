ref css media queries were filtered out which makes sense as theyre not supported as inline style now that more and more clients support style tags in the head it makes sense to include them there when the source css contains them MailChimp merge tags use and to open and close the tags When an HTML email is run through the inliner these come back as CUNSUB C has an example of MailChimp merge tags but I highly doubt they actually work Hello guys For any of you trying to parse site with CSS large enough MB and not getting any results make sure you set inisetpcrebacktracklimit to higher value than mil I was parsing MB CSS and spent whole day debugging till found this is default config limiting pregreplace function Just letting you know Peace Any fontfamily name that needs to be quoted because of being more than one word long gets removed and simply replaced with a quote Added an empty check in the convert function If an empty HTML is given an Uncaught TypeError will be throw at documentremoveChildhtmlElement because htmlElement is null instead of a DOMNode instance We have JSONLD script tags in our emails and they get a style attribute added to them which doesnt make sense html script typeapplicationldjson stylefontfamily Avenir Helvetica sansserif boxsizing borderbox context type EmailMessage potentialAction type ConfirmAction name Approve Expense handler type HttpActionHandler url description Approval request for John u s expense for office supplies script body html i was trying to use this awesome class but i cant event start ive been trying installing via composer and thru direct requiring none of them are working it displays this error Parse error syntax error unexpected class TCLASS expecting identifier TSTRING or variable TVARIABLE or or in wwwdatasystemolandainvoicesmailchimphtmltomailCssToInlineStylesphp on line my file is just like this requirevendorautoloadphp requiresrcCssToInlineStylesphp CssToInlineStylesnew CssToInlineStyles In my case of use I have to set eg textdecoration property twice to make it correct in all target supported mail clients It means my links have textdecoration none textdecoration none important Inliner gets logically only last value it means link in inlineCssOnElement function has inlineProperties textdecoration none important It isnt problem to edit function to keep original styles and only add not included foreach arraymergecssProperties inlineProperties as property rules propertytoString elementsetAttributestyle elementgetAttributestyleimplode rules but which way is optimal for keeping both properties from style tag Generally I need to add important or nonimportant version of property if miss in inline Has anyone idea Thanks in advance My site uses the PureCSS framework I use php to include this library inside a style block of my html email At CssToInlineStylesphp css pregreplacemedia css its returning css null and stripping out everything including nonmedia queries Ive stripped down the CSS to just this and it is still failing style typetextcss mediascreen media only screen and maxwidth px pureform inputnot type pureform input typetext pureform input typepassword pureform input typeemail pureform input typeurl pureform input typedate pureform input typemonth pureform input typetime pureform input typedatetime pureform input typedatetimelocal pureform input typeweek pureform input typenumber pureform input typesearch pureform input typetel pureform input typecolor pureform label anything puregroup inputnot type puregroup input typetext puregroup input typepassword puregroup input typeemail puregroup input typeurl puregroup input typedate puregroup input typemonth puregroup input typetime puregroup input typedatetime puregroup input typedatetimelocal puregroup input typeweek puregroup input typenumber puregroup input typesearch puregroup input typetel puregroup input typecolor anything pureform purehelpinline pureformmessageinline pureformmessage anything emailbody padding em maxwidth px margin auto emailtable margin auto fontfamily Lato Helvetica sansserif textalign left logo width px style but if you remove one random selector from the media query block ie pureform purehelpinline from that it works again and the emailbody and below are being used If it is asis above it remove all styles and emailbody isnt inlined Is there something wrong with the RegExp stripping out the media queries 