Greetings sentencepiece developers and contributors We re reaching out because your project is an important part of the open source ecosystem and we d like to invite you to integrate with our fuzzing service OSSFuzz OSSFuzz is a free fuzzing infrastructure you can use to identify security vulnerabilities and stability bugs in your project OSSFuzz will Continuously run at scale all the fuzzers you write Alert you when it finds issues Automatically close issues after they ve been fixed by a commit Many widely used open source projects like OpenSSL FFmpeg LibreOffice and ImageMagick are fuzzing via OSSFuzz which helps them find and remediate critical issues Even though typical integrations can be done in LoC we have a reward program in place which aims to recognize folks who are not just contributing to open source but are also working hard to make it more secure We want to stress that anyone who meets the eligibility criteria and integrates a project with OSSFuzz is eligible for a reward If youre not interested in integrating with OSSFuzz it would be helpful for us to understand why lack of interest lack of time or something else so we can better support projects like yours in the future If we ve missed your question in our FAQ feel free to reply or reach out to us at ossfuzzoutreachgooglegroupscom Thanks Tommy OSSFuzz Team Sentencepiece is available as a port in vcpkg a C library manager that simplifies installation for sentencepiece and other project dependencies Documenting the install process here will help users get started by providing a single set of commands to build sentencepiece ready to be included in their projects We also test whether our library ports build in various configurations dynamic static on various platforms OSX Linux Windows x x UWP ARM to keep a wide coverage for users Im a maintainer for vcpkg and here is what the port script looks like We try to keep the library maintained as close as possible to the original library The sentence piece provides four algorithm for training the tokenizer BPE char unigram and word Among these all are performing well however the BLEU score while testing on word based tokenization giving very bad result on test data This is also the same case with huggingface BertWordPiece tokenizer I have tested it on Bodo text which is written in Devanagiri script I hope this problem will be there in Hindi Marathi or other Indian languages using Devanagiri scripts I have uploaded the tokenizer model file in my page if you need to verify Hi I want specify the delimiter for splitting the sentence at starting of BPE training rather than utf character sequence Ex c c c c c c c c c c c c In this case delimiter is The pairs are like c c c c and so on Is there any option to specify the delimiter while training Please help me After seeing this issue closed From a fresh venv pip install tensorflow pip install tfsentencepiece venv python Python v c b a Dec GCC Compatible Apple LLVM clang on darwin Type help copyright credits or license for more information import tensorflow as tf tfversion import tfsentencepiece Traceback most recent call last File stdin line in module File Usersryanwheelerrepostomovenvlibpython sitepackagestfsentencepieceinitpy line in module from tfsentencepiecesentencepieceprocessorops import File Usersryanwheelerrepostomovenvlibpython sitepackagestfsentencepiecesentencepieceprocessoropspy line in module gensentencepieceprocessorop tfloadoplibrarysofile File Usersryanwheelerrepostomovenvlibpython sitepackagestensorflowcorepythonframeworkloadlibrarypy line in loadoplibrary libhandle pytfTFLoadLibrarylibraryfilename tensorflowpythonframeworkerrorsimplNotFoundError dlopenUsersryanwheelerrepostomovenvlibpython sitepackagestfsentencepiecesentencepieceprocessoropsso no suitable image found Did find Usersryanwheelerrepostomovenvlibpython sitepackagestfsentencepiecesentencepieceprocessoropsso unknown file type first eight bytes x F x x C x x x x x Usersryanwheelerrepostomovenvlibpython sitepackagestfsentencepiecesentencepieceprocessoropsso unknown file type first eight bytes x F x x C x x x x x Hi I would like to upload the R wrapper around sentencepiece to CRAN CRAN is pretty strict on compilation issues Would it be possible to fix the following issues which occur when checking on Debian Solaris ASANUBSAN On Debian Linux GCC no long double Im getting Found the following significant warnings sentencepiecesrcfreelisth warning void memsetvoid int sizet clearing an object of nontrivial type struct sentencepieceunigramLatticeNode use assignment or valueinitialization instead Wclassmemaccess sentencepiecesrcfreelisth warning void memsetvoid int sizet clearing an object of nontrivial type struct sentencepieceunigramLatticeNode use assignment or valueinitialization instead Wclassmemaccess On Oracle Solaris compilation fails with the following error Running R CMD build checking for file exporthomeXUABCjrRtempRtmpnMayqWremotes f sentencepieceDESCRIPTION OK preparing sentencepiece checking DESCRIPTION metainformation OK cleaning src checking for LF lineendings in source and make files and shell scripts checking for empty or unneeded directories building sentencepiece targz Installing package into exporthomeXUABCjrR as lib is unspecified installing source package sentencepiece using staged installation libs optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitearenacc o thirdpartyprotobuflitearenao optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitearenastringcc o thirdpartyprotobuflitearenastringo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitebytestreamcc o thirdpartyprotobuflitebytestreamo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitecodedstreamcc o thirdpartyprotobuflitecodedstreamo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitecommoncc o thirdpartyprotobuflitecommono optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobufliteextensionsetcc o thirdpartyprotobufliteextensionseto optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitegeneratedmessagetabledrivenlitecc o thirdpartyprotobuflitegeneratedmessagetabledrivenliteo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitegeneratedmessageutilcc o thirdpartyprotobuflitegeneratedmessageutilo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobufliteimplicitweakmessagecc o thirdpartyprotobufliteimplicitweakmessageo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobufliteint cc o thirdpartyprotobufliteint o optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobufliteiowin cc o thirdpartyprotobufliteiowin o optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitemessagelitecc o thirdpartyprotobuflitemessageliteo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobufliterepeatedfieldcc o thirdpartyprotobufliterepeatedfieldo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitestatuscc o thirdpartyprotobuflitestatuso optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitestatusorcc o thirdpartyprotobuflitestatusoro optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitestringpiececc o thirdpartyprotobuflitestringpieceo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitestringprintfcc o thirdpartyprotobuflitestringprintfo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitestructurallyvalidcc o thirdpartyprotobuflitestructurallyvalido optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitestrutilcc o thirdpartyprotobuflitestrutilo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitetimecc o thirdpartyprotobuflitetimeo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitewireformatlitecc o thirdpartyprotobuflitewireformatliteo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitezerocopystreamcc o thirdpartyprotobuflitezerocopystreamo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyprotobuflitezerocopystreamimpllitecc o thirdpartyprotobuflitezerocopystreamimplliteo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c thirdpartyabslstringsstringviewcc o thirdpartyabslstringsstringviewo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c sentencepiecesrcbuiltinpbsentencepiecepbcc o sentencepiecesrcbuiltinpbsentencepiecepbo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c sentencepiecesrcbuiltinpbsentencepiecemodelpbcc o sentencepiecesrcbuiltinpbsentencepiecemodelpbo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c sentencepiecesrcbpemodelcc o sentencepiecesrcbpemodelo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c sentencepiecesrcbpemodeltrainercc o sentencepiecesrcbpemodeltrainero optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c sentencepiecesrcbuildercc o sentencepiecesrcbuildero optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c sentencepiecesrccharmodelcc o sentencepiecesrccharmodelo optcswbing stdgnu IoptRR libRinclude DNDEBUG D HAVEPTHREAD Wnopedantic Wnomisleadingindentation Wnosigncompare pthread DSTRICTRHEADERS I Isentencepiece Isentencepiecesrc Isentencepiecesrcbuiltinpb Ithirdpartyabsl Ithirdpartydartsclone Ithirdpartyesaxx Ithirdpartyprotobuflite IexporthomeXUABCjrRRcppinclude Ioptcdwinclude Iusrlocalinclude fPIC O c sentencepiecesrccharmodeltrainercc o sentencepiecesrccharmodeltrainero sentencepiecesrccharmodeltrainercc In member function virtual sentencepieceutilStatus sentencepiececharacterTrainerTrain sentencepiecesrccharmodeltrainercc error call of overloaded loguint is ambiguous const float logsum logsum In file included from optcswlibgcci pcsolaris includefixedmathh from optcswincludec cmath from optcswincludec random from sentencepiecesrcutilh from sentencepiecesrctrainerinterfaceh from sentencepiecesrccharmodeltrainerh from sentencepiecesrccharmodeltrainercc optcswlibgcci pcsolaris includefixedisomathisoh note candidate long double stdloglong double inline long double loglong double X return loglX optcswlibgcci pcsolaris includefixedisomathisoh note candidate float stdlogfloat inline float logfloat X return logfX optcswlibgcci pcsolaris includefixedisomathisoh note candidate double stdlogdouble extern double log Pdouble sentencepiecesrccharmodeltrainercc error call of overloaded logconst long long int is ambiguous logitsecond logsum In file included from optcswlibgcci pcsolaris includefixedmathh from optcswincludec cmath from optcswincludec random from sentencepiecesrcutilh from sentencepiecesrctrainerinterfaceh from sentencepiecesrccharmodeltrainerh from sentencepiecesrccharmodeltrainercc optcswlibgcci pcsolaris includefixedisomathisoh note candidate long double stdloglong double inline long double loglong double X return loglX optcswlibgcci pcsolaris includefixedisomathisoh note candidate float stdlogfloat inline float logfloat X return logfX optcswlibgcci pcsolaris includefixedisomathisoh note candidate double stdlogdouble extern double log Pdouble At global scope cc plus warning unrecognized command line option Wnomisleadingindentation gmake optRR libRetcMakeconf sentencepiecesrccharmodeltrainero Error On Debian Linux GCC with Address Sanitizers ASANUBSAN Im getting address sanitizer failures in protobuflite See below sentencepiecetrainercc LOGINFO Running command inputtraindatatxt modelprefixsentencepiece vocabsize charactercoverage modeltypechar sentencepiecetrainercc LOGINFO Starts training with TrainerSpec input traindatatxt inputformat modelprefix sentencepiece modeltype CHAR vocabsize selftestsamplesize charactercoverage inputsentencesize shuffleinputsentence seedsentencepiecesize shrinkingfactor maxsentencelength numthreads numsubiterations maxsentencepiecelength splitbyunicodescript splitbynumber splitbywhitespace treatwhitespaceassuffix hardvocablimit useallvocab unkid bosid eosid padid unkpiece unk bospiece s eospiece s padpiece pad unksurface NormalizerSpec name nmtnfkc adddummyprefix removeextrawhitespaces escapewhitespaces normalizationruletsv trainerinterfacecc LOGINFO Loading corpus traindatatxt trainerinterfacecc LOGWARNING Found too long line trainerinterfacecc LOGWARNING Too long lines are skipped in the training trainerinterfacecc LOGWARNING The maximum length can be changed with maxsentencelengthsize flag trainerinterfacecc LOGINFO Loaded all sentences trainerinterfacecc LOGINFO Skipped too long sentences trainerinterfacecc LOGINFO Adding metapiece unk trainerinterfacecc LOGINFO Adding metapiece s trainerinterfacecc LOGINFO Adding metapiece s trainerinterfacecc LOGINFO Normalizing sentences trainerinterfacecc LOGINFO all chars count trainerinterfacecc LOGINFO Done characters are covered trainerinterfacecc LOGINFO Alphabet size trainerinterfacecc LOGINFO Final character coverage trainerinterfacecc LOGINFO Done preprocessed sentences trainerinterfacecc LOGINFO Saving model sentencepiecemodel thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobufliterepeatedfieldcc runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void trainerinterfacecc LOGINFO Saving vocabs sentencepiecevocab thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void sentencepiecetrainercc LOGINFO Running command inputtraindatatxt modelprefixsentencepiece vocabsize charactercoverage modeltypebpe sentencepiecetrainercc LOGINFO Starts training with TrainerSpec input traindatatxt inputformat modelprefix sentencepiece modeltype BPE vocabsize selftestsamplesize charactercoverage inputsentencesize shuffleinputsentence seedsentencepiecesize shrinkingfactor maxsentencelength numthreads numsubiterations maxsentencepiecelength splitbyunicodescript splitbynumber splitbywhitespace treatwhitespaceassuffix hardvocablimit useallvocab unkid bosid eosid padid unkpiece unk bospiece s eospiece s padpiece pad unksurface NormalizerSpec name nmtnfkc adddummyprefix removeextrawhitespaces escapewhitespaces normalizationruletsv trainerinterfacecc LOGINFO Loading corpus traindatatxt trainerinterfacecc LOGWARNING Found too long line trainerinterfacecc LOGWARNING Too long lines are skipped in the training trainerinterfacecc LOGWARNING The maximum length can be changed with maxsentencelengthsize flag trainerinterfacecc LOGINFO Loaded all sentences trainerinterfacecc LOGINFO Skipped too long sentences trainerinterfacecc LOGINFO Adding metapiece unk trainerinterfacecc LOGINFO Adding metapiece s trainerinterfacecc LOGINFO Adding metapiece s trainerinterfacecc LOGINFO Normalizing sentences trainerinterfacecc LOGINFO all chars count trainerinterfacecc LOGINFO Done characters are covered trainerinterfacecc LOGINFO Alphabet size trainerinterfacecc LOGINFO Final character coverage thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void thirdpartyprotobuflitegoogleprotobufrepeatedfieldh runtime error index out of bounds for type void Next it would be nice if we dont need to compile with Wnopedantic Wnomisleadingindentation Wnosigncompare as that makes the compiler pretty noisy Could such warnings also be removed thank you Hi guys Im wondering if this is a bug or if a workaround exists Im using sentencepiece in tf and I only come across a segfault when using sentencepiece with tfdataDatasets For my environment I am using a docker image tensorflowtensorflow py and using the wheel built on ie tfsentencepiece py py nonemanylinux x whl So this works python import tensorflow as tf import tfsentencepiece as tfs sentencepiecemodelfile any sentencepiece model printtfsencode hello modelprotoopensentencepiecemodelfilerbread But this doesnt python import tensorflow as tf import tfsentencepiece as tfs sentencepiecemodelfile any sentencepiece model dataset tfdataDatasetfromtensorslices hello world dataset datasetmaplambda line tfsencode line modelprotoopensentencepiecemodelfilerbread ERRORS HERE Segmentation fault core dumped for item in dataset printitem Thanks Thanks for your excellent work One thing I would like to check with you is that the model computing time difference between sentencepiece vs normal tokenization method such as Keras tokenizer Using a traditional tokenization method the training time takes maybe minutes Using BPE it does not take long to train the text corpus from scratch However the modeling time takes appr hours for one epoch Did I do anything wrong when combining BPE seq seq model Any comments Thank you in advance You can view my code from the following links or Im running a sentencepiece model and getting an stdbadalloc error when I increase the training size from M to M sentences it works fine for M sentences Heres how Im calling the function bash spmtrain inputinputtxt vocabsize charactercoverage modeltypeunigram inputsentencesize numthreads heres the specific error trainerinterfacecc LOGINFO Sampled sentences from sentences trainerinterfacecc LOGINFO Skipped too long sentences trainerinterfacecc LOGINFO Adding metapiece unk trainerinterfacecc LOGINFO Adding metapiece s trainerinterfacecc LOGINFO Adding metapiece s trainerinterfacecc LOGINFO Normalizing sentences trainerinterfacecc LOGINFO all chars count trainerinterfacecc LOGINFO Done characters are covered trainerinterfacecc LOGINFO Alphabet size trainerinterfacecc LOGINFO Final character coverage trainerinterfacecc LOGINFO Done preprocessed sentences terminate called after throwing an instance of stdbadalloc what stdbadalloc Ive tried compiling SentencePiece with and without gperftools and get the same error message Compiled with gcc GCC Red Hat in case that matters Edit also tried a more recent gcc with the same results I doubt that its a RAM limitation Im running this on a pretty beefy compute node with GB of memory and watching memory utilization as the program is running even at M input sentences I never get close to maxing out Any thoughts why I might be getting this error message