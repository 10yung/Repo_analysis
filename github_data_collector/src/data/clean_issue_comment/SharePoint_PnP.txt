 Category X Bug Enhancement Environment X Office SharePoint Online SharePoint SharePoint Bug in CoreProfilePictureUploader it does not seem to support government tenants If I specify full qualified tenant name in the configurationxml eg mygovtenantsharepointus it appends adminsharepointcom to the url resulting in the following error Initializing SPO web service Error initiating connection to profile web service in SPO Value cannot be null Parameter name cookieHeader Processing finished for user profiles or so If I just specify the root name in the configurationxml eg mygovtenant the behaves similarly Initializing SPO web service Error initiating connection to profile web service in SPO Value cannot be null Parameter name cookieHeader Processing finished for user profiles or so Thank you for reporting an issue or suggesting an enhancement We appreciate your feedback to help the team to understand your needs please complete the below template to ensure we have the necessary details to assist you If you have a actual question we would ask you to use SharePoint Developer Group at Microsoft Tech Community Thanks Which PnP repository should you use to report the issue Please navigate to the appropriate repository by clicking on the link below and create your issue there You can delete this section after you have navigated to the correct repository PnP Samples PnP Sites Core PnP JS Core PnP PowerShell Category Bug Enhancement Environment Office SharePoint Online SharePoint SharePoint If SharePoint onpremises whats exact CU version Expected or Desired Behavior If you are reporting a bug please describe the expected behavior If you are suggesting an enhancement please describe thoroughly the enhancement how it can be achieved and expected benefit Observed Behavior If you are reporting a bug please describe the behavior you expected to occur when performing the action If you are making a suggestion you can delete this section Steps to Reproduce If you are reporting a bug please describe the steps to reproduce the bug in sufficient detail to allow testing Only way to fix things properly is to have sufficient details to reproduce it If you are making a suggestion you can delete this section Submission Guidelines Delete this section after reading All suggestions or bugs are welcome please let us know whats on your mind If you are reporting any issues around PnP Core Component please reproduce the issue with latest release If you are reporting issue around PnP Provisioning Engine please share the xml template if possible If you are reporting an issue around any of the samples please ensure that you have clear reference on the sample and possibly code file which should be fixed If you have a general question please use the SharePoint Developer Group at Microsoft Tech Community Remember to include sufficient details and context If you have multiple suggestions or bugs please submit them in seperate bugs so we can track resolution Thanks for your contribution Sharing is caring Thank you for reporting an issue or suggesting an enhancement We appreciate your feedback to help the team to understand your needs please complete the below template to ensure we have the necessary details to assist you If you have a actual question we would ask you to use SharePoint Developer Group at Microsoft Tech Community Thanks Which PnP repository should you use to report the issue Please navigate to the appropriate repository by clicking on the link below and create your issue there You can delete this section after you have navigated to the correct repository PnP Samples PnP Sites Core PnP JS Core PnP PowerShell Category x Bug Enhancement Environment x Office SharePoint Online SharePoint SharePoint If SharePoint onpremises whats exact CU version Expected or Desired Behavior Converting classic pages to modern Observed Behavior I convert all my classic publishing pages in a library to modern and export them to an external library It works for some pages and fails with other pages with the error Parameter ServerRelativeFileName was used but is not listed as a web part property that can be used Steps to Reproduce I use the following script foreachpage in pages WriteHost Modernizing pageFieldValues FileLeafRef modernPage ConvertToPnPClientSidePage Identity page PublishingPage Overwrite TargetWebUrl WriteHost Done ForegroundColor Green I also have tried to extract the CustomPageLayout and the WebPartMapping XML and use it when converting the page without any success UPDATE I noticed that all the pages that did not work had a attached dokument that points to a location using RELATIVE PATH that makes the conversion go wrong Is there any automatic way to adjust these Submission Guidelines Delete this section after reading All suggestions or bugs are welcome please let us know whats on your mind If you are reporting any issues around PnP Core Component please reproduce the issue with latest release If you are reporting issue around PnP Provisioning Engine please share the xml template if possible If you are reporting an issue around any of the samples please ensure that you have clear reference on the sample and possibly code file which should be fixed If you have a general question please use the SharePoint Developer Group at Microsoft Tech Community Remember to include sufficient details and context If you have multiple suggestions or bugs please submit them in seperate bugs so we can track resolution Thanks for your contribution Sharing is caring Bumps MicrosoftDataOData from to Dependabot compatibility score Dependabot will resolve any conflicts with this PR as long as you dont alter it yourself You can also trigger a rebase manually by commenting dependabot rebase dependabotautomergestart dependabotautomergeend details summaryDependabot commands and optionssummary br You can trigger Dependabot actions by commenting on this PR dependabot rebase will rebase this PR dependabot recreate will recreate this PR overwriting any edits that have been made to it dependabot merge will merge this PR after your CI passes on it dependabot squash and merge will squash and merge this PR after your CI passes on it dependabot cancel merge will cancel a previously requested merge and block automerging dependabot reopen will reopen this PR if it is closed dependabot ignore this patchminormajor version will close this PR and stop Dependabot creating any more for this minormajor version unless you reopen the PR or upgrade to it yourself dependabot ignore this dependency will close this PR and stop Dependabot creating any more for this dependency unless you reopen the PR or upgrade to it yourself dependabot use these labels will set the current labels as the default for future PRs for this repo and language dependabot use these reviewers will set the current reviewers as the default for future PRs for this repo and language dependabot use these assignees will set the current assignees as the default for future PRs for this repo and language dependabot use this milestone will set the current milestone as the default for future PRs for this repo and language You can disable automated security fix PRs for this repo from the Security Alerts page details Category Bug X Enhancement Environment X Office SharePoint Online SharePoint SharePoint Hi team We are currently doing a manual association of the global Approval Sharepoint workflow to some of our document libraries everytime a new site is created We are trying to automate this task using ApplyPnPProvisioningTemplate Kindly advice what is the best way to do so One solution I could think of is creating a document library template in the topsite and manually associated the global workflows to the same Wanted to know which xml element can be used to associate this template to all the future document libraries Any help will be much appreciated I look forward to hear from you Regards Gren Repository PnP PowerShell Category x Bug Environment x Office SharePoint Online Expected or Desired Behavior When you invoke EnablePnPFeature for Site Feed feature on a new SPO site you expect Site Feed feature is activated Newsfeedaspx page appears on a site Newsfeed webpart is added on this page content is empty of course Observed Behavior Site Feed feature is activated all good there Newsfeedaspx page appears on a site all good as well Newsfeed webpart is added but its not displayed because of an error Web Part Error A Web Part or Web Form Control on this Page cannot be displayed or imported You dont have Add and Customize Pages permissions required to perform this action Correlation ID e c f e baccd cccd fa And now you cannot deactivate Site Feed feature MANUALLY it throws internal SharePoint error when attempting Steps to Reproduce Invoke the following script powershell ImportModule SharePointPnPPowershellOnline DisableNameChecking ConnectPnPOnline Url Credential GetCredential siteFeedFeatureId a c e d abab f e Stable Site Feed feature ID EnablePnPFeature Identity siteFeedFeatureId And then try to access You will see an error message specified above Tested on different tenants We are using the Picture Profile Uploader application In SharePoint Online you can Allow or Block third party apps when apply Apps that dont use modern authentication When we have the setting at block this application will not run correct Obviously the authentication is the issue Is there a way to change in the code to use this type of method Not a C developer Hi everyone I dont know if this is the right place to submit this issue but probably someone faced it If we create a list as part of a site script which is applied automatically after site creation because the site design is set as default for the web template that was used and we do an operation against that list right after the site got created like a CAML query we get the following error If we have a custom SPFX webpart that does a query same thing will happen This error disappears after some time minutes aprox This issue is random seems to happen when we create several sites in the same time window and theres no error if we browse the list from the UI Ideas Thanks Hi everyone Were facing the followng issue We have a couple of Azure runbooks to automate the enablement of certain SharePoint features like site collection app catalog enablement external sharing enablement and scripting enablement For each of them we have one runbook that receives the site url connects to the admin center and enables the feature The code of all the runbooks is pretty similar being the only difference just the PnP command they run The PnP commands were using are SetPnPTenantSite to enable external sharing or custom scripting AddPnPSiteCollectionAppCatalog to add app catalog Were randomnly finding the following issue that only happens if we run those runbooks at the same time In those cases the of the time well face the following The operations get successfully executed that means the app catalog is enabled custom scripting is enabled etc But if we put that code inside a try catch that of the times they will raise an exception The exception message varies these are the ones I saw for SetPnPTenantSite Object reference not set to an instance of an object At line char ConnectPnPOnline Token request failed At line char SetPnPTenantSite No connection please connect first with ConnectPnPOnline At line char AddPnPSiteCollectionAppCatalog Object reference not set to an instance of an object Background info In all cases regardless of the error the operations were successful The runbooks were never executed at the same time against the same site The runbooks were executed in the same time window by programatically triggering them through http request Thanks Hi all we need to get the users current position in SharePoint online site we are using the below code in SPFx extension navigatorgeolocationgetCurrentPositionposition let latitude positioncoordslatitude let longitude positioncoordslongitude we are able to get the latitude and longitude The issue is the browser location prompt is asking more than one time when we allow the browser to access the location the issue occurs in Edge browser Is there any way to restrict the prompt to ask for only one time or directly access the location without the user permission in SharePoint online site Expecting the response as soon as possible Thanks all 