 Summary Fixed following warnings caused by Ruby update Using the last argument as keyword parameters is deprecated calling URIopen via Kernelopen is deprecated call URIopen directly or use URIopen URIescape is obsolete When set method of excel sheet is used it is showing error message deprecated Cellnew use Cellcreatecell Issue LibreOffice generates following XML for float cells tabletablecell officevaluetypefloat officevalue calcextvaluetypefloat textp textp tabletablecell Some other generators like do not put redundant children elements so the outcome is as follows tabletablecell officevaluetypefloat officevalue tabletablecell Attempt to read such ODS throws at openofficerb line or so Fix Replace cell sheet key tablecellattributes value tosinclude tablecellchildrenfirsttextinclude vtof vtoi With cell sheet key tablecellattributes value tosinclude tablecellchildrenfirst tablecellchildrenfirsttextinclude vtof vtoi The former version does not comply to the best possible coding style The variable v comes from the caller and in this case is set to the stringified value attribute also the caller does not check for the presence of the child element The original code tries to access the first child element even if its not present resulting in exception Even if the problematic ODS is not valid this patch will improve the code quality and so increase Roo compatibility System configuration Roo version still present in Ruby version ruby p revision x mingw Summary Bugfix for Round float value before converting to integer Other Information I added a simple spec to cover the issue reported in issue and one of the ones I ran into Could the gemspec be updated to allow rubyzip version too More info here I found out that is due to this set of code in librooformatterscsvrb when string onecellgsub unless onecellempty can you provide an option to convert strings to csv without quotes chopraanmol I have a spreadsheet of members designed as below enter image description here My aim is to upload some columns and exclude others In this case I wish to upload only the name age and email and exclude the others I have been able to achieve this using the slice method as shown below def loadimportedmembers spreadsheet openspreadsheet spreadsheetdefaultsheet Worksheet header spreadsheetrow spreadsheetlastrowmap do i row Hash header spreadsheetrowi transpose member Memberfindbyidrow id Membernew memberattributes rowtohashsliceid name age email member end end The problem is that lastrow considers all the rows upto the last one and since there are validations on the form there are errors due to missing data as a result of the empty rows which shouldn t be considered Is there a way I can upload only specific columns as I have done yet limit to only the rows that have data There is issue when a xlsx file does not contain style xml compressed with it we should create a blank style xml file so that it does not raise issue and stop processing xlsx file only if the style xml is not present The below file was created with js library Attached xlsx file created which I was not able to upload Main View oct xlsx There can be other ways to solve this issue more efficiently but for me currently solved by making below changes Thanks for filing an issue Following these instructions will help us solve your problem sooner Steps to reproduce Create an excel file that has empty rows between filled rows Read the data with eachrowstreaming function Issue I need to show an error for the filled line which comes after the blank line The error should specify the row number like this The value on row rownumber is invalid Since the library access NokogiriXMLReader with NokogiriXMLParseOptionsNOBLANKS parameter on eachelement utility empty lines are skipped Which causes indices to be wrong Problematic line Also the original row number is stored in r attribute for each row on the XML file But since you only return the root data of the row there is no way to access this attribute either Possible solutions Accept another parameter for eachrowstreaming which will specify ParseOptions for Nokogiri instead of fixed NOBLANKS Allow eachrowstreaming to return the full row data instead of root only System configuration Roo version Ruby version 