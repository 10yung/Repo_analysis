We use a view to hold a UILabeluse setFramefunction to hold a textbut actuallythe width we calculated is not precisekCountMagnitudeAdaptationRatio will not as precise as we expected when count becomes larger and largerWhat causes the problem CGSize size badgeText boundingRectWithSizeCGSizeMakeMAXFLOAT MAXFLOAT options attributesNSFontAttributeNameTTFONTZH contextnil size barButtonItem valueForKeyview sometimes returns nil and hub not showing up let cartBarButton UIBarButtonItem UIBarButtonItemtitle Test style UIBarButtonItemStylePlain target self action nilselectorselftoggleLeft let attributes NSFontAttributeName UIFontfontAwesomeOfSize as Dictionary cartBarButtonsetTitleTextAttributesattributes forState Normal cartBarButtontitle StringfontAwesomeIconWithNameShoppingCart cartBarButtontintColor CommonMainColor selfnavigationItemrightBarButtonItem cartBarButton let hubRKNotificationHub RKNotificationHubbarButtonItem cartBarButton hubincrement hubcount hubsetCircleAtFrameCGRectMake hubpop 