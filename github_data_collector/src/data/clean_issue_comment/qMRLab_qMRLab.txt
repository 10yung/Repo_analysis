Hey ileppe and agahkarakuzu Someone flagged a bug in Barrals original code in my fork I was wondering if either of you encountered this while working on the qMRLab implementation and what workaround did you have It does appear that that variable contains all the important sequence information per the similar simulation script that works for me I have opened the qMRLab using Jupyter nb but I am not sure how to actually run the code and study my images Any help is appreciated On mp rage branch I was trying to use mtsat and get the following error Error while evaluating UIControl Callback It is not verbose enough for me to understand what exactly it is atm Yet I know that I did some changes to the GUI functionality on the mp rage branch will have to go through those changes and fix this problem hey team what should be the strategy for handling division by zero or epsilon when computing MTR this applies to other methods too eg MTsat detect small divisor mask out those elements during division and replace those elements in the output array by X divide everything and handle the output look for aberrant values and replace by X one problem with that is that when saving niftis with a very large range ie including eg the precision gets hurt in an uncontrolled manner requires to take care of the output dtype pushing physical space eg with float unnecessarily another problem minor is that division by zero might be handled differently across platforms potentially yielding differences in precision see my comment below andor warning messages What should be X zeros nan inf i see two problems with replacing by zero users might blindly use the output image to aggregate metrics and include zeros in their calculations a mask could be provided alongside the output image but some uninformed users will not consider the mask and go on with their processing Ive seen that happening some users will want to resample their output image to another space yielding critical bias when interpolating zeroedvalues at least naninf would output an error depending on the software Ive been trying to handle this at both levels during the division process and at the output level to provide maximum flexibility See an example here feedback welcome This is a TODO item to be worked on immediately after the ISMRM deadline Per our email discussion we need to implement a way so that the Protocol panel can be designed in the exact same way as the Option panel is in Option of the figure below MP RAGE Both MP RAGE to merge soon and MTSat need to then be refactored to used this new format for a cleaner GUI and better user experience Hello qMRILab developers I am using your package for QSM analysis when I run the code I got some errors which is not resolvable for me I will attach it below I appreciate any help thanks a lot Error using logical NaNs cannot be converted to logicals Error in qsmsbfit line dataMask logicaldataMask Error in FitData line Fit Modelfitdata Error in qMRLabFitGoFitData line FitResults FitDatadataModel Error in qMRLabFitGOCallback line FitGoFitDatahObject eventdata handles Error in guimainfcn line fevalvarargin Error in qMRLab line guimainfcnguiState varargin Error in matlabgraphicsinternalfigfileFigFilereadhObjecteventdataqMRLabFitGOCallbackhObjecteventdataguidatahObject Error while evaluating UIControl Callback I am very pleased to add this joint work by yasuhik and TomMingasson and myself Purpose This Monte Carlo simulator for D diffusion is able to generate synthetic diffusion signal from any D axon packing Approach First the axonpacking software is used to generate dense packing of circles Then the Monte Carlo simulator moves water molecules around in the packing and apply the phase shift induced by the diffusion gradients Interface First step is to generate an axon packing Prepacked examples are proposed img width altCapture d e cran a src Then when clicking on Update button the Monte Carlo simulation runs in this packing Note blues dots correspond to extraaxonal water molecules and red dots to intraaxonal water Note The MPG strength and Signal Strength plots correspond to the last bvalue in the protocol But Signal Strength is computed for all bvalues from the protocol Once the simulation is finished synthetic data are plotted and fitted by the charmed model The user is able to save this synthetic signal in a mat file Results Free water diffusion With no axons the diffusion coefficient is correctly measured Test particles Dmontecarlo x mm s ADCfitted x mm s Test particles Dmontecarlo x mm s ADCfitted x mm s Small pulse approximation model in single diameter samples img width altCapture d e cran a src We observe the diffusiondiffraction patterns and we can correctly measure axon diameter img width altCapture d e cran a src AxonDiameterPacking m AxonDiameterFitted m img width altCapture d e cran a src AxonDiameterPacking m AxonDiameterFitted m Open Questions and PreMerge TODOs Use github checklists When solved check the box and explain the answer Review that changed source fileslines are related to the pull requestissue If any filescommits were accidentally included cherrypick them into another branch Review that changed source fileslines were not accidentally deleted Fix appropriately if so Test new features or bug fix If not implementedresolved adequately solve it or inform the developer by requesting changes in your review Preferably set breakpoints in the locations that the code was changed and follow allong line by line to see if the code behaves as intended Manual GUI tests general Does the qMRLab GUI open Can you change models Can you load a data folder for a model Can you view data Can you zoom in the image Can you pan out of the image Can you view the histogram of the data Can you change the color map Can you fit dataset Fit data Can you saveload the results Can you open the options panel Can you change option parameters Can you saveload option paramters Can you select a voxel Can you fit the data of that voxel View data fit Can you simulate and fit a voxel Single Voxel Curve Can you run a Sensitivity Analysis Can you simulate a Multi Voxel Distribution Specifications Version Platform Subsystem Hi all I am trying to process T relaxation data in a naive rat brain with a mask covering just to corpus callosum as that is what we are mainly interested in The data was collected at T so it is expected that the T MW will be very short so I have been trying to process with the cutoff T range of MW to be to with some tries lower and higher I was able to make lower ranges by changing the T range in the getT m file from TE to or TE since my TEs begin at However I am getting data that seems to be zeroed out T MW and consequently MWF as well with a few sporadic voxels showing some trends of what I think would be normal and others showing nonzero results but only peak When looking at independent voxels in the GUI the T relaxation curve looks totally normal so I dont believe the issue lies with the data itself I am curious as to what I may be recommended to change in the code itself whether it be mu the chi range and within what ranges would be acceptable of if there is a tolerance variable that may be throwing it off I have attached my data mask protocol parameters for the GUI and an example set of processed data so show what I am talking about if that may help I am not sure if my assumptions or setups to the processing are valid or incorrect MWF data and resultszip Any suggestions Just noticed this here when creating a branch Getting the following error travisretry sudo aptget y qq install octave liboctavedev octavepkgdev Unable to correct problems you have held broken packages The command sudo aptget y qq install octave liboctavedev octavepkgdev failed Retrying of For Gaussian and spline filters it appears that theres a lot of bleedthrough from the noise outside the brain unlike for median and polynomial filters For certain scale bar ranges this can make it appear like theres different masking or erosion after filtering See Figure in this blog post 