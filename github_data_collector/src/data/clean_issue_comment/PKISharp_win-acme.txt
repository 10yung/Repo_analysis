Some minor improvements to the plugin loosely related to The original bug discussed in is already fixed by e d f c a a e d cd a d bc Is there a reason you implemented IDisposable explicitly If yes Ill revert this change of course Hello It semana that certificate is not valid How to ideal with Fake LE intermediate X Tested with Chrome Best regards After validation the records acmechallenge dont get deleted and remain in the dns Is this the correct behavior georgjung Lets Encrypt says However you should make sure to clean up old TXT records because if the response size gets too big Let s Encrypt will start rejecting it Proposal A Null store plugin that doesnt actually store anything It basically makes the store step a noop Rationale Would allow renewals as a user that does not have access to the Certificate Store ie nonadmin with the install step handled by a Script that does an application specific import and enable workflow Current Workaround Use a Central Store location that the nonadmin user does have access to in order to allow the renewal to run This is completely unused however as the application does not utilise the IIS central store functionality Background Longer Version We currently use winacme for Exchange certificate renewals so we use a PowerShell script based installation process to ensure the new certificate is assignedenabled for the correct Exchange services As part of this process to avoid running as an admin account we have the scheduled task set up to run as an unprivileged user that has some minimal Exchange admin roles assigned so as part of the install script we can do the ImportExchangeCertificate and EnableExchangeCertificate steps as this unprivilged user The byproduct of this is that during testing we found the initial runs failed as only Administrators can write to the Windows Certficate Store so wacs would not work at all as our unprivileged user To work around this we have this renewal set up to use the Central Certificate Store which is a location the user can write to however this leaves PFX files with no password or a static one on disk which is something our auditors are a little twitchy about We do work around this by ensuring ACLs on this dummy central store are set appropriately and have a scripted delete of these unused PFX files however it would be great if there was an option for a Null Store that is simply a noop This would then allow an install script to use CacheFile and CachePassword as we do to import and enable the certificate for use For security reasons Lets Encrypt is making changes to its ACMEv endpoint requiring clients to use something it calls POSTasGET Read the full announcement here but in summary it means that clients that dont implement this feature will stop working with Lets Encrypt x December disabled for the staging endpoint test November disabled for the production endpoint winacme implemented the POSTasGET feature in version which was released in November The upcoming release will also support it as a stop gap measure for Windows users Call to action If you are running Windows Server or above plan to upgrade to the latest version of the software this year There are some breaking changes between versions x and x but they are actually easily mitigated Due to a limitation of the underlying NET Core framework the latest version of winacme does not support Windows Server The x branch is not actively maintained or supported except by special request for people with a gold sponsorship on Patreon There will however be a release which supports POSTasGET but doesnt contain any other improvements This is an important announcement for users of software version x or earlier Lets Encrypt is phasing out support for the ACMEv protocol that these versions rely upon The full plan is available here but in summary it looks like this x November new registrations become impossible June it becomes impossible to validate new domains ie to get certificates for domains that you havent previously gotten a certificate for already January the service will be disabled intermittenty causing occasional renewal failures June the service will be permanently disabled winacme implemented the ACMEv protocol in version which was released in February Call to action If you are running Windows Server or above plan to upgrade to the latest version of the software Its easy to import renewals from the old version to the new version and you will enjoy a more userfriendly stable and fullfeatured version of the software Due to a limitation of the underlying NET Core framework the latest version of winacme unfortunately does not support Windows Server You may install version as a stopgap measure but that version also has limited useful time remaining see The x branch is not actively maintained or supported except by special request for people with a gold sponsorship on Patreon Hi there We installed letsencryptexe back in and have been using it with great success on many servers LetsEncryptexe has a timestamp of Weve just received a notification that we need to start using ACMEv to validate from LetsEncrypt by June From the manual it appears theres quite a few upgrade steps and not sure we can even complete those as previous versions arent available for download Would it be better to complete uninstall LetsEncryptexe and start again Dave If you try to run the TOS PDF file and you missed to install an PDF reader or you are running windows core you get this error Terms of service C ProgramData winacme acmev apiletsencryptorg LESAv November pdf Open in default application yn yes EROR Unable to start application SystemComponentModelWin Exception x Class not registered at SystemDiagnosticsProcessStartWithShellExecuteExProcessStartInfo startInfo at SystemDiagnosticsProcessStart at SystemDiagnosticsProcessStartProcessStartInfo startInfo at PKISharpWACSAcmeAcmeClientAcceptTosString filename Byte content Do you agree with the terms yn no I know that is stupid that Im trying to open the PDF without an reader but I think there should be error handling implemented Running on Windows Server with IIS creating a new certificate fails to store the certificate so automatic renewals do not happen To Reproduce File Explorer to C Program Files WinAcme Right click on wacsexe Run as administrator n new certificate simple for IIS the site ID Enter select all bindings select second binding as common name y continue with selection See error Expected behavior Expected it to authorize request a new certificate apply it to all appropriate bindings and schedule it for renewal Log INFO Target generated using plugin IIS swupd hqgciorg and alternatives INFO Authorize identifier swupdhqgciorg INFO Cached authorization result valid INFO Authorize identifier swupd hqgciorg INFO Cached authorization result valid INFO Requesting certificate IIS site any host INFO Store with CertificateStore INFO Installing certificate in the certificate store INFO Adding certificate IIS site any host to store WebHosting EROR Error saving certificate to intermediate store EROR WindowsCryptographicException Unable to store certificate Access is denied EROR Create certificate failed Store failed Access is denied Platform OS Windows Server Standard English Version RELEASE UNPLUGGABLE Im having trouble with a renewal using WinAcme v on Server R Standard fully patched The error thrown is Authentication failed because the remote party has closed the transport stream Here is the verbose output from the request VERB Sending emails False DBUG Scanning IIS site bindings for hosts VERB named bindings found in IIS DBUG Filtering by sites VERB bindings remaining after site filter DBUG Filtering by host www example com VERB bindings remaining after host filter VERB matching bindings found INFO Force renewing certificate for wwwexamplecom VERB Loading ACME account signer DBUG Loading signer from C ProgramData winacme acmev apiletsencryptorg Signerv VERB Constructing ACME protocol client DBUG Send GET request to EROR IOException Authentication failed because the remote party has closed the transport stream DBUG Exception details IOException TargetSiteVoid StartReadFrameByte I nt SystemNetAsyncProtocolRequest StackTrace at SystemNetSecuritySs lStreamStartReadFrameByte buffer Int readBytes AsyncProtocolRequest asyn cRequest r n at SystemNetSecuritySslStreamPartialFrameCallbackAsyncProto colRequest asyncRequest r n End of stack trace from previous location where exception was thrown r n at SystemNetSecuritySslStreamThrowIfException al r n at SystemNetSecuritySslStreamInternalEndProcessAuthenticationLaz yAsyncResult lazyResult r n at SystemNetSecuritySslStreamEndProcessAuthen ticationIAsyncResult result r n at SystemNetSecuritySslStreamEndAuthenti cateAsClientIAsyncResult asyncResult r n at SystemNetSecuritySslStream cAuthenticateAsClientAsyncb IAsyncResult iar r n at SystemThreading TasksTaskFactory FromAsyncCoreLogicIAsyncResult iar Func endFunction Ac tion endAction Task promise Boolean requiresSynchronization r n End of stack trace from previous location where exception was thrown r n at Syst emNetHttpConnectHelperEstablishSslConnectionAsyncCoreStream stream SslClie ntAuthenticationOptions sslOptions CancellationToken cancellationToken Messa geAuthentication failed because the remote party has closed the transport stre am Data InnerExceptionnull HelpLinknull SourceSystemNetSecurity HResult EROR Wrapped in HttpRequestException The SSL connection could not be establi shed see inner exception EROR Renewal for wwwexamplecom failed will retry on next run