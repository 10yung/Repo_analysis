 rddforeachPartition partitionOfRecords val connection HdfsConnectiongetHdfsConnectionconfig partitionOfRecordsforeach record connectionwriteUTFrecord connectionwriterecordgetBytesUTF connectionwriteBytes n flush try connectionhflush catch case e Exception loggererrorshflush exception egetMessage partition hdfs 