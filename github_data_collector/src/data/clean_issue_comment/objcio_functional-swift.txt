 extension Ship func canSafelyEngageShiptarget Ship friendly Ship Bool let rangeRegion differencecirclefiringRange minus circleunsafeRange let firingRegion shiftrangeRegion offset position let friendlyRegion shiftcircleunsafeRange offset friendlyposition let resultRegion differencefiringRegion minus friendlyRegion return resultRegiontargetposition This line let friendlyRegion shiftcircleunsafeRange offset friendlyposition should be let friendlyRegion shiftcirclefriendlyunsafeRange offset friendlyposition friendlyRegion should be represented the friendly ships unsafe region 