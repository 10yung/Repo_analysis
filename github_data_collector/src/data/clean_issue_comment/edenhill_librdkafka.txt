Description I am running a Python Producer service in AWS Lambda using the confluentkafka library which makes use of librdkafka connecting to a kafka service that requires SSL I have found that the only way I can authenticate to kafka is to include a physical CA PEM file in the sslcalocation setting This is deemed as a security risk because Id have to store the PEM file in my repo in order to deploy it with my Lambda code This feels like Im missing a better alternative but in my searches through the documentation I havent seen one Is there a better way to do this Checklist x librdkafka version release number or git tag confluentkafka x Apache Kafka version Confluent x librdkafka client configuration acks bootstrapserversKAFKABROKERsecurityprotocolSASLSSLsaslmechanismSCRAMSHA saslusernameSASLUSERNAMEsaslpasswordSASLPASSWORDsslcalocationpath to CA pem x Operating system Python x Provide logs There are no logs without the CA producerlisttopics and producerflush just hang until timeout x Provide broker log excerpts No logs x Critical issue No Another minor tweak to a type For proper atomicity with respect to signal handler the type of variables modified in signal handlers should be sigatomict with volatile qualifier modifying other types such as a plain int is undefined behaviour even if it works as expected on most platforms This is atomicity between main code signal handler ie required even in singlethreaded program In C files used for false and for true respectively just to avoid any confusion and implicit conversions which is otherwise fine sigatomict type is available since C so should be reasonably portable Read the FAQ first Description Hi I am trying to create a producer that connects to a KAFKA broker This is a SSL connection with all the certs supplied RDKAFKA BROKERFAIL rdkafkaproducer thrdssl bootstrap ssl bootstrap failed err Local Host resolution failure errno Bad address nfmtracedumptxt Jan Plogger RDKAFKA FAIL rdkafkaproducer thrdssl bootstrap ssl bootstrap Failed to resolve invalid flags value How to reproduce Created a conf and updated the parameters Setup the dcoscontext snprintfvrfstr sizeofvrfstr d if setenvDCOSCONTEXT vrfstr rdkafkaconfsetconf bootstrapservers rdkafkaconfsetconf securityprotocol SSL errstr sizeoferrstr rdkafkaconfsetconfsslcertificatelocation clientkafkaKafkaClientcrterrstr sizeoferrstr rdkafkaconfsetconf sslkeylocation clientkafkaKafkaClientkeyerrstr sizeoferrstr rdkafkaconfsetconf sslcalocation clientkafkaCacrterrstr sizeoferrstr rdconfnew with above configs were successful Created a topic using rdkafkatopicnew which was successful rkt rdkafkatopicnewrk topictest NULL Started the rdkafka poll after the creation of the producer rdkafkapollrk block for max ms Got the following logs RDKAFKA SSL rdkafkaproducer thrdapp Loading CA certificates from file clientkaf kaCacrt RDKAFKA SSL rdkafkaproducer thrdapp Loading certificate from file clientkafkaKafkaClientcrt RDKAFKA SSL rdkafkaproducer thrdapp Loading private key file from clientkafkaKafkaClientkey RDKAFKA BRKMAIN rdkafkaproducer thrd internal internal Enter main broke r thread RDKAFKA STATE rdkafkaproducer thrd internal internal Broker changed sta te INIT UP RDKAFKA WAKEUPFD rdkafkaproducer thrdapp ssl bootstrap Enabl ed lowlatency partition queue wakeups RDKAFKA BROADCAST rdkafkaproducer thrd internal Broadcasting state change RDKAFKA WAKEUPFD rdkafkaproducer thrdapp ssl bootstrap Enabl ed lowlatency ops queue wakeups RDKAFKA BROKER rdkafkaproducer thrdapp ssl bootstrap Added n ew broker with NodeId KAFKA Created kafka producer RDKAFKA TOPIC rdkafkaproducer thrdapp New local topic topictest RDKAFKA BRKMAIN rdkafkaproducer thrdssl bootstrap ssl bootstrap Enter main broker thread RDKAFKA CONNECT rdkafkaproducer thrdssl bootstrap ssl bootstrap broker in state INIT connecting RDKAFKA TOPPARNEW rdkafkaproducer thrdapp NEW topictest x cdbc at rdka fkatopicnew RDKAFKA METADATA rdkafkaproducer thrdapp Skipping metadata refresh of topic s no usable brokers Created kafka topic Created producer RDKAFKA BROKERFAIL rdkafkaproducer thrdssl bootstrap ssl bootstrap failed err Local Host resolution failure errno Bad address RDKAFKA FAIL rdkafkaproducer thrdssl bootstrap ssl bootstrap Failed to resolve invalid flags value RDKAFKA ERROR rdkafkaproducer thrdssl bootstrap ssl bootstrap Failed to resolve invalid flags value The certs are all present and the broker is accessible via openssl DCOSCONTEXT openssl sclient CAfile clientkafkaCacrt connect prexit cert clientkafkaKafkaClientcrt key clientkafkaKafkaClient key debug state tls msg SSL handshake has read bytes and written bytes IMPORTANT Always try to reproduce the issue on the latest released version see if it cant be reproduced on the latest version the issue has been fixed Checklist IMPORTANT We will close issues where the checklist has not been completed Please provide the following information x librdkafka version release number or git tag REPLACE with eg v or a git sha NOT latest or currentVersion pre Apache Kafka version x librdkafka client configuration REPLACE with eg messagetimeoutms autoresetoffsetearliest x Operating system REPLACE with eg Centos x NXOS x Provide logs with debug as necessary from librdkafka Provide broker log excerpts x Critical issue sizet being an unsigned type zu is the correct format specifier Using zd is technically undefined behaviour due to sign mismatch recently I used fluentd to send logs to kafka using the rdkafka type in fluentpluginkafka Rdkafka will use rdkafkaruby as the client and rdkafkaruby will call librdkafka as the actual worker I did some tests for performance but the results were very unsatisfactory Description The producer and kafka server are on the same network so there is no network delay The test loads pieces of data from a file each piece of data is about bytes the average transmission time of the test results is s and only more than pieces of data are processed per second and I found from the trace log print that most of the time is used for data After processing it will take very little time to send to Kafka after packaging into a MessageSet Does anyone have experience in this area please help How to reproduce Requires a complete fluentd environment IMPORTANT Always try to reproduce the issue on the latest released version see if it cant be reproduced on the latest version the issue has been fixed Checklist IMPORTANT We will close issues where the checklist has not been completed Please provide the following information x librdkafka version release number or git tag x Apache Kafka version x librdkafka client configuration batchnummessages queuebufferingmaxms requestrequiredacks queuebufferingmaxmessages queuebufferingmaxkbytes socketkeepaliveenable true socketsendbufferbytes socketblockingmaxms messagemaxbytes x Operating system Alpine Linux v x Provide logs with debug as necessary from librdkafka Provide broker log excerpts Critical issue Additionally i think its misleading to use RDKAFKARESPERRMSGSIZETOOLARGE in the error op below as its a broker error implying it originated from the broker This had me confused for some time Ill let you work out what to do with that Read the FAQ first Description Every time TopicImplname is called a new stdstring is created via copy form C string That will waste CPU and create extra allocationsdeallocations if someone decides to do things like log the topic name from a Topic instance Topicname should return a stdstring like TopicPartitiontopic does TopicImplname should create the string lazily and store it as a member for reuse How to reproduce In code IMPORTANT Always try to reproduce the issue on the latest released version see if it cant be reproduced on the latest version the issue has been fixed Checklist IMPORTANT We will close issues where the checklist has not been completed Please provide the following information x librdkafka version release number or git tag master branch Apache Kafka version na librdkafka client configuration na Operating system na Provide logs with debug as necessary from librdkafka Provide broker log excerpts Critical issue Description Back Trace x ffff in thrdcreate from usrlib libpthreadso x ffff afe in rdkafkanew typeRDKAFKACONSUMER appconf x errstr x c errstrsize at rdkafkac New Thread x ffff ca LWP rdkafkanew typeRDKAFKACONSUMER appconf x errstr x c errstrsize at rdkafkac rkrkinitwaitcnt gdb n reterr RDKAFKARESPERRCRITSYSRESOURCE gdb n reterrno errno gdb n if errstr gdb n rdsnprintferrstr errstrsize gdb n rdkafkawrunlockrk gdb p errstr x c Failed to create thread No such file or directory gdb Librdkafka is built with the following options configure enablegssapi enablessl disableoptimization checking for libpthread by pkgconfig failed checking for libpthread by compile ok cached checking for c threads by pkgconfig failed checking for c threads by compile failed disable Checklist IMPORTANT We will close issues where the checklist has not been completed Please provide the following information x librdkafka version release number or git tag latest Operating system RHEL Critical issue update the usage with the compression codec of lz and zstd When building without the fix you get an error Build started Project rdkafkaexample Configuration Release x C Program Files x Microsoft Visual Studio Professional MSBuild Microsoft VC v MicrosoftCppBuildtargets error MSB The build tools for v Platform Toolset v cannot be found To build using the v build tools please install v build tools Alternatively you may upgrade to the current Visual Studio tools by selecting the Project menu or rightclick the solution and then selecting Retarget solution Done building project rdkafkaexamplevcxproj FAILED The error is NOT fixed when retargeting the solution The file commonvcxproj needs to contain the relevant platform toolset definitions and this is what this commit does