As per Mitre detection techniques if and adversary tries to collect knowledge about domain trust such as nltest domaintrusts I have written a sysmon rule to detect T Its not related to this thing but I wanted to know is there a way to Map Kill Chain phases or is it already done somehow Please Guide What may be the reason COMPLETE ERROR MESSAGE MergeAllSysmonXml Cannot bind argument to parameter Path because it is null At line char MergeAllSysmonXml Path GetChildItem xml AsString O CategoryInfo InvalidData MergeAllSysmonXml ParameterBindingValidationException FullyQualifiedErrorId ParameterArgumentValidationErrorNullNotAllowedMergeAllSysmonXml Hi I am new to sysmon and experimenting with configs from this repository Now I have installed a clean client with my baseline settings and I get a lot triggers for the rules T T I came to the conclusion that this happens after every GPUpdate since my settings tell the client to process every object even if these have not changed Would there be a good way to filter this events One possibility I see is to filter based on the Image which did the change In this case it would be svchostexe Now I wonder if this would lead to missing out on critical detections Thx Bernhard Fantastic work on doing the mapping love it We use a modified version of either yours or Swifts config and remove entries from certain areas to reflect what we want to see in our environment With modular itd be super handy if we could have a file of things we want to remove that the script would reference when its done putting things together that would then remove those entries That way we could update from the git when theres a change and not have to manually go remove entries from the final product Thanks Hi I have been testing the latest master branch with the latest sysmon I have customised by removing some of the rules for tools i do not use i have also added a new rule as below From my testing though it seems part of the config is not applying My rule is not applied and generates alot of events if i dump the config with sysmon c picking some key executables from the config i cannot find them in the dump where as if i use swiftonsecuritys zalpha config i can find matching words Below is my processaccess config and an example of portion of the event firing still Also event seems to hit alot whereas zalpha doesnt comparing the configs i cannot see why it would be triggering unless the event hides the actual reg path I have tried your default config and seem to have similar events triggering with the obvious inclusion of sfcexe Any suggestionstests Sysmon schemaversion EventFiltering RuleGroup name groupRelationor ProcessAccess onmatchexclude SourceImage conditionend withsfcexeSourceImage ProcessAccess RuleGroup EventFiltering Sysmon Process accessed RuleName UtcTime SourceProcessGUID d bab ef e dad SourceProcessId SourceThreadId SourceImage C Program Files Cisco AMP sfcexe Registry object added or deleted RuleName EventType CreateKey UtcTime ProcessGuid d bab ef e dad ProcessId Image C WINDOWS system svchostexe TargetObject HKCR Thanks Hi Congrats for this great work just suggesting a few more exlclusions regarding the Microsoft Azure Sentinel SIEMs agent PROCESS CREATION Sysmon schemaversion EventFiltering RuleGroup name groupRelationor ProcessCreate onmatchexclude Rule groupRelationand ParentCommandLine conditionisC Program Files Microsoft Monitoring Agent Agent MonitoringHostexe EmbeddingParentCommandLine CommandLine conditionisC Windows system cscriptexe nologo MonitorKnowledgeDiscoveryvbsCommandLine Microsoft Sentinel SIEM agent based on MOM Rule ProcessCreate RuleGroup EventFiltering Sysmon PIPE CREATION Sysmon schemaversion EventFiltering RuleGroup name groupRelationor PipeEvent onmatchexclude Image conditionisC Program Files Microsoft Monitoring Agent Agent MonitoringHostexeImage Microsoft Sentinel SIEM agent based on MOM PipeEvent RuleGroup EventFiltering Sysmon My cents Phil