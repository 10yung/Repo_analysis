 Describe your issue This is the log when running sudo lvlip levelip sudo lvlip Unsupported ethertype dd ARP was not for us Unknown IP header proto Unsupported ethertype dd Unknown IP header proto Unknown IP header proto Unknown IP header proto Unsupported ethertype dd Unknown IP header proto Unknown IP header proto Unknown IP header proto Unsupported ethertype dd Unknown IP header proto ARP was not for us Unsupported ethertype dd Unsupported ethertype dd Unsupported ethertype dd Unknown IP header proto Unsupported ethertype dd Unsupported ethertype dd Unknown IP header proto Unsupported ethertype dd Unknown IP header proto Unsupported ethertype dd Unsupported ethertype dd Unsupported ethertype dd Unknown IP header proto Unknown IP header proto Unknown IP header proto Unsupported ethertype dd Unsupported ethertype dd Unknown IP header proto Unknown IP header proto Unsupported ethertype dd Unknown IP header proto Unsupported ethertype dd Unknown IP header proto Unsupported ethertype dd Unsupported ethertype dd Unknown IP header proto Unsupported ethertype dd Unsupported ethertype dd Unknown IP header proto Unsupported ethertype dd Unknown IP header proto Describe your running environment Ubuntu LTS This PR introduces support for Netlink AFINETIPPROTOTCP socket information gathering See man sockdiag Useful with the ss tool from iproute toolslevelip ss n t State RecvQ SendQ Local AddressPort Peer AddressPort TIMEWAIT TIMEWAIT NAMECentOS Linux VERSION Core IDcentos IDLIKErhel fedora VERSIONID PRETTYNAMECentOS Linux Core ANSICOLOR CPENAMEcpeocentoscentos HOMEURL BUGREPORTURL CENTOSMANTISBTPROJECTCentOS CENTOSMANTISBTPROJECTVERSION REDHATSUPPORTPRODUCTcentos REDHATSUPPORTPRODUCTVERSION Linux SCXIFIXT el x SMP Fri Feb UTC x x x GNULinux make all cc I include Wall Werror pthread c srcskbuffc o buildskbuffo In file included from srcskbuffc includesysheadh fatal error syscapabilityh No such file or directory include syscapabilityh compilation terminated make buildskbuffo Error Nov levelipmaster I followed the instructions in readme file when executing make all many errormessages come into screen so could you tell me about your environment when compiling code pls eg what is the version of your gcc c or gnu or else thanX OS eg cat etcosrelease NAMECentOS Linux VERSION Core IDcentos IDLIKErhel fedora VERSIONID PRETTYNAMECentOS Linux Core ANSICOLOR CPENAMEcpeocentoscentos HOMEURL BUGREPORTURL CENTOSMANTISBTPROJECTCentOS CENTOSMANTISBTPROJECTVERSION REDHATSUPPORTPRODUCTcentos REDHATSUPPORTPRODUCTVERSION Kernel eg uname a Linux lll el x SMP Wed Mar UTC x x x GNULinux Sequence numbers must not be compared for inequality naively since they are designed to wrap around For example there is an issue here when checking if an incoming segment has a valid sequence number Consider the case tcbrcvnxt tcbrcvwnd thseq This is an acceptable segment it is more than tcbrcvnxt so it is within the receive window but your code will decide it is not acceptable One way to fix this specific part of code is like this c uint t seqrelativetorcvnxt uint tthseq tcbrcvnxt if seqrelativetorcvnxt tcbrcvwnd invalid segment Note that the conversion of the result of the subtraction to uint t is imperative to ensure modulo reduction Route lookup should return the longest prefix match in case of more than one match See and look for Longest Match 