Hi all and in particular mcvinding robertoostenveld Here is a more thorough description of the issues I am encountering when using various options for ftvolumesegment of maybe not so great quality MRIs Ive done several checks now with permutations of coordsys ctf or acpc for ftvolumerealign either with or without ftvolumereslice spm and spm with either old or new Code attached but the basics are mri ftreadmri dirmri fisubname cfg cfgmethod interactive cfgcoordsys ctf mrialignedctf ftvolumerealigncfgmri mrireslice ftvolumereslice mrialignedctf Segment anatomy cfg cfgspmversion spm cfgoutput brain scalp skull cfgcoordsyst ctf mrisegmentreslicectf ftvolumesegmentcfg mrireslicectf Ive tried so many things that I dont even know anymore wherewhy artefacts are introduced and which pipeline I should go for The issue is the following ACPC with spm with or without reslicing seems fine CTF wiht spm artefact is introduced I dont think it can be due to my placement of the fiducials Ive always done it this way but never saw this issue before The artefact is more prominent with CTF but maybe because of some skull stripping with SPM old that is different for ACPCCTF Finally SPM new SPM new is nicely segmenting the tumour in this case better than SPM old which is a good thing But I still seem to have some artefacts see picture above the light blue pixels in the red box Ive tried so many things by now that Im a bit lost and dont know what is a real artefact what I can ignore which pipeline I should use and whether this is an issue I should be reporting at all But I promised mcvinding I would do that so here is the complete picture Somehow I accumulated a whole bunch of changes in my personal fieldtrip copy which ended up under the effectsize branch I should carefully review them prior to merging As discussed with Robert and initiated by the concrete question whether ftappendfreqtimelock should optionally allow for cfgselect to be union rather than the now only supported and hardcoded intersect we identified that in general we may want to rethink this functionality for all ftfunctions that concatenate across a set of varargins ftappend ftstatistics ftgrandaverage compile a list of relevant functions rethink expected behavior and the potential consequences of optional functionality note that ftselectdata which should do the lowlevel selection in most cases now does an eitheror for all dimtoks Probably expected behavior will be to be selective for certain dimtok For instance what is expected behavior when ftappendtimelock is called with appenddimchan ftselectdata should not exclude taking the union if specified by the user across the chan dimension to begin with Hmmm Fixed the channel selection problem The fix is to to the channel selection on tmpdata instead of data as it was done before When I run to read the standard atlas atlas ftreadatlasfullfileftpath templateatlasbrainnetomeBNAMPMthr mmnii Matlab R a throws Array indices must be positive integers or logical values Error in ftreadatlas line atlastissuelabelidx lab I am using latest git updated fieldtrip as of pm So far the option allow for overlap is not possible because the option is not retrieved and not taken into account by ftfetchdata With this modification adding cfgoverlap true will enable it when calling ftredefintrial Apparently this was to prevent some issues but when you need to manually add some buffer that will be further removed for instance then it can become useful to have data overlap This occurs for example when ftreadatlas is used to read Talairachlabels mmnii since the labels are stored in a separate text file Trying to create a ftsensitivitymap function translating python code from MNE Started a branch Code is more like a draft right now Options are not implemented Testing it with the practicalMEEG dataset and copied bits of pipelinesourceanalysis The file sensitivity map that I get seems off Can you provide guidance Specified the extrapolation parameter for interp to ensure data is not extrapolated This can happen when cfgtime is used and times are given outside the range of the current data The added parameter enforces that all values outside the data range are set to zero Add w to githubs URL to see the diff with whitespace ignored Several fixes and updates to read NeuroOmega and Blackrocks NSx files Add w to githubs URL to see the diff with whitespace ignored 