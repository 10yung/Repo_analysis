On latest version of webrtc library I m using a RTCView to render my localstream however when I switch the stream from front to back camera or vice versa I have to change mirrored to true or false I can do that but the result is a second or so to where the previous stream is mirrored before the camera switches from front to back or vice versa Has anyone encountered this issue iOS Expo Bare project Expected behavior onaddstream gets called everytime when remote peer calls addstream and renegotiate Observerd behavior onaddstream gets called once in just the first time and whenever there is a new addstream and renegotiate it doesnt get called for second time Steps to reproduce the problem stopstart camera sharing on the web app Platform information React Native version Plugin version OS Android OS version PKQ My app has a stutter when I leave the room and then join the room it finally crashes Expected behavior no stutter no crash Observerd behavior Steps to reproduce the problem leave the room then join the room Platform information React Native version Plugin version OS Android iOS iOS OS version WechatIMG I needed the way to get video size from RTCView I made this fork This PR fixes by adding onFirstFrame callback which fires when first video frame is received Note however that audio stream can start playing earlier createOffer promise does not resolve or reject on iOS I was testing with iOS recently and I noticed that I was having an error connecting to peers After some debugging I found that the createOffer method is not behaving as expected on iOS On iOS and below everything works as expected Expected behavior Expected createOffer method in RTCPeerConnection to either resolve or reject promise Observed behavior When calling createOffer the promise is neither resolved or rejected Steps to reproduce the problem On iOS javascript import as WebRTC from reactnativewebrtc const configuration iceServers url stunstunlgooglecom const pc new WebRTCRTCPeerConnectionconfiguration pccreateOfferthendesc consolelogdesccatcherr consolelogerr nothing happens on iOS javascript import as WebRTC from reactnativewebrtc const configuration iceServers url stunstunlgooglecom const pc new WebRTCRTCPeerConnectionconfiguration pccreateOfferthendesc consolelogdesccatcherr consolelogerr Successfully resolves RTCSessionDescription sdp v Platform information React Native version Plugin version OS iOS OS version Expected behavior When a call is released the app is still alive Observerd behavior When i close a webrtc communication the app crash with this info From the console Terminating app due to uncaught exception NSInternalInconsistencyException reason threading violation expected the main thread From Xcode from thread Queue orgwebrtcRTCDispatcherCaptureSession serial libsystemkerneldylibpthreadkill x bebcfeb mov x x x bebcfeb svc x x bebcfebc blo x bebcfed x bebcfec stp x x sp x x bebcfec mov x sp x bebcfec bl x bebaef cerrornocancel x bebcfecc mov sp x x bebcfed ldp x x sp x x bebcfed ret x bebcfed ret Steps to reproduce the problem Establish a webrtc communication and close it Everything is OK Establish again a new webrtc communication After the release the app crash Platform information React Native version Plugin version based on cf cba b da f ef e dbfed e from Master in order to get the dispatchasync pushed few days ago OS iOS OS version Expected behavior Video should be displayed in RTCView on iPhone Pro Max iOS simulator Observerd behavior Video data seems to be sending over the peer connection but the video is not displayed in the RTCView The RTCView displays a red view instead Steps to reproduce the problem Upgrade to the latest Xcode version and attempt to broadcast a video on the latest iPhone Pro Max iOS simulator Platform information React Native version Plugin version OS iOS OS version Xcode version Screen Shot at PM I am getting only the camera switch but not the remaining Here is my code given below import React Component from react import AppRegistry StyleSheet Text TouchableHighlight View TextInput Platform value from reactnative import ListView from deprecatedreactnativelistview import io from socketioclient const socket ioconnect transports websocket import RTCPeerConnection RTCIceCandidate RTCSessionDescription RTCView MediaStream MediaStreamTrack mediaDevices from reactnativewebrtc const configuration iceServers url stunstunlgooglecom const pcPeers let localStream const pc new RTCPeerConnectionconfiguration function getLocalStreamisFront callback let videoSourceId on android you dont have to specify sourceId manually just use facingMode uncomment it if you want to specify if PlatformOS ios mediaDevicesenumerateDevicesthensourceInfos consolelogsourceInfos sourceInfos for const i i sourceInfoslength i const sourceInfo sourceInfos i ifsourceInfokind video sourceInfofacing isFront front back videoSourceId sourceInfoid mediaDevicesgetUserMedia audio true video mandatory minWidth Provide your own width height and frame rate here minHeight minFrameRate facingMode isFront user environment optional videoSourceId sourceId videoSourceId function stream consoleloggetUserMedia success stream callbackstream logError function joinroomID socketemitjoin roomID functionsocketIds consolelogjoin socketIds for const i in socketIds const socketId socketIds i createPCsocketId true function createPCsocketId isOffer const pc new RTCPeerConnectionconfiguration pcPeers socketId pc pconicecandidate function event consolelogonicecandidate eventcandidate if eventcandidate socketemitexchange to socketId candidate eventcandidate function createOffer pccreateOfferfunctiondesc consolelogcreateOffer desc pcsetLocalDescriptiondesc function consolelogsetLocalDescription pclocalDescription socketemitexchange to socketId sdp pclocalDescription logError logError pconnegotiationneeded function consolelogonnegotiationneeded if isOffer createOffer pconiceconnectionstatechange functionevent consolelogoniceconnectionstatechange eventtargeticeConnectionState if eventtargeticeConnectionState completed setTimeout getStats if eventtargeticeConnectionState connected createDataChannel pconsignalingstatechange functionevent consolelogonsignalingstatechange eventtargetsignalingState pconaddstream function event consolelogonaddstream eventstream containersetStateinfo One peer join const remoteList containerstateremoteList remoteList socketId eventstreamtoURL containersetState remoteList remoteList pconremovestream function event consolelogonremovestream eventstream pcaddStreamlocalStream function createDataChannel if pctextDataChannel return const dataChannel pccreateDataChanneltext dataChannelonerror function error consolelogdataChannelonerror error dataChannelonmessage function event consolelogdataChannelonmessage eventdata containerreceiveTextDatauser socketId message eventdata dataChannelonopen function consolelogdataChannelonopen containersetStatetextRoomConnected true dataChannelonclose function consolelogdataChannelonclose pctextDataChannel dataChannel return pc function exchangedata const fromId datafrom let pc if fromId in pcPeers pc pcPeers fromId else pc createPCfromId false if datasdp consolelogexchange sdp data pcsetRemoteDescriptionnew RTCSessionDescriptiondatasdp function if pcremoteDescriptiontype offer pccreateAnswerfunctiondesc consolelogcreateAnswer desc pcsetLocalDescriptiondesc function consolelogsetLocalDescription pclocalDescription socketemitexchange to fromId sdp pclocalDescription logError logError logError else consolelogexchange candidate data pcaddIceCandidatenew RTCIceCandidatedatacandidate function leavesocketId consolelogleave socketId const pc pcPeers socketId const viewIndex pcviewIndex pcclose delete pcPeers socketId const remoteList containerstateremoteList delete remoteList socketId containersetState remoteList remoteList containersetStateinfo One peer leave socketonexchange functiondata exchangedata socketonleave functionsocketId leavesocketId socketonconnect functiondata consolelogconnect getLocalStreamtrue functionstream localStream stream containersetStateselfViewSrc streamtoURL containersetStatestatus ready info Please enter or create room ID function logErrorerror consoleloglogError error function mapHashhash func const array for const key in hash const obj hash key arraypushfuncobj key return array function getStats const pc pcPeers ObjectkeyspcPeers if pcgetRemoteStreams pcgetRemoteStreams getAudioTracks const track pcgetRemoteStreams getAudioTracks consolelogtrack track pcgetStatstrack functionreport consoleloggetStats report report logError let container export default class Main extends Component constructorprops superprops thisds new ListViewDataSourcerowHasChanged r r true thisstate info Initializing status init roomID isFront true selfViewSrc null remoteList textRoomConnected false textRoomData textRoomValue componentDidMount container this pressevent alertthisstateroomID thisrefsroomIDblurevent thissetState status connect info Connecting joinevent switchVideoType const isFront thisstateisFront thissetStateisFront alertthisstateisFront getLocalStreamisFront functionstream if localStream for const id in pcPeers const pc pcPeers id pc pcremoveStreamlocalStream localStreamrelease localStream stream containersetStateselfViewSrc streamtoURL for const id in pcPeers const pc pcPeers id pc pcaddStreamlocalStream receiveTextDatadata const textRoomData thisstatetextRoomDataslice textRoomDatapushdata thissetStatetextRoomData textRoomValue textRoomPress if thisstatetextRoomValue return const textRoomData thisstatetextRoomDataslice textRoomDatapushuser Me message thisstatetextRoomValue for const key in pcPeers const pc pcPeers key pctextDataChannelsendthisstatetextRoomValue thissetStatetextRoomData textRoomValue renderTextRoom return ListView dataSourcethisdscloneWithRowsthisstatetextRoomData renderRowrowData rowDatauser rowDatamessage TextInput stylestylessendMessageText onChangeTextvalue thissetStatetextRoomValue value valuethisstatetextRoomValue Send render return thisstateinfo thisstatetextRoomConnected thisrenderTextRoom View styleflexDirection row thisstateisFront Use front camera Use back camera Switch camera thisstatestatus ready TextInput refroomID autoCorrectfalse stylestylestextInputRoomID onChangeTexttext thissetState roomID text valuethisstateroomID TouchableHighlight onPressthispressbindthis thisstateroomID Enter room null mapHashthisstateremoteList functionremote index return RTCView keyindex streamURLremote stylestylesremoteView View const styles StyleSheetcreate selfView width height remoteView width height container flex justifyContent center welcome fontSize textAlign center margin listViewContainer height textInputRoomID width height borderColor gray borderWidth switchCamera borderWidth borderColor black sendMessageText width height borderColor gray borderWidth I am working in the reactnative reactnativewebrtc devices is iphone IOS version 