Im using graphqlshield with Apollo Federation To Reproduce js const permissions shield Company andisAuthenticated orandisEmployee userExists isAdmin Query deny This will make sure you will add a handler to the rule company andisAuthenticated orandisEmployee userExists isAdmin clinic andisAuthenticated orandisEmployee userExists isAdmin me andisAuthenticated isEmployee Mutation deny This will make sure you will add handler to the rule createClinic andisAuthenticated orandisEmployee userExists isAdmin In order to make it work I use these permissions ts const permissions shield Company andisAuthenticated orandisEmployee userExists isAdmin Query deny This will make sure you will add handler to the rule service allow entities allow companies andisAuthenticated isAdmin clinic andisAuthenticated orandisEmployee userExists isAdmin me andisAuthenticated isEmployee Mutation deny This will make sure you will add handler to the rule createClinic andisAuthenticated orandisEmployee userExists isAdmin This is the error I see When I deploy this and graphqlgateway tries to fetch the data for the service it fails with error js message Not Authorised locations Object path service extensions code INTERNALSERVERERROR exception Object Expected behavior deny should not affect default federation fields Bumps handlebars from to details summaryChangelogsummary Sourced from handlebarss changelog v January th Features feat default options for controlling proto access af c This makes it possible to disable the prototype access restrictions added in an error is logged in the console if access to prototype properties is attempted and denied and no explicit configuration has taken place Compatibility notes no compatibilities are expected Commits v January th Features feat access control to prototype properties via whitelist d b ec Bugfixes fixruntimejs partials compile not caching d e Chores docs various refactorings and improvements to tests d f dcf d d f modernize the buildsetup use prettier to format and eslint to verify c d f c e e f f use nyc instead of istanbul to collect coverage b ff ebce b update build code to use modern javascript and make it cleaner b c ec a b e dde e b e a restructur build commands e dc eslint rule changes ac e dc Update C year in the LICENSE file d fb b chore try to fix saucelabs credentials Update readmemd with updated links edcc f BREAKING CHANGES access to prototype properties is forbidden completely by default specific properties or methods can be allow via runtimeoptions See for details If you are using Handlebars as documented you should not be accessing prototype properties from your template anyway so the changes should not be a problem for you Only the use of undocumented features can break your build That is why we only bump the minor version despite mentioning breaking changes Commits trtable truncated details details summaryCommitssummary d c v f b Update release notes d fix use logger instead of consoleerror af c feat default options for controlling proto access a b d v d Update release notes d f dcf refactor fix typo in private test method d test add path to nodeJs when running testbin d f test show diff when testbin fails d b ec feat access control to prototype properties via whitelist Additional commits viewable in compare view details br Dependabot compatibility score Dependabot will resolve any conflicts with this PR as long as you dont alter it yourself You can also trigger a rebase manually by commenting dependabot rebase dependabotautomergestart dependabotautomergeend details summaryDependabot commands and optionssummary br You can trigger Dependabot actions by commenting on this PR dependabot rebase will rebase this PR dependabot recreate will recreate this PR overwriting any edits that have been made to it dependabot merge will merge this PR after your CI passes on it dependabot squash and merge will squash and merge this PR after your CI passes on it dependabot cancel merge will cancel a previously requested merge and block automerging dependabot reopen will reopen this PR if it is closed dependabot ignore this patchminormajor version will close this PR and stop Dependabot creating any more for this minormajor version unless you reopen the PR or upgrade to it yourself dependabot ignore this dependency will close this PR and stop Dependabot creating any more for this dependency unless you reopen the PR or upgrade to it yourself dependabot use these labels will set the current labels as the default for future PRs for this repo and language dependabot use these reviewers will set the current reviewers as the default for future PRs for this repo and language dependabot use these assignees will set the current assignees as the default for future PRs for this repo and language dependabot use this milestone will set the current milestone as the default for future PRs for this repo and language You can disable automated security fix PRs for this repo from the Security Alerts page details Bumps npm from to details summaryRelease notessummary Sourced from npms releases v DEPENDENCIES dba a pacote d f fixgit Do not drop uidgid when executing in rootowned directory isaacs v BUG FIXES fd a ec Fix cache location for npm ci zhenyavinogradov b f cca fixversion using allowsameversion git commit allowempty and git tag f rhengles TESTING e f d testci add failing cache config test ruyadorno f fbf test fix binoverwriting test on Windows isaacs ae f ci Allow builds to run even if one fails XhmikosR a bee Remove the unused appveyoryml XhmikosR ac ci switch to actionscheckoutv XhmikosR DOCUMENTATION f d ac fix netlify publish path config claudiahdz cf update gatsby dependencies felixonmars fb dbb docs clarify usage of global prefix jgehrcke v BUGFIXES ac aee npmbinlinks npmgentlefs Do not remove global binman links inappropriately isaacs DEPENDENCIES fd gentlefs isaacs d f c b binlinks isaacs v DEPENDENCIES ce a binlinks Properly normalize sanitize and verify bin entries in packagejson c aae npmpacklist trtable truncated details details summaryChangelogsummary Sourced from npms changelog DEPENDENCIES dba a pacote d f fixgit Do not drop uidgid when executing in rootowned directory isaacs BUG FIXES fd a ec Fix cache location for npm ci zhenyavinogradov b f cca fixversion using allowsameversion git commit allowempty and git tag f rhengles TESTING e f d testci add failing cache config test ruyadorno f fbf test fix binoverwriting test on Windows isaacs ae f ci Allow builds to run even if one fails XhmikosR a bee Remove the unused appveyoryml XhmikosR ac ci switch to actionscheckoutv XhmikosR DOCUMENTATION f d ac fix netlify publish path config claudiahdz cf update gatsby dependencies felixonmars fb dbb docs clarify usage of global prefix jgehrcke BUGFIXES ac aee npmbinlinks npmgentlefs Do not remove global binman links inappropriately isaacs DEPENDENCIES fd gentlefs isaacs d f c b binlinks isaacs trtable truncated details details summaryCommitssummary ac f c c docs changelog for dba pacote bb e update AUTHORS docs changelog for fb dbb npmlink clarify usage of global prefix b f c featversion using allowsameversion git commit allowempty and git t e a a f chore ci cleanup f fb Fix binoverwriting test on Windows Additional commits viewable in compare view details details summaryMaintainer changessummary This version was pushed to npm by ruyadorno a new releaser for npm since your current version details br Dependabot compatibility score Dependabot will resolve any conflicts with this PR as long as you dont alter it yourself You can also trigger a rebase manually by commenting dependabot rebase dependabotautomergestart dependabotautomergeend details summaryDependabot commands and optionssummary br You can trigger Dependabot actions by commenting on this PR dependabot rebase will rebase this PR dependabot recreate will recreate this PR overwriting any edits that have been made to it dependabot merge will merge this PR after your CI passes on it dependabot squash and merge will squash and merge this PR after your CI passes on it dependabot cancel merge will cancel a previously requested merge and block automerging dependabot reopen will reopen this PR if it is closed dependabot ignore this patchminormajor version will close this PR and stop Dependabot creating any more for this minormajor version unless you reopen the PR or upgrade to it yourself dependabot ignore this dependency will close this PR and stop Dependabot creating any more for this dependency unless you reopen the PR or upgrade to it yourself dependabot use these labels will set the current labels as the default for future PRs for this repo and language dependabot use these reviewers will set the current reviewers as the default for future PRs for this repo and language dependabot use these assignees will set the current assignees as the default for future PRs for this repo and language dependabot use this milestone will set the current milestone as the default for future PRs for this repo and language You can disable automated security fix PRs for this repo from the Security Alerts page details This PR contains the following updates Package Type Update Change semanticrelease devDependencies major Release Notes details summarysemanticreleasesemanticreleasesummary v Compare Source Bug Fixes fetch tags on repo cached by the CI b b e v Compare Source Bug Fixes package update envci to version ab v Compare Source BREAKING CHANGES For v beta users only In v a JSON object stored in a Git note is used to keep track of the channels on which a version has been released the channel suffix is no longer necessary The tags formatted as vversion channel will now be ignored If you have releases using this format you will have to upgrade them Find all the versions that have been released on a branch other than the default one by searching for all tags formatted as vversion channel For each of those version Create a tag without the channel if none doesnt already exists Add a Git note to the tag without the channel containing the channels on which the version was released formatted as channels channel channel and using null for the default channel for examplechannels nullchannel channel Push the tags and notes Update the GitHub releases that refer to a tag formatted as vversion channel to use the tag without it Delete the tags formatted as vversion channel Require Nodejs Git CLI version or higher is now required The merge option of the git tag command has been added in Git version and is now used by semanticrelease Regexp are not supported anymore for property matching in the releaseRules option Regex are replaced by globs For example core should be changed to core The branch option has been removed in favor of branches The new branches option expect either an Array or a single branch definition To migrate your configuration If you want to publish package from multiple branches please see the configuration documentation If you use the default configuration and want to publish only from master nothing to change If you use the branch configuration and want to publish only from one branch replace branch with branches branch myreleasebranch branches myreleasebranch Features allow addChannel plugins to return false in order to signify no release was done e c allow publish plugins to return false in order to signify no release was done f allow to release any version on a branch if up to date with next branch c support multiple branches and distribution channels b use Git notes to store the channels on which a version has been released b c b c package update semanticreleasecommitanalyzer to version e e Performance Improvements use git tag merge branch to filter tags present in a branch history cffe a Bug Fixes add channel to publish success log c e add a flag indicate which branch is the main one caafba Add helpful detail to ERELEASEBRANCHES error message bcc e allow multiple branches with same channel f ae allow to set ci option via API and config file faff call getTagHead only when necessary de a call success plugin only once for releases added to a channel a b correct log when adding channel to tag be correctly determine next prerelease version a correctly determine release to add to a channel aec c correctly handle skipped releases d display erroring git commands properly edae do not call addChannelfor merged branches configured with the same channel aad cd do not create tags in dryrun mode for released to add to a channel c fetch all release branches on CI b fix branch type regexp to handle version with multiple digits ca b fix maintenance branch regex a fix range regexp to handle version with multiple digits a e handle branch properties set to false a f harmonize parameters passed to getError f c ignore lasst release only if prerelease on the same channel as current branch e f increase next version on prerelease branch based on highest commit type ecc a look also for previous prerelease versions to determine the next one modify fetch function to handle CircleCI specifics cbef d on maintenance branch add to channel only version to start range c ae remove confusing logs when searching for releases to add to a channel b b remove hack to workaround GitHub Rebase Merge e b remove unnecessary await a af d simplify gettags algorithm a throws error if the commit associated with a tag cannot be found update plugin versions a update plugins dependencies verify is branch is up to date by comparing remote and local HEAD a c remove unnecessary branch parameter from push function b revert to the correct refspec in fetch function a update plugins dependencies f c repositoryUrl on beta repositoryUrl needs auth for prerelease flows details Renovate configuration date Schedule At any time no schedule defined verticaltrafficlight Automerge Disabled by config Please merge this manually once you are satisfied recycle Rebasing Whenever PR becomes conflicted or if you modify the PR title to begin with rebase nobell Ignore Close this PR and you wont be reminded about this update again rebasecheck If you want to rebaseretry this PR check this box This PR has been generated by WhiteSource Renovate View repository job log here This PR contains the following updates Package Type Update Change husky devDependencies major Release Notes details summarytypicodehuskysummary v Compare Source v Compare Source Fix read stdin from hook script v Compare Source v Compare Source Fix Yarn when running inside winpty v Compare Source Revert change in v v Compare Source Fix use processexit if install fails v Compare Source Fix npm ignore eslintrcjs v Compare Source Fix error message if trying to install in a nongit repo v Compare Source Fix show error message when hook fails v Compare Source Fix make Yarn silent When Husky was installed with Yarn hooks output was too verbose v Compare Source Support Yarn v new PlugnPlay feature thanks to arcanis Improve path handling on Windows in particular with Cygwin and Cmdr Remove dependencies and simplify code Breaking requires Node Thanks to all contributors and everyone who is supporting Husky on Open Collective GitHub sponsors and Patreon details Renovate configuration date Schedule At any time no schedule defined verticaltrafficlight Automerge Disabled by config Please merge this manually once you are satisfied recycle Rebasing Whenever PR becomes conflicted or if you modify the PR title to begin with rebase nobell Ignore Close this PR and you wont be reminded about this update again rebasecheck If you want to rebaseretry this PR check this box This PR has been generated by WhiteSource Renovate View repository job log here Is there a way with GraphQL Shield to apply more advanced caching strategies to rules Lets say I have a user who upgrades their account to give themselves increased permissions At this point Id want to evict the related items in the cache so that they were recalculated Of course Id want to do this across all hosts if my API was running across multiple servers Do you have a recommended approach for such a scenario Hi Im using prisma and nexus I wanted to prevent the field role from User to be written or read by nonadmin users Then I set role from User Object Type to be allowed only for Admins export const permissions shield Mutation createUser isAuth User role isAdmin Nonadmins cant get role field it works smiley The problem here is that Object Type User is being used only by responses Nexus generates a lot of Input Types for User UserWhereInput UserOrderByInput UserUpdateManyMutationInput UserUpdateInput UserCreateInput and every Mutation or Query uses a different one as argument I tried like below but it doesnt work cry User role isAdmin UserWhereInput role isAdmin UserOrderByInput role isAdmin UserUpdateManyMutationInput role isAdmin UserUpdateInput role isAdmin UserCreateInput role isAdmin Do you guys know how to achieve this Bug report Describe the bug Given a schema gql type User name String token String type Thread members User And permissions ts User token someRule When running a query such that it violates the rule gql on Thread members name token Instead of permission error I get an error Cannot return null for nonnullable field Username This seems to have something to do with a specific combination of having a list and nullability settings because here are a few examples of what can be changed either in schema or in a query so that I dont get this issue meaning I get the correct permission error if I request the same fields on a User that is not part of a list gql on User name token if I dont request the name gql on Thread members token if I make name nullable gql type User name String token String if I make User nonnullable in members gql type Thread members User Notes Reproducible on the latest version of graphqlshield Feature request Is your feature request related to a problem Please describe Currently you can supply a fallbackError which is great but we cant really localize any of the error messages in my case because the language is attached to the context I think it would make sense to allow a function inside the fallbackError Describe the solution youd like other settings fallbackError args ctx info Perform localization or do custom logic Bug report Describe the bug When running the example withgraphqlnexus there are a few problems The datamodelprisma seems to be out of date id modifier should be on the Users id tag createdAt and updatedAt should be added as well The dockercomposeyml has to have the version updated with the current prisma cli as well When we run prisma deploy it doesnt generate the srcgeneratednexusprisma directory Which gives an error for the module not being found when running yarn start To Reproduce Steps to reproduce the behavior please provide code snippets or a repository The deployment steps in the README of withgraphqlnexus along with the fixes and above On the step with yarn start I get the error below which I found is because the srcgeneratednexusprisma directory isnt generated with prisma deploy ts Error Cannot find module generatednexusprisma at FunctionModuleresolveFilename internalmodulescjsloaderjs at FunctionModuleload internalmodulescjsloaderjs at Modulerequire internalmodulescjsloaderjs at require internalmodulescjshelpersjs at Objectanonymous UsersalnimDownloadsgraphqlshieldexampleswithgraphqlnexussrcschemaindexjs at Modulecompile internalmodulescjsloaderjs at ObjectModuleextensionsjs internalmodulescjsloaderjs at Moduleload internalmodulescjsloaderjs at tryModuleLoad internalmodulescjsloaderjs at FunctionModuleload internalmodulescjsloaderjs Expected behavior yarn start should start the node server with no errors prisma deploy should generate the nexusprisma directory