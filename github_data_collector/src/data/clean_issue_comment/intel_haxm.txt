Hello Hope this projects Github Issues is an acceptable place for what would normally be asked by IRC or a Discussions style Forum Am unclear on exactly how HAXM compares to and is implemented on systems which might already have various emulators and hypervisors installed The Project home page describes HAXM as an Intelspecific hypervisor Subject to the limitations described during installation eg HyperV must be disabled CPU must be post core models Does this mean that HAXM is virtualization tools agnostic Does this mean then that any virtualization Usermode tools can be used to create a virtual machine on this hypervisor Does this mean that HAXM automatically becomes the preferred hypervisor over a hypervisor that might have been installed by a virtualization technology Or does HAXM provide some kind of enhanced hardware acceleration for whatever virtualization technology or emulator thats installed Example If a system already has VMware or Virtualbox installed if HAXIM is installed what is the result The VMware or Virtualbox hypervisor is superceded by the HAXIM hypervisor The VMware or Virtualbox hypervisor is used but is enhanced by the HAXIM hypervisor or driver Ive never really heard of multiple hypervisors used simultaneously QEMU has the capability to emulate alien architectures different than the HostOS and my understanding is implemented in the hypervisor HAXIM seems to also have this capability for instance supporting Android ARM on x x Does this mean that this capability is also extended to virtualzation technologies that normally does not have this capability like VMware and Virtualbox Thank you Some fail cases in haxcreatevm may call old EPT implementation which are not expected Separate oldnew EPT routines with CONFIGHAXEPT so that only one approarch is enabled at same time Signedoffby Colin Xu colinxuintelcom Random and rear reproduce Locally built pdb used Again Since there no shared release pdb HAXM version Release driver DriverVer x Host OS version Win x Host OS architecture x Guest OS version Win x BUGCHECKP c BUGCHECKP fffff d BUGCHECKP ffffa f c BUGCHECKP EXCEPTIONCODE NTSTATUS x dcb Unable to get error code text FAULTINGIP IntelHaxmdecodeopmodrmrm c git haxm core emulatec fffff d f cmp qword ptr rdi h CONTEXT ffffa f c cxr xffffa f c rax rbxffffb dc da rcxffffb dc da rdx d rsiffffb dda f rdi ripfffff d rspffffa f rbp r fcffffffffffffff r ffffb dda f r ffffb dda f r c r r r ffffb dddf r iopl nv up ei ng nz na po nc cs ss ds b es b fs gs b efl IntelHaxmdecodeopmodrmrm x fffff d f cmp qword ptr rdi h ds b Resetting default scope BUGCHECKSTR DCB CPUCOUNT CPUMHZ af CPUVENDOR GenuineIntel CPUFAMILY CPUMODEL e CPUSTEPPING a CPUMICROCODE FMSR SIG cache init BLACKBOXBSD blackboxbsd BLACKBOXNTFS blackboxntfs BLACKBOXPNP blackboxpnp BLACKBOXWINLOGON CURRENTIRQL ANALYSISSESSIONHOST WS UT ANALYSISSESSIONTIME ANALYSISVERSION amd fre LASTCONTROLTRANSFER from fffff d fa fa to fffff d STACKTEXT ffffa f fffff d fa fa ffffb dc da ffffb dda f ffffb dc e IntelHaxmdecodeopmodrmrm x c git haxm core emulatec ffffa f fffff d f b ffffb de bc ffffb dc cc d IntelHaxmhaxlistadd xa c git haxm include haxlisth ffffa f b fffff d f b ffffb de bc ffffb dddf IntelHaxmhaxwinconstructssdl x c git haxm platforms windows componentsc ffffa f f fffff f c ffffb de bc IntelHaxmDriverEntry xb c git haxm platforms windows haxentryc ffffa f fffff de e ffffa f a ffffb de bc ffffb dddf ntIofCallDriver x ffffa f fffff de f ffffa f a ffffb de bc ffffa f a ntNtDeviceIoControlFile xe ffffa f fffff de c c e ntNtDeviceIoControlFile xc ffffa f fffff d d ntNtDeviceIoControlFile x ffffa f ff c a ntsetjmpex x b f x ff c a THREADSHA HASHMODFUNC f c fc f d cccfb d b d c a e cd THREADSHA HASHMODFUNCOFFSET c b cf cd aaf f c c dfed THREADSHA HASHMOD ef a bdb c f b e f FOLLOWUPIP IntelHaxmdecodeopmodrmrm c git haxm core emulatec fffff d f cmp qword ptr rdi h FAULTINSTRCODE f FAULTINGSOURCELINE c git haxm core emulatec FAULTINGSOURCEFILE c git haxm core emulatec FAULTINGSOURCELINENUMBER TARGETTIME T Z OSBUILD OSSERVICEPACK SERVICEPACKNUMBER OSREVISION SUITEMASK PRODUCTTYPE OSPLATFORMTYPE x OSNAME Windows OSEDITION Windows WinNt TerminalServer SingleUserTS Comments to csar and trar validity checking stating that these can be wrong set by qemu But the checks were done before every vmentry with reading the values from vmcs and that is bad for performance I moved the checks to vcpusetregs since qemu sets them through this function I did not found any other places that write these to vmcs Im trying to load Ubuntu bionic cloud image with QEmu and HAX acceleration Usually the image loads correctly while once HAX is enabled the boot hangs without any details QEMU version v g a ecf fdirty QEMU command line qemusystemx d guesterrors m drive filecloudimageqcow ifvirtio noacpi nohpet display gtk boot c drive filecloudinitisomediacdrom serial stdio machine accelhax OS Host Windows bit HyperV disabled VT support yes NX support yes OS Guest Linux generic Ubuntu x On output I just see HAX is working and emulator runs in fast virt mode and nothing more PDPTE values are not restored after snapshot loading I added PDPTE values reading from guest memory and write these to vmcs after all EFER writes and control register writes from qemu since these can change memory mode to use PDPTES Open questions Is it necessary to set the checkpaepdpt after memory load from qemu It is theoretically possible not changing CRs and MSRs from qemu but change memory at location pointed by CR Should we assume this scenario Random and rear reproduce Please provide pdb for better callstack HAXM version Release driver DriverVer x Host OS version Win x Host OS architecture x Guest OS version Win x Bugcheck Analysis SYSTEMSERVICEEXCEPTION b An exception happened while executing a system service routine Arguments Arg c Exception code that caused the bugcheck Arg fffff d f f Address of the instruction which caused the bugcheck Arg ffffdc bbe c Address of the context record for the exception that caused the bugcheck Arg zero Debugging Details KEYVALUESSTRING PROCESSESANALYSIS SERVICEANALYSIS STACKHASHANALYSIS TIMELINEANALYSIS DUMPCLASS DUMPQUALIFIER BUILDVERSIONSTRING amd fre h release SYSTEMMANUFACTURER System manufacturer SYSTEMPRODUCTNAME System Product Name SYSTEMSKU ASUSMBCNL SYSTEMVERSION System Version BIOSVENDOR American Megatrends Inc BIOSVERSION BIOSDATE BASEBOARDMANUFACTURER ASUSTeK COMPUTER INC BASEBOARDPRODUCT PRIME B PLUS BASEBOARDVERSION Rev xx DUMPTYPE BUGCHECKP c BUGCHECKP fffff d f f BUGCHECKP ffffdc bbe c BUGCHECKP EXCEPTIONCODE NTSTATUS xc The instruction at xp referenced memory at xp The memory could not be s FAULTINGIP IntelHaxm f f fffff d f f f cmp qword ptr rdi h CONTEXT ffffdc bbe c cxr xffffdc bbe c rax rbxffffa a b d rcxffffa a b d rdx rsiffffa a b c e rdi ripfffff d f f rspffffdc bbe rbp r fffcffffffffffff r ffffa a b c r ffffa a b c d r r r r ffffa a fd a r iopl nv up ei ng nz na po nc cs ss ds b es b fs gs b efl IntelHaxm x f f fffff d f f f cmp qword ptr rdi h ds b Resetting default scope BUGCHECKSTR x Bc CPUCOUNT CPUMHZ af CPUVENDOR GenuineIntel CPUFAMILY CPUMODEL e CPUSTEPPING a CPUMICROCODE ea FMSR SIG cache init BLACKBOXBSD blackboxbsd BLACKBOXNTFS blackboxntfs BLACKBOXPNP blackboxpnp BLACKBOXWINLOGON DEFAULTBUCKETID WIN DRIVERFAULT PROCESSNAME qemusystemx exe CURRENTIRQL ANALYSISSESSIONHOST xxxx ANALYSISSESSIONTIME ANALYSISVERSION amd fre LASTCONTROLTRANSFER from fffff d e to fffff d f f STACKTEXT ffffdc bbe fffff d e ffffa a b d ffffa a b c e ffffa a b df IntelHaxm x f f ffffdc bbe fffff d ffffa a ec ffffa a c c IntelHaxm x e ffffdc bbe b fffff d b ffffa a ec ffffa a fd a IntelHaxm x ffffdc bbe f fffff e f c ffffa a ec IntelHaxm x b ffffdc bbe fffff e f ffffdc bbe a ffffa a ec ffffa a fd a ntIofCallDriver x ffffdc bbe fffff e ffffdc bbe a ffffa a ec ffffdc bbe a ntIopSynchronousServiceTail x a ffffdc bbe fffff e d d e ntIopXxxControlFile xc ffffdc bbe fffff fd b ntNtDeviceIoControlFile x ffffdc bbe ffffa fc a ntKiSystemServiceCopyEnd x f x ffffa fc a THREADSHA HASHMODFUNC ef ea d b bac ac d d d db THREADSHA HASHMODFUNCOFFSET ba e cc f b a c f f a f b THREADSHA HASHMOD ef a bdb c f b e f FOLLOWUPIP IntelHaxm f f fffff d f f f cmp qword ptr rdi h FAULTINSTRCODE f SYMBOLSTACKINDEX SYMBOLNAME IntelHaxm f f FOLLOWUPNAME MachineOwner MODULENAME IntelHaxm IMAGENAME IntelHaxmsys DEBUGFLRIMAGETIMESTAMP d da f STACKCOMMAND cxr xffffdc bbe c kb BUCKETIDFUNCOFFSET f f FAILUREBUCKETID x Bc IntelHaxmunknownfunction BUCKETID x Bc IntelHaxmunknownfunction PRIMARYPROBLEMCLASS x Bc IntelHaxmunknownfunction TARGETTIME T Z OSBUILD OSSERVICEPACK SERVICEPACKNUMBER OSREVISION SUITEMASK PRODUCTTYPE OSPLATFORMTYPE x OSNAME Windows OSEDITION Windows WinNt TerminalServer SingleUserTS OSLOCALE USERLCID OSBUILDTIMESTAMP unknowndate BUILDDATESTAMPSTR BUILDLABSTR h release BUILDOSVERSTR amd fre h release ANALYSISSESSIONELAPSEDTIME e ANALYSISSOURCE KM FAILUREIDHASHSTRING km x bc intelhaxmunknownfunction FAILUREIDHASH ba f bc ba bbd ce cc c ca b Followup MachineOwner Hello friends I want to learn to program in Android and I have choosen LiveCode Is there a package that contains LiveCode JDK and Android SDK in a similar way to WAMP andor JoomlaSpanishServer I ask this because I am having trouble with Android HAXM Logging started This computer does not support Intel Virtualization Technology VTx or it is being exclusively used by HyperV HAXM cannot be installed Please ensure HyperV is disabled in Windows Features or refer to the Intel HAXM documentation for more information Logging stopped Java SE Development Kit u androidstudioide windows zip Intel HAXM installer HiperV When I read about how to install HAXM I see things as Visual Studio Universal Windows Platform development Desktop development with C Windows SDK for Windows Windows Driver Kit WDK for Windows Note that the Windows SDK installed by Visual Studio may not be the latest version Enterprise WDK EWDK with Visual Studio Build Tools NuGet CLI tool nugetexe version x or later But I only want to run LiveCode x and make programs in it Thanks HERNAN Hello friends I decompress haxmwindowsv zip and run silentinstallbat haxmsilentrunlog Logging started This computer does not support Intel Virtualization Technology VTx or it is being exclusively used by HyperV HAXM cannot be installed Please ensure HyperV is disabled in Windows Features or refer to the Intel HAXM documentation for more information Logging stopped Could you say me how can I procceed please HERNAN Android Virtual Device AVD instance crashed blue screened the SurfacePro W version OS Build BugCheck A cafc ff a fffff d a ERROR Module load completed but symbols could not be loaded for IntelHaxmsys Probably caused by IntelHaxmsys IntelHaxm a Bugcheck Analysis IRQLNOTLESSOREQUAL a An attempt was made to access a pageable or completely invalid address at an interrupt request level IRQL that is too high This is usually caused by drivers using improper addresses If a kernel debugger is available get the stack backtrace Arguments Arg cafc memory referenced Arg ff IRQL Arg a bitfield bit value read operation write operation bit value not an execute operation execute operation only on chips which support this level of status Arg fffff d a address which referenced memory Debugging Details DUMPCLASS DUMPQUALIFIER BUILDVERSIONSTRING amd fre h release SYSTEMMANUFACTURER Microsoft Corporation SYSTEMPRODUCTNAME Surface Pro SYSTEMSKU SurfacePro SYSTEMVERSION D B F C P BIOSVENDOR Microsoft Corporation BIOSVERSION BIOSDATE BASEBOARDMANUFACTURER Microsoft Corporation BASEBOARDPRODUCT Surface Pro DUMPTYPE BUGCHECKP cafc BUGCHECKP ff BUGCHECKP a BUGCHECKP fffff d a READADDRESS Unable to get offset of ntMIVISIBLESTATESpecialPool Unable to get value of ntMIVISIBLESTATESessionSpecialPool cafc CURRENTIRQL FAULTINGIP ntIopCompleteRequestf fffff d a mov qword ptr rcx rax CPUCOUNT CPUMHZ a CPUVENDOR GenuineIntel CPUFAMILY CPUMODEL e CPUSTEPPING CPUMICROCODE e FMSR SIG CC cache CC init DEFAULTBUCKETID WIN DRIVERFAULT BUGCHECKSTR AV PROCESSNAME qemusystemx exe ANALYSISSESSIONHOST SURFACEPRO ANALYSISSESSIONTIME ANALYSISVERSION amd fre IRPADDRESS ffffffffffffff TRAPFRAME fffffe fbf f trap xfffffe fbf f NOTE The trap frame does not contain all registers Some register values may be zeroed or incorrect rax rbx rcx cafc rdxfffffe fbf f rsi rdi ripfffff d a rspfffffe fbf f f rbpfffffe fbf f r fffffe fbf f r fffffe fbf f r fffff d r r r r r iopl nv up di pl zr na po nc ntIopCompleteRequest xf fffff d a mov qword ptr rcx rax ds cafc Resetting default scope LASTCONTROLTRANSFER from fffff d ce e to fffff d bc STACKTEXT fffffe fbf f fffff d ce e a cafc ff a ntKeBugCheckEx fffffe fbf f fffff d caa b fffff a ntKiBugCheckDispatch x fffffe fbf f fffff d a ffff f cb a ba ntKiPageFault x b fffffe fbf f f fffff d d d ffff f cc ffff f ffff f ntIopCompleteRequest xf fffffe fbf f e fffff d f ffffffff ffff f ntKiDeliverApc x d fffffe fbf f a fffff d b ffff f cc ff e c f c ffff f cc ffff ec e ntKiExitDispatcher x fffffe fbf f fffff d b fff f d ntIopfCompleteRequest x b fffffe fbf f fffff a a ffff f d ffff f ced ntIofCompleteRequest x fffffe fbf f fffff a f ffff f ced fffffe fbf f ffff f ffff f IntelHaxm x a fffffe fbf f d fffff d cc ffff f IntelHaxm x f fffffe fbf f fffff dbeb c fffffe fbf fa ffff f ced ffff f ntIofCallDriver x fffffe fbf f fffff dbeb a ffff f fffffe fbf fa ntIopSynchronousServiceTail x a fffffe fbf f e fffff dbeaa ntIopXxxControlFile x ca fffffe fbf f fffff d ce ntNtDeviceIoControlFile x fffffe fbf f ffb fbc ntKiSystemServiceCopyEnd x cafc x ffb fbc STACKCOMMAND kb THREADSHA HASHMODFUNC fa e ed bb db bc bcdc ff f THREADSHA HASHMODFUNCOFFSET b fd f db b e e f THREADSHA HASHMOD d e b f e e f af b c FOLLOWUPIP IntelHaxm a fffff a a ed test rbprbp FAULTINSTRCODE ed SYMBOLSTACKINDEX SYMBOLNAME IntelHaxm a FOLLOWUPNAME MachineOwner MODULENAME IntelHaxm IMAGENAME IntelHaxmsys DEBUGFLRIMAGETIMESTAMP cb c BUCKETIDFUNCOFFSET a FAILUREBUCKETID AVCODEAVIntelHaxmunknownfunction BUCKETID AVCODEAVIntelHaxmunknownfunction PRIMARYPROBLEMCLASS AVCODEAVIntelHaxmunknownfunction TARGETTIME T Z OSBUILD OSSERVICEPACK SERVICEPACKNUMBER OSREVISION SUITEMASK PRODUCTTYPE OSPLATFORMTYPE x OSNAME Windows OSEDITION Windows WinNt TerminalServer SingleUserTS OSLOCALE USERLCID OSBUILDTIMESTAMP BUILDDATESTAMPSTR BUILDLABSTR h release BUILDOSVERSTR amd fre h release ANALYSISSESSIONELAPSEDTIME f ANALYSISSOURCE KM FAILUREIDHASHSTRING kmavcodeavintelhaxmunknownfunction FAILUREIDHASH dde c a a bffe d a c Followup MachineOwner 