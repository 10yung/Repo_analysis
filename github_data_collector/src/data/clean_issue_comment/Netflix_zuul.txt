I use zuul oauth and jwt to construct a sso system An error was reported when requesting the application interface zuul config spring application name zuulserver server port useforwardheaders true eureka client serviceUrl defaultZone instance preferipaddress true zuul routes clienta path demo serviceId clientdemo authserver path auth serviceId authserver stripPrefix true sensitiveheaders CookieSetCookie security oauth client accesstokenuri userauthorizationuri clientid epxingauth clientsecret epxing granttype password granttype authorizationcode resource jwt keyvalue epxing sso loginpath authserverauthlogin authorization checktokenaccess logging level orgspringframeworksecurity debug comnetflix DEBUG logback logenvprofile dev logenvmodule epxingzuul logenvloggerlevel info WebSecurityConfigurerAdapter config Configuration Order EnableWebSecurity EnableOAuth Sso public class ZuulWebSecurityConfigurerAdapter extends WebSecurityConfigurerAdapter Override protected void configureHttpSecurity http throws Exception http authorizeRequests antMatchersBaseConstantsLOGINURLauthserverauth permitAll anyRequest authenticated and csrf disable sessionManagementsessionCreationPolicySessionCreationPolicySTATELESSand URL logout logoutlogoutUrlBaseConstantsLOGOUTURLpermitAll logoutSuccessUrlBaseConstantsLOGINURLpermitAll ERROR DEBUG nio exec osswaExceptionTranslationFilter Calling Authentication entry point DEBUG nio exec osswaHttp ForbiddenEntryPoint Preauthenticated entry point called Rejecting access DEBUG nio exec osswheaderwritersHstsHeaderWriter Not injecting HSTS header since it did not match the requestMatcher orgspringframeworksecuritywebheaderwritersHstsHeaderWriterSecureRequestMatcher b fa DEBUG nio exec sswcSecurityContextPersistenceFilter SecurityContextHolder now cleared as request processing completed DEBUG nio exec ossecuritywebFilterChainProxy error at position of in additional filter chain firing Filter WebAsyncManagerIntegrationFilter DEBUG nio exec ossecuritywebFilterChainProxy error at position of in additional filter chain firing Filter SecurityContextPersistenceFilter DEBUG nio exec ossecuritywebFilterChainProxy error at position of in additional filter chain firing Filter HeaderWriterFilter DEBUG nio exec ossecuritywebFilterChainProxy error at position of in additional filter chain firing Filter LogoutFilter DEBUG nio exec osswebutilmatcherOrRequestMatcher Trying to match using Ant patternauthserverauthlogout GET DEBUG nio exec osswumatcherAntPathRequestMatcher Checking match of request error against authserverauthlogout DEBUG nio exec osswebutilmatcherOrRequestMatcher Trying to match using Ant patternauthserverauthlogout POST DEBUG nio exec osswumatcherAntPathRequestMatcher Request GET error doesnt match POST authserverauthlogout DEBUG nio exec osswebutilmatcherOrRequestMatcher Trying to match using Ant patternauthserverauthlogout PUT DEBUG nio exec osswumatcherAntPathRequestMatcher Request GET error doesnt match PUT authserverauthlogout DEBUG nio exec osswebutilmatcherOrRequestMatcher Trying to match using Ant patternauthserverauthlogout DELETE DEBUG nio exec osswumatcherAntPathRequestMatcher Request GET error doesnt match DELETE authserverauthlogout DEBUG nio exec osswebutilmatcherOrRequestMatcher No matches found DEBUG nio exec ossecuritywebFilterChainProxy error at position of in additional filter chain firing Filter RequestCacheAwareFilter DEBUG nio exec ossecuritywebFilterChainProxy error at position of in additional filter chain firing Filter SecurityContextHolderAwareRequestFilter DEBUG nio exec ossecuritywebFilterChainProxy error at position of in additional filter chain firing Filter AnonymousAuthenticationFilter DEBUG nio exec osswaAnonymousAuthenticationFilter Populated SecurityContextHolder with anonymous token orgspringframeworksecurityauthenticationAnonymousAuthenticationToken cf ec Principal anonymousUser Credentials PROTECTED Authenticated true Details orgspringframeworksecuritywebauthenticationWebAuthenticationDetailsfffde d RemoteIpAddress SessionId CB F A C BD F FC DCAECE Granted Authorities ROLEANONYMOUS DEBUG nio exec ossecuritywebFilterChainProxy error at position of in additional filter chain firing Filter SessionManagementFilter DEBUG nio exec ossecuritywebFilterChainProxy error at position of in additional filter chain firing Filter ExceptionTranslationFilter DEBUG nio exec ossecuritywebFilterChainProxy error at position of in additional filter chain firing Filter FilterSecurityInterceptor DEBUG nio exec ossecuritywebFilterChainProxy error reached end of additional filter chain proceeding with original chain DEBUG nio exec osswaExceptionTranslationFilter Chain processed normally DEBUG nio exec sswcSecurityContextPersistenceFilter SecurityContextHolder now cleared as request processing completed DEBUG nio exec ossecuritywebFilterChainProxy clientdemoapiproduct at position of in additional filter chain firing Filter WebAsyncManagerIntegrationFilter DEBUG nio exec ossecuritywebFilterChainProxy clientdemoapiproduct at position of in additional filter chain firing Filter SecurityContextPersistenceFilter DEBUG nio exec ossecuritywebFilterChainProxy clientdemoapiproduct at position of in additional filter chain firing Filter HeaderWriterFilter DEBUG nio exec ossecuritywebFilterChainProxy clientdemoapiproduct at position of in additional filter chain firing Filter LogoutFilter DEBUG nio exec osswebutilmatcherOrRequestMatcher Trying to match using Ant patternauthserverauthlogout GET DEBUG nio exec osswumatcherAntPathRequestMatcher Checking match of request clientdemoapiproduct against authserverauthlogout DEBUG nio exec osswebutilmatcherOrRequestMatcher Trying to match using Ant patternauthserverauthlogout POST DEBUG nio exec osswumatcherAntPathRequestMatcher Request GET clientdemoapiproduct doesnt match POST authserverauthlogout DEBUG nio exec osswebutilmatcherOrRequestMatcher Trying to match using Ant patternauthserverauthlogout PUT DEBUG nio exec osswumatcherAntPathRequestMatcher Request GET clientdemoapiproduct doesnt match PUT authserverauthlogout DEBUG nio exec osswebutilmatcherOrRequestMatcher Trying to match using Ant patternauthserverauthlogout DELETE DEBUG nio exec osswumatcherAntPathRequestMatcher Request GET clientdemoapiproduct doesnt match DELETE authserverauthlogout DEBUG nio exec osswebutilmatcherOrRequestMatcher No matches found DEBUG nio exec ossecuritywebFilterChainProxy clientdemoapiproduct at position of in additional filter chain firing Filter RequestCacheAwareFilter DEBUG nio exec ossecuritywebFilterChainProxy clientdemoapiproduct at position of in additional filter chain firing Filter SecurityContextHolderAwareRequestFilter DEBUG nio exec ossecuritywebFilterChainProxy clientdemoapiproduct at position of in additional filter chain firing Filter AnonymousAuthenticationFilter DEBUG nio exec osswaAnonymousAuthenticationFilter Populated SecurityContextHolder with anonymous token orgspringframeworksecurityauthenticationAnonymousAuthenticationToken cf ec Principal anonymousUser Credentials PROTECTED Authenticated true Details orgspringframeworksecuritywebauthenticationWebAuthenticationDetailsfffde d RemoteIpAddress SessionId CB F A C BD F FC DCAECE Granted Authorities ROLEANONYMOUS DEBUG nio exec ossecuritywebFilterChainProxy clientdemoapiproduct at position of in additional filter chain firing Filter SessionManagementFilter DEBUG nio exec ossecuritywebFilterChainProxy clientdemoapiproduct at position of in additional filter chain firing Filter ExceptionTranslationFilter DEBUG nio exec ossecuritywebFilterChainProxy clientdemoapiproduct at position of in additional filter chain firing Filter FilterSecurityInterceptor DEBUG nio exec osswebutilmatcherOrRequestMatcher Trying to match using Ant patternauthserverauthlogout GET DEBUG nio exec osswumatcherAntPathRequestMatcher Checking match of request clientdemoapiproduct against authserverauthlogout DEBUG nio exec osswebutilmatcherOrRequestMatcher Trying to match using Ant patternauthserverauthlogout POST DEBUG nio exec osswumatcherAntPathRequestMatcher Request GET clientdemoapiproduct doesnt match POST authserverauthlogout DEBUG nio exec osswebutilmatcherOrRequestMatcher Trying to match using Ant patternauthserverauthlogout PUT DEBUG nio exec osswumatcherAntPathRequestMatcher Request GET clientdemoapiproduct doesnt match PUT authserverauthlogout DEBUG nio exec osswebutilmatcherOrRequestMatcher Trying to match using Ant patternauthserverauthlogout DELETE DEBUG nio exec osswumatcherAntPathRequestMatcher Request GET clientdemoapiproduct doesnt match DELETE authserverauthlogout DEBUG nio exec osswebutilmatcherOrRequestMatcher No matches found DEBUG nio exec osswumatcherAntPathRequestMatcher Checking match of request clientdemoapiproduct against authserverauthlogin DEBUG nio exec osswumatcherAntPathRequestMatcher Checking match of request clientdemoapiproduct against authserverauth DEBUG nio exec osswumatcherAntPathRequestMatcher Checking match of request clientdemoapiproduct against authserverauthoauthtoken DEBUG nio exec osswaiFilterSecurityInterceptor Secure object FilterInvocation URL clientdemoapiproduct Attributes authenticated DEBUG nio exec osswaiFilterSecurityInterceptor Previously Authenticated orgspringframeworksecurityauthenticationAnonymousAuthenticationToken cf ec Principal anonymousUser Credentials PROTECTED Authenticated true Details orgspringframeworksecuritywebauthenticationWebAuthenticationDetailsfffde d RemoteIpAddress SessionId CB F A C BD F FC DCAECE Granted Authorities ROLEANONYMOUS DEBUG nio exec ossaccessvoteAffirmativeBased Voter orgspringframeworksecuritywebaccessexpressionWebExpressionVoter e returned DEBUG nio exec osswaExceptionTranslationFilter Access is denied user is anonymous redirecting to authentication entry point orgspringframeworksecurityaccessAccessDeniedException Access is denied at orgspringframeworksecurityaccessvoteAffirmativeBaseddecideAffirmativeBasedjava at orgspringframeworksecurityaccessinterceptAbstractSecurityInterceptorbeforeInvocationAbstractSecurityInterceptorjava at orgspringframeworksecuritywebaccessinterceptFilterSecurityInterceptorinvokeFilterSecurityInterceptorjava at orgspringframeworksecuritywebaccessinterceptFilterSecurityInterceptordoFilterFilterSecurityInterceptorjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebaccessExceptionTranslationFilterdoFilterExceptionTranslationFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebsessionSessionManagementFilterdoFilterSessionManagementFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebauthenticationAnonymousAuthenticationFilterdoFilterAnonymousAuthenticationFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebservletapiSecurityContextHolderAwareRequestFilterdoFilterSecurityContextHolderAwareRequestFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebsavedrequestRequestCacheAwareFilterdoFilterRequestCacheAwareFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebauthenticationlogoutLogoutFilterdoFilterLogoutFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebheaderHeaderWriterFilterdoFilterInternalHeaderWriterFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebcontextSecurityContextPersistenceFilterdoFilterSecurityContextPersistenceFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebcontextrequestasyncWebAsyncManagerIntegrationFilterdoFilterInternalWebAsyncManagerIntegrationFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebFilterChainProxydoFilterInternalFilterChainProxyjava at orgspringframeworksecuritywebFilterChainProxydoFilterFilterChainProxyjava at orgspringframeworkwebfilterDelegatingFilterProxyinvokeDelegateDelegatingFilterProxyjava at orgspringframeworkwebfilterDelegatingFilterProxydoFilterDelegatingFilterProxyjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkwebfilterRequestContextFilterdoFilterInternalRequestContextFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworksecurityoauth clientfilterOAuth ClientContextFilterdoFilterOAuth ClientContextFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkwebfilterHttpPutFormContentFilterdoFilterInternalHttpPutFormContentFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkwebfilterHiddenHttpMethodFilterdoFilterInternalHiddenHttpMethodFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkbootactuatemetricswebservletWebMvcMetricsFilterfilterAndRecordMetricsWebMvcMetricsFilterjava at orgspringframeworkbootactuatemetricswebservletWebMvcMetricsFilterfilterAndRecordMetricsWebMvcMetricsFilterjava at orgspringframeworkbootactuatemetricswebservletWebMvcMetricsFilterdoFilterInternalWebMvcMetricsFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkwebfilterCharacterEncodingFilterdoFilterInternalCharacterEncodingFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgapachecatalinacoreStandardWrapperValveinvokeStandardWrapperValvejava at orgapachecatalinacoreStandardContextValveinvokeStandardContextValvejava at orgapachecatalinaauthenticatorAuthenticatorBaseinvokeAuthenticatorBasejava at orgapachecatalinacoreStandardHostValveinvokeStandardHostValvejava at orgapachecatalinavalvesErrorReportValveinvokeErrorReportValvejava at orgapachecatalinacoreStandardEngineValveinvokeStandardEngineValvejava at orgapachecatalinavalvesRemoteIpValveinvokeRemoteIpValvejava at orgapachecatalinaconnectorCoyoteAdapterserviceCoyoteAdapterjava at orgapachecoyotehttp Http ProcessorserviceHttp Processorjava at orgapachecoyoteAbstractProcessorLightprocessAbstractProcessorLightjava at orgapachecoyoteAbstractProtocolConnectionHandlerprocessAbstractProtocoljava at orgapachetomcatutilnetNioEndpointSocketProcessordoRunNioEndpointjava at orgapachetomcatutilnetSocketProcessorBaserunSocketProcessorBasejava at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava at orgapachetomcatutilthreadsTaskThreadWrappingRunnablerunTaskThreadjava at javalangThreadrunThreadjava Request with token postman back info timestamp T status error Forbidden message Access Denied path clientdemoapiproduct Since there is no longer a tag in the repo all links in the wiki broke unintentionally If Github allowed PRs to wikis benefit of having all md files within the repo instead of the built in Wiki IMO I would have created a PR to fix this issue instead below is a diff of what I think fixes this no longer resolves to source code and instead should be Attached is a git diff replacing all links with master update linkspatchzip How does websocket connect to the backend cluster through zuul I tried a lot of online configurations but found that they are not available There are too few examples of zuul configuration to support websocket can you help me See NOTE not sure if this is a bug or a misuse of the zuul server Affected Version comnetflixzuulzuulcore Context Running instances of zuul server part of integration tests using Junit Steps Create an integration test that creates a new instance of a Zuul server at the beginning of each test and tears it down at the end of each test Make sure that there are at least two tests method in the test class so that there will be two zuul instances created one after the other Run the test class Expected Result No errors same behavior as with version What happened instead Using version the following PassportStateServerHandler spectator related precondition exception is now thrown when the second test method is executed ie when the second zuul server is started WARN ionettychannelChannelInitializer SalamanderClientToZuulWorker Failed to initialize a channel Closing id x dc a L R javalangIllegalStateException registry already set at comgooglecommonbasePreconditionscheckStatePreconditionsjava at comnetflixzuulnettyinsightsPassportStateServerHandlersetRegistryPassportStateServerHandlerjava at comnetflixzuulnettyserverBaseZuulChannelInitializeraddPassportHandlerBaseZuulChannelInitializerjava at comnetflixzuulnettyserverZuulServerChannelInitializerinitChannelZuulServerChannelInitializerjava at ionettychannelChannelInitializerinitChannelChannelInitializerjava at ionettychannelChannelInitializerhandlerAddedChannelInitializerjava at ionettychannelAbstractChannelHandlerContextcallHandlerAddedAbstractChannelHandlerContextjava at ionettychannelDefaultChannelPipelinecallHandlerAdded DefaultChannelPipelinejava at ionettychannelDefaultChannelPipelineaccess DefaultChannelPipelinejava at ionettychannelDefaultChannelPipelinePendingHandlerAddedTaskexecuteDefaultChannelPipelinejava at ionettychannelDefaultChannelPipelinecallHandlerAddedForAllHandlersDefaultChannelPipelinejava at ionettychannelDefaultChannelPipelineinvokeHandlerAddedIfNeededDefaultChannelPipelinejava at ionettychannelAbstractChannelAbstractUnsaferegister AbstractChanneljava at ionettychannelAbstractChannelAbstractUnsafeaccess AbstractChanneljava at ionettychannelAbstractChannelAbstractUnsafe runAbstractChanneljava at ionettyutilconcurrentAbstractEventExecutorsafeExecuteAbstractEventExecutorjava at ionettyutilconcurrentSingleThreadEventExecutorrunAllTasksSingleThreadEventExecutorjava at ionettychannelkqueueKQueueEventLooprunKQueueEventLoopjava at ionettyutilconcurrentSingleThreadEventExecutor runSingleThreadEventExecutorjava at ionettyutilinternalThreadExecutorMap runThreadExecutorMapjava at ionettyutilconcurrentFastThreadLocalRunnablerunFastThreadLocalRunnablejava at javalangThreadrunThreadjava Analysis The exception seems to be thrown by a precondition related to a static registry field used for analytics purposes ie spectator So this new check makes it impossible to instantiate multiple zuul servers within the same JVM instance Not sure if it ever was May be it is just not supported I was wondering if you had any workaround to suggest for running zuul instances in the context of integration tests I am thinking of using reflection to reset the registry to null at the beginning of each test since spectator is not really important in my integration test anyway Any thoughts I have three services A frontend service B Gateway Service C backend websocket service When B service is not used a and C can be connected by websocket After B service is added a connection B can not be forwarded to C Zuul doesnt support this Or is there a problem with the configuration Page error reporting chat WebSocket connection to ws xiyiwebsocketcallPhoneid failed Error during WebSocket handshake Unexpected response code A frontend service ws new WebSocketws callPhoneid id C background service websocket address ws new WebSocketws xiyiwebsocketcallPhoneid id B gateway service address wsonopen function Web Socket send consolelog wssend B Gateway Service zuul zuul routes websocket zhinengwebsocket path xiyiwebsocket serviceId zhinengwebsocketlocal Component Slf j public class AdminAuthorizationPreFilter extends ZuulFilter Override public String filterType return pre Override public int filterOrder return Override public boolean shouldFilter return true Override public Object run RequestContext context RequestContextgetCurrentContext try HttpServletRequest request contextgetRequest String upgradeHeader requestgetHeaderUpgrade if null upgradeHeader upgradeHeader requestgetHeaderupgrade if null upgradeHeader websocketequalsIgnoreCaseupgradeHeader contextaddZuulRequestHeaderconnection Upgrade catch Exception e logerror e return null C WebSockerServercallPhone public class CallPhoneWebSocketService extends TextWebSocketHandler public void afterConnectionEstablishedWebSocketSession session Systemoutprintln public void handleMessageWebSocketSession session WebSocketMessage message throws IOException String msg messagegetPayloadtoString Systemoutprintln msg Were noticing that these errors are showing up in our logs quite frequently Dec SEVERE ContainerBackgroundProcessor StandardEngine Catalina orgapachecatalinaloaderWebappClassLoaderBasecheckThreadLocalMapForLeaks The web application created a ThreadLocal with key of type comnetflixzuulcontextRequestContext value comnetflixzuulcontextRequestContext f b b and a value of type comnetflixzuulcontextRequestContext value but failed to remove it when the web application was stopped Threads are going to be renewed over time to try and avoid a probable memory leak I found this issue on GitHub but the springcloudnetflix project says it should be fixed in this project I couldnt find a related issue on this project so I opened this issue Our operations team has reported that whenever they see these errors Tomcat decides to restart on its own which may prevent an OutOfMemoryError but it would not be an ideal solution Were using orgspringframeworkcloudspringcloudstarternetflixzuul RELEASE if that helps We miss a question We are using spring cloud in GreenwichRC When The service is runing the Zuul occur connection reset exception I need help Exceptions are as follows Spring cloud version GreenwichRC Zuul springcloudstarternetflixzuul RC comnetflixzuulexceptionZuulException Forwarding error at orgspringframeworkcloudnetflixzuulfiltersrouteRibbonRoutingFilterhandleExceptionRibbonRoutingFilterjava at orgspringframeworkcloudnetflixzuulfiltersrouteRibbonRoutingFilterforwardRibbonRoutingFilterjava at orgspringframeworkcloudnetflixzuulfiltersrouteRibbonRoutingFilterrunRibbonRoutingFilterjava at comnetflixzuulZuulFilterrunFilterZuulFilterjava at comnetflixzuulFilterProcessorprocessZuulFilterFilterProcessorjava at comnetflixzuulFilterProcessorrunFiltersFilterProcessorjava at comnetflixzuulFilterProcessorrouteFilterProcessorjava at comnetflixzuulZuulRunnerrouteZuulRunnerjava at comnetflixzuulhttpZuulServletrouteZuulServletjava at comnetflixzuulhttpZuulServletserviceZuulServletjava at orgspringframeworkwebservletmvcServletWrappingControllerhandleRequestInternalServletWrappingControllerjava at orgspringframeworkcloudnetflixzuulwebZuulControllerhandleRequestZuulControllerjava at orgspringframeworkwebservletmvcSimpleControllerHandlerAdapterhandleSimpleControllerHandlerAdapterjava at orgspringframeworkwebservletDispatcherServletdoDispatchDispatcherServletjava at orgspringframeworkwebservletDispatcherServletdoServiceDispatcherServletjava at orgspringframeworkwebservletFrameworkServletprocessRequestFrameworkServletjava at orgspringframeworkwebservletFrameworkServletdoGetFrameworkServletjava at javaxservlethttpHttpServletserviceHttpServletjava at orgspringframeworkwebservletFrameworkServletserviceFrameworkServletjava at javaxservlethttpHttpServletserviceHttpServletjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgapachetomcatwebsocketserverWsFilterdoFilterWsFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkwebfilterCorsFilterdoFilterInternalCorsFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at cominhopecontainerfilterUserAuthorizeFilterdoFilterUserAuthorizeFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkbootactuatewebtraceservletHttpTraceFilterdoFilterInternalHttpTraceFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebaccessExceptionTranslationFilterdoFilterExceptionTranslationFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebsessionSessionManagementFilterdoFilterSessionManagementFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebauthenticationAnonymousAuthenticationFilterdoFilterAnonymousAuthenticationFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebauthenticationremembermeRememberMeAuthenticationFilterdoFilterRememberMeAuthenticationFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebservletapiSecurityContextHolderAwareRequestFilterdoFilterSecurityContextHolderAwareRequestFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebsavedrequestRequestCacheAwareFilterdoFilterRequestCacheAwareFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at cominhopecontainerfilterJwtAuthenticationTokenFilterdoFilterInternalJwtAuthenticationTokenFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebauthenticationlogoutLogoutFilterdoFilterLogoutFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebheaderHeaderWriterFilterdoFilterInternalHeaderWriterFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebcontextSecurityContextPersistenceFilterdoFilterSecurityContextPersistenceFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebcontextrequestasyncWebAsyncManagerIntegrationFilterdoFilterInternalWebAsyncManagerIntegrationFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgspringframeworksecuritywebFilterChainProxyVirtualFilterChaindoFilterFilterChainProxyjava at orgspringframeworksecuritywebFilterChainProxydoFilterInternalFilterChainProxyjava at orgspringframeworksecuritywebFilterChainProxydoFilterFilterChainProxyjava at orgspringframeworkwebfilterDelegatingFilterProxyinvokeDelegateDelegatingFilterProxyjava at orgspringframeworkwebfilterDelegatingFilterProxydoFilterDelegatingFilterProxyjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkwebfilterRequestContextFilterdoFilterInternalRequestContextFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkwebfilterFormContentFilterdoFilterInternalFormContentFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkwebfilterHiddenHttpMethodFilterdoFilterInternalHiddenHttpMethodFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkcloudsleuthinstrumentwebExceptionLoggingFilterdoFilterExceptionLoggingFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at braveservletTracingFilterdoFilterTracingFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkbootwebservletsupportErrorPageFilterdoFilterErrorPageFilterjava at orgspringframeworkbootwebservletsupportErrorPageFilteraccess ErrorPageFilterjava at orgspringframeworkbootwebservletsupportErrorPageFilter doFilterInternalErrorPageFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgspringframeworkbootwebservletsupportErrorPageFilterdoFilterErrorPageFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkbootactuatemetricswebservletWebMvcMetricsFilterfilterAndRecordMetricsWebMvcMetricsFilterjava at orgspringframeworkbootactuatemetricswebservletWebMvcMetricsFilterdoFilterInternalWebMvcMetricsFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgspringframeworkwebfilterCharacterEncodingFilterdoFilterInternalCharacterEncodingFilterjava at orgspringframeworkwebfilterOncePerRequestFilterdoFilterOncePerRequestFilterjava at orgapachecatalinacoreApplicationFilterChaininternalDoFilterApplicationFilterChainjava at orgapachecatalinacoreApplicationFilterChaindoFilterApplicationFilterChainjava at orgapachecatalinacoreStandardWrapperValveinvokeStandardWrapperValvejava at orgapachecatalinacoreStandardContextValveinvokeStandardContextValvejava at orgapachecatalinaauthenticatorAuthenticatorBaseinvokeAuthenticatorBasejava at orgapachecatalinacoreStandardHostValveinvokeStandardHostValvejava at orgapachecatalinavalvesErrorReportValveinvokeErrorReportValvejava at orgapachecatalinavalvesAbstractAccessLogValveinvokeAbstractAccessLogValvejava at orgapachecatalinacoreStandardEngineValveinvokeStandardEngineValvejava at orgapachecatalinaconnectorCoyoteAdapterserviceCoyoteAdapterjava at orgapachecoyotehttp Http ProcessorserviceHttp Processorjava at orgapachecoyoteAbstractProcessorLightprocessAbstractProcessorLightjava at orgapachecoyoteAbstractProtocolConnectionHandlerprocessAbstractProtocoljava at orgapachetomcatutilnetNioEndpointSocketProcessordoRunNioEndpointjava at orgapachetomcatutilnetSocketProcessorBaserunSocketProcessorBasejava at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava at orgapachetomcatutilthreadsTaskThreadWrappingRunnablerunTaskThreadjava at javalangThreadrunThreadjava Caused by comnetflixclientClientException null at comnetflixclientAbstractLoadBalancerAwareClientexecuteWithLoadBalancerAbstractLoadBalancerAwareClientjava at orgspringframeworkcloudnetflixzuulfiltersroutesupportAbstractRibbonCommandrunAbstractRibbonCommandjava at orgspringframeworkcloudnetflixzuulfiltersroutesupportAbstractRibbonCommandrunAbstractRibbonCommandjava at comnetflixhystrixHystrixCommand callHystrixCommandjava at comnetflixhystrixHystrixCommand callHystrixCommandjava at rxinternaloperatorsOnSubscribeDefercallOnSubscribeDeferjava at rxinternaloperatorsOnSubscribeDefercallOnSubscribeDeferjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOnSubscribeDefercallOnSubscribeDeferjava at rxinternaloperatorsOnSubscribeDefercallOnSubscribeDeferjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOnSubscribeDefercallOnSubscribeDeferjava at rxinternaloperatorsOnSubscribeDefercallOnSubscribeDeferjava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOnSubscribeMapcallOnSubscribeMapjava at rxinternaloperatorsOnSubscribeMapcallOnSubscribeMapjava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxinternaloperatorsOnSubscribeDoOnEachcallOnSubscribeDoOnEachjava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOnSubscribeDefercallOnSubscribeDeferjava at rxinternaloperatorsOnSubscribeDefercallOnSubscribeDeferjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxObservablesubscribeObservablejava at rxObservablesubscribeObservablejava at rxinternaloperatorsBlockingOperatorToFuturetoFutureBlockingOperatorToFuturejava at rxobservablesBlockingObservabletoFutureBlockingObservablejava at comnetflixhystrixHystrixCommandqueueHystrixCommandjava at comnetflixhystrixHystrixCommandexecuteHystrixCommandjava at orgspringframeworkcloudnetflixzuulfiltersrouteRibbonRoutingFilterforwardRibbonRoutingFilterjava common frames omitted Caused by javalangRuntimeException javanetSocketException Connection reset at rxexceptionsExceptionspropagateExceptionsjava at rxobservablesBlockingObservableblockForSingleBlockingObservablejava at rxobservablesBlockingObservablesingleBlockingObservablejava at comnetflixclientAbstractLoadBalancerAwareClientexecuteWithLoadBalancerAbstractLoadBalancerAwareClientjava common frames omitted Caused by javanetSocketException Connection reset at javanetSocketInputStreamreadSocketInputStreamjava at javanetSocketInputStreamreadSocketInputStreamjava at orgapachehttpimplioSessionInputBufferImplstreamReadSessionInputBufferImpljava at orgapachehttpimplioSessionInputBufferImplfillBufferSessionInputBufferImpljava at orgapachehttpimplioSessionInputBufferImplreadLineSessionInputBufferImpljava at orgapachehttpimplconnDefaultHttpResponseParserparseHeadDefaultHttpResponseParserjava at orgapachehttpimplconnDefaultHttpResponseParserparseHeadDefaultHttpResponseParserjava at orgapachehttpimplioAbstractMessageParserparseAbstractMessageParserjava at orgapachehttpimplDefaultBHttpClientConnectionreceiveResponseHeaderDefaultBHttpClientConnectionjava at orgapachehttpimplconnCPoolProxyreceiveResponseHeaderCPoolProxyjava at orgapachehttpprotocolHttpRequestExecutordoReceiveResponseHttpRequestExecutorjava at orgapachehttpprotocolHttpRequestExecutorexecuteHttpRequestExecutorjava at orgapachehttpimplexecchainMainClientExecexecuteMainClientExecjava at bravehttpclientTracingMainExecexecuteTracingMainExecjava at orgapachehttpimplexecchainProtocolExecexecuteProtocolExecjava at bravehttpclientTracingProtocolExecexecuteTracingProtocolExecjava at orgapachehttpimplexecchainRetryExecexecuteRetryExecjava at orgapachehttpimplclientInternalHttpClientdoExecuteInternalHttpClientjava at orgapachehttpimplclientCloseableHttpClientexecuteCloseableHttpClientjava at orgapachehttpimplclientCloseableHttpClientexecuteCloseableHttpClientjava at orgspringframeworkcloudnetflixribbonapacheRibbonLoadBalancingHttpClientexecuteRibbonLoadBalancingHttpClientjava at orgspringframeworkcloudnetflixribbonapacheRibbonLoadBalancingHttpClientexecuteRibbonLoadBalancingHttpClientjava at comnetflixclientAbstractLoadBalancerAwareClient callAbstractLoadBalancerAwareClientjava at comnetflixloadbalancerreactiveLoadBalancerCommand callLoadBalancerCommandjava at comnetflixloadbalancerreactiveLoadBalancerCommand callLoadBalancerCommandjava at rxinternalutilScalarSynchronousObservable callScalarSynchronousObservablejava at rxinternalutilScalarSynchronousObservable callScalarSynchronousObservablejava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOnSubscribeConcatMapConcatMapSubscriberdrainOnSubscribeConcatMapjava at rxinternaloperatorsOnSubscribeConcatMapConcatMapSubscriberonNextOnSubscribeConcatMapjava at comnetflixloadbalancerreactiveLoadBalancerCommand callLoadBalancerCommandjava at comnetflixloadbalancerreactiveLoadBalancerCommand callLoadBalancerCommandjava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOnSubscribeConcatMapcallOnSubscribeConcatMapjava at rxinternaloperatorsOnSubscribeConcatMapcallOnSubscribeConcatMapjava at rxObservableunsafeSubscribeObservablejava at rxinternaloperatorsOperatorRetryWithPredicateSourceSubscriber callOperatorRetryWithPredicatejava at rxinternalschedulersTrampolineSchedulerInnerCurrentThreadSchedulerenqueueTrampolineSchedulerjava at rxinternalschedulersTrampolineSchedulerInnerCurrentThreadSchedulerscheduleTrampolineSchedulerjava at rxinternaloperatorsOperatorRetryWithPredicateSourceSubscriberonNextOperatorRetryWithPredicatejava at rxinternaloperatorsOperatorRetryWithPredicateSourceSubscriberonNextOperatorRetryWithPredicatejava at rxinternalutilScalarSynchronousObservableWeakSingleProducerrequestScalarSynchronousObservablejava at rxSubscribersetProducerSubscriberjava at rxinternalutilScalarSynchronousObservableJustOnSubscribecallScalarSynchronousObservablejava at rxinternalutilScalarSynchronousObservableJustOnSubscribecallScalarSynchronousObservablejava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxinternaloperatorsOnSubscribeLiftcallOnSubscribeLiftjava at rxObservablesubscribeObservablejava at rxObservablesubscribeObservablejava at rxobservablesBlockingObservableblockForSingleBlockingObservablejava common frames omitted Does zuul Request Context provide any methods to get and set path variables of the request eg The original request url is From this url I want to get value of acctNbr ex manipulateencrypt it and set back as ex abcgy gyzyubhgyt into request url I use Zuul Proxy in our platform Spring Cloud gateway uses Zuul Proxy Our platform has a service written in python and it runs as uWSGI application Problem is that every second request fails My college mentions it here I checked with wireshark and found out that I do not know why after first request was successfully routed and responsed Zuul would close the connection so when client makes another HTTP request Zuul proxy tries to forward it and get error comnetflixzuulexceptionZuulException Forwarding error Caused by comnetflixclientClientException null Caused by javalangRuntimeException orgapachehttpNoHttpResponseException localhost failed to respond However if we have nginx between Zuul and uWSGI it works Alternatively if we run our python application it uses Flast framework without uWSGI server there is no problem Meanwhile I am going to make a test project to demonstrate you this problem