I have an RProfile in a directory that has some specific settings that I use for the project Im work on in that directory As RProfile files which are not in your user home directory are usually only run if you start R in the directory that the RProfile file is in Ive put some code in there that depends on getwd returning the directory that the RProfile file is in However this code breaks when I run remotesinstalllocal because as part of the installation process remotesinstalllocal reruns my RProfile but from a different temporary directory To reproduce this error you can interactive run the code below R Create directory for testing tmpdir remotesinstalllocaltest dircreatetmpdir setwdtmpdir Create dummy package installpackagesusethis usethiscreatepackagefakepkg open FALSE write MyFun function printhey fakepkgRmyfunR and check that installing it works installpackagesremotes remotesinstalllocalfakepkg libraryfakepkg MyFun detachpackagefakepkg unload TRUE removepackagesfakepkg Create RProfile that should throw an error when not run from the testing directory settestwdpath paste testwd getwd checkwd deparsequote if getwd testwd cat n n all is well n n else stoppaste n n where are you running this from getwd n n write csettestwdpath checkwd RProfile Check that RProfile works as intended sourceRProfile setwd sourcepaste tmpdir RProfile setwdtmpdir Try reinstalling package from CRAN installpackagesusethis Try reinstalling package and see error remotesinstalllocalfakepkg Clean up disk setwd unlinktmpdir TRUE TRUE remotesinstallversionabc dependenciesFALSE repos typesource Downloading package from url installing source package abc package abc successfully unpacked and MD sums checked R data inst bytecompile and prepare package for lazy loading help installing help indices building package indices installing vignettes testing if installed package can be loaded DONE abc remotesinstallversionabc dependenciesFALSE repos typesource Downloading package from url ERROR dependency abcdata is not available for package abc removing LibraryFrameworksRframeworkVersions Resourceslibraryabc Error Failed to install unknown package from URL converted from warning installation of package varfoldersznsgdmpcbj dltvpjdc dqg yq xpkTRtmpvOwVM remotes f aae baabc had nonzero exit status as of writing abc is the latest on Strangely enough not only it ignores dependenciesFALSE and tries to download dependencies anyway it also cannot find the dependency theres an abcdata on On my local machine running Ubuntu installversion is able to install a package from various CRAN mirrors All of the below work remotesinstallversionrstudioapi repos remotesinstallversionrstudioapi repos remotesinstallversionrstudioapi repos details summary Session information for local machine summary R version Platform x pclinuxgnu bit Running under Ubuntu LTS Matrix products default BLAS usrlibx linuxgnuatlaslibblasso LAPACK usrlibx linuxgnuatlasliblapackso locale LCCTYPEenUSUTF LCNUMERICC LCTIMEenUSUTF LCCOLLATEenUSUTF LCMONETARYenUSUTF LCMESSAGESenUSUTF LCPAPERenUSUTF LCNAMEC LCADDRESSC LCTELEPHONEC LCMEASUREMENTenUSUTF LCIDENTIFICATIONC attached base packages stats graphics grDevices utils datasets methods base loaded via a namespace and not attached compiler tools remotes packrat details In contrast in the Docker image rockerrbase installversion only works for some CRAN mirrors remotesinstallversionrstudioapi repos Error in packagefindrepopackage repos couldnt find package rstudioapi remotesinstallversionrstudioapi repos Error in packagefindrepopackage repos couldnt find package rstudioapi remotesinstallversionrstudioapi repos Downloading package from url installation output ommitted details summary Session information for rockerrbase summary R version Platform x pclinuxgnu bit Running under Debian GNULinux bullseyesid Matrix products default BLAS usrlibx linuxgnublaslibblasso LAPACK usrlibx linuxgnulapackliblapackso locale LCCTYPEenUSUTF LCNUMERICC LCTIMEenUSUTF LCCOLLATEenUSUTF LCMONETARYenUSUTF LCMESSAGESenUSUTF LCPAPERenUSUTF LCNAMEC LCADDRESSC LCTELEPHONEC LCMEASUREMENTenUSUTF LCIDENTIFICATIONC attached base packages stats graphics grDevices utils datasets methods base loaded via a namespace and not attached compiler tools remotes details When using custom library location normally provided to installpackageslibtmptmp I am not able to install a package because it is checked against another library and found to be installed there Function should check in provided lib location instead sh Rscript e remotesinstallcrandplyr libtmptmp Skipping install of dplyr from a cran remote the SHA has not changed since last install Use force TRUE to force installation Rscript e listfilestmptmp character Using remotes As discussed on slack we want to formalize declaring several types of development dependencies in the description file These are packages that are not needed to pass check but used for development Eg pkgdown packages used by pkgdown articles document packages such as roxygen needed to generate manuals By declaring these we can automate rendering docs without having to do custom stuff in the travis file or making these packages a requirement for running CMD check as Suggests does The proposal is to prefix the fields with ConfigDepends such that they do not trigger a NOTE txt Imports foo bar Suggest baz ConfigDependspkgdown tidyverse bench ConfigDependscoverage covr ConfigDependsdocument roxygen Fields may contain remotes syntax like crandplyr rlibroxygenbranch We generalize the dependencies parameter from the remotesinstall functions to support these custom dependencies such as pkgdown One open question is the dependency relationship between the dependency types For example r remotesinstallgithubdplyr dependencies pkgdown This should probably dependencies in ConfigDependspkgdown plus hard dependencies Depends Imports LinkingTo but not maybe Suggests which are mostly required to run tests To allow pkgdown to recognize that paragraph despite its not being the first paragraph Im trying to install a local package in Windows and I keep getting the following error cp unknown option Try usrbincp help for more information ERROR installing binary package failed When I use installpackagesxxxxzip repos NULL the package installs just fine but I need the dependencies to also install so Im going with remotesinstalllocalxxxxzip I think this may be an issue with the cpexe chosen during installation it doesnt use the Rtools cpexe which would be in CUsersxxxRtools but is instead trying to use usrbincp which doesnt exist I think on my computer But in console when I run where cp I get back C Users xxx Rtools bin cpexe So I dont see why it would be choosing to look for it in usrbincp hr sessionInfo R version Platform x w mingw x bit Running under Windows x build Matrix products default locale LCCOLLATEEnglishUnited States LCCTYPEEnglishUnited States LCMONETARYEnglishUnited States LCNUMERICC LCTIMEEnglishUnited States attached base packages stats graphics grDevices utils datasets methods base other attached packages AppliedPredictiveModeling loaded via a namespace and not attached Rcpp CORElearn lattice packrat MASS grid plyr magrittr ellipse stringi reshape remotes rpart tools stringr compiler cluster nnet We tried to install a package using remotesinstallgithub on Windows where the username contains a space like John Doe The function is not able to open the repository downloaded as a targz As can be read in the error message below in French the package targz is correctly downloaded and saved in CUsersYves BasAppDataLocalTempRtmpEHVgptfile b fa eatic targz however when trying to install from this archive R says C Users Yves No such file or directory which lets suppose the space causes problems arch i Erreur fatale impossible douvrir le fichier C Users Yves No such file or directory arch x Erreur fatale impossible douvrir le fichier C Users Yves No such file or directoryERROR loading failed for i x removing CUsersYves BasDocumentsRwinlibrary ticIn R CMD INSTALLError in ip converted from warning installation of package CUsersYves BasAppDataLocalTempRtmpEHVgptfile b fa eatic targz had nonzero exit status Also shouldnt destdir be used to download and unzip the targz instead of a temp dir that is not changeable by the user remotesinstallgithubropenscilabstic lib Cpackagesgithub destdir Cpackagestemporary When a file download fails sometimes the only fix required is to wait a little while and try again This can be annoying in a CI context Would it be reasonable to add a feature allowing for retries of failed downloads Perhaps controlled by environment variables specifying the maximum number of retries and delay between retries On a Windows machine with git installed in C Program Files Git bin running the command remotesinstallgit repo url git external Creates an unescaped loop of creating git for windows processes This continues until the computer runs out of Ram GB machine and has to be closed There were over processes Same command works on colleagues machines 