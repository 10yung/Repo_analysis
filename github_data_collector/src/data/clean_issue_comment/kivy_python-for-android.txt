 Versions Python OS Android Kivy Cython Description Im trying to scrap some information from webpage but it crashes my app Im using requestshtml to render webpage with javascript with iti need javascript render Is it any alternative for requestshtml that work on android On pc it is working fine The issue tracker is a tool to address bugs Please use the Disord community or Stack Overflow for support questions more information at Before opening a new issue make sure you do the following check that your issue isnt already filed prepare a short runnable example that reproduces the issue make sure to have loglevel in your buildozerspec reproduce the problem with the latest development version p abranch master doublecheck that the issue is indeed a bug and not a support request please use backticks to format code or logs Versions Python OSubuntu Kivymaster Cython Description its my code url its a valid url def launchwebbrowserself url import webbrowser if platform android from jnius import autoclass cast def openurlurl PythonActivity autoclassorgkivyandroidPythonActivity activity PythonActivitymActivity Intent autoclassandroidcontentIntent Uri autoclassandroidnetUri browserIntent Intent browserIntentsetActionIntentACTIONVIEW browserIntentsetDataUriparseurl currentActivity castandroidappActivity activity currentActivitystartActivitybrowserIntent Web browser support class AndroidBrowserobject def openself url new autoraiseTrue openurlurl def opennewself url openurlurl def opennewtabself url openurlurl webbrowserregisterandroid AndroidBrowser None webbrowseropenurl when i call launchwebbrowser in kv onpress rootlaunchwebbrowserrooturl i get this error in log webbrowserregisterandroid AndroidBrowser None TypeError register takes from to positional arguments but were given maybe i think its a bug of python please help ths buildozerspec Command sh REPLACE ME buildozer command ran eg buildozer android debug Spec file REPLACE ME Paste your buildozerspec file here Logs So depending on the requested recipes at built time a different test app will be ran as well as different unit tests We also set this unified test app the default for our CI tests since we remove the testappsqlite openssl alongside with some more test apps There are app modes kivy if kivy detected in apprequirementstxt flask if flask detected in apprequirementstxt nogui if above cases are not taken In all the cases mentioned the unittests will be run In the two first use cases kivy and flask the result of the unit tests can be seen via the app If an nogui app is built then the results must be checked via adb logcat Also be aware that this PR adds more artifacts for ghactions via an matrix so now we will have on device unit test app for Python arm v a tested on device Python armeabiv a tested on device Python x Python x Python arm v a tested on device Python armeabiv a tested on device Python x A quick view of the situation the removed testappkeyboard and testappservice now lives in the on device unit test app the testapps for pillow matplotlib and encryption has been moved into the unit tests so we can also test those recipes via the flask app the testapp for flask has been also movedreworked into the new on device unit test app this allow us to share the resources with the kivy app which are the same Furthermore we generate a file at build time apprequirementstxt which will hold the supplied recipes at build time This file will allow us to test these recipes via our unittests Just noting that the recipes we want to test must be explicitly mentioned Also should be mentioned that this feature its only available for direct build with p a when setuptestapppy is ranso buildozer builds will build an basic test app no matter what recipes are introduced into buildozerspec file because the apprequirementstxt will only be created if the setuptestapppy file is ran Notes inclement I included you as author of this thing alongside myself I think that we are the authors of the removed test apps and you are also the author of the base code for the on device unit test app AndreMiras and anyone looking into this I think that you are not involved with these test apps please let me know if Im mistaken and I will include you as author as well I avoided python s specific code in purpose so the new test app could be also run from python this way we can remove the python test apps BTW we only have one import to add python compatibility to this new unit test appimhoI thinks its worth it wink I labeled this WIP because I want to add a couple of commits in order to force to generate the flask testapp via ghactions and restore it to kivy so this way you guys can see the result of this flask unittest testapp without building anything for now you can download the kivy testapp at ghactions I have mixed feelings about this PRmaybe the whole thing its a crazy idea of minemmmmlet me know if this is the case and I will close this no problem at all I added a font file its very lightless than Kb and its free for commercialpersonal use This font has two purposes used for some titles in kivyflask apps to perform the unittests for the Pillow recipe inclement the testapp for keyboard that I deleted and included at the new unit test appIm not sure if its working as expectedit would be great that you could download one of the generated tests apps via ghactions and give your thoughts AndreMiras it would be awesome to have yours as well I did not test the buildozer build anyone could test it Some future improvements we could make removeintegrate some more test apps Merging this PR we will only have the following test apps testappvispy testlaunchersetup testlauncherrebootsetup make ghactions create a new artifact for rebuild updated recipes I have some job done in this point but not included at here add tests for all the recipes we have we have a basic set but we could go further Improve design and features specially for the flask app yeaI put more love with the kivy app smile test the artifacts we generate with ghactions on deviceAndreMiras you were working with that for travismaybe now it will be easier to do that with ghactions you tell me The issue tracker is a tool to address bugs Please use the Disord community or Stack Overflow for support questions more information at Before opening a new issue make sure you do the following check that your issue isnt already filed prepare a short runnable example that reproduces the issue make sure to have loglevel in your buildozerspec reproduce the problem with the latest development version p abranch master doublecheck that the issue is indeed a bug and not a support request please use backticks to format code or logs Versions Python OS Android Kivy Cython NDK r c I use c because b is not available at SDK Description Three issues with project build file management these are I think new with If I edit mainpy the change is not included in the apk unless I first delete mainpyc cleanbulds option does not appear to work but cleanall works If I have two projects both NDK c and SDK First project builds and runs Second project build but fails with SDL Error see image p a cleanall Second project builds and runs First project build but fails with same SDL Error Screenshot buildozerspec Command sh REPLACE ME buildozer command ran eg buildozer android debug Spec file REPLACE ME Paste your buildozerspec file here Logs REPLACE ME Paste the build ouput containing the error Needs cleaning up so not for merging yet in particular want to retain the py patches for py builds but this seems to work Versions Python Latest Python OS Android Kivy Latest Kivy Cython Latest Cython Description Im trying to use able to use BLE on android and getting an error about a missing javaclass orgableBLE This commit was working a few days ago Test code here My code is here buildozerspec Command buildozer v android release and buildozer android debug they produce the same result Spec file Logs No error during build Versions Python OS android Kivy Cython Description i am trying to do the following used in the plyer library sh androidactivitybindonactivityresultselfonactivityresult def onactivityresultself requestCode resultCode intent printin activity result if requestCode x printin if return printbefore unbind androidactivityunbindonactivityresultselfonactivityresult printafter unbind if selfoncompleteselffilename printin if selfremoveselffilename And getting the following error sh Class not found borgkivyandroidPythonActivityActivityResultListener Exception in connect function object of type NoneType has no len The issue tracker is a tool to address bugs Please use the Disord community or Stack Overflow for support questions more information at Before opening a new issue make sure you do the following check that your issue isnt already filed prepare a short runnable example that reproduces the issue make sure to have loglevel in your buildozerspec reproduce the problem with the latest development version p abranch master doublecheck that the issue is indeed a bug and not a support request please use backticks to format code or logs Versions Python Python OS Ubuntu LTS Kivy Cython Description The application crash after loading screen Even It cant connect to my socket server buildozerspec Command sh buildozer V android debug deploy run Spec file app str Title of your application title My Application str Package name packagename myapp str Package domain needed for androidios packaging packagedomain orgtest str Source code where the mainpy live sourcedir list Source files to include let empty to include all the files sourceincludeexts pypngjpgkvatlas list List of inclusions using pattern matching sourceincludepatterns assetsimagespng list Source files to exclude let empty to not exclude anything sourceexcludeexts spec list List of directory to exclude let empty to not exclude anything sourceexcludedirs tests bin list List of exclusions using pattern matching sourceexcludepatterns licenseimagesjpg str Application versioning method version str Application versioning method versionregex version versionfilename sourcedirsmainpy list Application requirements comma separated eg requirements sqlite kivy requirements python libffiopensslsqlite kivy str Custom source folders for requirements Sets custom source for any requirements with recipes requirementssourcekivy kivy list Garden requirements gardenrequirements str Presplash of the application presplashfilename sourcedirsdatapresplashpng str Icon of the application iconfilename sourcedirsdataiconpng str Supported orientation one of landscape sensorLandscape portrait or all orientation portrait list List of service to declare services NAMEENTRYPOINTTOPYNAME ENTRYPOINT TOPY OSX Specific author Copyright Info change the major version of python used by the app osxpythonversion Kivy version to use osxkivyversion Android specific bool Indicate if the application should be fullscreen or not fullscreen string Presplash background color for new android toolchain Supported formats are RRGGBB AARRGGBB or one of the following names red blue green black white gray cyan magenta yellow lightgray darkgray grey lightgrey darkgrey aqua fuchsia lime maroon navy olive purple silver teal androidpresplashcolor FFFFFF list Permissions androidpermissions INTERNET int Target Android API should be as high as possible androidapi int Minimum API your APK will support androidminapi int Android SDK version to use androidsdk str Android NDK version to use androidndk c int Android NDK API to use This is the minimum API your app will support it should usually match androidminapi androidndkapi bool Use private data storage True or dir public storage False androidprivatestorage True str Android NDK directory if empty it will be automatically downloaded androidndkpath str Android SDK directory if empty it will be automatically downloaded androidsdkpath str ANT directory if empty it will be automatically downloaded androidantpath bool If True then skip trying to update the Android sdk This can be useful to avoid excess Internet downloads or save time when an update is due and you just want to testbuild your package androidskipupdate False bool If True then automatically accept SDK license agreements This is intended for automation only If set to False the default you will be shown the license when first running buildozer androidacceptsdklicense True str Android entry point default is ok for Kivybased app androidentrypoint orgrenpyandroidPythonActivity list Pattern to whitelist for the whole project androidwhitelist str Path to a custom whitelist file androidwhitelistsrc str Path to a custom blacklist file androidblacklistsrc list List of Java jar files to add to the libs so that pyjnius can access their classes Dont add jars that you do not need since extra jars can slow down the build process Allows wildcards matching for example OUYAODKlibsjar androidaddjars foojarbarjarpathtomorejar list List of Java files to add to the android project can be java or a directory containing the files androidaddsrc list Android AAR archives to add currently works only with sdl gradle bootstrap androidaddaars list Gradle dependencies to add currently works only with sdl gradle bootstrap androidgradledependencies list Java classes to add as activities to the manifest androidaddactivites comexampleExampleActivity str pythonforandroid branch to use defaults to master p abranch master str OUYA Console category Should be one of GAME or APP If you leave this blank OUYA support will not be enabled androidouyacategory GAME str Filename of OUYA Console icon It must be a x png image androidouyaiconfilename sourcedirsdataouyaiconpng str XML file to include as an intent filters in activity tag androidmanifestintentfilters str launchMode to set for the main activity androidmanifestlaunchmode standard list Android additional libraries to copy into libsarmeabi androidaddlibsarmeabi libsandroidso androidaddlibsarmeabiv a libsandroidv so androidaddlibsx libsandroidx so androidaddlibsmips libsandroidmipsso bool Indicate whether the screen should stay on Dont forget to add the WAKELOCK permission if you set this to True androidwakelock False list Android application metadata to set keyvalue format androidmetadata list Android library project to add will be added in the projectproperties automatically androidlibraryreferences str Android logcat filters to use androidlogcatfilters S pythonD bool Copy library instead of making a libpymodulesso androidcopylibs str The Android arch to build for choices armeabiv a arm v a x androidarch armeabiv a Python for android p a specific str pythonforandroid git clone directory if empty it will be automatically cloned from github p asourcedir str The directory in which pythonforandroid should look for your own build recipes if any p alocalrecipes str Filename to the hook for p a p ahook str Bootstrap to use for android builds p abootstrap sdl int port number to specify an explicit port p a argument eg for bootstrap flask p aport iOS specific str Path to a custom kivyios folder ioskivyiosdir kivyios Alternately specify the URL and branch of a git checkout ioskivyiosurl ioskivyiosbranch master Another platform dependency iosdeploy Uncomment to use a custom checkout iosiosdeploydir iosdeploy Or specify URL and branch iosiosdeployurl iosiosdeploybranch str Name of the certificate to use for signing the debug version Get a list of available identities buildozer ios listidentities ioscodesigndebug iPhone Developer lastname firstname hexstring str Name of the certificate to use for signing the release version ioscodesignrelease ioscodesigndebugs buildozer int Log level error only info debug with command output loglevel int Display warning if buildozer is run as root False True warnonroot str Path to build artifact storage absolute or relative to spec file builddir buildozer str Path to build output ie apk ipa storage bindir bin List as sections You can define all the list as sectionkey Each line will be considered as a option to the list Lets take app sourceexcludepatterns Instead of doing app sourceexcludepatterns licensedataaudiowavdataimagesoriginal This can be translated into appsourceexcludepatterns license dataaudiowav dataimagesoriginal Profiles You can extend section key with a profile For example you want to deploy a demo version of your application without HD content You could first change the title to add demo in the name and extend the excluded directories to remove the HD content appdemo title My Application demo appsourceexcludepatternsdemo imageshd Then invoke the command line with the demo profile buildozer profile demo android debug Logs deploy error Exception in thread background thread for pid Traceback most recent call last File homepirlanaconda envsproject libpython threadingpy line in bootstrapinner selfrun File homepirlanaconda envsproject libpython threadingpy line in run selftargetselfargs selfkwargs File homepirlanaconda envsproject libpython sitepackagesshpy line in wrap fnargs kwargs File homepirlanaconda envsproject libpython sitepackagesshpy line in backgroundthread handleexitcodeexitcode File homepirlanaconda envsproject libpython sitepackagesshpy line in fn return selfcommandhandlecommandexitcodeexitcode File homepirlanaconda envsproject libpython sitepackagesshpy line in handlecommandexitcode raise exc shErrorReturnCode RAN homepirldevprojectmobilebuildozerandroidplatformbuildbuildotherbuildshostpython desktophostpython nativebuildpython setuppy buildext v STDOUT running buildext building jnius extension creating build creating buildtemplinuxx creating buildtemplinuxx jnius usrbinccache armlinuxandroideabigcc DANDROID fomitframepointer DANDROIDAPI mandroid isystem homepirlbuildozerandroidplatformandroidndkr csysrootusrincludearmlinuxandroideabi Ihomepirlbuildozerandroidplatformandroidndkr csysrootusrincludearmlinuxandroideabi isysroot homepirlbuildozerandroidplatformandroidndkr csysroot Ihomepirldevprojectmobilebuildozerandroidplatformbuildbuildpythoninstallsmyappincludepython DNDEBUG g fwrapv O Wall DANDROID fomitframepointer DANDROIDAPI mandroid isystem homepirlbuildozerandroidplatformandroidndkr csysrootusrincludearmlinuxandroideabi Ihomepirlbuildozerandroidplatformandroidndkr csysrootusrincludearmlinuxandroideabi isysroot homepirlbuildozerandroidplatformandroidndkr csysroot Ihomepirldevprojectmobilebuildozerandroidplatformbuildbuildpythoninstallsmyappincludepython marcharmv a mfloatabisoftfp mfpuvfp mthumb Ihomepirldevprojectmobilebuildozerandroidplatformbuildbuildotherbuildspython libffiopensslsqlite armeabiv andktarget python Include fPIC Ihomepirldevprojectmobilebuildozerandroidplatformbuildbuildotherbuildshostpython desktophostpython Include Ihomepirldevprojectmobilebuildozerandroidplatformbuildbuildotherbuildshostpython desktophostpython nativebuild c jniusjniusc o buildtemplinuxx jniusjniuso armlinuxandroideabigcc error jniusjniusc No such file or directory armlinuxandroideabigcc fatal error no input files compilation terminated error command usrbinccache failed with exit status STDERR adb error command adb logcat E E ANDRPERFMPCTL Invalid profile no total profiles only E ANDRPERFMPCTL Invalid profile no total profiles only E ActivityManager applyOptionsLocked pendingOptionsgetStartX pendingOptionsgetStartY E Zygote v E Zygote accessInfo E SensorService getSensorList a sensor Sensor Diagnostic Monitor without holding its required permission comsamsungpermissionSSENSOR E ContactsProviderEventLog Flush buffer to file cnt size Kb duration ms lastUpdatedAfter ms mFlushtimethreasold mCurrentSize E ANDRPERFMPCTL Invalid profile no total profiles only E LOWI a LOWIUtils channelBandToFreq Invalid bandchannel E LOWI a LOWIUtils channelBandToFreq Invalid bandchannel E LOWI a LOWIUtils channelBandToFreq Invalid bandchannel E wpasupplicant Cmd not handled E Watchdog Sync E Watchdog Sync E ContactsProviderEventLog Flush buffer to file cnt size Kb duration ms lastUpdatedAfter ms mFlushtimethreasold mCurrentSize E Watchdog Sync E Watchdog Sync E ContactsProviderEventLog Flush buffer to file cnt size Kb duration ms lastUpdatedAfter ms mFlushtimethreasold mCurrentSize The issue tracker is a tool to address bugs Please use the Disord community or Stack Overflow for support questions more information at Before opening a new issue make sure you do the following check that your issue isnt already filed prepare a short runnable example that reproduces the issue make sure to have loglevel in your buildozerspec reproduce the problem with the latest development version p abranch master doublecheck that the issue is indeed a bug and not a support request please use backticks to format code or logs Versions Python OS Ubuntu Docker from buildozers repo Kivy Cython pythonforandroid master dd f originmaster Merge pull request from kivyrelease Description What are you trying to get done Create an APK with a Python Kivy app which includes among others Pythons gevent module which depends on PyNoneStruct symbol not found What has happened and What went wrong Building process finished correctly I have the APK Execution process ended before the app is fully loaded with error message ImportError dlopen failed cannot locate symbol PyNoneStruct referenced by datadataorgtestmyappfilesapppythonbundlesitepackagesgeventhublocalso What did you expect I expected the app to run smoothly as it does on Linux Short runnable App testerrorzip buildozerspec Command sh buildozer android clean debug Spec file app str Title of your application title My App str Package name packagename myapp str Package domain needed for androidios packaging packagedomain orgtest str Source code where the mainpy live sourcedir src list Source files to include let empty to include all the files sourceincludeexts pypngjpgkvatlas list List of inclusions using pattern matching sourceincludepatterns data list Source files to exclude let empty to not exclude anything sourceexcludeexts spec list List of directory to exclude let empty to not exclude anything sourceexcludedirs tests bin build list List of exclusions using pattern matching sourceexcludepatterns licenseimagesjpg str Application versioning method version str Application versioning method versionregex version versionfilename sourcedirsmainpy list Application requirements comma separated eg requirements sqlite kivy requirements python kivyparallelsshargparsesixopensslcfficryptographygevent str Custom source folders for requirements Sets custom source for any requirements with recipes requirementssourcekivy kivy list Garden requirements gardenrequirements str Presplash of the application presplashfilename sourcedirsdatapresplashpng str Icon of the application iconfilename sourcedirsdataiconpng str Supported orientation one of landscape sensorLandscape portrait or all orientation all list List of service to declare services NAMEENTRYPOINTTOPYNAME ENTRYPOINT TOPY OSX Specific author Copyright Info change the major version of python used by the app osxpythonversion Kivy version to use osxkivyversion Android specific bool Indicate if the application should be fullscreen or not fullscreen string Presplash background color for new android toolchain Supported formats are RRGGBB AARRGGBB or one of the following names red blue green black white gray cyan magenta yellow lightgray darkgray grey lightgrey darkgrey aqua fuchsia lime maroon navy olive purple silver teal androidpresplashcolor FFFFFF list Permissions androidpermissions INTERNET int Target Android API should be as high as possible androidapi int Minimum API your APK will support androidminapi int Android SDK version to use androidsdk str Android NDK version to use androidndk c int Android NDK API to use This is the minimum API your app will support it should usually match androidminapi androidndkapi bool Use private data storage True or dir public storage False androidprivatestorage True str Android NDK directory if empty it will be automatically downloaded androidndkpath str Android SDK directory if empty it will be automatically downloaded androidsdkpath str ANT directory if empty it will be automatically downloaded androidantpath bool If True then skip trying to update the Android sdk This can be useful to avoid excess Internet downloads or save time when an update is due and you just want to testbuild your package androidskipupdate False bool If True then automatically accept SDK license agreements This is intended for automation only If set to False the default you will be shown the license when first running buildozer androidacceptsdklicense False str Android entry point default is ok for Kivybased app androidentrypoint orgrenpyandroidPythonActivity list Pattern to whitelist for the whole project androidwhitelist str Path to a custom whitelist file androidwhitelistsrc str Path to a custom blacklist file androidblacklistsrc list List of Java jar files to add to the libs so that pyjnius can access their classes Dont add jars that you do not need since extra jars can slow down the build process Allows wildcards matching for example OUYAODKlibsjar androidaddjars foojarbarjarpathtomorejar list List of Java files to add to the android project can be java or a directory containing the files androidaddsrc list Android AAR archives to add currently works only with sdl gradle bootstrap androidaddaars list Gradle dependencies to add currently works only with sdl gradle bootstrap androidgradledependencies list Java classes to add as activities to the manifest androidaddactivites comexampleExampleActivity str OUYA Console category Should be one of GAME or APP If you leave this blank OUYA support will not be enabled androidouyacategory GAME str Filename of OUYA Console icon It must be a x png image androidouyaiconfilename sourcedirsdataouyaiconpng str XML file to include as an intent filters in activity tag androidmanifestintentfilters str launchMode to set for the main activity androidmanifestlaunchmode standard list Android additional libraries to copy into libsarmeabi androidaddlibsarmeabi libsandroidso androidaddlibsarmeabiv a libsandroidv so androidaddlibsarm v a libsandroidv so androidaddlibsx libsandroidx so androidaddlibsmips libsandroidmipsso bool Indicate whether the screen should stay on Dont forget to add the WAKELOCK permission if you set this to True androidwakelock False list Android application metadata to set keyvalue format androidmetadata list Android library project to add will be added in the projectproperties automatically androidlibraryreferences list Android shared libraries which will be added to AndroidManifestxml using useslibrary tag androiduseslibrary str Android logcat filters to use androidlogcatfilters S pythonD bool Copy library instead of making a libpymodulesso androidcopylibs str The Android arch to build for choices armeabiv a arm v a x x androidarch armeabiv a Python for android p a specific str pythonforandroid fork to use defaults to upstream kivy p afork kivy str pythonforandroid branch to use defaults to master p abranch master str pythonforandroid git clone directory if empty it will be automatically cloned from github p asourcedir str The directory in which pythonforandroid should look for your own build recipes if any p alocalrecipes recipes str Filename to the hook for p a p ahook str Bootstrap to use for android builds p abootstrap sdl int port number to specify an explicit port p a argument eg for bootstrap flask p aport iOS specific str Path to a custom kivyios folder ioskivyiosdir kivyios Alternately specify the URL and branch of a git checkout ioskivyiosurl ioskivyiosbranch master Another platform dependency iosdeploy Uncomment to use a custom checkout iosiosdeploydir iosdeploy Or specify URL and branch iosiosdeployurl iosiosdeploybranch str Name of the certificate to use for signing the debug version Get a list of available identities buildozer ios listidentities ioscodesigndebug iPhone Developer lastname firstname hexstring str Name of the certificate to use for signing the release version ioscodesignrelease ioscodesigndebugs buildozer int Log level error only info debug with command output loglevel int Display warning if buildozer is run as root False True warnonroot str Path to build artifact storage absolute or relative to spec file builddir buildozer str Path to build output ie apk ipa storage bindir bin List as sections You can define all the list as sectionkey Each line will be considered as a option to the list Lets take app sourceexcludepatterns Instead of doing app sourceexcludepatterns licensedataaudiowavdataimagesoriginal This can be translated into appsourceexcludepatterns license dataaudiowav dataimagesoriginal Profiles You can extend section key with a profile For example you want to deploy a demo version of your application without HD content You could first change the title to add demo in the name and extend the excluded directories to remove the HD content appdemo title My Application demo appsourceexcludepatternsdemo imageshd Then invoke the command line with the demo profile buildozer profile demo android debug Logs Related build logs note the lld hacky stuff despite I have installed manually apt install llvm INFO Building libffi for armeabiv a INFO directory context homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildslibffiarmeabiv andktarget libffi INFO running autogensh INFO running autoreconf vif INFO running configure hostarmlinuxandroideabi prefixhomeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildslibffiarmeabiv andktarget libffi disablebuiand more INFO running make j libffila INFO running cp homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildslibffiarmeabiv andktarget libffilibslibffiso homeuserhostcwdbuildozerandroidplatand more INFO directory context homeuserhostcwdbuildozerandroidplatformpythonforandroid INFO Building librt for armeabiv a INFO running ln sf homeuserbuildozerandroidplatformandroidndkr cplatformsandroid archarmusrliblibcso homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherand more INFO running ln sf homeuserbuildozerandroidplatformandroidndkr cplatformsandroid archarmusrliblibca homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherband more INFO Building openssl for armeabiv a INFO directory context homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildsopensslarmeabiv andktarget openssl INFO running perl Configure shared nodso noasm androidarm DANDROIDAPI INFO Applying patch disablesoverpatch INFO running patch t d homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildsopensslarmeabiv andktarget openssl p i homeuserhostcwdbuildozerandroidand more INFO running make buildlibs INFO running cp libssl so libcrypto so homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildlibscollectionsmyapparmeabiv a INFO directory context homeuserhostcwdbuildozerandroidplatformpythonforandroid INFO Building sdl image for armeabiv a INFO Building sdl mixer for armeabiv a INFO Building sdl ttf for armeabiv a INFO Building sqlite for armeabiv a INFO directory context homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildssqlite armeabiv andktarget sqlite INFO running ndkbuild V APPPLATFORMandroid APPABIarmeabiv a INFO directory context homeuserhostcwdbuildozerandroidplatformpythonforandroid INFO Building python for armeabiv a INFO directory context homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildspython libffiopensslsqlite armeabiv andktarget python androidbuild WARNING Doing some hacky stuff to link properly INFO running cp homeuserbuildozerandroidplatformandroidndkr cplatformsandroid archarmusrlibcrtbeginsoo INFO running cp homeuserbuildozerandroidplatformandroidndkr cplatformsandroid archarmusrlibcrtendsoo WARNING lld not found linking without it Consider installing lld if linker errors occur INFO Activating flags for sqlite INFO Activating flags for libffi INFO Activating flags for openssl INFO running configure hostarmlinuxandroideabi buildx pclinuxgnu enableshared enableipv accvfiledevptmxyes accvfiledevptcno withoutensurepip accvlittleendiandand more INFO running make all j INSTSONAMElibpython mso INFO directory context homeuserhostcwdbuildozerandroidplatformpythonforandroid INFO Building cffi for armeabiv a INFO cffi apparently isnt already in sitepackages INFO Building compiled components in cffi INFO directory context homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildscffipython armeabiv andktarget cffi INFO running python setuppy clean all INFO running python setuppy buildext v INFO running find buildliblinuxx name o exec armlinuxandroideabistrip stripunneeded INFO directory context homeuserhostcwdbuildozerandroidplatformpythonforandroid INFO Installing cffi into sitepackages INFO directory context homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildscffipython armeabiv andktarget cffi INFO running python setuppy install O roothomeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildpythoninstallsmyapp installlib INFO Rebuilding compiled components in cffi INFO running python setuppy clean all INFO running python setuppy buildext v INFO running python setuppy install O roothomeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildshostpython desktophostpython nativebuild installlibLibsitepackages INFO directory context homeuserhostcwdbuildozerandroidplatformpythonforandroid INFO Building gevent for armeabiv a INFO gevent apparently isnt already in sitepackages INFO Cythonizing anything necessary in gevent INFO Moved DANDROID DANDROIDAPI Ihomeuserbuildozerandroidplatformandroidndkr csysrootusrincludearmlinuxandroideabi Ihomeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildpythoninstallsmyappincludepython Ihomeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildspython libffiopensslsqlite armeabiv andktarget python Include from CFLAGS to CPPFLAGS INFO Moved lm lpython m from LDFLAGS to LIBS INFO directory context homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildsgeventpython armeabiv andktarget gevent INFO running python c import sys printsyspath INFO Trying first build of gevent to get cython files this is expected to fail INFO running python setuppy buildext v INFO First build appeared to complete correctly skipping manualcythonising INFO directory context homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildsgeventpython armeabiv andktarget gevent INFO Stripping object files INFO running find iname so exec usrbinecho INFO running find iname so exec armlinuxandroideabistrip stripunneeded INFO directory context homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildsgeventpython armeabiv andktarget gevent INFO directory context homeuserhostcwdbuildozerandroidplatformpythonforandroid INFO Moved DANDROID DANDROIDAPI Ihomeuserbuildozerandroidplatformandroidndkr csysrootusrincludearmlinuxandroideabi Ihomeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildpythoninstallsmyappincludepython Ihomeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildspython libffiopensslsqlite armeabiv andktarget python Include from CFLAGS to CPPFLAGS INFO Moved lm lpython m from LDFLAGS to LIBS INFO Installing gevent into sitepackages INFO directory context homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildsgeventpython armeabiv andktarget gevent INFO running python setuppy install O roothomeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildpythoninstallsmyapp installlib INFO directory context homeuserhostcwdbuildozerandroidplatformpythonforandroid The last logs from ADB are I ActivityManager Start proc androidprocessmediau a for content provider comandroidprovidersdownloadsDownloadProvider I python INFO Image Providers imgtex imgdds imgsdl imggif imgpil imgffpyplayer ignored I python INFO Text Provider sdl I Finsky mnbrun Installer Installer starting I Finsky mnbrun Installer Installer started I Finsky moaa Installer found apps to install isMultiUserModetrue apps I Finsky uwra Connecting InstallListener to SplitInstallService broadcaster I python Traceback most recent call last I python File homeuserhostcwdbuildozerandroidappmainpy line in module I python File homeuserhostcwdbuildozerandroidappmainpy line in main I python File homeuserhostcwdbuildozerandroidappappMyApppy line in module I python File homeuserhostcwdbuildozerandroidappappServicesManagerpy line in module I python File homeuserhostcwdbuildozerandroidappappServicepy line in module I python File homeuserhostcwdbuildozerandroidappappsshdevicepy line in module I python File homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildpythoninstallsmyapppsshclientsinitpy line in module I python File homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildpythoninstallsmyapppsshclientsnativeinitpy line in module I python File homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildpythoninstallsmyapppsshclientsnativeparallelpy line in module I python File homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildpythoninstallsmyappgeventinitpy line in module I python File homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildpythoninstallsmyappgeventhublocalpy line in module I python File homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildpythoninstallsmyappgeventutilpy line in importcaccel I python File homeuserhostcwdbuildozerandroidplatformbuildarmeabiv abuildotherbuildspython libffiopensslsqlite armeabiv andktarget python Libimportlibinitpy line in importmodule I python ImportError dlopen failed cannot locate symbol PyNoneStruct referenced by datadataorgtestmyappfilesapppythonbundlesitepackagesgeventhublocalso I python Python for android ended In here we solve a problem we have when changing androidapi if we already have a build distribution that we can reuse The problem is that the changes are not reflected in the final APK because there is some hardcoded androidapi in some of the distribution files So in here we will update those files so when we perform the build of the APK with gradle it will change the necessary stuff with the new androidapi We also Store the androidapi value to distinfojson file and update it if we reuse the dist with a new androidapi Prettify distinfojson to be easier to read it for us Reduce complexity of Distributiongetdistributions Add unittests for the added code How to test this Well it will require two builds the first one with one androidapi and then another with a new androidapi Once the second build complete you will see that the distribution file AndroidManifestxml has the value of the second build btw we never modify this file in this PR this file is modified by gradle You can check around line for something like usessdk androidminSdkVersion androidtargetSdkVersion The value of androidtargetSdkVersion should be the one you used with androidapi in your second build How will look like the distinfojson file androidapi archs arm v a bootstrap sdl distname bdisttestpython sqliteopensslgooglendk hostpython homeopacamlocalsharepythonforandroidbuildotherbuildshostpython desktophostpython nativebuildpython ndkapi pythonversion recipes hostpython libffi openssl sdl image sdl mixer sdl ttf sqlite python sdl setuptools requests six pyjnius android kivy peewee usesetuppy false As you see the keys are sorted and indented with spaces winkimho far readable than all in one line right Notes Some parts of the code where taken from so this PR is a portion of what we presented there but refreshed and enhanced