Added a stop script that does corresponding work to the start script Modified the teststartssl script that the docker container has to be specified Error description only http works I am unable to setup a new certificate Steps to reproduce clone this repo and cd into it edit the env as you wish type startsh start your website container Expected result working https website on my domain name Error result Attaching to nginxletsencrypt nginxgen nginxweb nginxletsencrypt Info Custom DiffieHellman group found generation skipped nginxletsencrypt Generated appletsencryptservicedata from containers nginxletsencrypt Running appsignalleservice nginxletsencrypt Watching docker events nginxletsencrypt Contents of appletsencryptservicedata did not change Skipping notification appsignalleservice nginxletsencrypt Sleep for s nginxletsencrypt Sleep for s nginxletsencrypt Sleep for s nginxletsencrypt Received event start for container d a nginxletsencrypt Received event start for container b cc b dab nginxletsencrypt Debounce minTimer fired nginxletsencrypt Generated appletsencryptservicedata from containers nginxletsencrypt Running appsignalleservice nginxletsencrypt etcnginxcertsinfodatacf app nginxletsencrypt Reloading nginx dockergen using separate container nginxgen nginxletsencrypt Reloading nginx using separate container cee ecd dee a f f bb a edf d aabb ad e e a d nginxletsencrypt Creatingrenewal infodatacf certificates mydomaincom wwwmydomaincom nginxletsencrypt INFOsimple Generating new account key nginxletsencrypt ACME server returned an error urnacmeerrorunauthorized The client lacks sufficient authorization Account creation on ACMEv is disabled Please upgrade your ACME client to a version that supports ACMEv RFC See for details Comments I am looking for an alternative anybody have a idea Thanks Is it possible to have one site behind the nginx and Lets encrypt proxy that does not use SSL We have several sites behind an nginx and Lets encrypt reverse proxy using this docker container but for one of our sites we would like to be able to use normal unencrypted HTTP on port Is that possible On NIX OS there is no binbash It located in where bash runcurrentsystemswbinbash But usrbinenv should be on most of Linux distros See available options here Error description I got error when issue new cert Steps to reproduce Just do as usual Expected result Get my cert Error result INFOsimple Generating new certificate private key ACME server returned an error urnacmeerrormalformed The request message was malformed Error creating new cert CSR contains more than DNS names Debugging tips v improves output verbosity Help is available under help app Comments Any help Thanks I used to have following timeoutconf http fastcgireadtimeout s proxyreadtimeout s For many months my dockercomposeletsencryptnginxproxycompanion setup worked worked flawlessly Yesterday I noticed that all calls to the server where timing out Checking the nginx container logs I saw a bunch of emerg http directive is not allowed here in etcnginx Kindly asking for suggestions on what went wrong and on how to apply my s timeout again Hi out of times I start with this script nginxgen does not start and each time I have to start it manually which is a pain making it pause for second and doing dockercompose start makes sure it started of the time And it does skip the ones already started Also adding dockercompose ps at the end is a nice way to confirm it is up and running as it should Please accept this Cheers Khalil I have trouble setting up realconf It just doesnt seem to work I did read some related issues specially where it seems its working for some guys I did try a couple of versions setrealipfrom header XForwardedFor setrealipfrom realipheader XRealIP realipheader XRealIP realiprecursive on Pretty sure I did all the combos you can do with it But still the real ip wont get through Also to my to my knowledge it should work with both XForwardedFor and XRealIP in same block One thing I dont get at all shouldnt there be changes in my defaultconf when I change something in the realconf of course after a restart of nginxweb container I cant see any Maybe my understanding is to basic but shouldnt there be changes in the location section Here is my defaultconf when starting the container with the startsh script xxxxxxcom upstream xxxxxxcom Can be connected with webproxy network xxx server server servername xxxxxxcom listen accesslog varlognginxaccesslog vhost return server servername xxxxxxcom listen ssl http accesslog varlognginxaccesslog vhost sslprotocols TLSv TLSv TLSv TLSv sslciphers ECDHEECDSACHACHA POLY ECDHERSACHACHA POLY ECDHEECDSAAES GCMSHA ECDHERSAAES GCMSHA ECDHEECDSAAES GCMSHA ECDHERSAAES GCMSHA DHERSAAES GCMSHA DHERSAAES GCMSHA ECDHEECDSAAES SHA sslpreferserverciphers on sslsessiontimeout m sslsessioncache sharedSSL m sslsessiontickets off sslcertificate etcnginxcertsxxxxxxcomcrt sslcertificatekey etcnginxcertsxxxxxxcomkey ssldhparam etcnginxcertsxxxxxxcomdhparampem sslstapling on sslstaplingverify on ssltrustedcertificate etcnginxcertsxxxxxxcomchainpem addheader StrictTransportSecurity maxage always include etcnginxvhostddefault location proxypass So again I would think it would need to be something like xxxxxxcom upstream xxxxxxcom Can be connected with webproxy network xxx server server servername xxxxxxcom listen accesslog varlognginxaccesslog vhost return server servername xxxxxxcom listen ssl http accesslog varlognginxaccesslog vhost sslprotocols TLSv TLSv TLSv TLSv sslciphers ECDHEECDSACHACHA POLY ECDHERSACHACHA POLY ECDHEECDSAAES GCMSHA ECDHERSAAES GCMSHA ECDHEECDSAAES GCMSHA ECDHERSAAES GCMSHA DHERSAAES GCMSHA DHERSAAES GCMSHA ECDHEECDSAAES SHA sslpreferserverciphers on sslsessiontimeout m sslsessioncache sharedSSL m sslsessiontickets off sslcertificate etcnginxcertsxxxxxxcomcrt sslcertificatekey etcnginxcertsxxxxxxcomkey ssldhparam etcnginxcertsxxxxxxcomdhparampem sslstapling on sslstaplingverify on ssltrustedcertificate etcnginxcertsxxxxxxcomchainpem addheader StrictTransportSecurity maxage always include etcnginxvhostddefault setrealipfrom realipheader XRealIP realiprecursive on location proxypass proxysetheader Host host proxysetheader XRealIP remoteaddr proxysetheader XForwardedFor remoteaddr thanks guys Error description I want to run the shlinkioshlinklatest container on my server with your nginx reverse proxy setup Problem The Letsencrypt Validation Service gets a error from nginxweb container when it tries to access the ACME Challenge Steps to reproduce I use the following dockercomposeyaml version volumes db networks shlink webproxy external name webproxy services db containername shlinkurldb image mariadb restart always volumes dbvarlibmysql environment from env files MYSQLROOTPASSWORD MYSQLROOTPASSWORD MYSQLDATABASE MYSQLDATABASE MYSQLUSER MYSQLUSER MYSQLPASSWORD MYSQLPASSWORD networks shlink shlinkurlshortener image shlinkioshlinklatest containername shlinkurlshortener environment Shlink Config SHORTDOMAINHOST SERVICEDOMAIN SHORTDOMAINSCHEMA https The name of a query param that can be used to visit short URLs avoiding the visit to be tracked DISABLETRACKPARAM notrack Reverse Proxy Settings VIRTUALHOST SERVICEDOMAIN VIRTUALPORT LETSENCRYPTHOST SERVICEDOMAIN LETSENCRYPTEMAIL bjesuitergmailcom DB Settings DBDRIVER mysql DBNAME MYSQLDATABASE DBUSER MYSQLUSER DBPASSWORD MYSQLPASSWORD DBHOST db expose dependson db networks webproxy shlink The env File for this dockercompose is Global Vars SERVICEDOMAINlinksavilio Mariadb Setup Vars MYSQLROOTPASSWORDsomeMariaDBrootPW Shared Setup Vars between MariaDB Shlink MYSQLDATABASEshlink MYSQLUSERshlink MYSQLPASSWORDsomeMySQLPW Change the SERVICEDOMAIN var when running these test files Change the LETSENCRYPTEMAIL to a personal one instead of mine Run dockercompose up d to start the thingy Expected result The ACME Challenge can be executed successfully Error result The Letsencrypt Validation Service gets a error from nginxweb container when it tries to access the ACME Challenge Comments Things I checked and tried I added all necessary config to the shlink container being env var VIRTUALHOST SERVICEDOMAIN env var VIRTUALPORT env var LETSENCRYPTHOST SERVICEDOMAIN env var LETSENCRYPTEMAIL bjesuitergmailcom use network webproxy expose port besides being already exposed through the dockerfile of shlink I especially used the VIRTUALPORT env var I deleted all previously generated folders for linksavilio in nginxdatacerts folder to have a fresh starting point Suggestion As a follow up suggestion to this issue Do you want to create some kind of FAQ File which answers the most asked questions Its the second time now that i encounter this problem I fixed it the first time by recloning the repository and deleting the data folder But i dont want to re setup the whole reverseproxysystem each time i encounter this error My feeling tells me that the system seems confused if it cant connect to the service container on the very first certificate request But i cant proof this Anyway the FAQ should have a section for I get a HTTP error when ACME Challenge is validated This could mean A connection error between the reverse proxy and your service container Is your VIRTUALPORT property set when service container runs on a port other than 