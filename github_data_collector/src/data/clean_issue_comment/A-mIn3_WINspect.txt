When running CheckScheduledTasks it will only try to translate SID from PrincipalsPrincipalUserID and if the security context is a group the SID is at PrincipalsPrincipalGroupId and the function will crash possible fix ifPrincipalsPrincipalUserID sid NewObject SystemSecurityPrincipalSecurityIdentifierPrincipalsPrincipalUserID taskSecurityContext sidTranslate SystemSecurityPrincipalNTAccount elseifPrincipalsPrincipalGroupId sid NewObject SystemSecurityPrincipalSecurityIdentifierPrincipalsPrincipalGroupId taskSecurityContext sidTranslate SystemSecurityPrincipalNTAccount else taskSecurityContext Error translating sid Description I tried my best to standardize the capitalization throughout the script along with spacing I also replaced aliases with their full name