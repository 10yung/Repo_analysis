 PYSPARKDRIVERPYTHONjupyter PYSPARKDRIVERPYTHONOPTSnotebook spark binhadoop binpyspark drivermemory g driverclasspath applicationsearchessparkrecommenderelasticsearchhadoop distelasticsearchspark jar Im extremely new to ES but Ive been going through the notebook changing code where required to make it work eg multiple types per index are no longer supported Im now stuck at the retrievingcalculating the recommendations part of the example after calculating the embeddings and bringing them back into ES Specifically in the fnquery this part of the ES query is out of date script inline payloadvectorscore lang native params field modelfactor vector queryvec cosine cosine fails and I get the error RequestError RequestError searchphaseexecutionexception scriptscore the script could not be loaded And Im not sure how to get this up to speed for ES Cheers EDIT Ah Im assuming the script is a plugin written by MLnick in his other repository Which I notice has a TODO for porting to latest ES I created a Dockerfile that install the vector plugin to elasticserch and create an image Hello Ive added functions to display users similar to a given one for useruser recommendation Since we only use user IDs and not usernames it is a bit raw but it is still functional PYSPARKDRIVERPYTHONjupyter PYSPARKDRIVERPYTHONOPTSnotebook spark binhadoop binpyspark drivermemory g driverclasspath elasticsearchhadoop distelasticsearchspark jar This gives an error in command prompt PYSPARKDRIVERPYTHON is not recognized as an internal or external command operable command or a batch file Downloaded and installed everything When Im running the check PySpark is running spark command I get this NameError Traceback most recent call last ipythoninput c c a in module from IPythondisplay import Image HTML display check PySpark is running spark NameError name spark is not defined My commands SET PYSPARKDRIVERPYTHONC Program Files x Python Scripts jupyterexe SET PYSPARKDRIVERPYTHONOPTSnotebook nobrowser spark binhadoop bin pyspark drivermemory g driverclasspath elasticsearchhadoop dist elasticsearchhadoop jar 