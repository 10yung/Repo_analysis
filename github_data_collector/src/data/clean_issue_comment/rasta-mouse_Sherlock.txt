I am running Sherlockps on a CTFstyle vulnerable machine and it flags MS as Appears Vulnerable However according to sysinfo the machine has installed the KB hotfix that fixes MS Hello rastamouse Ive been trying to adapt Sherlock to work with PowerShell v and managed to make it work even with v without any problem I have an ugly but full functional code here but I will comment on some suggestions to be adapted accordingly by you in a more beautiful way GetFileVersionInfo Instead using Win Product class unstable on v and nonexistent on v we can use CIMDataFile Double slash for CIMDataFile FilePath FilePathReplace PsH v v support via CIMDataFile VersionInfo GetWmiObject Class CIMDataFile Filter NameFilePath SelectObject VersionVersion Also on WinXPWin k with v v for some reason the architecture check fail in some functions and Path will return null triggering an error in GetFileVersionInfo I fixed it by simply adding an extra Elseif conditional ElseIf Architecture eq x Path envwindir system win ksys 