Weve tested your project with an updated dependency and the build failed This version is either within the version range you specified or you havent specified a versionrange To be able to test your project with the new version weve taken the liberty of pinning the version for this branch and pull request name version specification new version rack Unfortunately we encountered failing tests after pinning This means that this new version is not compatible with your project and the test failure will potentially also happen on fresh installs If you have correctly specified a semantic versioning version range you should probably also file an issue with the upstream project as they might have released an update thats breaking SemVer rules which is not cool But then again not all projects explicitly follow SemVer Weve left the pull request open for you to investigate this issue Please dont merge it as is because again weve pinned the version of rack for this test run What changed rack Repo Changelog details summaryRelease Notessummary h from changelogh blockquoteul liRemove codeRackChunkedcode from codeRackServercode default middleware a href a href liRestore support for code relying on codeSessionIdtoscode a href ulblockquote pemDoes any of this look wrong a href let us knowaemp details details summaryCommitssummary pa href the full diff on Githuba The new version differs by commitsp ul lia href changelog for stablecodeali lia href versioncodeali lia href chunked middleware from default server stackcodeali lia href ActiveStorage usecase and add test case Fixes codeali lia href not deprecate RackFilecodeali lia href pull request from jeremyevanssessionidtoscodeali ul details Depfu Status Depfu will automatically keep this PR conflictfree as long as you dont add any commits to this branch yourself You can also trigger a rebase manually by commenting with depfu rebase detailssummaryAll Depfu comment commandssummary blockquotedl dt depfu rebasedtddRebases against your default branch and redoes this updatedd dt depfu recreatedtddRecreates this PR overwriting any edits that youve made to itdd dt depfu mergedtddMerges this PR once your tests are passing and conflicts are resolveddd dt depfu closedtddCloses this PR and deletes the branchdd dt depfu reopendtddRestores the branch and reopens this PR if its closeddd dt depfu pausedtddIgnores all future updates for this dependency and closes this PRdd dt depfu pause minormajor dtddIgnores all future minormajor updates for this dependency and closes this PRdd dt depfu resumedtddFuture versions of this dependency will create PRs again leaves this PR as isdd dlblockquote details I have a microservice architecture and each microservice has a specific path to be accessed My oauth API has the path uaa So I tried to change the tokenurl param to be uaaoauthtoken and I didnt get success also I put my site address with the suffix uaa however and according to the semantic it considers only the domain ignoring the rest Weve tested your project with an updated dependency and the build failed This version is either within the version range you specified or you havent specified a versionrange To be able to test your project with the new version weve taken the liberty of pinning the version for this branch and pull request name version specification new version faraday Unfortunately we encountered failing tests after pinning This means that this new version is not compatible with your project and the test failure will potentially also happen on fresh installs If you have correctly specified a semantic versioning version range you should probably also file an issue with the upstream project as they might have released an update thats breaking SemVer rules which is not cool But then again not all projects explicitly follow SemVer Weve left the pull request open for you to investigate this issue Please dont merge it as is because again weve pinned the version of faraday for this test run What changed faraday Repo Changelog Depfu Status Depfu will automatically keep this PR conflictfree as long as you dont add any commits to this branch yourself You can also trigger a rebase manually by commenting with depfu rebase detailssummaryAll Depfu comment commandssummary blockquotedl dt depfu rebasedtddRebases against your default branch and redoes this updatedd dt depfu recreatedtddRecreates this PR overwriting any edits that youve made to itdd dt depfu mergedtddMerges this PR once your tests are passing and conflicts are resolveddd dt depfu closedtddCloses this PR and deletes the branchdd dt depfu reopendtddRestores the branch and reopens this PR if its closeddd dt depfu pausedtddIgnores all future updates for this dependency and closes this PRdd dt depfu pause minormajor dtddIgnores all future minormajor updates for this dependency and closes this PRdd dt depfu resumedtddFuture versions of this dependency will create PRs again leaves this PR as isdd dlblockquote details This is a simple change to merge a relative reference or absolute URI from the location header into the original request URI If there are any barriers to this being merged please let me know The returned location is used for the next request directly but in some cases this can be a relative URL An obsolete version of the HTTP specifications IETF RFC required a complete absolute URI for redirection The IETF HTTP working group found that the most popular web browsers tolerate the passing of a relative URL and consequently the updated HTTP specifications IETF RFC relaxed the original constraint allowing the use of relative URLs in Location headers When making the request to retrieve an access token if the API requires you to use TLS client auth as the authentication mechanism then it will fail if the client secret is sent For this auth type only the client ID should be sent We do not currently allow the developer to customise this we set the client ID and secret by default for all access token requests This PR adds an extra section to the case statement in Authenticatorapply to add the desired functionality when passing in tlsclientauth as the auth mode the client secret will be omitted from the request applicationhelperrb module ApplicationHelper def googleoauthclient GoogleAuthnewrequestservice params service end end libgoogleauthrb class GoogleAuth class GoogleAuthException StandardError end class JWTProblem GoogleAuthException end attrreader oauthclient redirecturi def initializerequeststatedata oauthclient OAuth Clientnew ENV GOOGLEOAUTHCLIENTID ENV GOOGLEOAUTHCLIENTSECRET site authorizeurl ooauth auth tokenurl ooauth token statedata statedata buildredirectparamsrequest end def identifyauthorizationcode accesstoken oauthclientauthcodegettoken authorizationcode redirecturi redirecturi profile accesstokenget email profile email refreshtoken accesstokenrefreshtoken return email email refreshtoken refreshtoken end def loginuri oauthclientauthcodeauthorizeurlredirectparams end def ticket ticket CASinoLoginTicketcreateticket end def state state ticket ticket mergestatedatatojson end private def buildredirectparamsrequest return redirectparams if redirectparams uri URIparserequesturl uripath ENV GOOGLEOAUTHCALLBACKPATH uriquery nil redirecturi uritos redirectparams redirecturi redirecturi scope email join accesstype offline state state end end Previously it was working fine but after upgrading ruby and rails version it is giving error uninitialized constant ApplicationHelperGoogleAuth Please let me know what could be the reason Hey I tried to do simple token refresh stubbing today but the lib made it tough client OAuth Clientnew CLIENTID CLIENTSECRET authorizeurl site tokenurl token OAuth AccessTokennew client ACCESSTOKEN refreshtoken REFRESHTOKEN You can ignore those URLs Then I do tokenrefresh in a test Heres a brief version of that RSpecdescribe quickbooksonlinetoken type feature do before do stubrequestpost with body clientidCLIENTID clientsecretCLIENTSECRET granttyperefreshtoken refreshtokenREFRESHTOKEN headers Accept AcceptEncodinggzipq deflateq identityq ContentTypeapplicationxwwwformurlencoded UserAgentFaraday v toreturn status body tokentype bearer expiresin refreshtoken NEWREFRESHTOKEN xrefreshtokenexpiresin accesstoken NEWACCESSTOKEN headers end context refresh do subject tokenrefresh token comes from code above it expectsubjectaccesstokento eqNEWACCESSTOKEN end end But all I got is this error OAuth Error tokentypebearerexpiresin refreshtokenNEWREFRESHTOKENxrefreshtokenexpiresin accesstokenNEWACCESSTOKEN So stubbing works fine but whats up with the error Does it make sense to you After digging I came across this clientrbL You just return generic error with response body Thats not very helpful Then after putting bunch of debugger statements I noticed that responseparsed returned nil But still couldnt figure out why After going deeper into response class I noticed that parser was nil so it couldnt pick up correct parser This is where I stopped trying to figure out how oauth picks up parser and just tried to set ContentType response header headers ContentTypeapplicationjson And that was it I think it would be way better to raise some meaningful error here responserbL instead of just returning nil and then raising generic OAuth Error with response body Writing an Rspec controller request spec using the oauth gem I had to do the following hack to mock up an OAuth error ruby context error do VERY hacky test made to allow us to raise an OAuth Error from looking at the gems documentation letoautherror do rawresponse FaradayResponsenew status responseheaders fake things body status errorMessage Authentication failed OAuth token invalid or expired OAuth ErrornewOAuth Responsenewrawresponse end it responds with error and tries again do allowOAuth Clientto receivenewandraiseoautherror get referoauthauthorizepath params codeplaceholder staterefer expectresponseto redirecttoreferoauthurl expectresponseto havehttpstatus end end Ideally the Oauth gem should return errors that are easy to test and dont require parsing the gems internals Hi Beginner question so apologies if obvious I am trying to authenticate using oauth against a rd party API I am using the ruby gem oauth The authorizeurl method insists on adding an oauth subfolder to my URL So I want this But I get clientid Demo clientsecret blablabla sitepath client OAuth Clientnewclientid clientsecret site sitepath clientauthcodeauthorizeurl Why is this happening and how can I solve it please