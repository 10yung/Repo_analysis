I have been trying to use TFdatasets to load batches from a collection of csv into a keras GRU classification model but have met several obstacles Code error messages and config details from my best attempt follows The code is adapted poorly from several examples on the rstudio tensorflow page eg R interface to TensorFlow Dataset API Data summary The bulk of the data are timesamples from electrodes The targetDV are classifications in the form of an integer column Emo In this attempt a function uses makecsvdataset to import from a list of files uses one hot encoding levels before ending with datasetprepare The output shape looks reasonable x Batch y Batch but keras produces Error in pycallimplcallable dotsargs dotskeywords KeyError see below for full for my first layer I trying to get this code to cycle through a list of csv but I have selected only a small amount of data for this example Apparently I am missing something important but I havent been able to determine what I need to do I have some R experience and worked with keras models but this is my first tfdatasets attempt I wouldnt ask unless I exhausted all my options so I humbly thank you in advance for any suggestions CODE figure out how to use TFdatasets load csv each with time samples electrodes into a keras model for classification installpackagesdevtools devtoolsinstallgithubcrstudioreticulate libraryreticulate devtoolsinstallgithubcrstudiotfdatasets devtoolsinstallgithubcrstudiotensorflow devtoolsinstallgithubcrstudiokeras librarytensorflow librarytensorflow librarytfdatasets librarykeras librarytidyverse rmlistls SAVEDir pasteFPeriERNRSubCatVal OutModels sep EmoKey cVal NumCatz Number of categories NofTrainTime For a small size test NofValidTimes ignore for now NofEpochs BatchN EmoDir pasteFPeriERNRSubCatVal Part sep To get CSV setwdEmoDir filesTE listfilespath pasteEmoDir fullnames TRUE Get the dataset change Emo to a categorical variable and output to keras EEGClass functionfilesTE Clz makecsvdatasetlistfilesTE batchsize BatchN header TRUE numepochs NofEpochs shuffle FALSE prefetchbuffersize BatchN Recommended value is the number of batches consumed per training step sloppy FALSE numrowsforinference datasetmap functionrecord recordEmo tfonehotrecordEmo L record datasetpreparex Emo y Emo dropremainder TRUE namedfeatures FALSE named TRUE Clz datasetrepeat end function EEGClass outputshapesClz results in x y outputtypesClz both dtype float Clz reticulateasiterator reticulateiternext reticulatepytor model GRU model NULL model kerasmodelsequential model layergruunits dropout recurrentdropout returnsequences TRUE batchsize BatchN resetafter TRUE recurrentactivation sigmoid inputshape listNULL End GRU layergruunits dropout recurrentdropout batchsize BatchN resetafter TRUE recurrentactivation sigmoid End GRU layerdenseNumCatz activation softmax batchsize BatchN model compile optimizer optimizeradam metrics accuracy loss listcategoricalcrossentropy End compile summarymodel Run this model history model fitEEGClassfilesTE stepsperepoch NofTrainTimeBatchN epochs NofEpochs For this test verbose callbacks callbackslist End run model OUTPUT and ERROR MESSAGE Train for steps ETA sError in pycallimplcallable dotsargs dotskeywords KeyError gruinput Detailed traceback File C Users Lauritz Anaconda envs rreticulate lib sitepackages tensorflowcore python keras engine trainingpy line in fit usemultiprocessingusemultiprocessing File C Users Lauritz Anaconda envs rreticulate lib sitepackages tensorflowcore python keras engine trainingv py line in fit totalepochsepochs File C Users Lauritz Anaconda envs rreticulate lib sitepackages tensorflowcore python keras engine trainingv py line in runoneepoch batchouts executionfunctioniterator File C Users Lauritz Anaconda envs rreticulate lib sitepackages tensorflowcore python keras engine trainingv utilspy line in executionfunction distributedfunctioninputfn File C Users Lauritz Anaconda envs rreticulate lib sitepackages tensorflowcore python eager deffunctionpy line in call result selfcallargs kwds File C Users Lauritz CONFIG DETAILS tensorflowtfconfig TensorFlow v C Users Lauritz ANACON envs RRETI lib sitepackages tensorflow initp Python v CUsersLauritzAnaconda envsrreticulatepythonexe reticulatepyconfig python CUsersLauritzAnaconda envsrreticulatepythonexe libpython CUsersLauritzAnaconda envsrreticulatepython dll pythonhome CUsersLauritzAnaconda envsrreticulate version Anaconda Inc default Jul MSC v bit AMD Architecture bit numpy CUsersLauritzAnaconda envsrreticulateLibsitepackagesnumpy numpyversion tensorflow C Users Lauritz ANACON envs RRETI lib sitepackages tensorflow initp python versions found CUsersLauritzAnaconda envsrreticulatepythonexe CUsersLauritzAnaconda pythonexe version platform x w mingw arch x os mingw system x mingw status major minor year month day svn rev language R versionstring R version nickname Dark and Stormy Night packageVersiontensorflow Hi I am having problems in understanding what am I doing wrong I have been working with tensorflow for a year without any problem tfplaceholder for example works fine this year I am trying to use Keras and I realised that there are problems with the tensorflow installation in particular I receive the following errors pyconfig python C Users tm n AppData Local Continuum Anaconda envs rtensorflow pythonexe libpython CUserstm n AppDataLocalContinuumAnaconda envsrtensorflowpython dll pythonhome C Users tm n AppData Local CONTIN ANACON envs RTENS version Anaconda Inc default Jul MSC v bit AMD Architecture bit numpy C Users tm n AppData Local CONTIN ANACON envs RTENS lib sitepackages numpy numpyversion keras C Users tm n AppData Local CONTIN ANACON envs RTENS lib sitepackages keras initp python versions found C Users tm n AppData Local Continuum Anaconda envs rtensorflow pythonexe C Users tm n AppData Local CONTIN ANACON pythonexe Is it possible that the system recognises more than one python version I open pythonexe and I try to run import tensorflow as tf import numpy as np and for both I receive an error stating that they are not correctly installed Then going back to run I also have these information reticulatepymoduleavailabletensorflow FALSE tensorflowtfconfig TensorFlow v C Users tm n AppData Local CONTIN ANACON envs RTENS lib sitepackages keras initp Python v C Users tm n AppData Local Continuum Anaconda envs rtensorflow pythonexe Also in this case does it mean that Tensorflow and Python are on different paths Thank you for your time and help Tullio Code I ran librarykeras librarytfdatasets bostonhousing datasetbostonhousing ctraindata trainlabels bostonhousingtrain ctestdata testlabels bostonhousingtest paste Training entries lengthtraindata labels lengthtrainlabels traindata Display sample features notice the different scales librarydplyr columnnames cCRIM ZN INDUS CHAS NOX RM AGE DIS RAD TAX PTRATIO B LSTAT traindf traindata astibblenamerepair minimal setNamescolumnnames mutatelabel trainlabels testdf testdata astibblenamerepair minimal setNamescolumnnames mutatelabel testlabels trainlabels Display first entries spec featurespectraindf label stepnumericcolumnallnumeric normalizerfn scalerstandard fit spec layer layerdensefeatures featurecolumns densefeaturesspec dtype tffloat layertraindf model compile loss mse optimizer optimizerrmsprop metrics listmeanabsoluteerror buildmodel function input layerinputfromdatasettraindf selectlabel output input layerdensefeaturesdensefeaturesspec layerdenseunits activation relu layerdenseunits activation relu layerdenseunits model kerasmodelinput output model compile loss mse optimizer optimizerrmsprop metrics listmeanabsoluteerror model Display training progress by printing a single dot for each completed epoch printdotcallback callbacklambda onepochend functionepoch logs if epoch cat n cat model buildmodel history model fit x traindf selectlabel y traindflabel epochs validationsplit verbose callbacks listprintdotcallback libraryggplot Error Prompt I tensorflowstreamexecutorplatformdefaultdsoloadercc Successfully opened dynamic library cublas dll E tensorflowstreamexecutorcudacudablascc failed to create cublas handle CUBLASSTATUSALLOCFAILED E tensorflowstreamexecutorcudacudablascc failed to create cublas handle CUBLASSTATUSALLOCFAILED E tensorflowstreamexecutorcudacudablascc failed to create cublas handle CUBLASSTATUSALLOCFAILED E tensorflowstreamexecutorcudacudablascc failed to create cublas handle CUBLASSTATUSALLOCFAILED E tensorflowstreamexecutorcudacudablascc failed to create cublas handle CUBLASSTATUSALLOCFAILED E tensorflowstreamexecutorcudacudablascc failed to create cublas handle CUBLASSTATUSALLOCFAILED E tensorflowstreamexecutorcudacudablascc failed to create cublas handle CUBLASSTATUSALLOCFAILED E tensorflowstreamexecutorcudacudablascc failed to create cublas handle CUBLASSTATUSALLOCFAILED E tensorflowstreamexecutorcudacudablascc failed to create cublas handle CUBLASSTATUSALLOCFAILED W tensorflowstreamexecutorstreamcc attempting to perform BLAS operation using StreamExecutor without BLAS support W tensorflowcorecommonruntimebasecollectiveexecutorcc BaseCollectiveExecutorStartAbort Internal Blas GEMM launch failed ashape bshape m n k node modeldenseMatMul Error in pycallimplcallable dotsargs dotskeywords InternalError Blas GEMM launch failed ashape bshape m n k node modeldenseMatMul defined at framework opspy Opinferencedistributedfunction Function call stack distributedfunction Detailed traceback File C Users jtseng AppData Local rminiconda envs rreticulate lib sitepackages tensorflowcore python keras engine trainingpy line in fit usemultiprocessingusemultiprocessing File C Users jtseng AppData Local rminiconda envs rreticulate lib sitepackages tensorflowcore python keras engine trainingv py line in fit totalepochsepochs File C Users jtseng AppData Local rminiconda envs rreticulate lib sitepackages tensorflowcore python keras engine trainingv py line in runoneepoch batchouts executionfunctioniterator File C Users jtseng AppData Local rminiconda envs rreticulate lib sitepackages tensorflowcore python keras engine traini My Config details tensorflowtfconfig TensorFlow v Python v CUsersjtsengAppDataLocalrminicondaenvsrreticulatepythonexe reticulatepyconfig python CUsersjtsengAppDataLocalrminicondaenvsrreticulatepythonexe libpython CUsersjtsengAppDataLocalrminicondaenvsrreticulatepython dll pythonhome CUsersjtsengAppDataLocalrminicondaenvsrreticulate version Anaconda Inc default Jul MSC v bit AMD Architecture bit numpy CUsersjtsengAppDataLocalrminicondaenvsrreticulateLibsitepackagesnumpy numpyversion version platform x w mingw arch x os mingw system x mingw status major minor year month day svn rev language R versionstring R version nickname Action of the Toes I know this is a known issue where the solution is to run code below import tensorflow as tf from kerasbackendtensorflowbackend import setsession config tfConfigProto configgpuoptionsallowgrowth True dynamically grow the memory used on the GPU configlogdeviceplacement True to log device placement on which device the operation ran nothing gets printed in Jupyter only if you run it standalone sess tfSessionconfigconfig setsessionsess set this TensorFlow session as the default session for Keras But I am using Rstudio as opposed to Python What do I do This issue has been bugging me ive reinstalled my Nvidia installation files successfully times reinstalled my R base and Rstudio times it eventually reverts back into the issue above Need your help to resolve this at your soonest convenience similarly Hardware Quadro M NVIDIA Installed Drivers and Prerequisite Applications Quadro desktopnotebook win bit cuda win exe cudnn windows x v zip thank you James tensorboardlogdir results in an error Traceback most recent call last File homejamesvirtualenvsrreticulatebintensorboard line in module sysexitrunmain File homejamesvirtualenvsrreticulatelibpython sitepackagestensorboardmainpy line in runmain defaultgetplugins defaultgetdynamicplugins File homejamesvirtualenvsrreticulatelibpython sitepackagestensorboarddefaultpy line in getdynamicplugins for entrypoint in pkgresourcesiterentrypointstensorboardplugins File homejamesvirtualenvsrreticulatelibpython sitepackagestensorboarddefaultpy line in listcomp for entrypoint in pkgresourcesiterentrypointstensorboardplugins File homejamesvirtualenvsrreticulatelibpython sitepackagespkgresourcesinitpy line in load selfrequireargs kwargs File homejamesvirtualenvsrreticulatelibpython sitepackagespkgresourcesinitpy line in require items workingsetresolvereqs env installer extrasselfextras File homejamesvirtualenvsrreticulatelibpython sitepackagespkgresourcesinitpy line in resolve raise VersionConflictdist reqwithcontextdependentreq pkgresourcesVersionConflict grpcio homejamesvirtualenvsrreticulatelibpython sitepackages Requirementparsegrpcio Error in if tensorboardversion argument is of length zero In addition Warning message In systemtensorboard versiontb intern TRUE running command tensorboard versiontb had status sessionInfo R version Platform x pclinuxgnu bit Running under Ubuntu LTS Matrix products default BLAS usrlibx linuxgnuopenblaslibblasso LAPACK usrlibx linuxgnulibopenblaspr so locale LCCTYPEenCAUTF LCNUMERICC LCTIMEenCAUTF LCCOLLATEenCAUTF LCMONETARYenCAUTF LCMESSAGESenCAUTF LCPAPERenCAUTF LCNAMEC LCADDRESSC LCTELEPHONEC LCMEASUREMENTenCAUTF LCIDENTIFICATIONC attached base packages stats graphics grDevices utils datasets methods base other attached packages tensorflow reticulate here tictoc purrr datatable caret ggplot lattice keras rlang magrittr assertthat digest loaded via a namespace and not attached tidyselect reshape splines colorspace generics stats base enc survival prodlim ModelMetrics pillar glue withr rappdirs foreach plyr lava stringr timeDate munsell gtable recipes codetools tfruns class Rcpp backports scales ipred jsonlite stringi dplyr rprojroot grid tools lazyeval tibble crayon whisker pkgconfig zeallot MASS Matrix lubridate gower rstudioapi iterators R rpart nnet nlme compiler I am using tensorflow r packageVersiontensorflow Running code from r spec featurespechearts target stepnumericcolumn allnumeric cp restecg exang sex fbs normalizerfn scalerstandard stepcategoricalcolumnwithvocabularylistthal stepbucketizedcolumnage boundaries c stepindicatorcolumnthal stepembeddingcolumnthal dimension stepcrossedcolumncthal bucketizedage hashbucketsize stepindicatorcolumncrossedthalbucketizedage spec fitspec Now define a simple keras model r input layerinputfromdatasethearts selecttarget output input layerdensefeaturesfeaturecolumns densefeaturesspec Get scores r model kerasmodelinput output heartsfeatures model predicthearts selecttarget dimheartsfeatures I look at the dense features defined in spec and I see that the second feature listed below is trestbps r densefeaturesspec age NumericColumnkeyage shape defaultvalueNone dtypetffloat normalizerfnfunction makepythonfunctionlocalspythonfunction at x f a trestbps NumericColumnkeytrestbps shape defaultvalueNone dtypetffloat normalizerfnfunction makepythonfunctionlocalspythonfunction at x f d a chol NumericColumnkeychol shape defaultvalueNone dtypetffloat normalizerfnfunction makepythonfunctionlocalspythonfunction at x f d e I would expect the second column on heartsfeatures to be standardized trestbps but it is not r dimheartsfeatures summaryheartsfeatures Min st Qu Median Mean rd Qu Max summaryheartstrestbps Min st Qu Median Mean rd Qu Max The number of columns on heartsfeatures is correct but the order seems inconsistent with spec I guess the order of the columns on heartsfeatures is determined by how tensor elements output by layerdensefeatures are ordered So is there a way to tell what the order is Hi I am trying to write feedforward networks in the sequential API but cannot reproduce the example here Specifically when converting the dataset using the following lines trainds mnisttrain tensorslicesdataset datasettake datasetmapmodifyatx x tfcast dtype tffloat datasetmapmodifyatx y tfcast dtype tfint datasetshuffle datasetbatch R prompts the following error message Error in pycallimplcallable dotsargs dotskeywords Evaluation error Unable to convert R object to Python type It seems still possible to run the example by taking out the cast lines because tf automatically coerces them into the proper format However I cannot achieve that with my own feedforward neural network In short I want to understand the format and dimension of data needed to run the sequential API and how to get them Thanks Looks like the valid range is not see Tensorflow wont install although it is running I loaded it sometime back so I think my setup has changed i it was not running initially and trying a certain number of combinations regarding the setting of environmental variables it started running But this is a problem as now Tensorboard is not running ii firstly my setup Windows a R Tensorflow version b tfestimators version c keras version I intend to run keras eventually e Python d environmental Variables Conda C Users gbort Anaconda Scripts Python C Users gbort Anaconda envs rtensorflow Question Do I have to have another tensorflow or tensorboard env variables or does python bind to these This is where my confusion lies There is a python folder in the R library folder under reticulate C Users gbort Documents R winlibrary reticulate python THE PROBLEMS I want to reinstall the tensorflow conda config installtensorflowmethodconda Error Unable to create process using C Users gbort ANACON pythonexe C Users gbort ANACON Scripts condascriptpy create yes name rreticulate python Error Error occurred creating conda environment rreticulate Tensorboard Error see below for the code and errors r Creating a single step TensorBoard Set up your session EmployeeSession tfSession Add your constants female tfconstant name FemaleEmployees male tfconstant name MaleEmployees total tfaddfemale male printEmployeeSessionruntotal Write to file towrite tfsummaryFileWritergraphs EmployeeSessiongraph Open Tensorboard tensorboardlogdir graphs Error invalid version specification Traceback most recent call last File C Users gbort ANACON envs RTENS Scripts tensorboardscriptpy line in module sysexitrunmain File C Users gbort ANACON envs RTENS lib sitepackages tensorboard mainpy line in runmain serverconfiguresysargv File C Users gbort ANACON envs RTENS lib sitepackages tensorboard programpy line in configure loaderfixflagsflags File C Users gbort ANACON envs RTENS lib sitepackages tensorboard plugins core corepluginpy line in fixflags raise ValueErrorA logdir or db must be specified ValueError A logdir or db must be specified For example tensorboard logdir mylogdir or tensorboard db sqlitetensorboarddb Run tensorboard helpfull for details and examples Dont understand the error Many Thanks By ther way when I run tfconfig the response is TensorFlow v C Users gbort ANACON envs RTENS lib sitepackages tensorflow initp Python v C Users gbort ANACON envs RTENS pythonexe history model fittrainxytrainepochs batchsize validationsplit W tensorflowcoreframeworkopkernelcc OPREQUIRES failed at castopcc Unimplemented Cast string to float is not supported E tensorflowcorecommonruntimeexecutorcc Executor failed to create kernel Unimplemented Cast string to float is not supported node Cast reticulatepyconfig python C conda envs rreticulate pythonexe libpython Ccondaenvsrreticulatepython dll pythonhome C conda envs RRETI version Anaconda Inc default Jul MSC v bit AMD Architecture bit numpy C conda envs RRETI lib sitepackages numpy numpyversion tensorflow C conda envs RRETI lib sitepackages tensorflow initp python versions found C conda envs rreticulate pythonexe C Users somy AppData Local Programs Python Python pythonexe C conda pythonexe C Users somy AppData Local Programs Python Python pythonexe tensorflowtfconfig TensorFlow v C conda envs RRETI lib sitepackages tensorflow initp Python v C conda envs rreticulate pythonexe 