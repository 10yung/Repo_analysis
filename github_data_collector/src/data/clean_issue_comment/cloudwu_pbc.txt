wmessagec pbcwmessageinteger LABELOPTIONAL pack isSet setDefault Hello how to write a logical given For example pbcmessagebool msg key true C lua lua pbc testlua extern C include luah include lualibh include lauxlibh include iostream include string int main luaState L luaLnewstate luaLopenlibsL int rst luaLdofileL testlua stdstring value luatostringL stdcout rst stdendl stdcout value stdendl g testluacpp I exportgameMXMMOluainclude exportgameMXMMOlualibliblua a ldl gameVM centos script aout error loading module protobufc from file protobufso protobufso undefined symbol luacheckstack uint t out uint tilow hi pbc luadecode gives the result not the same as origin data When I ran the program pattern A issue occurred its a heap use after free issue Details ERROR AddressSanitizer heapuseafterfree on address x at pc x f cdc d bp x ffc fae sp x ffc fad READ of size at x thread T x f cdc d usrlibx linuxgnulibasanso x d x f f in pbcMspquery srcmapc x e in pbcPgetmessage srcprotoc x fa in pbcpatternnew srcpatternc x b a in main testpatternc x f c d f in libcstartmain libx linuxgnulibcso x f x in start homemfcfuzzpbcbuildpattern x x is located bytes inside of byte region x e x freed by thread T here x f ce ca in interceptorfree usrlibx linuxgnulibasanso x ca x d in pbcMfree srcallocc x e in pbcHdelete srcallocc x b in pbcrmessagedelete srcrmessagec x f in pbcregister srcregisterc x b in main testpatternc x f c d f in libcstartmain libx linuxgnulibcso x f previously allocated by thread T here x f ce in malloc usrlibx linuxgnulibasanso x x e in pbcMmalloc srcallocc x dc in pbcHalloc srcallocc x ff in readstring srcrmessagec x b in readvalue srcrmessagec x da in pbcrmessagenew srcrmessagec x b f in pushvaluearray srcrmessagec x ba in pbcrmessagenew srcrmessagec x b f in pushvaluearray srcrmessagec x ba in pbcrmessagenew srcrmessagec x b f in pushvaluearray srcrmessagec x ba in pbcrmessagenew srcrmessagec x a in pbcrmessagenew srcrmessagec x e in pbcregister srcregisterc x b in main testpatternc x f c d f in libcstartmain libx linuxgnulibcso x f SUMMARY AddressSanitizer heapuseafterfree Shadow bytes around the buggy address x c fff f fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd x c fff fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd x c fff fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd x c fff fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd x c fff fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd x c fff fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd x c fff fd fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa x c fff fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa x c fff fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd x c fff fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd x c fff fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd Shadow byte legend one shadow byte represents application bytes Addressable Partially addressable Heap left redzone fa Heap right redzone fb Freed heap region fd Stack left redzone f Stack mid redzone f Stack right redzone f Stack partial redzone f Stack after return f Stack use after scope f Global redzone f Global init order f Poisoned by user f Container overflow fc Array cookie ac Intra object redzone bb ASan internal fe ABORTING The command line I used is just pattern testcase The testcase of this issue has been put at A global buffer overflow has been detected When I was running program pbc a global buffer overflow has been detected The input file has been put at Details provided by ASAN ERROR AddressSanitizer globalbufferoverflow on address x c at pc x f b bp x ffd f sp x ffd f b READ of size at x c thread T x f a in interceptorstrlen usrlibx linuxgnulibasanso x a x bf in calchash srcmapc x d f in pbcMspquery srcmapc x c e in setfieldone srcbootstrapc x in pbcBregisterfields srcbootstrapc x e in register srcregisterc x b in registernodependency srcregisterc x b in pbcregister srcregisterc x d b in testdes testpbcc x f in main testpbcc x f fd f in libcstartmain libx linuxgnulibcso x f x in start homemfcfuzzpbcbuildpbc x x c is located bytes to the right of global variable LC defined in srcbootstrapc x c of size LC is ascii string SUMMARY AddressSanitizer globalbufferoverflow interceptorstrlen Shadow bytes around the buggy address x e f f f f f f f f f f f x e f f f f f f f x e f f f f f f f f f f x e f f f f x e x e f f f x e f f f f x e a x e b x e c x e d Shadow byte legend one shadow byte represents application bytes Addressable Partially addressable Heap left redzone fa Heap right redzone fb Freed heap region fd Stack left redzone f Stack mid redzone f Stack right redzone f Stack partial redzone f Stack after return f Stack use after scope f Global redzone f Global init order f Poisoned by user f Container overflow fc Array cookie ac Intra object redzone bb ASan internal fe ABORTING When I ran the program addressbook ASAN found a global buffer overflow ERROR AddressSanitizer globalbufferoverflow on address x a at pc x ade bp x ffcea b sp x ffcea b READ of size at x a thread T x ade in pbcwmessagestring srcwmessagec x a in testwmessage testaddressbookc x in main testaddressbookc x f e f in libcstartmain libx linuxgnulibcso x f x in start homemfcfuzzpbcbuildaddressbook x x a is located bytes to the right of global variable LC defined in testaddressbookc x a of size LC is ascii string MOBILE SUMMARY AddressSanitizer globalbufferoverflow srcwmessagec pbcwmessagestring Shadow bytes around the buggy address x f e f f f f f f f f f f f f f x f f f f f f f f f f f f f f f x f f f f f f f f f f f x f f f f f f f f f f f f f f x f f f f f f f f f f f f f x f f f f f f f f f f f f x f f f f f f f x f x f f f f f f f f x f f f f f f f f f f f f f f f x f f f f f f f f f f f f f f f Shadow byte legend one shadow byte represents application bytes Addressable Partially addressable Heap left redzone fa Heap right redzone fb Freed heap region fd Stack left redzone f Stack mid redzone f Stack right redzone f Stack partial redzone f Stack after return f Stack use after scope f Global redzone f Global init order f Poisoned by user f Container overflow fc Array cookie ac Intra object redzone bb ASan internal fe ABORTING A SEGV signal occurred when running program pbc ERROR AddressSanitizer SEGV on unknown address x pc x fa a bp x ffff f sp x ffff edd T x fa a in strlen libx linuxgnulibcso x b x fa a dc a usrlibx linuxgnulibasanso x bc a x b in readfile testreadfileh x f in testdes testpbcc x e d in main testpbcc x fa a f in libcstartmain libx linuxgnulibcso x f x in start homemfcfuzzpbcbuildpbc x AddressSanitizer can not provide additional info SUMMARY AddressSanitizer SEGV strlen ABORTING 