Hi I have some questions about oncoprint function In instruction manual i can reorder column by columnorder sampleorder user defined list Is it possible to automatically reorder in subgroup define by user Lets say we have two distinct tumor group how can we reorder sample column in each subgroup Oncoprintsample add annotation name for the text annotations densityHeatmap add arguments to control whether show the quantile lines support biclustering how fix a bug of multiple horizontal legends put below the heatmap support ggtree improve the calculation of break values in the legends the first page is still empty the figure is in the second page when saving oncoPrint into PDF maybe other plots UpSet plots optimize the processing of many sets current solution consumes huge memory UpSet plots the intersect and union seem not correct Need more tests support a global and overlegends eg gaps between legends controls for multiple legends Setting a matrix as annotations is sometimes confusing eg which dimension of the matrix should be corresponded to the heatmap row or columns A solution is to automatically check it by looking at the dimension of the annotation matrix and the heatmap matrix griddendrogram optimized it solve the problem of node stack overflow I am working with data where I have a bar plot and I would like the bar plot to be able to be colored differently using a function How can I do this The function would just be use one color for all bars that share a different data value or feature Any help is appreciated Thanks Mark I would like to able to use cellfun to print the values of my cells When I try to do what you do at in section but skip the font size I get something unreadable If I set the font size it is more readable but I still cant see individual cell values This is partly because I have around columns I would like to be able to make one heatmap that is readable with values I am also interested on if I can split my heatmap into multiple pieces by column but not lose the coloring being determined by the whole rowfor the purpose of printing out the charts Please let me know if this is possible Thanks for such an amazing piece of software Mark Ive tried running this code several times but it does not work libraryComplexHeatmap alterfun list mut functionx y w h gridrectx y w h gp gparfill red col NA mut functionx y w h gridrectx y w h gp gparfill blue col NA mut functionx y w h gridrectx y w h gp gparfill yellow col NA mut functionx y w h gridrectx y w h gp gparfill purple col NA mut functionx y w h gridrectx y w h gp gparfill NA lwd mut functionx y w h gridpointsx y pch mut functionx y w h gridsegmentsx w y h x w y h gp gparlwd testalterfunalterfun I get the following error Error in testalterfunalterfun could not find function testalterfun here is my session information sessionInfo R version Platform x appledarwin bit Running under macOS Matrix products default BLAS SystemLibraryFrameworksAccelerateframeworkVersionsAFrameworksvecLibframeworkVersionsAlibBLASdylib LAPACK LibraryFrameworksRframeworkVersions ResourcesliblibRlapackdylib locale enUSUTF enUSUTF enUSUTF CenUSUTF enUSUTF attached base packages grid stats parallel stats graphics grDevices utils datasets methods base other attached packages ComplexHeatmap expands trackViewer rtracklayer Gviz tidyr dplyr yarrr circlize BayesFactor Matrix coda jpeg g viz RColorBrewer stringr GenVisR cellscape AneuFinder cowplot GenomicRanges GenomeInfoDb IRanges S Vectors AneuFinderData copynumber BiocGenerics loaded via a namespace and not attached tidyselect RSQLite AnnotationDbi htmlwidgets ReorderCluster BiocParallel RNeXML munsell codetools colorspace BiocInstaller Biobase knitr uuid rstudioapi rJava labeling GenomeInfoDbData bit farver vctrs xfun cgdsr biovizBase R doParallel AnnotationFilter flexmix bitops DelayedArray assertthat scales nnet gtable phylobase swirl ensembldb rlang MatrixModels zeallot GlobalOptions splines lazyeval acepack dichromat checkmate BiocManager yaml reshape GenomicFeatures backports Hmisc RMySQL tools ggplot ellipsis gplots ggdendro DNAcopy Rcpp plyr base enc progress zlibbioc purrr RCurl prettyunits rpart GetoptLong pbapply viridis SummarizedExperiment ggrepel cluster magrittr datatable NbClust mvtnorm grImport ProtGenerics matrixStats flexclust hms XML mclust gridExtra shape testthat compiler biomaRt tibble KernSmooth crayon Roo htmltools Formula DBI matlab MASS ade RmethodsS gdata pkgconfig rncl GenomicAlignments foreign xml InteractionSet foreach XVector VariantAnnotation digest graph Biostrings htmlTable curl Rsamtools gtools modeltools rjson FField lifecycle nlme jsonlite viridisLite BSgenome pillar lattice httr plotrix survival glue bamsignals iterators bit Rgraphviz class stringi blob moments commonsMath ecp latticeExtra caTools memoise ape As necessary extra functionality also implemented the ability to adjust vertical gaps between rows wasnt implemented at all and horizontal gaps between columns separately Sorry my editor vim automatically converted all tabs into spaces as well Hope this is not a problem Hello I was trying to increase the texts sizes in my figure I am trying the tutorial but failed Maybe I am missing something Any help Here is my code and the figure I got I want the same figure with larger font sizes in all texts Is ther any way to do this Best Zillur heatmapdnarepair colAnn HeatmapAnnotationdfanndata whichcol colcolours gapunit mmgp gparfontsize rowAnnHeatmapAnnotationdfanndata which rowcolcolor gapunit mmgp gparfontsize boxplotcol HeatmapAnnotation boxplotannoboxplotdatamatrixcpm borderTRUE gpgparfillCCCCCC pch sizeunit mm axisTRUE axisparam listside left annotationwidthunitc cm whichcol pngresultsheatmapdnarepair pngwidth height ht Heatmapdatamatrixcpm topannotation colAnn leftannotation rowAnn bottomannotation boxplotcol name logCPM col rainbow showrownames T showcolumnnames FALSE clusterrows F clustercolumns Frownamesgp gparfontsize width unit mmrowAnnotationrn annotextrownamescpm drawht heatmaplegendside left annotationlegendside rightlegendlabelgpgparfontsize devoff Hi I wonder if alterfun for oncoprint could be generated programmatically as a list of functions r alterfun list background functionx y w h gridrectx y wunit mm hunit mm gp gparfill CCCCCC col NA small green MUT functionx y w h gridrectx y wunit mm h gp gparfill col MUT col NA MUT functionx y w h gridrectx y wunit mm h gp gparfill col MUT col NA I have lots of MUTs MUT etc and want to automate color assignment to them Any advice Thanks Hello I was wondering if it is possible to have the possibility to programmatically set colors for column annotations in a case where it is not known what the columns of interest would be Use case for this would be a function that wraps the call of Heatmap in a way where the user simply selects the colData covariate of interest and then Heatmap handles these sensibly enough I know it is possible to pass the data frame directly but I was checking whether it is possible to have the output reproducible apart from setting the seed and at best with a set of palettes that could handle nicely most cases If you need a MRE for showcasing this I can try to put it together it is tightly related to a package I am currently developing the function would be gsheatmap in there I would appreciate any feedback on this Thanks again for the care you put in writing your packages Federico