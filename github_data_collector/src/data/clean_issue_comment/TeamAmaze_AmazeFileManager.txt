Adds an Operator that runs AbstractOperations these are a way of encapsulating any task that might need an undo and a check It also allows easy for sequencing of recursive tasks with a requiresAbstractOperation It can also make the async part of the app simpler if every task is an AbstractOperation it can be run as if they are all the same merging all Services into one OperatorService Fixes Per mail discussion offline it is found that any app may fire an Intent with action comamazefilemanagerservicesftpserviceFTPReceiverACTIONSTARTFTPSERVER or comamazefilemanagerservicesftpserviceFTPReceiverACTIONSTOPFTPSERVER to control Amazes builtin FTP server without user acknowledgement Changes in changeset add a custom permission comamazefilemanagerpermissionCONTROLFTPSERVER and set it at signature level FtpService requires comamazefilemanagerpermissionCONTROLFTPSERVER permission so only Amaze would be able to send intents to startstop the FTP server This supercedes which contained unfinished code that makes the PR difficult to understand Its work to work out a way to allow thirdparty apps to startstop Amazes FTP server will continue on another PR Describe the bug Folders with a lot of pictures crash the app Pictures accessed over SMB Connection crash the app always regardless of how many pictures in the folder with a message Connect to a network to download this image To Reproduce Steps to reproduce the behavior On Android install the app from Google Play Start the app Navigate to a folder with lots of pictures Open any of the pictures Expected behavior Picture opens up in the app or in external gallery app Smartphone please complete the following information Device Galaxy S OS Android Rooted No Version Additional context I used another File Explorer before until I updated to Android and it started doing the same after That was the reason I gave this a try but it seems to be a problem with all File Explorers and Android Fixes Previous finish is not enough to quit the Activity but an additional return can do Tested on Oneplus running Slim and LG Nexus x running AOSPExtended Fixes Reproduction Steps This crash is triggered with this shell instruction adb shell am start n comamazefilemanagercomamazefilemanageractivitiesTextEditorActivity Stack Trace EAndroidRuntime FATAL EXCEPTION main EAndroidRuntime Process comamazefilemanager PID EAndroidRuntime javalangRuntimeException Unable to start activity ComponentInfocomamazefilemanagercomamazefilemanageractivitiesTextEditorActivity javalangNullPointerException EAndroidRuntime at androidappActivityThreadperformLaunchActivityActivityThreadjava EAndroidRuntime at androidappActivityThreadhandleLaunchActivityActivityThreadjava EAndroidRuntime at androidappActivityThreadaccess ActivityThreadjava EAndroidRuntime at androidappActivityThreadHhandleMessageActivityThreadjava EAndroidRuntime at androidosHandlerdispatchMessageHandlerjava EAndroidRuntime at androidosLooperloopLooperjava EAndroidRuntime at androidappActivityThreadmainActivityThreadjava EAndroidRuntime at javalangreflectMethodinvokeNativeNative Method EAndroidRuntime at javalangreflectMethodinvokeMethodjava EAndroidRuntime at comandroidinternalosZygoteInitMethodAndArgsCallerrunZygoteInitjava EAndroidRuntime at comandroidinternalosZygoteInitmainZygoteInitjava EAndroidRuntime at dalviksystemNativeStartmainNative Method EAndroidRuntime Caused by javalangNullPointerException EAndroidRuntime at comamazefilemanageractivitiesTextEditorActivityonCreateTextEditorActivityjava EAndroidRuntime at androidappActivityperformCreateActivityjava EAndroidRuntime at androidappInstrumentationcallActivityOnCreateInstrumentationjava EAndroidRuntime at androidappActivityThreadperformLaunchActivityActivityThreadjava EAndroidRuntime more Debug info App Version Android Version Most of the folders in the root directory becomes unaccessible when root browsing is enabled Before root access After root access cant browse mnt Im using GenyMotion and Im trying to give an specific app permissions to write on a mounted folder Currently most operations when they fail make no attempt to revert the state of what was changed to be as it was before the operation was made I propose making operations so that they have a do revert and errorRevert where errors can be handled gracefully X Create a base implementation x Convert the extractor to an operation x Without undo x Add undo functionality requires folderfile deletion x FileFolder creationdeletion x Deletion x Creation x FolderFile copingcutting x CopyCut x Undo x Random bug squashing x Documentation Describe the bug When I try to copy a large filemore than GB from smb server app will pop a window about operation failed To Reproduce Steps to reproduce the behavior Go to smb server Copy a big file Paste to local storage See error Smartphone please complete the following information Device Xiaomi Note OS Android MIUIEU Rooted Yes Version Additional context Logcat W Choreographer OPTSINPUT First frame was drawed before optimized so skip D skia Failed to create image decoder with message unimplemented W Glide Load failed for smbsmbpathabigfile with size x W Glide class combumptechglideloadengineGlideException Failed to load resource D skia Failed to create image decoder with message unimplemented I chatty uid comamazefilemanager glidesourceth identical lines D skia Failed to create image decoder with message unimplemented W Choreographer OPTSINPUT First frame was drawed before optimized so skip D TabFragment Page Selected W Choreographer OPTSINPUT First frame was drawed before optimized so skip W Systemerr javalangIllegalArgumentException Size exceeds IntegerMAXVALUE W Systemerr at sunniochFileChannelImplmapFileChannelImpljava W Systemerr at comamazefilemanagerutilsfilesGenericCopyUtilcopyFileGenericCopyUtiljava W Systemerr at comamazefilemanagerutilsfilesGenericCopyUtilstartCopyGenericCopyUtiljava W Systemerr at comamazefilemanagerutilsfilesGenericCopyUtilcopyGenericCopyUtiljava W Systemerr at comamazefilemanagerasynchronousservicesCopyServiceDoInBackgroundCopycopyFilesCopyServicejava W Systemerr at comamazefilemanagerasynchronousservicesCopyServiceDoInBackgroundCopyexecuteCopyServicejava W Systemerr at comamazefilemanagerasynchronousservicesCopyServiceDoInBackgrounddoInBackgroundCopyServicejava W Systemerr at comamazefilemanagerasynchronousservicesCopyServiceDoInBackgrounddoInBackgroundCopyServicejava W Systemerr at androidosAsyncTask callUnknown Source W Systemerr at javautilconcurrentFutureTaskrunFutureTaskjava W Systemerr at androidosAsyncTaskSerialExecutor runUnknown Source W Systemerr at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava W Systemerr at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava W Systemerr at javalangThreadrunThreadjava E CopyService Got exception checkout smbsmbpathabigfile D skia Failed to create image decoder with message unimplemented I chatty uid comamazefilemanager glidesourceth identical lines D skia Failed to create image decoder with message unimplemented D skia Failed to create image decoder with message unimplemented W Glide Load failed for localpathabigfile with size x W Glide class combumptechglideloadengineGlideException Failed to load resource W Glide There were causes W Glide javaioIOExceptionjavalangRuntimeException setDataSource failed status xFFFFFFEA W Glide javaioIOExceptionjavalangRuntimeException setDataSource failed status xFFFFFFEA W Glide javaioIOExceptionjavalangRuntimeException setDataSource failed status xFFFFFFEA W Glide call GlideExceptionlogRootCausesString for more detail W Glide Cause of class combumptechglideloadengineGlideException Failed LoadPathFileInputStreamObjectDrawable LOCAL W Glide Cause of class combumptechglideloadengineGlideException Failed DecodePathFileInputStreamGifDrawableDrawable W Glide Cause of class combumptechglideloadengineGlideException Failed DecodePathFileInputStreamBitmapDrawable W Glide Cause of class combumptechglideloadengineGlideException Failed DecodePathFileInputStreamBitmapDrawableDrawable W Glide Cause of class combumptechglideloadengineGlideException Failed LoadPathParcelFileDescriptorObjectDrawable LOCAL W Glide There were causes W Glide javaioIOExceptionjavalangRuntimeException setDataSource failed status xFFFFFFEA W Glide javaioIOExceptionjavalangRuntimeException setDataSource failed status xFFFFFFEA W Glide call GlideExceptionlogRootCausesString for more detail W Glide Cause of class combumptechglideloadengineGlideException Failed DecodePathParcelFileDescriptorBitmapDrawable W Glide There was cause W Glide javaioIOExceptionjavalangRuntimeException setDataSource failed status xFFFFFFEA W Glide call GlideExceptionlogRootCausesString for more detail W Glide Cause of class javaioIOException javalangRuntimeException setDataSource failed status W Glide Cause of class combumptechglideloadengineGlideException Failed DecodePathParcelFileDescriptorBitmapDrawableDrawable W Glide There was cause W Glide javaioIOExceptionjavalangRuntimeException setDataSource failed status xFFFFFFEA W Glide call GlideExceptionlogRootCausesString for more detail W Glide Cause of class javaioIOException javalangRuntimeException setDataSource failed status W Glide Cause of class combumptechglideloadengineGlideException Failed LoadPathAssetFileDescriptorObjectDrawable LOCAL W Glide There was cause W Glide javaioIOExceptionjavalangRuntimeException setDataSource failed status xFFFFFFEA W Glide call GlideExceptionlogRootCausesString for more detail W Glide Cause of class combumptechglideloadengineGlideException Failed DecodePathAssetFileDescriptorBitmapDrawable W Glide There was cause W Glide javaioIOExceptionjavalangRuntimeException setDataSource failed status xFFFFFFEA W Glide call GlideExceptionlogRootCausesString for more detail W Glide Cause of class javaioIOException javalangRuntimeException setDataSource failed status I Glide Root cause of I Glide javaioIOException javalangRuntimeException setDataSource failed status xFFFFFFEA I Glide at combumptechglideloadresourcebitmapVideoDecoderdecodeVideoDecoderjava I Glide at combumptechglideloadengineDecodePathdecodeResourceWithListDecodePathjava I Glide at combumptechglideloadengineDecodePathdecodeResourceDecodePathjava I Glide at combumptechglideloadengineDecodePathdecodeDecodePathjava I Glide at combumptechglideloadengineLoadPathloadWithExceptionListLoadPathjava I Glide at combumptechglideloadengineLoadPathloadLoadPathjava I Glide at combumptechglideloadengineDecodeJobrunLoadPathDecodeJobjava I Glide at combumptechglideloadengineDecodeJobdecodeFromFetcherDecodeJobjava I Glide at combumptechglideloadengineDecodeJobdecodeFromDataDecodeJobjava I Glide at combumptechglideloadengineDecodeJobdecodeFromRetrievedDataDecodeJobjava I Glide at combumptechglideloadengineDecodeJobonDataFetcherReadyDecodeJobjava I Glide at combumptechglideloadengineSourceGeneratoronDataReadySourceGeneratorjava I Glide at combumptechglideloadmodelMultiModelLoaderMultiFetcheronDataReadyMultiModelLoaderjava I Glide at combumptechglideloaddataLocalUriFetcherloadDataLocalUriFetcherjava I Glide at combumptechglideloadmodelMultiModelLoaderMultiFetcherloadDataMultiModelLoaderjava I Glide at combumptechglideloadengineSourceGeneratorstartNextSourceGeneratorjava I Glide at combumptechglideloadengineDecodeJobrunGeneratorsDecodeJobjava I Glide at combumptechglideloadengineDecodeJobdecodeFromRetrievedDataDecodeJobjava I Glide at combumptechglideloadengineDecodeJobonDataFetcherReadyDecodeJobjava I Glide at combumptechglideloadengineSourceGeneratoronDataReadySourceGeneratorjava I Glide at combumptechglideloadmodelMultiModelLoaderMultiFetcheronDataReadyMultiModelLoaderjava I Glide at combumptechglideloaddataLocalUriFetcherloadDataLocalUriFetcherjava I Glide at combumptechglideloadmodelMultiModelLoaderMultiFetcherloadDataMultiModelLoaderjava I Glide at combumptechglideloadengineSourceGeneratorstartNextSourceGeneratorjava I Glide at combumptechglideloadengineDecodeJobrunGeneratorsDecodeJobjava I Glide at combumptechglideloadengineDecodeJobrunWrappedDecodeJobjava I Glide at combumptechglideloadengineDecodeJobrunDecodeJobjava I Glide at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava I Glide at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava I Glide at javalangThreadrunThreadjava I Glide at combumptechglideloadengineexecutorGlideExecutorDefaultThreadFactory runGlideExecutorjava I Glide Caused by javalangRuntimeException setDataSource failed status xFFFFFFEA I Glide at androidmediaMediaMetadataRetrieversetDataSourceNative Method I Glide at androidmediaMediaMetadataRetrieversetDataSourceUnknown Source I Glide at combumptechglideloadresourcebitmapVideoDecoderParcelFileDescriptorInitializerinitializeVideoDecoderjava I Glide at combumptechglideloadresourcebitmapVideoDecoderParcelFileDescriptorInitializerinitializeVideoDecoderjava I Glide at combumptechglideloadresourcebitmapVideoDecoderdecodeVideoDecoderjava I Glide more I Glide Root cause of I Glide javaioIOException javalangRuntimeException setDataSource failed status xFFFFFFEA I Glide at combumptechglideloadresourcebitmapVideoDecoderdecodeVideoDecoderjava I Glide at combumptechglideloadresourcebitmapBitmapDrawableDecoderdecodeBitmapDrawableDecoderjava I Glide at combumptechglideloadengineDecodePathdecodeResourceWithListDecodePathjava I Glide at combumptechglideloadengineDecodePathdecodeResourceDecodePathjava I Glide at combumptechglideloadengineDecodePathdecodeDecodePathjava I Glide at combumptechglideloadengineLoadPathloadWithExceptionListLoadPathjava I Glide at combumptechglideloadengineLoadPathloadLoadPathjava I Glide at combumptechglideloadengineDecodeJobrunLoadPathDecodeJobjava I Glide at combumptechglideloadengineDecodeJobdecodeFromFetcherDecodeJobjava I Glide at combumptechglideloadengineDecodeJobdecodeFromDataDecodeJobjava I Glide at combumptechglideloadengineDecodeJobdecodeFromRetrievedDataDecodeJobjava I Glide at combumptechglideloadengineDecodeJobonDataFetcherReadyDecodeJobjava I Glide at combumptechglideloadengineSourceGeneratoronDataReadySourceGeneratorjava I Glide at combumptechglideloadmodelMultiModelLoaderMultiFetcheronDataReadyMultiModelLoaderjava I Glide at combumptechglideloaddataLocalUriFetcherloadDataLocalUriFetcherjava I Glide at combumptechglideloadmodelMultiModelLoaderMultiFetcherloadDataMultiModelLoaderjava I Glide at combumptechglideloadengineSourceGeneratorstartNextSourceGeneratorjava I Glide at combumptechglideloadengineDecodeJobrunGeneratorsDecodeJobjava I Glide at combumptechglideloadengineDecodeJobdecodeFromRetrievedDataDecodeJobjava I Glide at combumptechglideloadengineDecodeJobonDataFetcherReadyDecodeJobjava I Glide at combumptechglideloadengineSourceGeneratoronDataReadySourceGeneratorjava I Glide at combumptechglideloadmodelMultiModelLoaderMultiFetcheronDataReadyMultiModelLoaderjava I Glide at combumptechglideloaddataLocalUriFetcherloadDataLocalUriFetcherjava I Glide at combumptechglideloadmodelMultiModelLoaderMultiFetcherloadDataMultiModelLoaderjava I Glide at combumptechglideloadengineSourceGeneratorstartNextSourceGeneratorjava I Glide at combumptechglideloadengineDecodeJobrunGeneratorsDecodeJobjava I Glide at combumptechglideloadengineDecodeJobrunWrappedDecodeJobjava I Glide at combumptechglideloadengineDecodeJobrunDecodeJobjava I Glide at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava I Glide at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava I Glide at javalangThreadrunThreadjava I Glide at combumptechglideloadengineexecutorGlideExecutorDefaultThreadFactory runGlideExecutorjava I Glide Caused by javalangRuntimeException setDataSource failed status xFFFFFFEA I Glide at androidmediaMediaMetadataRetrieversetDataSourceNative Method I Glide at androidmediaMediaMetadataRetrieversetDataSourceUnknown Source I Glide at combumptechglideloadresourcebitmapVideoDecoderParcelFileDescriptorInitializerinitializeVideoDecoderjava I Glide at combumptechglideloadresourcebitmapVideoDecoderParcelFileDescriptorInitializerinitializeVideoDecoderjava I Glide at combumptechglideloadresourcebitmapVideoDecoderdecodeVideoDecoderjava I Glide more I Glide Root cause of I Glide javaioIOException javalangRuntimeException setDataSource failed status xFFFFFFEA I Glide at combumptechglideloadresourcebitmapVideoDecoderdecodeVideoDecoderjava I Glide at combumptechglideloadengineDecodePathdecodeResourceWithListDecodePathjava I Glide at combumptechglideloadengineDecodePathdecodeResourceDecodePathjava I Glide at combumptechglideloadengineDecodePathdecodeDecodePathjava I Glide at combumptechglideloadengineLoadPathloadWithExceptionListLoadPathjava I Glide at combumptechglideloadengineLoadPathloadLoadPathjava I Glide at combumptechglideloadengineDecodeJobrunLoadPathDecodeJobjava I Glide at combumptechglideloadengineDecodeJobdecodeFromFetcherDecodeJobjava I Glide at combumptechglideloadengineDecodeJobdecodeFromDataDecodeJobjava I Glide at combumptechglideloadengineDecodeJobdecodeFromRetrievedDataDecodeJobjava I Glide at combumptechglideloadengineDecodeJobonDataFetcherReadyDecodeJobjava I Glide at combumptechglideloadengineSourceGeneratoronDataReadySourceGeneratorjava I Glide at combumptechglideloaddataLocalUriFetcherloadDataLocalUriFetcherjava I Glide at combumptechglideloadengineSourceGeneratorstartNextSourceGeneratorjava I Glide at combumptechglideloadengineDecodeJobrunGeneratorsDecodeJobjava I Glide at combumptechglideloadengineDecodeJobdecodeFromRetrievedDataDecodeJobjava I Glide at combumptechglideloadengineDecodeJobonDataFetcherReadyDecodeJobjava I Glide at combumptechglideloadengineSourceGeneratoronDataReadySourceGeneratorjava I Glide at combumptechglideloadmodelMultiModelLoaderMultiFetcheronDataReadyMultiModelLoaderjava I Glide at combumptechglideloaddataLocalUriFetcherloadDataLocalUriFetcherjava I Glide at combumptechglideloadmodelMultiModelLoaderMultiFetcherloadDataMultiModelLoaderjava I Glide at combumptechglideloadengineSourceGeneratorstartNextSourceGeneratorjava I Glide at combumptechglideloadengineDecodeJobrunGeneratorsDecodeJobjava I Glide at combumptechglideloadengineDecodeJobdecodeFromRetrievedDataDecodeJobjava I Glide at combumptechglideloadengineDecodeJobonDataFetcherReadyDecodeJobjava I Glide at combumptechglideloadengineSourceGeneratoronDataReadySourceGeneratorjava I Glide at combumptechglideloadmodelMultiModelLoaderMultiFetcheronDataReadyMultiModelLoaderjava I Glide at combumptechglideloaddataLocalUriFetcherloadDataLocalUriFetcherjava I Glide at combumptechglideloadmodelMultiModelLoaderMultiFetcherloadDataMultiModelLoaderjava I Glide at combumptechglideloadengineSourceGeneratorstartNextSourceGeneratorjava I Glide at combumptechglideloadengineDecodeJobrunGeneratorsDecodeJobjava I Glide at combumptechglideloadengineDecodeJobrunWrappedDecodeJobjava I Glide at combumptechglideloadengineDecodeJobrunDecodeJobjava I Glide at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava I Glide at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava I Glide at javalangThreadrunThreadjava I Glide at combumptechglideloadengineexecutorGlideExecutorDefaultThreadFactory runGlideExecutorjava I Glide Caused by javalangRuntimeException setDataSource failed status xFFFFFFEA I Glide at androidmediaMediaMetadataRetrieversetDataSourceNative Method I Glide at combumptechglideloadresourcebitmapVideoDecoderAssetFileDescriptorInitializerinitializeVideoDecoderjava I Glide at combumptechglideloadresourcebitmapVideoDecoderAssetFileDescriptorInitializerinitializeVideoDecoderjava I Glide at combumptechglideloadresourcebitmapVideoDecoderdecodeVideoDecoderjava I Glide more W Glide Load failed for smbsmbpathabigfile with size x W Glide class combumptechglideloadengineGlideException Failed to load resource D skia Failed to create image decoder with message unimplemented I chatty uid comamazefilemanager glidesourceth identical lines D skia Failed to create image decoder with message unimplemented To Reproduce Go to a foldernot root Input a short stringsuch like a to search box Search itthen crash Crash occurs with high possibly when the input text is shortsmaller than I do not know the reason of this bug It so weird 