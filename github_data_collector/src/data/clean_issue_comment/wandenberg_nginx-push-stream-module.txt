My nginx is running in a docker swarm I realized recently that all or almost all of subscribers are at the same worker Why is it so How are the subscribers distributed among workers Output from pushstreamchannelsstatistics infos channels channels wildcardchannels wildcardchannels publishedmessages publishedmessages storedmessages storedmessages messagesintrash messagesintrash channelsindelete channelsindelete channelsintrash channelsintrash subscribers subscribers uptime uptime byworker worker pid pid subscribers subscribers uptime uptime worker worker pid pid subscribers subscribers uptime uptime worker worker pid pid subscribers subscribers uptime uptime worker worker pid pid subscribers subscribers uptime uptime worker byworker infos I have a problem when sub or pub into the android client using OkHttp or another library supporting Http in Android If possible there is an android client library used to nginxpushstream Or any suggestion using Library Http for android client library thank you Hi For js client I must use only pushstreamjs Or I can use other Is it possible to publish events into channels from other nginx modules like mirror ie conf location ws pushstreamsubscriber websocket pushstreamchannelspath argid pushstreamcreated created pushstreamdestroyed destroyed pushstreamsubscribed subscribed pushstreamunsubscribed unsubscribed pushstreammessagetemplate id id channel channel text text location created proxypass location destroyed proxypass location subscribed proxypass location unsubscribed proxypass Hello Im having a problem with large trash queue It grows slowly version of pushstreammodule nginx V sed s ng nginx version nginx built by gcc UbuntuLinaro ubuntu built with OpenSSL j Sep TLS SNI support enabled configure arguments prefixvarwwwnginx sbinpathusrsbinnginx confpathetcnginxnginxconf lockpathvarlocksubsysnginx withipv withhttpsslmodule withhttprealipmodule withhttpstubstatusmodule withhttpsecurelinkmodule withccoptO g pipe Wall WpDFORTIFYSOURCE fexceptions fstackprotector paramsspbuffersize m mtunegeneric withldoptWlErpathvarlibjenkinsworkspacedockercontainernginxcommonluaimageluajitlib errorlogpathvarlogcontainernginxerrorlog httplogpathvarlogcontainernginxaccesslog pidpathvarrunnginxpid withouthttpfastcgimodule withouthttpuwsgimodule withouthttpscgimodule httpproxytemppathvarlibnginxtmpproxy httpclientbodytemppathvarlibnginxtmpclientbody withhttpv module addmodulevarlibjenkinsworkspacedockercontainernginxpushstreamnginxmoduledevkit addmodulevarlibjenkinsworkspacedockercontainernginxpushstreamoutnginxmodulelua addmodulevarlibjenkinsworkspacedockercontainernginxpushstreamnginxmodulepushstream withopensslvarlibjenkinsworkspacedockercontainernginxcommonopensslopenssl j these options are default pushstreamsharedmemorysize pushstreamchanneldeletedmessagetext pushstreamchannelinactivitytime pushstreammessagettl in error logs I have nothing corresponding to the problem zabbix graph nginx v nginxpushstreammodule v ngxshmtxlock mtx x d f d d at srccorengxshmtxc x fcbc in ngxhttppushstreamworkersubscribercleanup rvalue optimized out at modulesnginxpushstreammodulesrcngxhttppushstreammoduleutilsc ngxhttppushstreamcleanuprequestcontext rvalue optimized out at modulesnginxpushstreammodulesrcngxhttppushstreammoduleutilsc x fcbc ee in ngxhttppushstreamruncleanuppoolhandler r x cc at modulesnginxpushstreammodulesrcngxhttppushstreammoduleutilsc ngxhttppushstreamsendresponsefinalizeforlongpollingbytimeout r x cc at modulesnginxpushstreammodulesrcngxhttppushstreammoduleutilsc x c in ngxeventexpiretimers at srceventngxeventtimerc x in ngxprocesseventsandtimers cycle x c at srceventngxeventc x d in ngxworkerprocesscycle cycle x c datavalue optimized out at srcosunixngxprocesscyclec x a in ngxspawnprocess cycle x c proc x d ngxworkerprocesscycle data x name x d f worker process respawn at srcosunixngxprocessc x c in ngxstartworkerprocesses cycle x c n type at srcosunixngxprocesscyclec x a bc in ngxmasterprocesscycle cycle x c at srcosunixngxprocesscyclec x bc in main argcvalue optimized out argvvalue optimized out at srccorenginxc I hope this helps you find the error HI How can I connect push stream long poling in auto scaling servers just like cross domain Thanks hi wandenberg first of all thank you very much for your open source project I am very lucky to encounter it Now I have some problems I hope you can help me Thank you version st problem memory leak function ngxhttppushstreamoutputfilter if ngxhttpoutputfilter return not NGXOK the parameter in will not call ngxchainupdatechains memory leak or not st problem dead lock struct ngxhttppushstreamshmdatas channelsmutex only all the channel share them If a running channel use the same lock as the channel to be deleted There will be a deadlock first lockchannelmutex second lockdatachannelstrashmutex Look at the following two process GDB stacks gdb bt x a d in semwait from lib libpthreadso x in ngxshmtxlock mtx x b d e at srccorengxshmtxc x d in nxghttppushstreamfreechannelmemory data x b d force at nginxpushstreammodulesrcngxhttppushstreammoduleutilsc ngxhttppushstreamfreememoryofexpiredchannels data x b d force at nginxpushstreammodulesrcngxhttppushstreammoduleutilsc ngxhttppushstreamfreememoryofexpiredmessagesandchannelsdata data x b d force at nginxpushstreammodulesrcngxhttppushstreammoduleutilsc x dc eb in ngxhttppushstreammemorycleanup evvalue optimized out at nginxpushstreammodulesrcngxhttppushstreammoduleutilsc ngxhttppushstreammemorycleanuptimerwakehandler evvalue optimized out at nginxpushstreammodulesrcngxhttppushstreammoduleutilsc x b in ngxeventexpiretimers at srceventngxeventtimerc x d in ngxprocesseventsandtimers cycle x e at srceventngxeventc x b e in ngxworkerprocesscycle cycle x e datavalue optimized out at srcosunixngxprocesscyclec x c c in ngxspawnprocess cycle x e proc x b ea ngxworkerprocesscycle data x name x e d worker process respawn at srcosunixngxprocessc x a bb in ngxstartworkerprocesses cycle x e n type at srcosunixngxprocesscyclec x bc in ngxmasterprocesscycle cycle x e at srcosunixngxprocesscyclec x d b in main argcvalue optimized out argvvalue optimized out at srccorenginxc gdb bt x a d in semwait from lib libpthreadso x in ngxshmtxlock mtx x b d at srccorengxshmtxc x d e in ngxhttppushstreamthrowthemessageaway msg x b a a data x b d at nginxpushstreammodulesrcngxhttppushstreammoduleutilsc x d in ngxhttppushstreamensureqtdofmessages data x b d channel x b b maxmessages expired at nginxpushstreammodulesrcngxhttppushstreammoduleutilsc x d a in ngxhttppushstreamaddmsgtochannel mcf x e aa log x bb channel x b b textvalue optimized out len eventidvalue optimized out eventtype x storemessages temppool x eaa at nginxpushstreammodulesrcngxhttppushstreammoduleutilsc x decb in ngxhttppushstreampublisherbodyhandler r x eaf at nginxpushstreammodulesrcngxhttppushstreammodulepublisherc x a in ngxhttpreadclientrequestbody r x eaf posthandler x deb e ngxhttppushstreampublisherbodyhandler at srchttpngxhttprequestbodyc x d a in ngxhttppushstreampublisherhandleafterreadbody rvalue optimized out posthandlervalue optimized out at nginxpushstreammodulesrcngxhttppushstreammodulepublisherc x df ed in ngxhttppushstreampublisherhandler r x eaf at nginxpushstreammodulesrcngxhttppushstreammodulepublisherc x c fe in ngxhttpcorecontentphase r x eaf ph x a at srchttpngxhttpcoremodulec x in ngxhttpcorerunphases r x eaf at srchttpngxhttpcoremodulec x in ngxhttphandler rvalue optimized out at srchttpngxhttpcoremodulec x fe in ngxhttpprocessrequest r x eaf at srchttpngxhttprequestc x c in ngxhttpprocessrequestheaders revvalue optimized out at srchttpngxhttprequestc x b in ngxhttpprocessrequestline rev x b at srchttpngxhttprequestc x e e in ngxhttpkeepalivehandler rev x b at srchttpngxhttprequestc x cd in ngxepollprocessevents cycle x e timervalue optimized out flagsvalue optimized out at srceventmodulesngxepollmodulec x f in ngxprocesseventsandtimers cycle x e at srceventngxeventc x b e in ngxworkerprocesscycle cycle x e datavalue optimized out at srcosunixngxprocesscyclec x c c in ngxspawnprocess cycle x e proc x b ea ngxworkerprocesscycle data x name x e d worker process respawn at srcosunixngxprocessc x a bb in ngxstartworkerprocesses cycle x e n type at srcosunixngxprocesscyclec x bc in ngxmasterprocesscycle cycle x e at srcosunixngxprocesscyclec x d b in main argcvalue optimized out argvvalue optimized out at srccorenginxc thanks best regard 