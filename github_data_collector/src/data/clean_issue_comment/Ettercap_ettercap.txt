Unfortunately the introduction of adjusting SSL interception at runtime had one blind spot that only becomes visible when one really makes use of the selective SSL redirection When SSL interception is enabled Ettercap checks if a seen packet is part of SSL interception Then its flagged not to be forwarded by Ettercap as its terminated by the sockets Ettercap created for the connection This check is solely based on source or destination port eg If you now try to limit the SSL interception with the new feature to let say HTTPS all traffic from and to this IP would be intercepted by Ettercap and the forwarding engine does not forward these packets So far so good Under this constellation all other packets on port HTTPS will be dropped Theyre not redirected to the Ettercap listener and theyre still marked to be dropped because the port matched This blackholes all other HTTPS traffic which is not the wanted behaviour of selective SSL interception and need correction This pull request addresses this issue The check is being extended to also check if the source or destination IP lies within the IP specification done in the SSL interception dialog To reduce the perpacket processing overhead I decided to remove the possibility to specify a source IP since I cant imagine there are any requirements or usecases that would make use of it Sorry the explanation was a little bit lengthy but the issue is not trivial at least to find and understand On OpenBSD some things need to get adjusted to get Ettercap built on OpenBSD Could please help me with the problem When I press and hold ctrlsscan for hosts Ettercap crashes with segmentation fault This is what it says Ooops This shouldnt happen Segmentation Fault Please recompile in debug mode reproduce the bug and send a bugreport Have a nice day Can someone please take me through the steps to make it work SEND L ERROR byte packet dd a destined to ff ff was not forwarded libnetwriterawipv bytes written No route to host SEND L ERROR byte packet dd a destined to ff ff was not forwarded libnetwriterawipv bytes written No route to host SEND L ERROR byte packet dd a destined to ff ff was not forwarded libnetwriterawipv bytes written No route to host SEND L ERROR byte packet dd destined to ff fb was not forwarded libnetwriterawipv bytes written No route to host SEND L ERROR byte packet dd a destined to ff was not forwarded libnetwriterawipv bytes written No route to host SEND L ERROR byte packet dd destined to ff fb was not forwarded libnetwriterawipv bytes written No route to host SEND L ERROR byte packet dd a destined to ff was not forwarded libnetwriterawipv bytes written No route to host System MAC OS Catalina Start Command sudo usrlocalCellarettercap binettercap Tq i en P dnsspoof M arp I set usrlocalCellarettercap bottleetcettercapetterdns A my compute ip is Apache Service is running can normal open websitei try it buy i use dnsspoof plugins redirect any host Not affected Hi there Im currently using ettercap v and none of the scripts for macOS Mojave ipfw has been deprecated BSD PF resolves in segmentation fault on sniffing BSD PF for IPv doesnt resolve in segmentation fault but even though it catches the dns and says it spoofs it it doesnt and microsoftcom for instance loads correctly note ecuid ecgid Any insight on what the proper script for mojave might be Thanks CMake Error LOG can someone help me with this and this is the bash script for installing ettercap link Hi Alexander A quick question In Etterfilter is it possible to pause the program block for minutes before continuing For example First block if tcpsrc DATAdata x xe DATAdata x b xb msgHolding Register data replaced sleep m Waits minutes Second block if tcpsrc DATAdata x x DATAdata x x d msgHolding Register data replaced Sleep command is used in Shell script to pause between blocks Is there an equivalent command in etterfilter At present the unload filter option will completely stop all program blocks I want the filter to be active and first block to be running during pause period Is this possible When I do arp poisoning mitm I get the error SEND L ERROR byte packet destined to xxxxxx was not forwarded libnetwriterawipv bytes written Operation not permitted I copied the error from another page so the ip isn t the same does anyone know how I can fix this I m on kali Linux I try to build and install from latest source code but i have the issue and not solved img width altScreen Shot at AM src Hi I am trying to use ettercap as MitM with ARP spoofing to inject big amount of data kB into a mail TCP SMTP connection This much data will clearly not fit in one packet and this is a problem The filter is correctly identifying the desired packet SMTP packet with the mail itself and then using replace function replacing some predefined string with long strings of base encoded data In wireshark I can see that the packet that has been matched by filter is correctly substituted and sent then second packet is being sent I guess its being generated by ettercap however after that ettercap exits with Segmentation Fault The last thing I see before ettercap crashes is an ACK from mailserver In packet capture above packets are the packets containing original email the filter is matching the first as it sontains the keyword Subject and therefore substituting strings czesc czesc czesc with total of characters After that two ettercap created packets are sent and Then the ACK packet is coming back from server with seq of both and The injected message did not fit in those two packets sent by ettercap The code is simply two if statements to detect SMTP packet carrying the data and replace functions one ofter another I the code below I omitted most of the gibberish together in those functions I am inserting almost characters if ipproto TCP tcpdst if regexDATAdata Subject replace czesc iVBORw KGgoAAAANSUhEUgAAAoAAAAHgCAMAAAAC replace czesc ydDtTY ltNxDP r rN MQsCkIlyzzN XtuVzduNdr m replace czesc EKIAACh TEoLfzLlSYjEYFcRwBSJFktFgSOwjSHh replace czesc vxrUrCtdGMVa EUyLzGrgZ zY GfDSpcC XZmo replace czesc zZsyBDdc RjlwTLQQ xLsvNpZab Og VWWGA jM I get the Segmentation Fault error regardless of how big the argument of each replace function is I have tried injecting those chars all with replace with replaces with replaces every time getting the same error Is it possible to achieve that kind of injection If so what am I doing wrong or how should I approach the issue Is ettercap capable of injecting so much data that it requires segmentation and creation of additional packets Any input will be highly appreciated 