 Use GitHub Actions instead of Travis CI x Have Composer in toolscomposer and managed through composer selfupdate see updatetools target in buildxml x Install Psalm using Phive as toolspsalm phive install copy psalm x Install PHPCSFixer using Phive as toolsphpcsfixer phive install copy phpcsfixer x Create Psalm configuration Add Psalm build step to GitHub Actionsbased CI workflow Add PHPCSFixer build step to GitHub Actionsbased CI workflow See DOMNodeC N call removes encoding from XML somehow This is bad for comparison of non ascii xmls because it makes them unreadable Please see example Currently resources are compared by their internal ID For readable streams it would be useful to compare their content This tries to read and reset the resource and compares the hashed results Refs According to docs of ScalarComparator Compares scalar or NULL values for equality equality do we consider it as an equality operator of PHP for that I would propose to put extra assertion that compares not only if expectedactual matches provided expectation but also are they following contract and mimics equality I expect Travis to fail and show when contract of is violated ref ref I removed documentformatOutput true documentnormalizeDocument Because the unittests not failed after that and I dont see why it needed I removed a lot of checks instanceof DOMDocument because in fact there is always DOMDocument in the node variable in case if canonicalize is true and it is always true I removed canonicalize because in fact it is always true and the unused argument just make the code maintenance harder Especially without corresponding unittests This fix implements a custom serializedeserialize method on the ComparisionFailure class which means it loses the stack trace during serialization This allows PHPUnit to run in process isolation mode when the stack trace may contain references to nonserializable objects such as the PDO