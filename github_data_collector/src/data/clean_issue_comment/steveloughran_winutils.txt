I submit this task from windows to linux have an error Error cannot find or load main class orgapachehadoopmapreducev appMRAppMasterHow should I solve this problem Please reply to me soon Thank pyspark Python tagsv e e Jul MSC v bit AMD on win Type help copyright credits or license for more information WARNING An illegal reflective access operation has occurred WARNING Illegal reflective access by orgapachesparkunsafePlatform fileCProgram Filesspark binhadoop jarssparkunsafe jar to method javanioBitsunaligned WARNING Please consider reporting this to the maintainers of orgapachesparkunsafePlatform WARNING Use illegalaccesswarn to enable warnings of further illegal reflective access operations WARNING All illegal access operations will be denied in a future release Exception in thread main javalangExceptionInInitializerError at orgapachehadooputilStringUtilsclinitStringUtilsjava at orgapachehadoopsecuritySecurityUtilgetAuthenticationMethodSecurityUtiljava at orgapachehadoopsecurityUserGroupInformationinitializeUserGroupInformationjava at orgapachehadoopsecurityUserGroupInformationensureInitializedUserGroupInformationjava at orgapachehadoopsecurityUserGroupInformationloginUserFromSubjectUserGroupInformationjava at orgapachehadoopsecurityUserGroupInformationgetLoginUserUserGroupInformationjava at orgapachehadoopsecurityUserGroupInformationgetCurrentUserUserGroupInformationjava at orgapachesparkutilUtilsanonfungetCurrentUserName applyUtilsscala at orgapachesparkutilUtilsanonfungetCurrentUserName applyUtilsscala at scalaOptiongetOrElseOptionscala at orgapachesparkutilUtilsgetCurrentUserNameUtilsscala at orgapachesparkSecurityManagerinitSecurityManagerscala at orgapachesparkdeploySparkSubmitsecMgrlzycompute SparkSubmitscala at orgapachesparkdeploySparkSubmitorgapachesparkdeploySparkSubmitsecMgr SparkSubmitscala at orgapachesparkdeploySparkSubmitanonfunprepareSubmitEnvironment applySparkSubmitscala at orgapachesparkdeploySparkSubmitanonfunprepareSubmitEnvironment applySparkSubmitscala at scalaOptionmapOptionscala at orgapachesparkdeploySparkSubmitprepareSubmitEnvironmentSparkSubmitscala at orgapachesparkdeploySparkSubmitorgapachesparkdeploySparkSubmitrunMainSparkSubmitscala at orgapachesparkdeploySparkSubmitdoRunMain SparkSubmitscala at orgapachesparkdeploySparkSubmitsubmitSparkSubmitscala at orgapachesparkdeploySparkSubmitdoSubmitSparkSubmitscala at orgapachesparkdeploySparkSubmitanon doSubmitSparkSubmitscala at orgapachesparkdeploySparkSubmitmainSparkSubmitscala at orgapachesparkdeploySparkSubmitmainSparkSubmitscala Caused by javalangStringIndexOutOfBoundsException begin end length at javabasejavalangStringcheckBoundsBeginEndStringjava at javabasejavalangStringsubstringStringjava at orgapachehadooputilShellclinitShelljava more Traceback most recent call last File C Progra spark binhadoop python pyspark shellpy line in module SparkContextensureinitialized File C Progra spark binhadoop python pyspark contextpy line in ensureinitialized SparkContextgateway gateway or launchgatewayconf File C Progra spark binhadoop python pyspark javagatewaypy line in launchgateway return launchgatewayconf File C Progra spark binhadoop python pyspark javagatewaypy line in launchgateway raise ExceptionJava gateway process exited before sending its port number Exception Java gateway process exited before sending its port number Could you please kindly provide build for hadoop Using winutils with hadoop jars seems causing problems like this WARN SharedState URLsetURLStreamHandlerFactory failed to set FsUrlStreamHandlerFactory A needed class was not found This could be due to an error in your runpath Missing class orgapachehadoopcryptokeyKeyProviderTokenIssuer javalangNoClassDefFoundError orgapachehadoopcryptokeyKeyProviderTokenIssuer at javalangClassLoaderdefineClass Native Method at javalangClassLoaderdefineClassClassLoaderjava at javasecuritySecureClassLoaderdefineClassSecureClassLoaderjava at javanetURLClassLoaderdefineClassURLClassLoaderjava at javanetURLClassLoaderaccess URLClassLoaderjava at javanetURLClassLoader runURLClassLoaderjava at javanetURLClassLoader runURLClassLoaderjava at javasecurityAccessControllerdoPrivilegedNative Method at javanetURLClassLoaderfindClassURLClassLoaderjava at javalangClassLoaderloadClassClassLoaderjava at javalangClassLoaderloadClassClassLoaderjava at javalangClassforName Native Method at javalangClassforNameClassjava at javautilServiceLoaderLazyIteratornextServiceServiceLoaderjava at javautilServiceLoaderLazyIteratornextServiceLoaderjava at javautilServiceLoader nextServiceLoaderjava at orgapachehadoopfsFileSystemloadFileSystemsFileSystemjava at orgapachehadoopfsFileSystemgetFileSystemClassFileSystemjava at orgapachehadoopfsFileSystemcreateFileSystemFileSystemjava at orgapachehadoopfsFileSystemaccess FileSystemjava at orgapachehadoopfsFileSystemCachegetInternalFileSystemjava at orgapachehadoopfsFileSystemCachegetFileSystemjava at orgapachehadoopfsFileSystemgetFileSystemjava at orgapachehadoopfsPathgetFileSystemPathjava at orgapachesparksqlcatalystcatalogInMemoryCatalogliftedTree InMemoryCatalogscala at orgapachesparksqlcatalystcatalogInMemoryCatalogdoCreateDatabaseInMemoryCatalogscala at orgapachesparksqlcatalystcatalogExternalCatalogcreateDatabaseExternalCatalogscala at orgapachesparksqlinternalSharedStateexternalCataloglzycomputeSharedStatescala at orgapachesparksqlinternalSharedStateexternalCatalogSharedStatescala at orgapachesparksqlinternalBaseSessionStateBuildercataloglzycomputeBaseSessionStateBuilderscala at orgapachesparksqlinternalBaseSessionStateBuildercatalogBaseSessionStateBuilderscala at orgapachesparksqlinternalBaseSessionStateBuilderanon initBaseSessionStateBuilderscala at orgapachesparksqlinternalBaseSessionStateBuilderanalyzerBaseSessionStateBuilderscala at orgapachesparksqlinternalBaseSessionStateBuilderanonfunbuild applyBaseSessionStateBuilderscala at orgapachesparksqlinternalBaseSessionStateBuilderanonfunbuild applyBaseSessionStateBuilderscala at orgapachesparksqlinternalSessionStateanalyzerlzycomputeSessionStatescala at orgapachesparksqlinternalSessionStateanalyzerSessionStatescala at orgapachesparksqlexecutionQueryExecutionanalyzedlzycomputeQueryExecutionscala at orgapachesparksqlexecutionQueryExecutionanalyzedQueryExecutionscala at orgapachesparksqlexecutionQueryExecutionassertAnalyzedQueryExecutionscala at orgapachesparksqlDatasetofRowsDatasetscala at orgapachesparksqlSparkSessioninternalCreateDataFrameSparkSessionscala at orgapachesparksqlSparkSessioncreateDataFrameSparkSessionscala at orgapachesparksqlSparkSessioncreateDataFrameSparkSessionscala Also AWS EMR users are bound to certain versions of hadoop thats why this is an issue The command winutils systeminfo returns an error with the code and a message PdhAddCounter Network Interface Bytes ReceivedSec failed with xc bb Error in GetDiskAndNetwork Err when running Hadoop on Windows bit Its not possible run the Winutilsexe due to the error winutilsexe System Error The code execution cannot proceed because MSVCR dll was not found Reinstalling the program may fix this problem Or stacktrace from from Hadoop Caused by ExitCodeException exitCode at orgapachehadooputilShellrunCommandShelljava at orgapachehadooputilShellrunShelljava at orgapachehadooputilShellShellCommandExecutorexecuteShelljava at orgapachehadooputilShellexecCommandShelljava at orgapachehadooputilShellexecCommandShelljava PS There is workaround install the VC redistributable packages See details here 