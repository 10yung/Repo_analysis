Very useful package I have a minor suggestion in addpi and possibly other functions I havent checked an error is thrown if tb does not include a column for the response variable The actual values in the column are ignored but the column has to be present Id guess this is due to some internal code similar to X formulafit modelmatrixdata tb used to get the design matrix for simulationbased prediction intervals Using a few more steps should eliminate the need to include the response Something like chrformula formulafit deparse strsplit getElement X asformulachrformula modelmatrixdata tb I noticed this specifically with a Poisson GLM addci did not require the response to be in tb Dear Johnbr I am running GLMM models with familyGamma and I want to use addci to compute confidence intervals around predictions many thanks for developing this by the waybrUnfortunately addci often encounters the following error Error in quantiledefaultnewX i missing values and NaNs not allowed if narm is FALSE often but not always I can rerun addci and it might fail or notbr And it seems to be associated with this type of warning message In lme bootMerfit mypred nsim nSims type parametric some bootstrap runs failed Here is the code I m running modfinalglmercumulativeduration winter month scumuldurasmall bigtreat idfirstfeederpair datadataFRICOE family Gammalink log with cumulativeduration being the time in seconds spent by the common chaffinch Fringilla coelebs on a feeder newdatpred expandgridwinterasfactor monthasfactorJan scumuldurasmall bigtreatasfactorcNONEPICPIC idfirstfeederpairasfactor addcinewdatpredmodfinalalpha responseTincludeRanefFtypebootnSims namesclowBCIuppBCI Note nSims set to for speed reason but planning on using for final results I hope Im giving enough useful details on this Im happy to share more as needed I attach the data table dataFRICOEtxt if it can help reproduce this error several runs of addci might be required given it does not always yield this error dataFRICOEtxt Trying addci on a model with a formula involving I ie libraryciTools librarylme data dataframex c y c gr mod lmery Ix gr data addcidata mod results in Error in x nonnumeric argument to binary operator Attempting addcidata mod type parametric results in Error in dataframetmp names value numeric replacement has rows data has The code completes in other cases but returns spurious confidence intervals and the warning longer object length is not a multiple of shorter object length At least in the parametric case the problem appears to be in getxmatrixmermod Trying addci on a model with no fixed effects ie data dataframex repseq y crnorm rnorm mean gr crep rep mod lmery gr data data addcimod type parametric results in Error in reformulateattributestermsfittermlabels termlabels must be a character vector of length at least one Again the problem appears to be in getxmatrixmermod Beta regression is a good alternative to binomial regression when the number of trials is unknown I would like to support this model Some users dont fit mixed models For certain methods like addpiglm and addquantileglm a small parametric bootstrap is performed to generate the desired statistic Presently if these two methods are used a separate simulation is run for each method If the number of replicates nSims and new data tb are not changed it would be nice to store and reuse the simulation data The benefits of storing simulation data are twofold We can speed up our computations if many methods are run in sequence addpi addqauntile and addprobs will be consistent within an analysis each statistic calculated on the same simulation data Though we could just handle the second point by setting a seed Was also wondering if it would be hard to also support mgcvgam generalized additive models and scam shape constrained additive models models The recipe to calculate confidence and prediction intervals for these should be quite similar to that for GLMs right Im finding that we cannot use addcilmer for big data I tried an example from the mermod vignette with observations and found that R couldnt put the new data frame into memory Heres the example I tried linear example xgenmermod functionng nw n ng nw x runifn group repascharacter ng each nw returntibbletibblex x group group mmpipe functiontb modelmatrixdata tb getvalidationset functiontb sigma sigmaG beta includeRanef groupIntercepts vm samplentb replace F rep each vf bindrowsvm tb selectgroup mmpipe vf vf vGroups ifincludeRanef rnorm sigmaG else groupIntercepts asnumericvmgroup vm y vf beta vGroups rnorm mean sd sigma vm ygenmermod functiontb sigma sigmaG delta includeRanef FALSE validationPoints FALSE groupIntercepts rnormlengthuniquetbgroup sigmaG tf tb dplyrselectgroup mmpipe beta repdelta ncoltf ifvalidationPoints vm getvalidationsettb sigma sigmaG beta includeRanef groupIntercepts tb y tf beta groupIntercepts asnumerictbgroup rnormnrowtb mean sd sigma tb truth tf beta groupIntercepts asnumerictbgroup includeRanef ifvalidationPoints returnlisttb tb vm vm else returntb tb xgenmermod ygenmermod fit lmery x group data tb tb addcifit type parametric includeRanef TRUE names cLCB UCB Lmer works just fine on an example data set this large but ciTools chokes and spits out Error cannot allocate vector of size Gb We need to reexamine how we are storing things in memory and see if we can do something more efficient Im not sure if this bug affects the other methods as well Would it also be possible for the package to support confidence and prediction intervals for gls models I would like to have some methods for inflated Poisson and NegBin models Im not sure how these models are commonly fit in R what package or functions are used I think this issue is less important than and 