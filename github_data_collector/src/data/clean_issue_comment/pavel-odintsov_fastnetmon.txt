 Your operating system name and version Debian Buster LTS Kernel Please attach varlogfastnetmonlog install log attached Then please describe your issue as detailed as possible Thanks you Started the installation of fastnetmon on a freshly installed Debian Buster using guide After a short time the following error occurs CMake Error at CMakeListstxt message We cant find jsonc library Cant build project Configuring incomplete errors occurred See also tmpfastnetmonbuilddirxVVAx iEArfastnetmonsrcbuildCMakeFilesCMakeOutputlog See also tmpfastnetmonbuilddirxVVAx iEArfastnetmonsrcbuildCMakeFilesCMakeErrorlog Run make to build FastNetMon make No targets specified and no makefile found Stop Cant build fastnetmon Please share tmpfastnetmoninstall log with FastNetMon team at GitHub to get help CMakeErrorlog CMakeOutputlog fastnetmoninstall log Hello Is it possible to whitelist source of traffic I would like to whitelist for example Google Servers IP addresses Regards Ramiro If you want to solve your issue please read following information below First of all please check following steps Do you have latest FastNetMon version If not please upgrade to version Were running Do we have similar tickets already Please check bug tracker and Mailing list about similar issues None than I can find If it does not help please fill information below Your operating system name and version Debian Please attach your etcfastnetmonconf configuration file What capture engine are you using netflow sflow miror Netflow Then please describe your issue as detailed as possible Thanks you Fastnetmon report some attack as Attack type unknown Attack protocol tcp while its for example the ICMP pps threshold that is being hit And all the other values eg TCP ppsbandwidth are well under the limits Eg Incoming icmp pps packets per second Before we bumped the threshold in This caused us some confusion as we were looking at TCP traffic only at first based on the report Were tracking the issue in as well Thanks Hi I have issue when trying to change some value in fastnetmonconf and then restart the services I found that new threshold setting are not loaded and fastnetmon service still use old value ex Old setting Different approaches to attack detection banforpps on banforbandwidth on banforflows on Limits for DosDDoS attacks thresholdpps thresholdmbps thresholdflows Per protocol attack thresholds We dont implement per protocol flow limits sorry These limits should be smaller than global ppsmbps limits thresholdtcpmbps thresholdudpmbps thresholdicmpmbps thresholdtcppps thresholdudppps thresholdicmppps banfortcpbandwidth on banforudpbandwidth on banforicmpbandwidth on banfortcppps on banforudppps on banforicmppps on And new config Different approaches to attack detection banforpps on banforbandwidth on banforflows on Limits for DosDDoS attacks thresholdpps thresholdmbps thresholdflows Per protocol attack thresholds We dont implement per protocol flow limits sorry These limits should be smaller than global ppsmbps limits thresholdtcpmbps thresholdudpmbps thresholdicmpmbps thresholdtcppps thresholdudppps thresholdicmppps banfortcpbandwidth on banforudpbandwidth on banforicmpbandwidth on banfortcppps on banforudppps on banforicmppps on Im still seing that FNM banned traffic over k pps and mbps please see below INFO Attack with direction incoming IP Power INFO Call script for ban client INFO Script for ban client is finished INFO Call ExaBGP for ban client started INFO Call to ExaBGP for ban client is finished INFO Attack with direction incoming IP Power traffic samples collected Please give a hint FNM Version master git e dd fb c d fc f a f OS Ubuntu LTS Thank you Hello I have im seeing some false positive DDoS alerts aparently caused by clients that use Googles QUIC protocol UDP traffic on ports from Chrome users to Google servers I would apreciate any ideas to get around this issue Thank you Here is an example of the alerts IP XXXXXX Attack type udpflood Initial attack power packets per second Peak attack power packets per second Attack direction incoming Attack protocol udp Total incoming traffic mbps Total outgoing traffic mbps Total incoming pps packets per second Total outgoing pps packets per second Total incoming flows flows per second Total outgoing flows flows per second Average incoming traffic mbps Average outgoing traffic mbps Average incoming pps packets per second Average outgoing pps packets per second Average incoming flows flows per second Average outgoing flows flows per second Incoming ip fragmented traffic mbps Outgoing ip fragmented traffic mbps Incoming ip fragmented pps packets per second Outgoing ip fragmented pps packets per second Incoming tcp traffic mbps Outgoing tcp traffic mbps Incoming tcp pps packets per second Outgoing tcp pps packets per second Incoming syn tcp traffic mbps Outgoing syn tcp traffic mbps Incoming syn tcp pps packets per second Outgoing syn tcp pps packets per second Incoming udp traffic mbps Outgoing udp traffic mbps Incoming udp pps packets per second Outgoing udp pps packets per second Incoming icmp traffic mbps Outgoing icmp traffic mbps Incoming icmp pps packets per second Outgoing icmp pps packets per second Average packet size for incoming traffic bytes Average packet size for outgoing traffic bytes Incoming UDP flows XXXXXX bytes packets My fastnetmon threshold settings are enableconnectiontracking on Different approaches to attack detection banforpps off banforbandwidth on banforflows on Limits for DosDDoS attacks thresholdpps thresholdmbps thresholdflows Per protocol attack thresholds We dont implement per protocol flow limits sorry These limits should be smaller than global ppsmbps limits thresholdtcpmbps thresholdudpmbps thresholdicmpmbps thresholdtcppps thresholdudppps thresholdicmppps banfortcpbandwidth off banforudpbandwidth on banforicmpbandwidth on banfortcppps off banforudppps off banforicmppps off Hi Im sending sflow v from Cumulus switch to fastnetmon Cumulus use the hsflowd daemon The fastnetmoncli shows bytespps etc I get the following log INFO Logger initialized INFO Read configuration file INFO We loaded networks from whitelist file INFO We are working on Linux and could use ip tool for detecting local IPs INFO We found local IP addresses and will monitor they INFO We loaded networks from networks file INFO Totally we have IPv subnets INFO Totally we have IPv subnets INFO Total number of monitored hosts total size of all networks INFO We need MB of memory for storing counters for your networks INFO I will allocate records for subnet cidr mask INFO I will allocate records for subnet cidr mask INFO I will allocate records for subnet cidr mask INFO We start total zerofication of counters INFO We finished zerofication INFO We loaded IPv subnets to our inmemory list of networks INFO Run banlist cleanup thread we will awake every seconds INFO sflow plugin started INFO sflow We will listen on ports INFO netflow plugin started INFO Using custom sampling ratio for netflow INFO netflow We will listen on ports INFO sflow plugin will listen on udp port INFO netflow plugin will listen on udp port ERROR sflow not supported protocol ERROR sflow not supported protocol ERROR sflow not supported protocol ERROR sflow not supported protocol ERROR sflow not supported protocol ERROR sflow not supported protocol Fastnetmon version community For documentation purposes it would be great to allow comments in networklist and networkwhitelist When i comment out the whole line it currently works but throws an error in the logfile ERROR Cant parse line from subnet list testcomment I think a WARNING would be more accurate in this case Unfortunately inlinecomments doesnt work at all because the whole line is ignored ERROR Cant parse line from whitelist testcomment I think the function loadournetworkslist in fastnetmoncpp has to be rewritten respectively the parsing logic has to be expanded in this case Regards Alex FastNetmon Community Edition currently exports pps bps and number of flows on a per host base to Graphite Total values are only exported for pps and bps and unfortunately not for number of flows It would be great if you could check if its also possible to implement export of total number of flows Thanks in advance Regards Alex Hello it would be quite nice to use fastnetmon with multiple uplinks each for example has its own vlan and apply vlan based limits So for example your network has two uplinks one with eg Gbit and one with Gbit A attack should not trigger the banning if it goes up to Gbit on the Gbit link however on the Gbit link it should not trigger the ban as long as it does not go in a dangerous load level for example it stays below Gbit Ive already checked the lua hooks but they dont seem to be the right solution for that The other solution would be to adapt the source code on my own if such a feature doesnt exist already We are use a port mirror for collect traffic and community version of Fastnetmon The value of TTL in varlogfastnetmonattacks is always displayed as x xxx protocol tcp flags pshack frag packets size bytes ttl sample ratio x xxx protocol tcp flags pshack frag packets size bytes ttl sample ratio x xxx protocol tcp flags pshack frag packets size bytes ttl sample ratio x xxx protocol tcp flags pshack frag packets size bytes ttl sample ratio x xxx protocol tcp flags pshack frag packets size bytes ttl sample ratio 