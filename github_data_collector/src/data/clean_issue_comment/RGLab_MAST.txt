Hey MAST makers Big fan of your work The best singlecell RNAseq analysis package currently out there that I know of Apologies if I am not doing this in the right spot I am new to making R packages and new to GitHub and this seemed like the only spot to ask questions I have come across and issue that I cant seem to solve but it appears to be related to how my package currently in development is pulling in and using the glmer function in MAST I am using this line of code in one of my functions zlmCond suppressMessagesMASTzlm Status DonorID sca methodglmerebayes F which spits back this error when I run the function in my code Error in fixefobjectfitC could not find function fixef If I load the lme package within my function prior to running that component it works which I read in Wickhams R packages that this is something to avoid so I am trying to avoid doing it this way At first it was a problem with the fixef function somewhere missing lme but when I looked through your R files I noticed this was not the case all are lme fixef Any ideas what I am doing incorrectly Again sorry to waste your time with this if I am doing something stupid here I am still very new to all of this Thanks so much Kip R changes the signature to Cinfluence dropping the docoef argument I think we may have just copied the source of lminfluence with some minor modifications So it probably needs to be updated for the interface in R whatever minor modifications occurred I cant really tell and dont think this was my code and even if it wasthe code is nearly years old now gfinak do you have any recollection One of our vignettes depends on this code and is making our builds fail I am going to remove the dependency ondevianceresidualshook in the vignette but devianceresidualshook is exported so we probably cant just remove it Hi guys Not sure if this forum or Seurat forum is better to ask this but Im running into an issue specifically when I try to use Mast within the Seurat package all other DGE tests still work The error reads Assuming data assay in position with name et is logtransformed Error in nextMethodObject Object design design invalid name for slot of class BayesGLMlike printbar I cant seem to find much on this error have tried reinstalling the Mast package but didnt really seem to fix the issue Hello I believe there is a bug in bayesglmR I attached bayesglmA R where I inserted a few cat statements If you run it using the code from the other file youll see from the output that the last two weights that correspond to pseudodata are initialized but never updated The problem is that in bayesglmfitloopupdateState the working weights are computed as wstar cw sqrtstatedispersionpriorsscale but to update them one needs to use statepriorsd in the denominator which should be equal to priorsscale only in the beginning It looks like you only need to change one line to fix it Regards Nik Tuzov bayesglmissuezip Hi I have been running MAST on scRNAdata set containing samples After running the zlm on sca object I run summary and only get coefficient c D S and logFC but no H coefficient I am not sure why is that and was wondering if you could help me with it or give some input Here is the code I run sca SceToSingleCellAssaysce sce class SingleCellAssay checksanity FALSE cdr colSumsassaysca colDatascacngeneson scalecdr colnamescolDatasca cond factorcolDatascacategory condrelevelcondNR colDatascaconditioncond cond zlmCond zlm cond cngeneson sca summaryCond MASTsummaryzlmCond summaryDt summaryConddatatable printsummaryCond n byD printsummaryCond n byC printsummaryCond n byS fcHurdle mergesummaryDt contrast condall componentH primerid PrChisq summaryDt contrastcondall componentlogFC primerid coef cihi cilo byprimerid fcHurdle fdrpadjustPrChisq fdr Hope you will have time to check it and give some input Thank you in advance Regards Kristina Hi Im trying MAST for differential analysis in a scRNAseq experiment after clustering ie I dont have any treatment vs control but Im interested in all possible differences in expression between two or more clusters I tried following the examples objmast FromMatrixlogcountsreadsqcendog cData dataframewellKey colnamesreadsqcendog sc k readsqcendogsc clusters colDataobjmastcngeneson scalecolSumsassayobjmast zlmk zlmsc k cngeneson objmast summaryk summaryzlmk doLRT sc k summaryDtk summaryk datatable While it works this only gives the DE of clusters v v v and so on as the first level is taken as reference I unsuccessfully tried to modify the code to get all other comparisons ie v v v v What am I missing Thanks Andrea Hi there Ive just recently encountered this issue and was hoping to see whether you guys could help with understanding whats going on I want to identify differentially expressed genes between conditions We have replicates samples from different animals per condition which were processed in batches from each conditionbatch The formula I used to fit the model is Condition Batch nGenes animal One of the known differences between the conditions is that a transgene is only expressed in one of them and the signal is very robust From previous posts I understand that the continuous component of the model cant be computed in that scenario which is what I see if I fit the model with the formula as above just without the mixed effect However when fitting with the mixed effect the discrete component is no longer estimated and a coefficient appears for the continuous component although not significant Im trying to understand why this is happening since this transgene is essentially a positive control for differential expression and isnt showing up Do you have any insights on whats causing this how to resolve it Here are the relevant rows from the summary object sumlrt MASTsummarymastzlmFit doLRT T using the formulas Condition Batch nGenes Condition Batch nGenes animal Thanks Gabriela Hi I was wondering if you might be able to help me with an issue Ive been having I am trying to run MAST with a nested batch effect I have data from an experiment with mice in conditions mice each spread over plates condition control spread halfhalf per plate Now Id like to run MAST on normalized but not batchcorrected data and include the batch as a covariate First I ran condition sample chip ngeneson where sample is just the mouse I got expected genes out of this although downregulated when I expected them to be upregulated Then I noticed that sample is just a higher resolution of condition each mouse is either condition or control So that would lead to a nonfullrank design matrix and should have output wrong results I assume Running just condition chip ngeneson however gives me far fewer DE genes and not the ones I would expect I assume this has to do with the variability between mice making the background noise quite high I was wondering if I can add the mouse covariate so that it is fit separately per condition to account for variation between mice without interfering with the condition covariate Thanks for any help you can provide I am using MAST on logtransformed tpm data The scRNAseq matrix is composed by cells genes I used a similar matrix before and I had not any problem in getting meaningful results from MAST Earlier I was using a different preprocessing procedure Removal of ribosomal genes Filtering of cells based on spikeins mitochondrial genes and removal of such genes Removal of genes expressed in few cells less than Upper quartile normalization and logtransformation Reading the original MAST paper I decided to use the proposed log TPM normalization However in this case I get no significant False Discovery Rate for all genes What may be the problem here Thanks Francesco Hi there I had a question regarding the interpretation of the hurdle model coefficients in particular with respect to genes expressed at low levels Specifically after running MAST to obtain differentially expressed genes on singlecell RNASeq data we have noticed that the genes with the largest continuous model coefficients correspond to genes that barelydont change in expression between conditions and are also barely expressed Were unsure how to interpret this intuitively we would interpret that large coefficients would mean these genes play a role in explaining the differences between groups but this doesnt make sense if they dont changealmost arent expressed Is this an artifact of how the model fitting occurs in MAST and should one prefilter the data to only include genes expressed in a larger fraction of cells Ive attached plots to illustrate what Im talking about The first plots the coefficient for the continuous component vs the logFC and the nd plots it vs the number of cells each gene is expressed in Any guidance would be appreciated thanks Gabriela 