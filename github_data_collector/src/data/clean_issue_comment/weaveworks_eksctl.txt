 Add kubeconfig context flag in scale nodegroup Signedoffby Dinos Kousidis dinkousidisgmailcom Description Hi this is a WIP PR with some changes addressing a part of It implements flags usekubeconfigcontext and kubeconfigpath in eksctl scale nodegroup which read the cluster name from a given context Some details in the combination of the flags and the cluster naming If both cluster and usekubeconfigcontext are passed the name is taken from the context Im not sure if the other way is better or if an error should be raised instead The path of the kubeconfig is expected to be absolute from If the cluster name ends in eksctlio the name is split and the first part is stored as the generated names in the kubeconfig have the suffix regioneksctlio If this is in the right direction I can add some test cases and add it to other commands where it makes sense Checklist Added tests that cover your change if possible Addedmodified documentation as required such as the READMEmd and examples directory x Manually tested Added labels for change area eg areanodegroup and target version eg version x Added note in docsreleasenotesdraftmd or relevant release note If you havent done so already you can add your name to the humanstxt file If you need the attention of the maintainers ping weaveworkseksctl Description Address Notes I was thinking about to update localhost to to by pass lookup but NewOpenIDConnectManager method parsed input and derive host which might impact mock function Checklist Added tests that cover your change if possible Addedmodified documentation as required such as the READMEmd and examples directory Manually tested Added labels for change area eg areanodegroup and target version eg version Added note in docsreleasenotesdraftmd or relevant release note If you havent done so already you can add your name to the humanstxt file If you need the attention of the maintainers ping weaveworkseksctl I am running make test on MacOS Catalina however it failed due to differences for localhost in IPv eg instead of Expected string connecting to issuer OIDC Get dial tcp connect connection refused to have prefix string connecting to issuer OIDC Get dial tcp connect connection refused Description bump image to dkrecruswest amazonawscomekscorednsv change proxy to forward more details can be found at Checklist Added tests that cover your change if possible Addedmodified documentation as required such as the READMEmd and examples directory Manually tested Added labels for change area eg areanodegroup and target version eg version Added note in docsreleasenotesdraftmd or relevant release note If you havent done so already you can add your name to the humanstxt file If you need the attention of the maintainers ping weaveworkseksctl What happened If one deletes an eksctl created service account it does not appear that one can recreate it with eksctl create iamserviceaccount configfile fooyaml or with eksctl create iamserviceaccount configfile fooyaml overrideexistingserviceaccounts The output suggests that the serviceaccount was excluded This adds a step in the normal workflow to build binaries for all the distros This is not normally run and has to be started manually Needs rebasing once is merged x Manually tested This new versioning embeds the version of eksctl in the code so that regardless of where its built the binary will always print the correct version The versioning format follows semver except for the timestamp which contains XYZ preReleaseId gitCommittimestamp Some examples development snapshot version dev d c T Z a release candidate rc a release The version is kept in pkgversionreleasego and releasegeneratego is used to automate certain operations like preparing a release or release candidate move to the next development version releasegeneratego is used by the release scripts to automate the manipulation of the pkgversionreleasego file It also uses the version to produce artifacts in circleci Check it here fixes x Added tests that cover your change if possible x Addedmodified documentation as required such as the READMEmd and examples directory x Manually tested x Added labels for change area eg areanodegroup and target version eg version Added note in docsreleasenotesdraftmd or relevant release note If you havent done so already you can add your name to the humanstxt file If you need the attention of the maintainers ping weaveworkseksctl Before creating a feature request please search existing feature requests to see if you find a similar one If there is a similar feature request please upvote it andor add your comments to it instead Why do you want this feature As an organization we rely soley on oath tokens for github authentication and do not use ssh keys The following command example does not appear to have a method to use anything other than SSH keys EKSCTLEXPERIMENTALtrue eksctl enable repo giturl gitgithubcomexamplemyeksconfig gitemail youremailcom cluster yourclustername region yourclusterregion Having to add an ssh key as a deploy key is cumbersome What featurebehaviorchange do you want A clear and concise description of the change you would like to see in eksctl The command parameter giturl gitgithubcomexamplemyeksconfig needs to have the ability to pass credentials via https using an oath token as an authentication option Do not hesitate when appropriate to share the exact commands or API you would like andor to share a diagram eg asciiflowcom a picture is worth a thousand words Description To address the lack of test coverage for pkgvpcvpcgo with small change in implementation This is related to Hopefully this is the last ground work PR for the actual fix The current coverage of this file is improved to Noted I am using dependency injection to mock the private methods Please let me know if its accepted I personally dont like this approach much as its going against the idea of using gingko BDD testing but mocking the entire stack calls is just hard Checklist x Added tests that cover your change if possible Addedmodified documentation as required such as the READMEmd and examples directory Manually tested Added labels for change area eg areanodegroup and target version eg version Added note in docsreleasenotesdraftmd or relevant release note If you havent done so already you can add your name to the humanstxt file If you need the attention of the maintainers ping weaveworkseksctl What happened A description of actual behavior with error messages Installed via snap and failed to create cluster using profile flag Remove snap package and installed from githubreleases Same command worked What you expected to happen cluster creation How to reproduce it install from snap Run eksctl create cluster profile MYPROFILE Anything else we need to know Ubuntu Versions Please paste in the output of these commands eksctl version kubectl version Logs eksctl version using region useast retryable error RequestError send request failed caused by Put dial tcp connect no route to host from ec metadataGetToken will retry after delay of ms retryable error RequestError send request failed caused by Put dial tcp connect no route to host from ec metadataGetToken will retry after delay of ms 