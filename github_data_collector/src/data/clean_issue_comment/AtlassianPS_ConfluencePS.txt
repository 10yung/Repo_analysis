Good morning Thank you very much for this very useful PowerShell Module The Subject asks my question Is it possible to get the last modification time for an Attachment I would like to quickly check if an Attachment was already modified in the current month Thanks a lot kind regrads Thomas markdownlintdisable MD markdownlintdisable MD Provide a general summary of your changes in the Title above Description Added switch parameter AsPlainText for function ConvertToStorageFormat to replace chars which confluence would try to convert to macros Motivation and Context Why is this change required What problem does it solve If it fixes an open issue please link to the issue here as follows closes closes We encountered some troubles during uploading powershell script descriptions to confluence because of using chars which confluence would try to convert to macros Types of changes What types of changes does your code introduce Put an x in all the boxes that apply Bug fix nonbreaking change which fixes an issue x New feature nonbreaking change which adds functionality Breaking change fix or feature that would cause existing functionality to change Checklist Go over all the following points and put an x in all the boxes that apply If youre unsure about any of these dont hesitate to ask Were here to help My code follows the code style of this project I have added Pester Tests that describe what my changes should do I have updated the documentation accordingly markdownlintdisable MD markdownlintdisable MD Description Converting a string to confluence storage format with ConvertToConfluenceStorageFormat returns the error comatlassianconfluencecontentrenderxhtmlmigrationexceptionsUnknownMacroMigrationException Steps To Reproduce SystemString JobDescription NOTES Created on Created by Created for DESCRIPTION PSCustomObject FileToExtend PSCustomObject Path C Temp Testtxt SystemString LastAccessTime SystemDateTime PSCustomObject Path C Temp Testtxt SystemString LastAccessTime SystemDateTime ConvertToConfluenceStorageFormat Content JobDescription WARNUNG Confluence returned HTTP error InternalServerError InvokeMethod comatlassianconfluencecontentrenderxhtmlmigrationexceptionsUnknownMacroMigrationException The macro path c is unknown In Modules ConfluencePS Public ConvertToStorageFormatps Zeichen InvokeMethod iwParametersvalue CategoryInfo InvalidResult statusCode Server ErrorString InvokeMethod ArgumentException FullyQualifiedErrorId InvalidResponseStatus InvokeMethod Expected Output p ltbr NOTESbr br Created onbr Created bybr Created forbr br DESCRIPTIONp p PSCustomObject FileToExtend br PSCustomObject br Path C Temp Testtxt SystemString br LastAccessTime SystemDateTime br br PSCustomObject br Path C Temp Testtxt SystemString br LastAccessTime SystemDateTime br br br p gtp Your Environment Confluence GetHost Name Windows PowerShell ISE Host Version GetModule Name ConfluencePS Name ConfluencePS Description PowerShell module to interact with the Atlassian Confluence REST API Version markdownlintdisable MD markdownlintdisable MD Description Im also receiving a bad request when attempting to retrieve a page by label Ive included the request and response below powershell response GetConfluencePage Label noarchivesingle WARNING Confluence returned HTTP error BadRequest InvokeMethod Could not parse cql typepage AND labelnoarchivesingle At C Program Files WindowsPowerShell Modules ConfluencePS ConfluencePSpsm char InvokeMethod iwParameters CategoryInfo InvalidResult statusCode Bad RequestString InvokeMethod ArgumentException FullyQualifiedErrorId InvalidResponseStatus InvokeMethod Steps To Reproduce Run this from the command prompt Any label with a in it will not work powershell GetConfluencePage Label noarchivesingle Expected behavior Content to be returned from the web service powershell PS H GetModule ConfluencePS ListAvailable Select Name Version Name Version ConfluencePS Possible Solution Not obligatory but suggest a fixreason for the bug As arrays which are not of fixed size must be migrated to SystemCollectionsGenericList link script files have problems when the OS cant identify the encoding from the file OS may assume a wrong encoding To Do change encoding of files change tests change gitattributes markdownlintdisable MD markdownlintdisable MD Description As it seems ConfluencePS doesnt support yet if the corporate Wiki is behind ADFS authentication GetConfluenceSpace SpaceKey spaceid raises exception ConvertFromJson Invalid JSON primitive At C Program Files WindowsPowerShell Modules ConfluencePS ConfluencePSpsm char response ConvertFromJson TextEncoding UTF GetStringwebRes CategoryInfo NotSpecified ConvertFromJson ArgumentException FullyQualifiedErrorId SystemArgumentExceptionMicrosoftPowerShellCommandsConvertFromJsonCommand The actual issue appears in ConfluencePspsm Line The InvokeWebrequest delivers in webResponseContent html head head body onloaddocumentforms submit noscriptp strongNotestrong Your browser does not support JavaScript Press Continue to proceed p noscript form methodPOST action div input typehidden nameSAMLRequest valuePHNhbWxwOkF dGhuUmVxdWVzdCB bWx ZXN Pg div noscript div input typesubmit valueContinue div noscript form body html strong Your browser does not support JavaScript Press Continue to proceed p This is because PowerShell doesnt run the JaveScript Code on the Server Thats very likely the reason why the redirection does not work Steps To Reproduce Use ConfluenceWiki Server with ADFS Authentification Run GetConfluenceSpace Exception ConvertFromJson Invalid JSON primitive see above or Picture Expected behavior Detection if ADFS used and support the occuring redirect Screenshots is the internetfacing ADFS proxy Your Environment Include as many relevant details about the environment you experienced the bug in The following code snip is a recommendation You can just paste the output here ConfluencePS PSVersion Confluence Server Possible Solution Thanks When attempting to upload any files larger than MB MB in our case to a page in our Confluence space powershells memory usage on the client machine doing the uploading spikes to GB and the upload never completes We can upload files less than MB quickly and without issue and we have confirmed with our Atlassian team that the max file size for REST API uploads is MB We are on the latest version of AtlassianPS and our server is on Confluence version Hi when I run the GetConfluenceAttachment below to get the attachment for the page GetConfluenceAttachment PageID the following exception is thrown can you please help ConvertToAttachment Exception calling ToInt with arguments Index was out of range Must be nonnegative and less than the size of the collection Parameter name startIndex At C Program Files WindowsPowerShell Modules ConfluencePS ConfluencePSpsm char result converter CategoryInfo NotSpecified ConvertToAttachment MethodInvocationException FullyQualifiedErrorId ArgumentOutOfRangeExceptionConvertToAttachment markdownlintdisable MD markdownlintdisable MD Provide a general summary of your changes in the Title above Description GetUser Motivation and Context Closes Types of changes What types of changes does your code introduce Put an x in all the boxes that apply Bug fix nonbreaking change which fixes an issue x New feature nonbreaking change which adds functionality Breaking change fix or feature that would cause existing functionality to change Checklist Go over all the following points and put an x in all the boxes that apply If youre unsure about any of these dont hesitate to ask Were here to help x My code follows the code style of this project I have added Pester Tests that describe what my changes should do x I have updated the documentation accordingly 