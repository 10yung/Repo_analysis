as per Environment please complete the following information na Your Text Just wondering what the parameter type is intended to be on the following methods MailboxmarkMailAsRead MailboxmarkMailAsUnread MailboxmarkMailAsImportant Environment please complete the following information PHP IMAP version PHP Version Type of execution daemon Describe the bug when fetching by messageid rather than by filter query get bunch of notices about Trying to get property of nonobject PHP Notice Trying to get property encoding of nonobject in appvendorphpimapphpimapsrcPhpImapMailboxphp on line PHP Notice Trying to get property type of nonobject in appvendorphpimapphpimapsrcPhpImapMailboxphp on line PHP Notice Trying to get property subtype of nonobject in appvendorphpimapphpimapsrcPhpImapMailboxphp on line PHP Notice Trying to get property type of nonobject in appvendorphpimapphpimapsrcPhpImapMailboxphp on line PHP Notice Trying to get property type of nonobject in appvendorphpimapphpimapsrcPhpImapMailboxphp on line To Reproduce Steps to reproduce the behavior The used code php function constructmailbox opts thismailboxnew PhpImap Mailbox mailboxhost imapssl IMAP server and mailbox folder mailboxemailAddress Username for the before configured mailbox mailboxpasswd Password for the before configured username thissaveAttachPath Directory where attachments will be saved optional USASCII Server encoding optional thismailboxsetAttachmentsIgnoretrue return this function fetchAllSince mailsIds thismailboxsearchMailboxSINCE datedMYstrtotimesincedate messages foreach mailsIds as mailsId arraypushmessages thismailboxgetMailmailsId return messages function fetchAttachmentsmessageId mailthismailboxgetMailmessageId retmailgetAttachments The headers of the parsed email if required and possible only if its NOT confidential headersRaw string MIMEVersion Received from VE EUR HT eopEUR prodprotectionoutlookcom b e by CY PR MB namprd prodoutlookcom with HTTPS via CY PR CA NAMPRD PRODOUTLOOKCOM Fri Dec ARCSeal i arsasha sarcselector dmicrosoftcom cvpass bSdGQghe y E qxtdSz NCs alVssr sokcH hHXcF cbUWznAP X nnLNIrfP YIPpoE rWDomJiVo zqjfdPeHEKK b MQ G MwBmo gBWdO BwltoCcUUwGMnIrn w sTrpoFNXGwxmUROwUEfyet W yb LQsUMm r SkmEEhJVtT A kKUEory iAl n pVNufzSKhnAN xSbcvrnXLW yygknhlASdlHkbUdb OyABDFAtjMDnu wuhbKT k cGmKgCVmcIwA UIGiXvMYLxRfJGDmdcm uPvCinPZSBdfYP M fz RB l yaMwa g ARCMessageSignature i arsasha crelaxedrelaxed dmicrosoftcom sarcselector hFromDateSubjectMessageIDContentTypeMIMEVersionXMSExchangeSenderADCheck bh DSBnyFbvMWF NY YZQyZLQz F EYycyByaTveg bKCo xsITceKSnMB Lwi SFjCO rrdddMFkPxXMqXg cfq VR PNgFz vNExzOCtodJ SyxyFVGnxv nPSkghU d GbYmygKSW Ehay byX s FI xipxpJ d nThRwsIF RVyC lN zQZZ xtK sYmxTmwQZMkUGLbjYoi H O ooDtmfcbnS uf CqKHuZqyLALrd M gT ymjlYjuRLUwLJd s FfyogLv YWqfs IHNPu c xYNGsnUM fxZ dlxJy RvGK FiXa PfWKPZST EctJi ZyGYeLMog gGjXB Ac JdsTWrHfUiohMijH w ARCAuthenticationResults i mxmicrosoftcom spfpass sender ip is smtprcpttodomainhotmailcom smtpmailfromhotmailcom dmarcpass pnone spnone pct actionnone headerfromhotmailcom dkimpass signature was verified headerdhotmailcom arcpass oda ltdi Received from VE EUR FT eopEUR prodprotectionoutlookcom by VE EUR HT eopEUR prodprotectionoutlookcom with Microsoft SMTP Server versionTLS cipherTLSECDHERSAWITHAES GCMSHA id Fri Dec AuthenticationResults spfpass sender IP is smtpmailfromhotmailcom hotmailcom dkimpass signature was verified headerdhotmailcomhotmailcom dmarcpass actionnone headerfromhotmailcom ReceivedSPF Pass protectionoutlookcom domain of hotmailcom designates as permitted sender receiverprotectionoutlookcom clientip heloNAM SN obeoutboundprotectionoutlookcom Received from NAM SN obeoutboundprotectionoutlookcom by VE EUR FT mailprotectionoutlookcom with Microsoft SMTP Server versionTLS cipherTLSECDHERSAWITHAES GCMSHA id via Frontend Transport Fri Dec XIncomingTopHeaderMarker OriginalChecksumF F BB F AB D F E AFB C E C AE FF E UpperCasedChecksum BF AEBF A C FED DB BBD D C C BB E A FSizeAsReceived Count ARCSeal i arsasha sarcselector dmicrosoftcom cvnone bGqFQjUNebJPGhYgKuyi lMzAGjsR r cShuEJOnZXMCsmi I WWba orAv iM sCrjHnY nS vhJK iL kChEKRDJhx PzUzJPvDmHQeSCfU oaCpEkwG pwu KGIWZJugLKnquQKGqseGfmRom qLjSvaC klc lhhe NsCwbrbI I rvqnrrzDyRXALX Yh cwt GySQ vHecDmQyVjxJ h YNleHIsFre ZCY EQzjzt Z cOmnQZOgKIcdIfB SlrEtImXruP HgQq L WqGEER Xw BOHH WxXzbGJEo TOy EA ARCMessageSignature i arsasha crelaxedrelaxed dmicrosoftcom sarcselector hFromDateSubjectMessageIDContentTypeMIMEVersionXMSExchangeSenderADCheck bh DSBnyFbvMWF NY YZQyZLQz F EYycyByaTveg bQXqDilErfmMf NEsux zShZMUEYJs kCLq TuUwxWoCe VL Zq ZmgOzWEpU kZ mHVeo yCeK ZX yUvJzSjvwRl Bv yw fZR XP aK sLDwERdbjIbwSJOT iIrwbA OD cYaJMYNK x txycwxgGqmrYTGCGs o fRqt qxkyOyCDMMI f tploj O Ma lulB tYArQ h CI L Sf xRD XF dlU rlAFNoD Yzx HetZh G m WUl KZdRU Ecx GaDPsMQTW O RukhPVEmuQhY IOzdJLkWVnhQ PFuVitlqZ DnkGSoQ ARCAuthenticationResults i mxmicrosoftcom spfnone dmarcnone dkimnone arcnone DKIMSignature v arsasha crelaxedrelaxed dhotmailcom sselector hFromDateSubjectMessageIDContentTypeMIMEVersionXMSExchangeSenderADCheck bh DSBnyFbvMWF NY YZQyZLQz F EYycyByaTveg bNxie iubnFsU TJEAq fPKnT lQXZM ak MdCIh gZ C Os MAbmE vlLLhpOACIwgwRrC CHznuSXnkRDbIa kYirO ofz SLTwWWKkwGu XousTsLJ yfd rLwPT jq ONrsMcv d CLKcxwnr RzwHnxbDRFBdylnKEODb BpVQX J hBj BXlJTaQHBv I tLSxd Nsk zh CrTdXjG g nfCAjbklwkI zzSK NQnWfxSXf KbPOq bdhuUhzE cuAZ DKiQwH DZjnPv xR qtR Jj LeexxF sSsbBJHboqD OpBw f wj EVoASztzg Received from CO NAM FT eopNAM prodprotectionoutlookcom by CO NAM HT eopNAM prodprotectionoutlookcom with Microsoft SMTP Server versionTLS cipherTLSECDHERSAWITHAES GCMSHA id Fri Dec Received from CY PR MB namprd prodoutlookcom by CO NAM FT mailprotectionoutlookcom with Microsoft SMTP Server versionTLS cipherTLSECDHERSAWITHAES GCMSHA id via Frontend Transport Fri Dec Received from CY PR MB namprd prodoutlookcom fe f e f b e c by CY PR MB namprd prodoutlookcom fe f e f b e c with mapi id Fri Dec From yuliang ruan yuliangruanhotmailcom To yuliang ruan yuliangruanhotmailcom Subject ahoy ThreadTopic ahoy ThreadIndex AQHVrFVC MeN Ok w m RF A Date Fri Dec MessageID CY PR MB F D C F F CY PR MB namprd prodoutlookcom AcceptLanguage enUS ContentLanguage enUS XMSHasAttach XMSTNEFCorrelator xincomingtopheadermarker OriginalChecksumB CDA F A B E BBB C F DC C BBE CEA EFAA C A UpperCasedChecksum D C F F E AC B C B F D EAFBFC E B B CSizeAsReceived Count xtmn OTeR ivG OeaKEtikeI WeDWVqunetbn xmspublictraffictype Email xincomingheadercount xeopattributedmessage XMSOffice FilteringCorrelationId d ec fe b e d a ca xmsexchangeslblobmailprops gnUhuqUAszvuq N u vyV OBBeUexM CvlFl KQZST TlgR ELI iybepe FvKzqBHtHomHwNtMTfpQvockbdUy uFXq rQyA nTPe nR ABH ZDGkUK rmVg u u VoHqU O taJ VQ JQk RSFbdBaiJIgEEQ H vknf UjVlZ QNPvT Ma Y rzpkAy iIlrpiS zHoGVI r fbGL uFcokPFKiof MM GlpASDIOlZMj knFEklnztnHWat NaL LD STrGiwGw PrTRMhb t M nF U iEYMCLRFqfXHFn nG OTaf qn D WcwyYRL v eK s nohlq p Ho zbbvj gRNknpxcoXM TFxY AiZgkFDrURhHGS SXit y DP xoSHJmAHlRWNA gbhr xBhs qiLlTnq MtMC yXMybDxXr Ikv cx opoOxQOJPyMp kfQzfeC S wpxhewRuWpLKv QF S KdPzV MntQpbGIiJIMD FWPPTvLkcUrh KOsh kRdVaw e aJPxddUGm wiYx vlOIWCgo XMSTrafficTypeDiagnostic CO NAM HT VE EUR HT XMicrosoftAntispamUntrusted BCL XMicrosoftAntispamMessageInfoOriginal cl xqMDb oBvEqopmp svkIvuUiqyUWijJy Jo q Y wc Qn bo qmuIiaxRZpF K xOs oHfgmZcSqIdagzZ Y vuC L KSbI hpGAtvrhAJ jR VAPHZkswbhGgtk eyPej j QgYjWv a m isSkWZupyCPz J gQoiQ VBTftnG EboXpF xmsexchangetransportforked True ContentType multipartalternative boundary CY PR MB F D C F F CY PR MB namp XMSExchangeTransportCrossTenantHeadersStamped CO NAM HT XIncomingHeaderCount ReturnPath yuliangruanhotmailcom XMSExchangeOrganizationExpirationStartTime Dec UTC XMSExchangeOrganizationExpirationStartTimeReason OriginalSubmit XMSExchangeOrganizationExpirationInterval XMSExchangeOrganizationExpirationIntervalReason OriginalSubmit XMSExchangeOrganizationNetworkMessageId d ec fe b e d a ca XEOPTenantAttributedMessage df e fe f afb aaaaaaaaaaaa XMSExchangeOrganizationMessageDirectionality Incoming XMSExchangeTransportCrossTenantHeadersStripped VE EUR FT eopEUR prodprotectionoutlookcom XMSExchangeTransportCrossTenantHeadersPromoted VE EUR FT eopEUR prodprotectionoutlookcom XForefrontAntispamReport EFVNLI XMSExchangeOrganizationAuthSource VE EUR FT eopEUR prodprotectionoutlookcom XMSExchangeOrganizationAuthAs Anonymous XMSUserLastLogonTime PM XMSOffice FilteringCorrelationIdPrvs d bdc c e cdc d a ca ef XMSExchangeEOPDirect true XSenderIP XSIDPRA YULIANGRUANHOTMAILCOM XSIDResult PASS XMSExchangeOrganizationPCL XMicrosoftAntispam BCL XOriginatorOrg hotmailcom XMSExchangeCrossTenantOriginalArrivalTime Dec UTC XMSExchangeCrossTenantNetworkMessageId d ec fe b e d a ca XMSExchangeCrossTenantId df e fe f afb aaaaaaaaaaaa XMSExchangeCrossTenantRMSPersistedConsumerOrg XMSExchangeCrossTenantrmspersistedconsumerorg XMSExchangeCrossTenantFromEntityHeader Internet XMSExchangeTransportCrossTenantHeadersStamped VE EUR HT XMSExchangeTransportEndToEndLatency XMSExchangeProcessedByBccFoldering XMicrosoftAntispamMailboxDelivery dkl rwl ucf jmr ex auth destIOFRSpamFilterPassENG XMessageInfo vMbyqxGkdeFFkMRl guZnb i zgrgolnniV oHqqoTmwAPpBGYOzXgMcplK MIvryTA wSw yGDnLNz j p HZHiFOkY ulRIHtQL IGg NUte vTSgymasVUusXvYzydXgvZ z qmdkyUNYm bhIIpGSvhwBq O lcQaoL yhba AuSGW rwMgpHg GI AwM FckqWBC fg XMessageDelivery Vj xLjE dXM MDtsPTA YT xO Q MTtHRD xO NDTD tMQ XMicrosoftAntispamMessageInfo QyspKafzo OsOu ZX NkfBwPGmizbZSeOqv DLWA Qw EdFrcz IjCtRg DkWvaAi p hSiWVVE usqDkxL BP lr pJVTbX QTX i LXDp sjdbBeNIOpJ fn TROMYrBAknsATYjw sSHDdGeqzaS ZXrWpNMtt OG Fw wgPzt HxodEHj fXjsf fUGhPMaOYNdHvnaHUvVTzeAJD CtC lVd WQrx eknyFx lR PTvHInBrRo S UuA YpRAlthtT Cak F wqk FGYTcBZOGJnbWg Y LH m FG ZZYVjRf aX DskPhwgsQLpxkwujsyNnUq AP eHc Sv Zj NFX seD u Qj L WRj s bMxotswsRha ttCUjEByxshhDYnX qIyVLgjffzVOSEBfgBFLi VsQ tZ PbLngK RKzMLwh R DBR iyeshLr ODvvuTEtS ToibKJte IJTLy aiAucirno zUrq VO vzlvqP ndCBqkiIDSZvHl FhXpRGraoUKeldgWev pEzvMcMqRsOsH DYdF sjR S Fe dywJLyojkYETwY XieRpmQPs yCgZ Q VJbfJnmgrrVn TJrmOui PsZyaL Py JWHGvEZIEel NfnzEciGABRZd gXR YKwzizoSaM AU InfvTSUgpilPzDD ie UGgIrmnA Y oYTPopfdLXDJcMnhwyuU eEGP IQrDlNxsSelUh OOzwnk FQBra evDVVdauMVA qo ehMMMD YicrzB hrw hy NK IPYPX DVVwm FlhwTw Expected behavior no notices generated Screenshots Outputs If applicable add screenshots or outputs of your script to help explain your problem Additional context Add any other context about the problem here Environment please complete the following information environment not applicable Your Text Im about sure ie not totally that should be option FTPREFETCHTEXT as the results in a bool which when passed nonstrictly to the int options param of imapfetchheader would result in a meaning its always stuck at FTUID bumping up test coverage a little Hi First of all the package was greater before Novermber attachment class was updated at the moment work with attachment should be reviewed by a developer in the code because there is no any documentation how to work with attachment item My feature idea is to add a method to get an attachment extenstion and another information it can be realised with finfofile object like it getMimeType method does now for mime type Environment PHP IMAP version PHP Version Type of execution Web Server Describe the bug When using setFilePath method only the filepath property value is changed The filePath property is used when saving the file to disk which results in saving the file to undesired location To Fix Change setFilePath method to presumably keeping both properties is for backward compatibility public function setFilePathfilePath thisfilePath thisfilepath filePath How to read SentJunk box or other folders Is Google OAuth authentication supported in this library Environment PHP IMAP version PHP Version Type of execution Web Server Describe the bug the attachments inside eml are all with emlOriginfalse instead true To Reproduce send mail from outlook with msg attachment msg with attached pdf inside The used code php mailbox new Mailboxhostinbox username password mailsIds mailbox searchMailboxALL foreachmailsIds as mailid email mailbox getMailmailid false if email hasAttachments mailbox getAttachmentsIgnore attachments email getAttachments foreachattachments as at if at name here all attachments both msg converted to eml both msgeml sub parts are with emlOrigin false The headers of the parsed email if required and possible only if its NOT confidential MIMEVersion Received from srvmail xxxit by srvexchangexxxit with Microsoft SMTP Server TLS id Tue Dec Received from SRVMAILxxxit by srvmail xxxit with Microsoft SMTP Server versionTLS cipherTLSECDHERSAWITHAES CBCSHA id Tue Dec Received from SRVMAILxxxit fe e e f c cd by srvmailxxxit fe e e f c cd with mapi id Tue Dec From xxx xxxmailit To yyy yyy mailit Subject sbj ThreadTopic sbj ThreadIndex AdW Y ft jPNIFRGLTU r h xg Date Tue Dec MessageID b fc f aa c c fc d f srvmailxxxit AcceptLanguage itIT enUS ContentLanguage itIT XMSExchangeOrganizationAuthAs Internal XMSExchangeOrganizationAuthMechanism XMSExchangeOrganizationAuthSource srvmailxxxit XMSHasAttach yes XMSExchangeOrganizationSCL XMSTNEFCorrelator ContentType multipartmixed boundary b fc f aa c c fc d f srvmailxxxit Expected behavior i dont know exactly attachmentemlOrigin logic meaning especially on eml attached but i would have expected to find at least pdf attachment that was inside the msg converted into eml with emlOrigin true Screenshots Outputs Additional context Add any other context about the problem here 