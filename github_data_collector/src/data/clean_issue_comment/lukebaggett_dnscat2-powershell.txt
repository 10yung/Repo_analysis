session got terminated after a part of time and when the computer is in idle mode the session got disconnected and error code shown CategoryInfo NotSpecified WriteError WriteErrorException FullyQualifiedErrorId MicrosoftPowerShellCommandsWriteErrorExceptionUpdateDnscat Session on line and char Sessions SessionId UpdateDnscat Session Sessions SessionId I have the sever running but get the below error on the Windows client StartDnscat EncInit Failed to negotiate encryption Ensure your dnscat server is set up correctly At line char Session StartDnscat EncInit Session False CategoryInfo NotSpecified WriteError WriteErrorException FullyQualifiedErrorId MicrosoftPowerShellCommandsWriteErrorExceptionStartDnscat EncInit The following commands are having issues upload tmptest Ctest download Ctest tmptest For download dnscat says that it is expecting more bytes and fails to write the file or the file is written but is missing a few bytes at the end For upload sometimes it works and sometimes nothing happens Looking into this At the moment encryption functions use BouncyCastles crypto DLL which requires a reflective load of a huge amount of data significantly increasing the script size This should be avoided which will require finding alternative Salsa SHA and ECDHP functions Add documentation and more comments