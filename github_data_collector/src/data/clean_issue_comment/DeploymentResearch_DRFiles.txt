Im using SCCM with MDT integration added a run command line task to run this script Initially it was failing saying expected Then at line whatever I threw in few Thens and it was happy but now it fails saying D SMSTaskSequence WDPackage scripts ConfigDisableWindowsStoreUpdateswsf WshShellRegDelete Invalid root in registry key HKEYLOCALMACHINE NewOS Microsoft Windows CurrentVersion WindowsStore WindowsUpdate AutoDownload It fails here If oEnvironmentItemSMSTSInWinPE true Then oShellRegDelete HKEYLOCALMACHINE NewOS SOFTWARE Microsoft Windows CurrentVersion WindowsStore WindowsUpdate AutoDownload I cannot work this out I get the same thing if I try and run the script on my standard Win box even if I manually create the key Any ideas Replaced Visual C with Visual C as it is binary compatible with and Included issue fix from baardhermansem to silently install and newer ones Pull request Hi Johan RE InstallMicrosoftVisualCx x wsf Is there a way to make this compatible with both MDT and SCCM Or maybe an easy way to switch between the two via commenting x installs seem to be working but the x installs are being completely ignored The only changes I have made is the file name changes as suggested in Using the Bunnys ImageFactory to build an image I am calling ConfigDisableWindowsStoreUpdateswsf in the same manner as illustrated here but registry changes do not stick Indeed I can pause the TS in WinPE and make the changes manually I can see the c windows system config software files modified date is updated but if I mount the hive manually once again the registry values are not present from either the script or my manual changes To be sure I also check again once in full Windows and they are not there Does anybody find that ConfigDisableWindowsStoreUpdateswsf is working with Hello gurus Just wanted to let you know that the script for installing VS needs a modification on below lines sSetupFile x oUtilityScriptDir Source VS muvisualcppredistributableforvisualstudio version x exe sSetupFile x oUtilityScriptDir Source VS muvisualcppredistributableforvisualstudio version x exe They should become sSetupFile x oUtilityScriptDir Source VS vcredistx exe sSetupFile x oUtilityScriptDir Source VS vcredistx exe Since thats their name now on the URL you specify in your script Scenario works When using the Download Package Content task in a task sequence if you reference a package directly through the task sequence using this task OSDDownloadDownloadPackages variable gets set and CM finds and downloads the correct version of the package Scenario does not work When using the Download Packaget Content task in the task sequence and you set OSDDownloadDownloadPackages variable through a this script during the task sequence OSDDownloadDownloadPackages is set correctly however SCCM does not find the correct version of the package This is causing issues with E Nomad as it is trying to download the package stored in OSDDownloadDownloadPackages version instead of the correct version of the package Native CM seems to be able to figure this out but it is not working for alternate downloaders scenario scenario In the task sequence for DC does this script change the domain name in the Authorize DHCP step in the State Restore node Thanks agian for this starting row oLoggingCreateEntry oUtilityScriptName About to install sSetupFile x LogTypeInfo iRetVal oUtilityRunWithHeartbeat sSetupFile x sArguments Must be the same year I think Looks like is missing from the script as per 