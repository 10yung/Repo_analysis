 Avoiding inserting blank lines at the end of project files by using SystemIOFile WriteAllText instead of outfile Removed SolutionDir ConditionSolutionDir Or SolutionDir Undefined SolutionDir Using the same file encoding when saving the file I have Visual Studio and installed I have a directory that contains Visual Studio sln files When I doubleclick on the sln files they open in Visual Studio without issues However after running migrateToAutomaticPackageRestoreps on that directory doubleclicking on the sln files opens them in Visual Studio Files with the extension sln are associated with the Microsoft Visual Studio Version Selector The problem is that the sln files were originally saved using ANSI encoding but migrateToAutomaticPackageRestoreps changed them to use UTF encoding and this is what caused the issue Resaving the sln files back to ANSI and then doubleclicking them opens in Visual Studio as expected Im thinking the script should save the files in their original encoding Thank you Running migrateToAutomaticPackageRestoreps doesnt remove the following line in the project files SolutionDir ConditionSolutionDir Or SolutionDir Undefined SolutionDir That line is added when Enabling NuGet Package Restore on the solution in Visual Studio Update and NuGet Package Manager v Thank you 