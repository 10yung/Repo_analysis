According the code the Jensens alpha is calculated with accumulated return in the following formula result Rp Rf CAPMbetaRa Rb Rf Rpb Rf Yet if Rf is feed with a time series which is normal in practical application a same size of vector will be returned instead of a single value which is expected in general Again if Rp is the accumulated return of Ra we have the same reason to expect that Rf should be the the accumulated return of riskfree interest rate engine added for boxplot timeseries drawdown performancesummary Noticed an issue in the DrawdownPeak private function when trying to calculate a Ulcer Index myself using the Drawdowns function Seems to me DrawdownPeak may be an old implementation of Drawdowns that never got swapped in some older functions Issue is returns are divided by at one point compounded and then multiplied back by So it seems to assumes percent returns are passed in as integers instead of decimals It seems to me in the rest of the package decimal returns are always expected so seems to fall out of place The fix is simple just remove the divide by and multiply by That makes drawdown results match those returned by the Drawdowns function val val R j drawdownpeak i val This PR is a proposed fix with unit test for I am running the chartSnailTrail function from the PerformanceAnalytics package in r I get the following subscript out of bounds error Error in chartSnailTrailz Rf main Error in rval i j drop drop subscript out of bounds I am not understanding the relevance of the rval i j drop drop message nor the reason the subscript is out of bounds Heres the reprex librarydatatable if requireNamespacexts quietly TRUE z datatable date asDatec Advisors cNA NA NA NA NA NA NA NA NA CompositePortfolio cNaN NaN NaN NaN NaN NaN NaN NaN NaN print datatable printz print head of xts printheadasxtsdatatablez xts might not be attached on search path convert to xts zasxtsdatatablez chartSnailTrailzRf mainaddnames nonewidthPeriodQtrstepsize legendloctopleft cexaxis cexlab supCreated on by the reprex package v sup devtoolssessioninfo Session info setting value version R version os Windows x system x mingw ui RTerm language EN collate EnglishUnited States ctype EnglishUnited States tz AmericaNewYork date Packages package version date lib source assertthat CRAN R backports CRAN R callr CRAN R cli CRAN R crayon CRAN R desc CRAN R devtools CRAN R digest CRAN R evaluate CRAN R fs CRAN R glue Github tidyverseglue b e highr CRAN R htmltools CRAN R knitr CRAN R magrittr CRAN R memoise CRAN R pkgbuild CRAN R pkgload CRAN R prettyunits CRAN R processx CRAN R ps CRAN R R CRAN R Rcpp CRAN R remotes CRAN R rlang CRAN R rmarkdown CRAN R rprojroot CRAN R sessioninfo CRAN R stringi CRAN R stringr CRAN R testthat CRAN R usethis CRAN R withr CRAN R xfun CRAN R yaml CRAN R CUsersutexas DocumentsRwinlibrary CProgram FilesRR library Any assistance or direction on resolving this error is greatly appreciated Thank you Hello in tableDownsideRiskRatio function freq is not defined if scale is not NA y checkDataR columns ncoly columnnames colnamesy if isnascale freq periodicityR for column in columns znames cpaste freqscale downside risk Annualised downside risk Downside potential Omega Sortino ratio Upside potential Upside potential ratio Omegasharpe ratio Previously incorrect formula for Fisher skewness x should be replaced by x meanx This can easily be verified in Excel as it also uses Fisher skewness Today I came across this amazing package which fit the needs of a colleague who wanted to have a little special on here base plot legend Thanks to the authors and contributors for their hard work However we were confused how bordercol worked because it acutally didnt Here is a snippet of code which describes what I mean plot PerformanceAnalyticslegendbottomright legend test fill lightgrey bordercol blue borderlty dashed borderlwd boxcol red boxlty dotted boxlwd Normally the box of the legend should be red not blue Same with the lwd and the lty I found the lines and fixed it with two commits Would appreciate seeing it merged If I missed something feel free to comment According to the documentation for Returnportfolio rebalanceon parameter Ignored rebalanceon parameter if weights is an xts object that specifies the rebalancing dates However I observe that the behavior of the code is only consistent with this documentation for Returnportfolio geometricTRUE NOT Returnportfolio geometricFALSE Specifically for geometricFALSE Returnportfolio rebalances on every observation within the R asset returns argument regardless of the weights is specified with a rebalancing dates or if the rebalanceon argument is used Here is a simple reproducible example dataedhec data edhec retgeo Returnportfoliodata rebalanceon quarters verbose TRUE geometric TRUE retgeoBOPWeight Note that BOPWeight only resets to on a quarterly basis Convertible Arbitrage CTA Global retari Returnportfoliodata rebalanceon quarters verbose TRUE geometric FALSE retariBOPWeight Note that BOPWeight resets to at EVERY OBS Convertible Arbitrage CTA Global I dug into Returnportfolioarithmetic and it looks like the following line should be replaced bopweights k weights i I believe it should be if j bopweights k weights i else bopweights k eopweights k Please let me know you think I can open a PR to fix this if you do indeed agree it is a bug or otherwise needs an update Thanks in advance