 stata display Hello I am printed in Stata produces comerror Traceback most recent call last C Users Public Anaconda lib sitepackages win com client dynamicpy in GetGoodDispatchIDispatch clsctx try IDispatch pythoncomconnectIDispatch except pythoncomoleerror comerror Invalid class string None None During handling of the above exception another exception occurred comerror Traceback most recent call last ipythoninput ccd in module getipythonruncellmagicstata display Hello I am printed in Stata n C Users Public Anaconda lib sitepackages IPython core interactiveshellpy in runcellmagicself magicname line cell with selfbuiltintrap args magicargs cell result fnargs kwargs return result C Users Public Anaconda lib sitepackages decoratorpydecoratorgen in stataself line cell localns C Users Public Anaconda lib sitepackages IPython core magicpy in lambdaf a k but its overkill for just that one bit of state def magicdecoarg call lambda f a k fa k if callablearg C Users Public Anaconda lib sitepackages ipystata ipystatamagicpy in stataself line cell localns timesleep selflogdict sessionid ospathjoinselflibdir logstxt sessionid selfsessiondict sessionid win comclientDispatchstataStataOLEApp selfdodict sessionid selfsessiondict sessionid DoCommandAsync selfsessiondict sessionid UtilShowStata C Users Public Anaconda lib sitepackages win com client initpy in Dispatchdispatch userName resultCLSID typeinfo UnicodeToString clsctx assert UnicodeToString is None this is deprecated and will go away dispatch userName dynamicGetGoodDispatchAndUserNamedispatchuserNameclsctx return WrapDispatchdispatch userName resultCLSID typeinfo clsctxclsctx C Users Public Anaconda lib sitepackages win com client dynamicpy in GetGoodDispatchAndUserNameIDispatch userName clsctx else userName struserName return GetGoodDispatchIDispatch clsctx userName def GetDescInvokeTypeentry invoketype C Users Public Anaconda lib sitepackages win com client dynamicpy in GetGoodDispatchIDispatch clsctx IDispatch pythoncomconnectIDispatch except pythoncomoleerror IDispatch pythoncomCoCreateInstanceIDispatch None clsctx pythoncomIIDIDispatch else may already be a wrapped class comerror Invalid class string None None Ive just started using IPyStata and its great but the inline graphs were displaying as blank gray boxes in the jupyter notebook My install is a little unusual so Im not sure if others have run into the same problem but it looks like its related to this issue from Jupyter If I understand correctly there was a securityminded fix to Jupyter that prevents pdf images from being loaded inline in notebooks This seems to be the case since I couldnt load pdf images directly from the Jupyter project folder but was able to load png images Unfortunately unixlinux Stata is unable to save graphs to png Ive implemented a kludgy fix on my installation which uses imagemagick to convert tempfilepdf to tempfilepng before loading the graph in the notebook with IFrame but it doesnt seem like a good solution to the problem since it introduces system calls and adds a nonPython dependency Has anyone else run into this problem My setup Jupyter Jupyternotebook and dev IPython Python latest IPyStata chromebook ChromeOS Hi Just wanted to point out that while import os in cell above enables writing of log file it also seems to turn off output to the Jupyter notebook So you can have one or the other but not both output to Jupyter notebook and a log file It would be nice to be able to get both command window output to Jupyter AND a log file A nice enhancement if there is an easy way to do this Thanks again for writing this terrific Stata magic as we know in Stata even the variable names can be Chinese characters but Ipystata cannot display those names properly Hope you will fix this minior problem in the future ipystata is a really GREAT thing It would be great if it were possible to show multiple graphs per cell like ipython can I believe this could be done by keeping track of the graphdata before and after a cell is run to see if any are new Statas graph dir lists the graph names New graphs would be those that have new names or have been regenerated the date and time can be checked with graph describe name Graph exporting and display likely would be the same This approach could be always done removing the need to explicitly use gr actually I have a question I see that you can send a dataframe to stata and get back some data from Stata How do you do that Are you using the tostata method in Pandas And for the other way around This is a very useful function but it can be very tricky What about the dtypes How does it work Thanks Just a quick note feel free to close and wontfix the issue There is a way to have Stata automation with OS X through AppleScript commands I dont have OS X so I cant do a PR but there is a working Python example here There are ways to get the location of the stata binary by calling the winreg package and looking for some keys There is an example here for instance Its not perfect but it works quite well for Stata Is it possible to toggle cell magic onoff for multiple cells This would be cool because we wouldnt have to use stata for every cell 