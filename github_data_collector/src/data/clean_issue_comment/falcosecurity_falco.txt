Motivation After will be merged in we need to ensure that all the built packages listrequire the dynamic deps they need Feature A little followup to PR in order to list the packages deps CPack Motivation PR already introduced a CircleCI workflow for build and test purposes It proved to be way faster and stable than Travis Furthermore there is no need to have CI systems Feature Remove TravisCI configuration Alternatives NONE Additional context CircleCI is a better option for integrating our CI with the CNCF CI system What to document I am asking wheter we should remove or not the CONTRIBUTING and CODEOFCONDUCT from the repo in order to fallback to the organization ones here They are the same files and the github repo works pretty well as a default mechanism kubeapiserver configuration auditpolicyfileetckubernetesauditpolicyyaml auditwebhookconfigfileetckubernetesauditwebhookkubeconfig rootkubemaster k susingdaemonset cat etckubernetesauditwebhookkubeconfig apiVersion v kind Config clusters cluster server name falco contexts context cluster falco user name defaultcontext currentcontext defaultcontext preferences users rootkubemaster k susingdaemonset k sauditrulesyaml macro create condition kaverbcreate macro containsprivatecredentials condition kareqconfigmapobj contains awsaccesskeyid or kareqconfigmapobj contains awsaccesskeyid or kareqconfigmapobj contains awss accesskeyid or kareqconfigmapobj contains awss accesskeyid or kareqconfigmapobj contains password or kareqconfigmapobj contains passphrase rule CreateModify Configmap With Private Credentials desc Detect creatingmodifying a configmap containing a private credential aws key password etc condition kevt and configmap and kmodify and containsprivatecredentials output K s configmap with private credential userkausername verbkaverb configmapkareqconfigmapname configkareqconfigmapobj priority WARNING source k saudit tags k s demo apiVersion v data uiproperties colorgoodpurple colorbadyellow allowtextmodetrue accessproperties awsaccesskeyid MYID awssecretaccesskey MYKEY kind ConfigMap metadata creationTimestamp T Z name myconfig namespace default resourceVersion selfLink apiv namespacesdefaultconfigmapsmyconfig uid b dc d e cd f db audit events rootkubemaster k susingdaemonset grep awsaccesskeyid varlogkuberneteskubeapiserverauditlog jq kind Event apiVersion auditk siov level Request auditID ad a dbcd ec fbffc a stage ResponseComplete requestURI apiv namespacesdefaultconfigmaps verb create user username admin groups systemmasters systemauthenticated sourceIPs userAgent kubectlv linuxamd kubernetes b objectRef resource configmaps namespace default name myconfig uid b dc d e cd f db apiVersion v responseStatus metadata code requestObject kind ConfigMap apiVersion v metadata name myconfig namespace default selfLink apiv namespacesdefaultconfigmapsmyconfig uid b dc d e cd f db creationTimestamp T Z data accessproperties awsaccesskeyid MYID nawssecretaccesskey MYKEY n uiproperties colorgoodpurple ncolorbadyellow nallowtextmodetrue n requestReceivedTimestamp T Z stageTimestamp T Z annotations authorizationk siodecision allow authorizationk sioreason But falco did not receive it rootkubemaster kubectl logs f falcodaemonsetbzlds Setting up usrsrc links from host Unloading falcoprobe if present Running dkms install for falco Kernel preparation unnecessary for this kernel Skipping Building module cleaning build area make j KERNELRELEASE C libmodules build Mvarlibdkmsfalco build cleaning build area DKMS build completed falcoprobeko Running module version sanity check Original module Found libmodules kernelextrafalcoprobeko Storing in varlibdkmsfalcooriginalmodule x Archiving for uninstallation purposes Installation Installing to libmodules kernelextra depmod DKMS install completed Trying to load a dkms falcoprobe if present falcoprobe found and loaded in dkms Thu Jan Falco initialized with configuration file etcfalcofalcoyaml Thu Jan Loading rules from file etcfalcofalcorulesyaml Thu Jan Loading rules from file etcfalcofalcoruleslocalyaml Thu Jan Loading rules from file etcfalcok sauditrulesyaml Thu Jan Starting internal webserver listening on port Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml fileetcldsocache k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml filelib libselinuxso k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml filelib libaclso k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml filelib libattrso k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml filelib libcso k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml filelib libpcreso k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml filelib libdlso k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml filelib libpthreadso k snsNA k spodNA containerThu Jan Falco internal syscall event drop system calls dropped in last secondhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml fileprocfilesystems k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandmv i auditloggingyaml k sauditloggingyaml fileusrliblocalelocalearchive k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Error File below or root opened for writing userroot commandvi rulesk sauditrulesyaml parentbash filerootfalcorulesk sauditrulesyamlswp programvi containeridhost imageNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Error File below or root opened for writing userroot commandvi rulesk sauditrulesyaml parentbash filerootfalcorulesk sauditrulesyamlswx programvi containeridhost imageNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Error File below or root opened for writing userroot commandvi rulesk sauditrulesyaml parentbash filerootfalcorulesk sauditrulesyamlswp programvi containeridhost imageNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Critical Falco internal syscall event drop system calls dropped in last second ebpfenabled ndrops ndropsbuffer ndropsbug ndropspf nevts Error File below or root opened for writing userroot commandvi rulesk sauditrulesyaml parentbash filerootfalcorulesk sauditrulesyamlswp programvi containeridhost imageNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Error File below or root opened for writing userroot commandvi rulesk sauditrulesyaml parentbash filerootfalcorulesk sauditrulesyamlswx programvi containeridhost imageNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Error File below or root opened for writing userroot commandvi rulesk sauditrulesyaml parentbash filerootfalcorulesk sauditrulesyamlswp programvi containeridhost imageNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat usrlibsystemdsystemkubeapiserverservice fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat usrlibsystemdsystemkubeapiserverservice fileetcldsocache k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat usrlibsystemdsystemkubeapiserverservice fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat usrlibsystemdsystemkubeapiserverservice filelib libcso k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat usrlibsystemdsystemkubeapiserverservice fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat usrlibsystemdsystemkubeapiserverservice fileusrliblocalelocalearchive k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat usrlibsystemdsystemkubeapiserverservice fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat usrlibsystemdsystemkubeapiserverservice fileusrlibsystemdsystemkubeapiserverservice k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat etckubernetesauditwebhookkubeconfig fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat etckubernetesauditwebhookkubeconfig fileetcldsocache k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat etckubernetesauditwebhookkubeconfig fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat etckubernetesauditwebhookkubeconfig filelib libcso k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat etckubernetesauditwebhookkubeconfig fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat etckubernetesauditwebhookkubeconfig fileusrliblocalelocalearchive k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat etckubernetesauditwebhookkubeconfig fileNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Notice a tracked program opened a file userroot commandcat etckubernetesauditwebhookkubeconfig fileetckubernetesauditwebhookkubeconfig k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Error File below or root opened for writing userroot commandvi rulesk sauditrulesyaml parentbash filerootfalcorulesk sauditrulesyamlswp programvi containeridhost imageNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Error File below or root opened for writing userroot commandvi rulesk sauditrulesyaml parentbash filerootfalcorulesk sauditrulesyamlswx programvi containeridhost imageNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Error File below or root opened for writing userroot commandvi rulesk sauditrulesyaml parentbash filerootfalcorulesk sauditrulesyamlswp programvi containeridhost imageNA k snsNA k spodNA containerhost k snsNA k spodNA containerhost k snsNA k spodNA containerhost Critical Falco internal syscall event drop system calls dropped in last second ebpfenabled ndrops ndropsbuffer ndropsbug ndropspf nevts Thu Jan Falco internal syscall event drop system calls dropped in last second Critical Falco internal syscall event drop system calls dropped in last second ebpfenabled ndrops ndropsbuffer ndropsbug ndropspf nevts Thu Jan Falco internal syscall event drop system calls dropped in last second Critical Falco internal syscall event drop system calls dropped in last second ebpfenabled ndrops ndropsbuffer ndropsbug ndropspf nevts Describe the bug All builds started failing after introduced an ASSERT macrot hat was already defined in sysdigh How to reproduce it Open any PR and it will fail Expected behavior PRs go green unless they introduce something broken Environment NO need Additional context Please use this template while reporting a bug and provide as much info as possible Not doing so may result in your bug not being addressed in a timely manner Thanks Describe the bug we have to use appsv places like here A clear and concise description of what the bug is How to reproduce it use latest k s apply the yaml files You will get below error kubectl apply f k swithrbacfalcodaemonsetconfigmapyaml error unable to recognize k swithrbacfalcodaemonsetconfigmapyaml no matches for kind DaemonSet in version extensionsv beta Minimal and precise steps to reproduce the bug Expected behaviour A clear and concise description of what you expected to happen Screenshots If applicable add screenshots to help explain your problem Environment Please complete the following info Falco version Use falco version System info Falco has a builtin support command you can use falco support jq systeminfo Cloud provider or hardware configuration OS Eg output of cat etcosrelease Kernel Eg output of uname a Installation method Eg Kubernetes RPM DEB from source Additional context Add any other context about the problem here Signedoffby Rajib Mitra rajibjolitegmailcom Thanks for sending a pull request Here are some tips for you If this is your first time please read our contributor guidelines in the CONTRIBUTINGmd CONTRIBUTINGmd file and learn how to compile Falco from source here Please label this pull request according to what type of issue you are addressing Please add a release note If the PR is unfinished while opening it specify a wip in the title before the actual title for example wip my awesome feature What type of PR is this Uncomment one or more kind lines kind bug kind cleanup kind design kind documentation kind failingtest kind feature If contributing rules or changes to rules please make sure to also uncomment one of the following line kind ruleupdate kind rulecreate Please remove the leading whitespace before the kind you uncommented Any specific area of the project related to this PR Uncomment one or more area lines area build area engine area examples area rules area integrations area tests area proposals Please remove the leading whitespace before the area you uncommented What this PR does why we need it Which issues this PR fixes Automatically closes linked issue when PR is merged Usage Fixes issue number or Fixes paste link of issue If PR is kindfailingtests or kindflakytest please post the related issuestests in a comment and do not use Fixes Fixes Special notes for your reviewer Does this PR introduce a userfacing change If no just write NONE in the releasenote block below If yes a release note is required Enter your extended release note in the block below If the PR requires additional action from users switching to the new release prepend the string action required For example action required change the API interface of the rule engine releasenote Motivation Long back in the community call we discussed to standerize python code so that it remains or follows same pattern of code In python this can be done by checking flake and pep rules in ci pipeline Is your feature request related to a problem Please describe what the problem is clearly and concisely Eg Im always frustrated when Feature Flake pylint Describe the solution you would like A clear and concise description of what you want to happen Alternatives Describe alternatives you have considered if any A clear and concise description of any alternative solutions or features you have considered Additional context Add any other context or screenshots about the feature request here Describe the bug We have the Kubernetes audit endpoint enabled which is receiving all the JSON audit events When Falco receives a Pod created event with the following piece of JSON Pod spec JSON spec volumes name etc hostPath path etc type It crashes with this error terminate called after throwing an instance of nlohmanndetailtypeerror what jsonexceptiontypeerror type must be string but is object It seems that Falco is not expecting an object for the hostPath field How to reproduce it Create a pod with a hostpath volume Expected behaviour The event should be scanned and processed successfully Environment Falco version Docker image built from minimal Dockerfile System info systeminfo machine x nodename release amzn x sysname Linux version SMP Thu Nov UTC Cloud provider or hardware configuration AWS OS Amazon Linux Installation method Kubernetes Docker What type of PR is this kind feature Any specific area of the project related to this PR NONE What this PR does why we need it releasenote switch to systemd if available in debian package hardened systemd settings 