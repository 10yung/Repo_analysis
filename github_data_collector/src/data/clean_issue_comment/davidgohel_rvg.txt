I am having trouble with text being slightly shifted vertically in the PPT output compared to what I see onscreen eg the X axis labels touch the X axis tickmarks in the PPT when they dont touch onscreen Also the width height argument appears to be ignored as my graph is always stretched across the slide which I dont want here sorry if thats a silly issue Reproducible example libraryggplot librarydevtools devtoolsinstallgithubdavidgohelrvg devtoolsinstallgithubdavidgohelofficer devtoolsinstallgithubdavidgohelgdtools libraryrvg librarygdtools plotdata dataframe a runif b seq x width height z ggplotdata plotdata mapping aes x a y b geompoint labsx my xlabel y my ylabel themepanelbackground elementblank panelborder elementrect fill NA size axisticks elementline color black lineend round size axistickslength unit mm axistext elementtext color black plotmargin unitrep cm text elementtext size familysans color black z libraryofficer doc readpptx doc addslidedoc Title and Content Office Theme doc phwithdoc dmlggobj z width height I get the same output with extra argument fonts listsans TT Arial location phlocationtypetype body fileout testpptx printdoc target fileout onscreenresult testpptx PPTresult sessionInfo R version Platform x w mingw x bit Running under Windows x build Matrix products default locale LCCOLLATEEnglishUnited States LCCTYPEEnglishUnited States LCMONETARYEnglishUnited States LCNUMERICC LCTIMEEnglishUnited States attached base packages stats graphics grDevices utils datasets methods base other attached packages officer gdtools rvg usethis devtools ggplot RevoUtils RevoUtilsMath loaded via a namespace and not attached zip Rcpp pillar compiler base enc prettyunits remotes tools uuid testthat digest pkgbuild pkgload memoise tibble gtable pkgconfig rlang cli rstudioapi curl xml withr dplyr systemfonts fs desc rprojroot grid tidyselect glue R processx sessioninfo purrr callr magrittr htmltools scales backports ps assertthat colorspace labeling lazyeval munsell crayon Im trying to plot scatter plots on one PowerPoint slide using officer with rvgs phwithvgat function The plots are achieved by using parmfrow c within the code expression Each plot has lines in it so it is quite complex If I only plot of the graphs theres no problem but if I do all I always get this error Error in xpathsearchxnode xdoc xpath xpath nsMap ns numresults Memory allocation failed growing nodeset hit limit This is my first crack at addresssing Not sure its ready to merge but it works Still requires some more robust testing Im also unsure whether dml is the best function name but it is short This requires development pandoc as well as development rmarkdown due to a PR I sent there making it possible to lookup the template pptx from within the Rmd file The method will look up placeholder locations and use these for the dimensions of the printed graph but the user can override them to place the graph anywhere on the slide Some internal functions are memoised so as to avoid creatingopening the reference pptx every time dimensions are needed Raster plots are not supported and I dont think its possible to do so without a postprocessor approach It would be useful to do this in an officerpptx rmarkdown type or maybe as a PR to rmarkdownpowerpointdocument It would allow users to use the mechanism here to place static images anywhere on the slide they would like as well I think the best way to implement would be to put the postprocessing requirements in the knitprint metadata as htmlwidgets do The development version of pandoc now allows passing of raw openxml into powerpoint Using this Ive been able to make a quick proofofconcept of creating editable powerpoints through R Markdown output powerpointpresentation keepmd true mdextensions rawattribute r setup includeFALSE libraryrvg libraryknitr optschunksetecho FALSE local hookplot knithooksgetplot knithookssetplot functionx options x pastex collapse if grepl dml x returnhookplotx options xx xml readxmlx read the content of the rvg image and write it out without xml pastecopenxml strsplitascharacterxx n collapse n Slide r echoFALSE devdmlpptx figextdml devargsliststandaloneFALSE plotpressure code blocks indented here to keep formatting I can probably put in a bit of work to try to make this a smooth workflow There are several ways to approach this PR into knitr an option for an rvg device make a new rmarkdown format like rvgpowerpoint or create an object type like rvgplot that has knitprint methods to print raw openxml blocks I figure the latter is the most flexible and will require the least of the user The actual rendering can delayed until knitprint is called so that the method can choose dmldocxdvgpptx as appropriate and fall back to a different graphics device for older pandocother output formats I think one could use officer to read the PPTX template to set the plot properties correctly Any thoughts on the best approach Would you take a PR to rvg for knitprint methods A boxplot with constrained yaxis fills the box only partially halfbox doplot function do a boxplot with constrained yaxis boxplottestdata ylimc colgrey create test data setseedseed testdata runifn doplot this is how it should look libraryexport doplot this is how it should look graph pptfileplotpptx aspectr appendT this creates a box which is only filled with grey above and right of the diagonal sessionInfo R version Platform x w mingw x bit Running under Windows x build Service Pack Matrix products default locale LCCOLLATEGermanGermany LCCTYPEGermanGermany LCMONETARYGermanGermany LCNUMERICC LCTIMEGermanGermany attached base packages stats graphics grDevices utils datasets methods base other attached packages rvg magrittr officer export gdtools glmulti rJava loaded via a namespace and not attached zip Rcpp compiler later base enc tools digest uuid jsonlite evaluate shiny crosstalk yaml stargazer stringr xml knitr htmlwidgets webshot manipulateWidget rprojroot R rgl rmarkdown backports promises htmltools flextable mime xtable httpuv miniUI stringi Hi David Not sure that one is a rvg or a officer issue Apprently the shapes generated by phwithvg are counted while computing the id of each shape in a particular slide The consequence for that is that when generating multiple reports the idchr argument is unpredictable from one version to another The reproducible example below describes the problem librarytidyverse libraryofficer libraryrvg graphgeneratingfunction functioni gg mtcars filtercyl i ggplotaesx disp y drat geompoint themebw pptx readpptx addslidelayout Two Content master Office Theme phwithvgggobj gg type body index phwithtextSome text type body index phaddtext some following text type body idchr pptx printtarget paste cyl i pptx c mapgraphgeneratingfunction Here the loop works for i but for the other values it will throw the error Error selection does not match any row in slidesummary Use function slidesummary A workaround here is to rewrite the slide generating part but this limits the possibility to control perfectly which placeholder must be at the top and which one must be a the bottom pptx readpptx addslidelayout Two Content master Office Theme phwithtextSome text type body index phaddtext some following text type body idchr phwithvgggobj gg type body index Here are my session info sessionInfo R version Platform x w mingw x bit Running under Windows x build Matrix products default locale LCCOLLATEFrenchFrance LCCTYPEFrenchFrance LCMONETARYFrenchFrance LCNUMERICC LCTIMEFrenchFrance attached base packages stats graphics grDevices utils datasets methods base other attached packages gdtools bindrcpp rvg officer forcats stringr dplyr purrr readr tidyr tibble ggplot tidyverse loaded via a namespace and not attached reshape haven lattice colorspace htmltools yaml base enc rlang Roo pillar foreign glue Rutils modelr readxl uuid bindr plyr munsell gtable cellranger rvest RmethodsS zip psych labeling parallel broom Rcpp scales jsonlite mnormt hms digest stringi grid cli tools magrittr lazyeval crayon pkgconfig xml lubridate assertthat httr rstudioapi R nlme compiler Lukas commented on Fri Mar I saw some issues when using plotmath expressions in powerpoint files Specifically if an expression is composed of multiple elements joined using or separate textboxes are created in PowerPoint which leads faulty vertical alignment It would be better if the whole expression were contained in one textbox For example the following code displays buggy vertical alignment of the text plot titleexpressionfoo oo Also using an en dash in plotmath expressions causes a bug where each element of the expression is individually centered and overlaps PS thank you for developing this great package davidgohel commented on Tue Apr Hi Sorry its a known issue but I dont know exactly what is wrong Ill have a coding session probably next month and will invest on this case David This is probably not fixable but since text is rendered in text elements the text width reported by eg gridstringWidth may not be exactly what you get when the SVG is rendered There is an interaction with justification since it seems R graphics calculates the justification rather than passing this to the device This isnt a big problem for leftjustified or even centerjustified text but rightjustified text can go quite wrong In my case Im trying to combine a chart label with a line callout connecting it to the data and the label can overlap the callout as a result eg where the rectangle is the calculated bounding box img width altscreenshot src And correctly in PNG img width altscreenshot src This seems to be a limitation on the amount of fine control SVG gives over text rendering One solution would be to use SVGs own textanchor attribute then widths would still be calculated incorrectly but at least justification would be correct But from scanning the source it seems like the justification is already dealt with before it reaches this package although if there is some way around this that would be great In the meantime I guess the workaround in my case is use callouts from the lefthand side of text labels which is calculated reliably I added raw functions in dsvgcpp and a usejquery parameter defaulting to TRUE to sendtooltip sendclick and senddataid to enable setting of data attributes and other attributes without jQuery I also added without jQuery equivalent tests to the test harness and made initial changes to a local copy of ggiraph to see how well it works and it works well This lays the groundwork for making a jQueryindependent widget in ggiraph 