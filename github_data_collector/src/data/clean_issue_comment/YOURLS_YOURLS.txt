Two fixes for patch by teyeheimans to report dbcreation errors patch by me to lower key size to to accommodate mysql databases using utf mb We ran into heavy load issues on our databasesAuroraSQL we had a look and changed the Data Type of url column to VARCHAR from TEXT TEXT is not a performance firndly data type I changed the versions app and db to and The upgrade applies a patch on the database table yourlsurl on column url We haev notice a drastric decrease in db load This change was needed due to the long processing of data through includes vendoraurasqlsrcExtendedPdophp at the processing stage in Rebuilder I noticed here that md is used for time limited signature token This PR would allow sha hashs for time limited signature token but would be backward compatible This is done by counting the string length of the signature md creates a char long hash sha creates a char long hash What do you think Hi there I had a problem with sharing on twitter wrongold url Sadly I saw no possibility to fix this with a plugin While coding I noticed a few other things tweetlimit in PHP was in PHP now everywhere enabledisable individual services With fallback instead only url also text is posted to facebook thats why I renamed tweettext to sharetext rewrote js New url is only generatedwritten on click not on every textchange template in dataattribute Url in href as nonjsfallback With the new js it is also more easy for plugindevs to add other services Just add a link with the href the template and add the onclick Minimal example html a href echo text datashareurl onclicksharethisreturn falseTESTa Hey there Now that tests are all in the main repo we should make sure someone running tests locally will not lose data I mean I for one just lost all data on my dev box just because I wanted to test tests YOURLSunittests used to mention Create an empty MySQL database and user Do not use an exisiting database or you will lose data guaranteed Copy yourlstestsconfigsamplephp to yourlstestsconfigphp edit it and include your database name user and password I think we should provide such a config file for tests and some sort of checks to make sure the average Ozh Joe wont erase all their data Thoughts This bug appears on the website isnt hosted on port Use HTTPHOST to replace the SERVERNAME For example The SERVER SERVERNAME maybe when the website is hosted on But SERVER HTTPHOST will be in this situation x Ive read the guidelines for Contributing to YOURLS Projects x This request isnt a duplicate of an existing issue x Ive read the docs and followed them if applicable x This is not a personal support request that should be posted on the YOURLS Discourse community Describe the bug If a plugin directory is symlinked into YOURLS plugins directory calls to yourlspluginurl for that plugins directory return nonexistent incorrect URLs To Reproduce Steps to reproduce the behavior Symlink a plugin directory into YOURLSROOTuserplugins Load a page that the plugin affects eg by injecting a script or stylesheet A plugin that uses yourlspluginurl is needed of course I discovered this issue while installing the Sleeky backend So lets say I have a plugin living in homedgwreposSleekysleekybackend with symlink homedgwyourlsuserpluginssleekybackend pointing to it for the purpose of explanation Expected behavior The injected asset loads correctly yourlspluginurlfileext generates the URL Actual behavior The injected asset fails to load because the URL generated is incorrect yourlspluginurlfileext generates Versions YOURLS x the code for this function has not changed since on Ubuntu Linux under nginx with phpfpm Additional context I made the examples above with a specific file for clarity However Sleeky itself uses yourlspluginurl DIR and then stores that value for later Either way the method used in yourlspluginbasename to remove the leading absolute path is likely the root cause here Theres an easy workaround to this of course Dont symlink plugin directories But this approach to adding plugins works in many many different software packages I use it a ton Low priority this bug may be I do think it really is a bug Describe the bug When putting load on yourls it can happen that it tries to insert the same key again This results in a db error which message is send as respone with http To Reproduce Put load on service with parallel curl commands for i in do curl w n sSiv raw done You might want to increase the counter andor try it several times Expected behavior Catch the db exception because it could be handled either retry or respond with http status Internal server error or maybe service unavailable Catch all unkown exceptions and respond with log error Actual behavior Response is the db error message with HTTP OK Output HTTP OK br bFatal errorb Uncaught PDOException SQLSTATE Integrity constraint violation Duplicate entry hwza for key PRIMARY in varwwwhtmlincludesvendoraurasqlsrcExtendedPdophp Stack trace varwwwhtmlincludesvendoraurasqlsrcExtendedPdophp PDOStatement gtexecute varwwwhtmlincludesvendoraurasqlsrcExtendedPdophp Aura Sql ExtendedPdo gtperformINSERT INTO yo Array varwwwhtmlincludesfunctionsphp Aura Sql ExtendedPdo gtfetchAffectedINSERT INTO yo Array varwwwhtmlincludesfunctionsphp yourlsinsertlinkindb hwza varwwwhtmlincludesfunctionsapiphp yourlsaddnewlink hwza varwwwhtmlincludesfunctionspluginsphp yourlsapiactionshorturlfalse varwwwhtmlyourlsapiphp yourlsapplyfilterapiactionshor false main thrown in bvarwwwhtmlincludesvendoraurasqlsrcExtendedPdophpb on line b bbr Versions on Google Cloud Kubernetes TIM 