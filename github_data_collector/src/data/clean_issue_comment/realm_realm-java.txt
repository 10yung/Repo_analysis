Closes Closes This PR adds support for datatype specific to MongoDB specifically ObjectId and Decimal TODO Measure the impact of adding a dependency on the BSON library We probably want to make it optional for nonsync no matter what but we should also check the impact on the sync variant CoreObjectId release to depend on Annotation processor x Allow Decimal as a type in ClassMetaData Indexable No Primary key No x Allow ObjectId as a type in ClassMetaData Indexable Yes Primary Key Yes x Annotation processor tests Verify how RealmResultstoJson works with ObjectId and Decimal RealmcreateClass ObjectId copyToRealm copyToRealmOrUpdate insert insertOrUpdate createObjectFromJsonClass InputStream createObjectFromJsonClass JSONObject createObjectFromJsonClass String createOrUpdateObjectFromJsonClass InputStream createOrUpdateObjectFromJsonClass JSONObject createOrUpdateObjectFromJsonClass String createAllFromJsonClass InputStream createAllFromJsonClass JSONArray createAllFromJsonClass String createOrUpdateAllFromJsonClass InputStream createOrUpdateAllFromJsonClass JSONArray createOrUpdateAllFromJsonClass String DynamicRealmObject getDecimal field setDecimal field getObjectIdfield setObjectIdfield RealmResults setfield Object setDecimal field Decimal setObjectIdfield ObjectId Querypredicates Aggregates are not support for Decimal limitation of Core Decimal equalTo notEqualTo lessThan lessThanOrEqual greater greaterThan ObjectId equalTo notEqualTo lessThan lessThanOrEqual greater greaterThan Please kindly add Sign in with Google Account option at website Goal I want to provide a Realm file from my assets folder via RealmConfigurationBuilder assetFileassetfilenamerealm build Actual Results This doesnt work unless the assets Realm file name matches the name in the Realm configuration RealmCachecopyAssetFileIfNeeded seems to assume that the asset file path from the configuration will match the realm file name When a realm file name isnt provided to the configuration the default name is used defaultrealm and the asset file copy doesnt work properly because the names dont match This causes a misleading error message to be thrown RealmFileException Could not resolve the path to the asset file assetfilenamerealm Kind ACCESSERROR Caused by javaioFileNotFoundException assetfilenamerealm When in reality the file is present in the assets folder Realm is just expecting it to have a different name This is fixed by providing a custom name to the configuration builder that matches the asset file name RealmConfigurationBuilder assetFileassetfilenamerealm nameassetfilenamerealm build Additionally this behavior doesnt seem to be in the docs around the section that details the assetFile builder option so the behavior is a bit misleadingconfusing Steps Code to Reproduce Add a realm file in the assets folder with a nondefault name Call RealminitapplicationContext Create a custom RealmConfiguration RealmConfigurationBuilder schemaVersionmySchemaVersion assetFilecustom name here build Set that configuration as the default RealmsetDefaultConfigurationrealmConfiguration Fetch a Realm instance via RealmgetDefaultInstance see error Version of Realm and tooling Realm versions Realm Sync feature enabled No Android Studio version Android Build Tools version Whatever is automatically set by Android Studio Gradle version Which Android version and devices Latest Android Pixel emulator equalsTo equalTo idequalTo idequalTo or idequalTo idequalTo realm Goal Write the unit tests of code using Realm Actual Results Strange exceptions during the unit test execution more precisely BEFORE the unit tests cases Test and initialisers Before are executed probably somewhere during the test environment setup ApplicationsAndroid StudioappContentsjrejdkContentsHomebinjava ea Dideatestcyclicbuffersize javaagentApplicationsAndroid StudioappContentslibideartjar ApplicationsAndroid StudioappContentsbin DfileencodingUTF classpath ApplicationsAndroid StudioappContentslibideartjarApplicationsAndroid StudioappContentspluginsjunitlibjunitrtjarApplicationsAndroid StudioappContentspluginsjunitlibjunit rtjarApplicationsAndroidsdkplatformsandroid dataresVolumesGemaltoMBISDKMBISDKCommonCommonCorebuildintermediatesclassestestdebugVolumesGemaltoMBISDKMBISDKCommonCommonCorebuildintermediatesclassesdebugVolumesGemaltoMBISDKMBISDKCommonCommonCorebuildgeneratedresrsdebugVolumesGemaltoMBISDKMBISDKCommonCommonCorebuildgeneratedresresValuesdebugUserskkm repositoryjunitjunit junit jarUserskkgradlecachesmodules files javaxinjectjavaxinject da a bd d a b c d javaxinject jarUserskkm repositoryorghamcresthamcrestlibrary hamcrestlibrary jarUserskkm repositoryorghamcresthamcrestcore hamcrestcore jarUserskkgradlecachesmodules files orgpowermockpowermockmodulejunit dd e e a c e fe da df epowermockmodulejunit jarUserskkgradlecachesmodules files orgpowermockpowermockmodulejunit rule e d ac ba a ab a af e df ad dpowermockmodulejunit rule jarUserskkgradlecachesmodules files orgpowermockpowermockmodulejunit common c d f fa ec c e ce b f powermockmodulejunit common jarUserskkgradlecachesmodules files orgrobolectricrobolectric b ec a a ca b eaaa fb a f robolectric jarUserskkgradlecachesmodules files orgpowermockpowermockapimockito e e f ba b a cc baefda e e epowermockapimockito jarUserskkgradlecachesmodules files orgpowermockpowermockclassloadingxstream dfd b e ac a f b c a b a fd powermockclassloadingxstream jarUserskkgradlecachesmodules files orgrobolectricshadowsframework da a f d e c b f dfdf shadowsframework jarUserskkm repositorycomgoogleandroidappscommontestingaccessibilityframeworkaccessibilitytestframework accessibilitytestframework jarUserskkgradlecachesmodules files orgrobolectricresources ccc ec c e b d fe f d bec dd bresources jarUserskkgradlecachesmodules files orgrobolectricjunit f c a c ffa a beb ba eejunit jarUserskkgradlecachesmodules files orgrobolectricsandbox b b b ebc a e ddcfdbfc e cd sandbox jarUserskkgradlecachesmodules files orgrobolectricpluginsmavendependencyresolver b d c eff ec e d b c b d pluginsmavendependencyresolver jarUserskkgradlecachesmodules files orgrobolectricutils ae d fc ef fc a b aefe eb utils jarUserskkgradlecachesmodules files comgoogleautoserviceautoservice rc d f b bbd fc a eb fd cautoservice rc jarUserskkgradlecachesmodules files comgoogleautoautocommon c f af e b d d b ef f c d c autocommon jarUserskkgradlecachesmodules files comgoogleguavaguava jrebd a b e d c bbc aeguava jrejarUserskkgradlecachesmodules files comandroidsupportsupportannotations ed f a d fd d fb c c d ca d supportannotations jarUserskkgradlecachesmodules files orgmockitomockitocore e f bef e d dd b e f e fe effemockitocore jarUserskkgradlecachesmodules files orgpowermockpowermockapimockitocommon da b a c c cef e c a b cpowermockapimockitocommon jarUserskkgradlecachesmodules files orgrobolectricpluginapi e eba ea de c f f pluginapi jarUserskkgradlecachesmodules files orgrobolectricshadowapi a e b c aa afc c eac a bfb eshadowapi jarUserskkgradlecachesmodules files orgrobolectricannotations ba cdb be a ae e c d a b b f annotations jarUserskkgradlecachesmodules files orgrobolectricutilsreflector e b d df c f b a da f bcutilsreflector jarUserskkgradlecachesmodules files javaxannotationjavaxannotationapi c d cfef a e bf b a d javaxannotationapi jarUserskkgradlecachesmodules files orgbouncycastlebcprovjdk on a faf d e b ed a f f d bcprovjdk on jarUserskkgradlecachesmodules files orgpowermockpowermockclassloadingbase fda cbf ba c eef b c b c a apowermockclassloadingbase jarUserskkgradlecachesmodules files orgpowermockpowermockapisupport ba af a c efcdadb ef f ae a a powermockapisupport jarUserskkgradlecachesmodules files orgpowermockpowermockcore fae f d ff f cc c b c powermockcore jarUserskkgradlecachesmodules files comthoughtworksxstreamxstream c f e bfa b e a a c cf dd xstream jarUserskkgradlecachesmodules files orgapachemavenmavenanttasks b be d d e fef aacf abcmavenanttasks jarUserskkgradlecachesmodules files orgapacheantant b ca b f e cc f d a c c d ant jarUserskkgradlecachesmodules files orgow asmasmcommons d b c ae a ddc bca ae cdd asmcommons jarUserskkgradlecachesmodules files orgow asmasmutil d d c a dbb e f fb dasmutil jarUserskkgradlecachesmodules files orgow asmasmanalysis b d d f c b a f b d f bc ac fasmanalysis jarUserskkgradlecachesmodules files orgow asmasmtree bc dcb af e e b d ef c asmtree jarUserskkgradlecachesmodules files orgow asmasm d d ba dee f fb dcb fcdb a cd asm jarUserskkm repositorycomalmworkssqlite javasqlite java sqlite java jarUserskkm repositorycomibmicuicu j icu j jarUserskkgradlecachesmodules files androidxannotationannotation f cd ac a fa a c cdd c eadannotation jarUserskkgradlecachesmodules files orgpowermockpowermockreflect fa d acee c ab ef a bbb a bae powermockreflect jarUserskkgradlecachesmodules files orgjavassistjavassist GA f db c fb eddbb c a d bjavassist GAjarUserskkgradlecachesmodules files orgobjenesisobjenesis b c b c b ec ed db aabb objenesis jarUserskkgradlecachesmodules files xmlpullxmlpull b e d ab e ecaa db cdedbc c dfaxmlpull jarUserskkgradlecachesmodules files xpp xpp min c d e b f e f f ea d b xpp min cjarUserskkgradlecachesmodules files orgapacheantantlauncher b ba fa fb da f de ddc c antlauncher jarUserskkm repositoryorgapachemavenmavenproject mavenproject jarUserskkm repositoryorgapachemavenmavenartifactmanager mavenartifactmanager jarUserskkm repositoryorgapachemavenmavenerrordiagnostics mavenerrordiagnostics jarUserskkm repositoryorgapachemavenmavensettings mavensettings jarUserskkm repositoryorgapachemavenmavenprofile mavenprofile jarUserskkm repositoryorgapachemavenmavenpluginregistry mavenpluginregistry jarUserskkm repositoryorgcodehausplexusplexuscontainerdefault alpha stable plexuscontainerdefault alpha stable jarUserskkm repositoryclassworldsclassworlds alpha classworlds alpha jarUserskkm repositoryorgapachemavenmavenartifact mavenartifact jarUserskkm repositoryorgapachemavenmavenmodel mavenmodel jarUserskkgradlecachesmodules files orgapachemavenwagonwagonfile beta c caf d de e d afb wagonfile beta jarUserskkgradlecachesmodules files orgapachemavenwagonwagonhttplightweight beta b c b f e d c b c c wagonhttplightweight beta jarUserskkgradlecachesmodules files orgapachemavenwagonwagonhttpshared beta ccd d e d c e a f da ca a be wagonhttpshared beta jarUserskkgradlecachesmodules files orgapachemavenwagonwagonproviderapi beta f e ae ae d bb e b wagonproviderapi beta jarUserskkm repositoryorgapachemavenmavenrepositorymetadata mavenrepositorymetadata jarUserskkgradlecachesmodules files orgcodehausplexusplexusutils c ce eb c ed plexusutils jarUserskkgradlecachesmodules files orgcodehausplexusplexusinterpolation ad dddff ad d c ff d c f plexusinterpolation jarUserskkgradlecachesmodules files comgoogleguavafailureaccess dcf de a bf a d b c bac c failureaccess jarUserskkgradlecachesmodules files comgoogleguavalistenablefuture emptytoavoidconflictwithguavab c f adef c e c d ac listenablefuture emptytoavoidconflictwithguavajarUserskkgradlecachesmodules files orgcheckerframeworkcheckerqual cea d a a b a f bb efc checkerqual jarUserskkgradlecachesmodules files comgoogleerrorproneerrorproneannotations e c e b e c f da fc f cerrorproneannotations jarUserskkgradlecachesmodules files comgooglej objcj objcannotations ed ded a b c b def f b e j objcannotations jarUserskkgradlecachesmodules files orgcodehausmojoanimalsnifferannotations f ce decaea b e f b f fbanimalsnifferannotations jarUserskkm repositorycomgoogleprotobufprotobufjava protobufjava jarUserskkm repositorybackportutilconcurrentbackportutilconcurrent backportutilconcurrent jarUserskkgradlecachesmodules files nekohtmlxercesMinimal d c e a e f cd f a d af fa xercesMinimal jarUserskkgradlecachesmodules files nekohtmlnekohtml d be b ae dbbbe ab ffdc f c nekohtml jarUserskkgradlecachestransforms files monitor aar ed b cb eae c d jarsclassesjarUserskkm repositoryiorealmrealmannotations GTOrealmannotations GTOjarVolumesGemaltoMBISDKMBILIBScomgemaltoandroidlibhttprealdebug httprealdebug jarVolumesGemaltoMBISDKMBILIBScomgemaltoandroidliblogging SNAPSHOTlogging SNAPSHOTjarVolumesGemaltoMBISDKMBILIBScomgemaltosecurestoragesecurestorage securestorage jarVolumesGemaltoMBISDKMBILIBSorgspongycastlespongycastle spongycastle jarUserskkgradlecachesmodules files comgooglecodefindbugsjsr ea e b c a bd d fe ea f djsr jarUserskkgradlecachesmodules files comandroidsupportsupportannotations ded b e ce c b e d cdc ecee supportannotations jarUserskkgradlecachesmodules files androidarchlifecyclecommon edf f bfb a d efa b a ee f common jarUserskkgradlecachesmodules files androidarchcorecommon f d d cd b e dcd b f common jarUserskkgradlecachestransforms files realmandroidlibrary GTOaar d e b a a eeeb ed jarsclassesjarUserskkgradlecachestransforms files appcompatv aar ab b c fee f f ejarsclassesjarUserskkgradlecachestransforms files appcompatv aar ab b c fee f f eresUserskkgradlecachestransforms files sprng aar fe bfcd c d a jarsclassesjarUserskkgradlecachestransforms files sprng aar fe bfcd c d a resUserskkgradlecachestransforms files relinker aar dfdbe f a a f a ee ajarsclassesjarUserskkgradlecachestransforms files supportfragment aar a b ed e e b a e e f jarsclassesjarUserskkgradlecachestransforms files animatedvectordrawable aar aea a c b f f e d a jarsclassesjarUserskkgradlecachestransforms files supportcoreui aar aed d bfffe cea d fajarsclassesjarUserskkgradlecachestransforms files supportcoreui aar aed d bfffe cea d faresUserskkgradlecachestransforms files supportcoreutils aar d ed c f ecd e jarsclassesjarUserskkgradlecachestransforms files supportvectordrawable aarb cb a fd fa e ae e jarsclassesjarUserskkgradlecachestransforms files supportcompat aarb e e db d cae a acefjarsclassesjarUserskkgradlecachestransforms files supportcompat aarb e e db d cae a acefresUserskkgradlecachestransforms files livedatacore aar e db c ab e af jarsclassesjarUserskkgradlecachestransforms files viewmodel aarfdcef c a fa c a jarsclassesjarUserskkgradlecachestransforms files runtime aar cdfae d d c b eef f a jarsclassesjarUserskkgradlecachestransforms files runtime aar a c d eb b ec cjarsclassesjarVolumesGemaltoMBISDKMBISDKCommonCommonApibuildintermediatesclassesdebugVolumesGemaltoMBISDKMBISDKCommonCommonApibuildgeneratedresrsdebugVolumesGemaltoMBISDKMBISDKCommonCommonApibuildgeneratedresresValuesdebugVolumesGemaltoMBISDKMBISDKCommonCommonCorebuildintermediatessourceFolderJavaResourcestestdebugVolumesGemaltoMBISDKMBISDKCommonCommonCorebuildintermediatessourceFolderJavaResourcesdebugVolumesGemaltoMBISDKMBISDKCommonCommonApibuildintermediatessourceFolderJavaResourcesdebugVolumesGemaltoMBISDKMBISDKCommonCommonCorebuildgeneratedmockableandroid v jar comintellijrtexecutionjunitJUnitStarter ideVersion junit comgemaltombicommoninternalrealmMbiRealmPersistingFacilityTesttestReadAndWriteOfData Robolectric WARN Android SDK requires Java have Java Tests wont be run on SDK unless explicitly requested WARNING No manifest file found at AndroidManifestxml No such manifest file AndroidManifestxml Falling back to the Android OS resources only To remove this warning annotate your test class with ConfigmanifestConfigNONE Robolectric comgemaltombicommoninternalrealmMbiRealmPersistingFacilityTesttestReadAndWriteOfData sdk resourcesLEGACY Robolectric NOTICE legacy resources mode is deprecated see javalangRuntimeException Method clear in androidutilSparseArray not mocked See for details at androidutilSparseArrayclearSparseArrayjava at orgrobolectricshadowsShadowAccessibilityNodeInforesetObtainedInstancesShadowAccessibilityNodeInfojava at orgrobolectricShadowsresetShadowsjava at orgrobolectricandroidinternalAndroidTestEnvironmentresetStateAndroidTestEnvironmentjava at orgrobolectricRobolectricTestRunnerlambdafinallyAfterTest RobolectricTestRunnerjava at orgrobolectricutilPerfStatsCollectormeasurePerfStatsCollectorjava at orgrobolectricRobolectricTestRunnerfinallyAfterTestRobolectricTestRunnerjava at orgrobolectricinternalSandboxTestRunner lambdaevaluate SandboxTestRunnerjava at orgrobolectricinternalbytecodeSandboxlambdarunOnMainThread Sandboxjava at javautilconcurrentFutureTaskrunFutureTaskjava at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava at javalangThreadrunThreadjava javalangRuntimeException Method setLocale in androidcontentresConfiguration not mocked See for details at androidcontentresConfigurationsetLocaleConfigurationjava at orgrobolectricandroidDeviceConfigsetLocaleDeviceConfigjava at orgrobolectricandroidDeviceConfigapplyRulesDeviceConfigjava at orgrobolectricandroidBootstrapapplyQualifiersBootstrapjava at orgrobolectricandroidinternalAndroidTestEnvironmentsetUpApplicationStateAndroidTestEnvironmentjava at orgrobolectricRobolectricTestRunnerbeforeTestRobolectricTestRunnerjava at orgrobolectricinternalSandboxTestRunner lambdaevaluate SandboxTestRunnerjava at orgrobolectricinternalbytecodeSandboxlambdarunOnMainThread Sandboxjava at javautilconcurrentFutureTaskrunFutureTaskjava at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava at javalangThreadrunThreadjava javalangNullPointerException at orgrobolectricRobolectricTestRunnerRobolectricFrameworkMethodTestExecutionContextaccess RobolectricTestRunnerjava at orgrobolectricRobolectricTestRunnerRobolectricFrameworkMethodgetSdkRobolectricTestRunnerjava at orgrobolectricRobolectricTestRunnerRobolectricFrameworkMethodhashCodeRobolectricTestRunnerjava at javautilconcurrentConcurrentHashMapgetConcurrentHashMapjava at orgjunitrunnersBlockJUnit ClassRunnerdescribeChildBlockJUnit ClassRunnerjava at orgjunitrunnersBlockJUnit ClassRunnerdescribeChildBlockJUnit ClassRunnerjava at orgjunitrunnersParentRunnergetDescriptionParentRunnerjava at orgjunitrunnerRunnertestCountRunnerjava at orgpowermockmodulesjunit internalimplDelegatingPowerMockRunnergetTestCountDelegatingPowerMockRunnerjava at orgpowermockmodulesjunit commoninternalimplJUnit TestSuiteChunkerImplrunJUnit TestSuiteChunkerImpljava at orgpowermockmodulesjunit commoninternalimplAbstractCommonPowerMockRunnerrunAbstractCommonPowerMockRunnerjava at orgpowermockmodulesjunit PowerMockRunnerrunPowerMockRunnerjava at orgjunitrunnerJUnitCorerunJUnitCorejava at comintellijjunit JUnit IdeaTestRunnerstartRunnerWithArgsJUnit IdeaTestRunnerjava at comintellijrtexecutionjunitIdeaTestRunnerRepeaterstartRunnerWithArgsIdeaTestRunnerjava at comintellijrtexecutionjunitJUnitStarterprepareStreamsAndStartJUnitStarterjava at comintellijrtexecutionjunitJUnitStartermainJUnitStarterjava Process finished with exit code Steps Code to Reproduce I just took this example and extracted the test from it Workaround I just followed this guide To setup the Robolectric and Powermock properly Then things started to work fine The only change is in the annotations of the test class the working one looks like this RunWithRobolectricTestRunnerclass Configsdk PowerMockIgnoreorgmockito orgrobolectric android androidx SuppressStaticInitializationForiorealminternalUtil PrepareForTestRealmclass RealmConfigurationclass RealmQueryclass RealmResultsclass RealmCoreclass RealmLogclass Version of Realm and tooling Realm versions xx Realm Sync feature enabled No Robolectric version Powermock version Android Studio version NA Android Build Tools version NA Gradle version NA Which Android version and devices NA See RPM for details See RPM for details I am using Realm datebase Now I have problem in knowing there is a table in my database I am getting this log when using realm in my app during development EREALM homejenkinsworkspacemrealmcorerelease JLYB STYEHDZYG MCNCHSR P KGQAINRPSTQDTS Q ZT Q srcrealmutilthreadcpp realmcore Destruction of mutex in use backtrace not supported on this platform IMPORTANT Please send this log and info about Realm SDK version and other relevant reproduction info to helprealmio comfhs Alibc Fatal signal SIGABRT code in tid RealmFinalizing pid I am using following configurations for Realm App level Gradle kapt androidxdatabindingdatabindingcompiler kapt iorealmrealmannotations kapt iorealmrealmannotationsprocessor Project level Gradle classpath iorealmrealmgradleplugin I would like to know what causes this issue to reproduce not everytime but after heavy usage of app steps with which we can handle this In our project for several operations we create different threads and do realm transaction in each one of them But in the mean time we got several crash reports regarding the out of memory problem we believe that the source of problem is having multiple instances of realm in each of the threads and the queue for transactions Do you have any recommendation for solving this problem