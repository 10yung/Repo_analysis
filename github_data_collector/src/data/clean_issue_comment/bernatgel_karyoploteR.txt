plotKaryotype fails with a cryptic error when building a karyotype kp plotKaryotypeplottype genomehg chromosomescpaste chr chrX WARNING There was an error when filtering the chromosomes Falling back to using the unfiltered genome Error subscript is a NSBS object that is incompatible with the current subsetting operation After some debugging this fails at the getCytoband step As getCytoband can also use or not use a cache I made this test diff diff git aRplotKaryotypeR bRplotKaryotypeR index ec b ab aRplotKaryotypeR bRplotKaryotypeR plotKaryotype functiongenomehg plottype ideogramplotterkpAddCyto Get the CytoBands if needed ifisnullcytobands ifisnullgenomename allischaractergenomename cytobands getCytobandsgenomename cytobands getCytobandsgenomename usecacheusecache else ifallischaractergenome cytobands getCytobandsgenome cytobands getCytobandsgenome usecacheusecache if there are cytobands filter the cytobands using the current genome If I bypass the cache like that all is well if not the error persists This happens on the latest master installed via devtools It seems like karyoploteR is computing coverage in a different way than IGV I think that IGV is ignoring the reads that have pairs mapping outside the viewing region In contrast karyoploteR is including those reads as if they cover those bases Im only interested to know about the actual sequenced bases supported by actual reads Im not interested in the gaps in the read alignments since the gaps do not tell me anything about how well a particular position is covered Could I please ask if you might have any hints about how to get the desired behavior Heres what I see from karyoploteR Heres what I see in IGV Heres my code r usrbinenv Rscript bamfile possortedgenomebambam BiocManagerinstall cTxDbHsapiensUCSChg knownGene GenomicRanges karyoploteR EnsDbHsapiensv libraryTxDbHsapiensUCSChg knownGene libraryGenomicRanges librarykaryoploteR librarymagrittr txdbfile gencodev annotationsqlite if fileexiststxdbfile txdb makeTxDbFromGFFfile gencodev annotationgtf gz txdb makeTxDbFromGFF file temp gtfgz format gtf organism Homo sapiens saveDbtxdb txdbfile else txdb loadDbtxdbfile gencoderds gencodev annotationgff rds if fileexistsgencoderds gencode rtracklayerimportgff gencodev annotationgff gz saveRDSgencode gencoderds else gencode readRDSgencoderds genes gencode cgenetype geneid genename unique proteincodingids genesgeneid genesgenetype proteincoding x gencode cgenename geneid unique ensembltosymbol xgenename namesensembltosymbol xgeneid genes genesgeneid ENSG genes genesgeneid ENSG pp getDefaultPlotParamsplottype ppleftmargin pptopmargin ppbottommargin ppideogramheight ppdata inmargin ppdata outmargin regions list HLAA toGRanges kp plotKaryotypegenome regions HLAA zoom regions HLAA cex plotparams pp kpAddBaseNumberskp tickdist minortickdist addunits TRUE cex ticklen genesdata makeGenesDataFromTxDb txdb txdb karyoplot kp plottranscripts TRUE plottranscriptsstructure TRUE proteincodingids genesdatagenesname ensembltosymbol mcolsgenesdatagenes kpPlotGeneskp data genesdata genenamecex r r How can I make this ignore the gaps in reads kp kpPlotBAMCoveragekp data bamfile r r computedymax kplatestplotcomputedvaluesmaxcoverage kpAxiskp ymin ymax computedymax r r kpAddMainTitlekp Coverage cex Hello bernatgel thank you for all of your work on this great package Im not sure if Im missing something obvious but if I try to make an ideograms only plot plottype adding base numbers causes the axis text to overlap each chromosome ideogram kp plotKaryotypeplottype kpAddBaseNumberskp ideograms Im wondering if there is some way to give an option so that kpAddBaseNumbers would only add a single xaxis for basepair coordinates at the bottom of the image which would be much cleaner in the case of only working with ideograms Ive tried using a simple call to axis but the problem seems a little more complicated than that Thank you I am trying out the kpPlotRainfall function with some internal datasets cancer genomes I seem to get an error when variants are absent from a particular chromosome Considering the demo dataset used in the tutorial the error can be exemplified as follows when removing variants from chromosome sm sm dplyrfilterchr smgr toGRangessm cchr start end ref alt seqlevelsStylesmgr UCSC kp plotKaryotypeplottype kpPlotRainfallkp data smgr Error in attrx tsp c NROWx attempt to set an attribute on NULL If r is NULL and r has two elements r and r use them as r and r This will reduce the typing when using autotrack Similar to the two triangles in UCSC When plotting genes with kpPlotGenes in datapanel the strand of the genes is flipped Problems with the computation of the strand marks Adding base numbers with very small tick dist is too slow Reimplement to take into account zoomed in region before plotting Hello I was wondering if you had any suggestions as to how kpPoints might plot point density in a similar way to ggplot We have points of estimated copy number in kb bins across chromosomes and its difficult to determine whether or not outliers CN etc are a minority of points Thanks Mike As reported by lnonell theres a bug in plottype causing the data panel to be inverted This is due to implementation changes that implemented it as a special case of plottype A potential solution would be to invert ymin and ymax Otherwise reimplement as an independent type