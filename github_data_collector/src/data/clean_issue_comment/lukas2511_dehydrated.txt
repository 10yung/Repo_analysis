Using debian vm and zsh shell Have created domainstxt and configsh Added the bind nameserver ip address Get the following error dehydrated c INFO Using main config file etcdehydratedconfig INFO Using additional config file etcdehydratedconfdconfigsh INFO Using additional config file etcdehydratedconfdletsencryptacmedns challengehooksh etcdehydratedconfdletsencryptacmedns challengehooksh line unbound variable Write an error message if the HookScript is broken If you use dns you got a fallback to http which will create stupid problems to debug and finde the problem See also It would be very good if it were possible to set the CA on a percertificate level Example for production domains Id like to use the real Lets Encrypt CA For test domains Id like to use the staging environment According to the confguration variable CA cannot be changed in certsexampleorgconfig or DOMAINSDexampleorg I tried to create a lets encrypt certificate in my openwert router using the following tuto however when I execute the command dehydrated c I get this error ERROR WELLKNOWN directory doesnt exist please create etcwwwdehydrated and set appropriate permissions I have already created etcwwwdehydrated and I can access to it and permissions are set drwxrwxrwx for etcwwwdehydrated and rwxrwxrwx for etcdehydratedconfig When running dehydrated with the v parameter I noticed that the operating system name is broken dehydrated v INFO Using main config file rootdehydratedconfig Dehydrated by Lukas Schauer Dehydrated version GITRevision unknown OS S Used software bash release curl curl awk GNU Awk API GNU MPFR p GNU MP sed sed GNU sed mktemp mktemp GNU coreutils grep grep GNU grep diff diff GNU diffutils openssl OpenSSL FIPS Sep The problem appears in the commandversion function in the following line bash echo OS cat etcissue grep v head n sed s rnl g Apparently it reads the etcissue file which in RHELCentOSFedora systems looks like this S Kernel r on an m l Since dehydrated does not expand S it appears asis Maybe on Linux distros using systemd it would be better to parse the requred etcosrelease file references Hello Currently when we want to reload services that are dependent on certificates we may use the hook script deploycert function Unfortunately this means that if the script is renewing multiple certificates the deploycert function will be called once per domain and thus reload the services multiple times deploycert local DOMAIN KEYFILE CERTFILE FULLCHAINFILE CHAINFILE TIMESTAMP echo Reloading services systemctl reload httpd postfix haproxy dovecot Reloading services Reloading services Reloading services Would it be possible to change the exithook function so that its passed a status parameter that tells if there was at least one certificate that was createdupdated so that the reload of the services only happens once exithook local STATUS if STATUS at least one domain was createdchanged reload only once systemctl reload httpd postfix haproxy dovecot fi Thank you systemctl is specific to systemd whereas service is a init system agnostic command that can run in all OSes I know about Ive been asked to do it in this Debian bug Page contains wrong link Here are some examples Examples for DNS hooks dehydrated config configstep x g signcsr somecsr INFO Using main config file configstep Requesting new certificate order from CA ERROR An error occurred while sending postrequest to Status Details HTTP cachecontrol nostore contenttype applicationproblemjson link replaynonce YVY Z VoVXZNWVhTRTVIYnVZQW uR N Yk RZk Ylg contentlength date Mon Nov GMT typeurnietfparamsacmeerrormalformeddetailkid does not have required prefix expected but got The server Im talking to does with with the acmesh client and smallsteps own acme client Hi Trying to run dehydrated in cron yields the following error Wed Oct CEST running dehydrated INFO Using main config file srvletsencryptscriptsdehydratedconf Wed Oct CEST Hook thishookscriptisbrokendehydratedisworkingfinepleaseignoreunknownhooksinyourscript Wed Oct CEST Hook startuphook Processing foobarcom with alternative names wwwfoobarcom kekfoobarcom lolfoobarcom Wed Oct CEST Hook thishookscriptisbrokendehydratedisworkingfinepleaseignoreunknownhooksinyourscript Checking domain names of existing cert unchanged Checking expire date of existing cert Valid till Nov GMT Certificate will expire Less than days Renewing Signing domains Generating private key Generating signing request Requesting new certificate order from CA Received authorizations URLs from the CA ERROR An error occurred while sending postrequest to Status Details HTTP Connection established HTTP server nginx date Wed Oct GMT contenttype applicationproblemjson contentlength boulderrequester cachecontrol public maxage nocache link replaynonce snip type urnietfparamsacmeerrormalformed detail Expired authorization status skipping Running the same command manually works just fine Requesting new certificate order from CA Received authorizations URLs from the CA Handling authorization for foobarcom Handling authorization for wwwfoobarcom Handling authorization for lolfoobarcom Handling authorization for kekfoobarcom pending challenges Deploying challenge tokens The error it receives in cron happens every time since I have it once per h and the certificates are almost days past the day renewal that Ive set Some of these domains where signed by v of the LE API while Im now using v Could this be the culprit If so its strange that it works when I ran the crontabcommand manually Any pointers