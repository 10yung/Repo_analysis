shutdowns SHUTWR in TIMEWAIT returns ENOTCONN From RFC s p Event Processing CLOSE Call during TIMEWAIT return with error connection closing Fixes From RFC s p Event Processing CLOSE Call during TIMEWAIT return with error connection closing Internal change Add syscalls for lgetxattr fgetxattr lsetxattr and fsetxattr Note that these simply will use the same logic as getxattr and setxattr which is not yet implemented for most filesystems Add support for TCPDEFERACCEPT recv on a closed TCP socket returns ENOTCONN From RFC s p Event Processing If RECEIVE Call arrives in CLOSED state and the user has access to such a connection the return should be error connection does not exist Fixes From RFC s p Event Processing If RECEIVE Call arrives in CLOSED state and the user has access to such a connection the return should be error connection does not exist Make some of the fcntl flags arch specific Some of the flags in the file system related system call are architecture specificONOFOLLOWODIRECT Ref to the fcntlh file in the Linux src codes Signedoffby Haibo Xu haiboxuarmcom ChangeId I d bfd c ff d e be da b fd f FUTURECOPYBARAINTEGRATEREVIEW from xiaobo xfcntlflags de d ae df a ff a supporting sError in guest kernel on Arm For test case TestBounce we use KVMSETVCPUEVENTS to trigger sError Signedoffby Bin Lu binluarmcom FUTURECOPYBARAINTEGRATEREVIEW from lubinszARMprring c a ce ed f cb a a dce eb When syscalls are called frequently it cost much time to lookup internal addresses of usermem in CopyIn and CopyOut In many cases the usermems passed into syscalls are repeated or in the same range So use a cache to store frequently used usermem address mapping may accelerate the PMA lookup