Vuls still uses obsolete and deprecated githubcomhashicorpuuid library Please consider switching to githubcomhashicorpgouuid successor library Thanks What did you do required The issue will be closed when not provided Scanning OS images during the build using vulsserver and oneliner scan with curl What did you expect to happen Report stored to servers disk Report usable with vulsrepo What happened instead Results are stored but cant be used with vulsrepo because reportedAt timestamp is left initial value T Z Steps to reproduce the behaviour start vulsserver with formatjson tolocalfile options and provide vulnerability DBs to it too Run oneliner scan from eg Debian container Check JSON from servers disk manually or try to open it with vulsrepo Configuration MUST fill this out Vuls container from Docker hub docker pull vulsvuls Go version go version Not applicable Go environment go env Not applicable Vuls environment Hash vuls v build d e cc To check the commit hash of HEAD vuls v or cd GOPATHsrcgithubcomfuturearchitectvuls git revparse short HEAD configtoml None command vuls server listen logdir tmpvuls vulnerability DBs from external Postgresql formatjson tolocalfile Running at Kubernetes What did you do required The issue will be closed when not provided Tried to do What did you expect to happen Scan from vuls pushed to server Report is both displayed in stdout and stored to server as server is configured to store the results What happened instead Error message using real server produced same error Dec ERROR localhost Failed to read from JSON Invalid path vulsresultshttplocalhost vuls githubcomfuturearchitectvulsreportJSONDir gosrcgithubcomfuturearchitectvulsreportutilgo Current Output vuls report debug tohttp Dec ERROR localhost Failed to read from JSON Invalid path vulsresultshttplocalhost vuls githubcomfuturearchitectvulsreportJSONDir gosrcgithubcomfuturearchitectvulsreportutilgo Steps to reproduce the behaviour container run rm it entrypoint binsh vulsvuls cat EOF configtoml servers serverslocalhost host localhost port local EOF vuls scan export VULSSERVERlocalhost vuls report tohttp Configuration MUST fill this out Go version go version NA Go environment go env NA Vuls environment Hash vuls v build e To check the commit hash of HEAD vuls v or cd GOPATHsrcgithubcomfuturearchitectvuls git revparse short HEAD configtoml servers serverslocalhost host localhost port local command vuls report tohttp If this Pull Request is work in progress Add a prefix of WIP in the title What did you implement Add CWE Top and CWESANS Top information to vuls report in additionto OWASP Top Type of change Please delete options that are not relevant Bug fix nonbreaking change which fixes an issue x New feature nonbreaking change which adds functionality Breaking change fix or feature that would cause existing functionality to not work as expected This change requires a documentation update How Has This Been Tested Please describe the tests that you ran to verify your changes Provide instructions so we can reproduce Checklist You dont have to satisfy all of the following Write tests Write documentation Check that there arent other open pull requests for the same issuefeature Format your source code by make fmt Pass the test by make test Provide verification config commands Enable Allow edits from maintainers for this PR Update the messages below Is this ready for review NO Reference If this is a FEATURE REQUEST request format does not matter Currently theres possiblity to make oneliner scan of system using curl Issue is that received JSON cant be displayed nicely with application because application always wants to get the data from vulnerability DB even theres everything needed in the JSON returned by vuls server What did you do required The issue will be closed when not provided Scanned Docker image with Ubuntu LTS OS What did you expect to happen Vuls should report all vulnerabilities present inside this image What happened instead Vuls reporting vulnerabilities which are not even present in this image Current Output Please rerun the command using debug and provide the output below Steps to reproduce the behaviour Configuration MUST fill this out Go version go version go version go linuxamd Go environment go env GOARCHamd GOBIN GOCACHEhomebhupindercachegobuild GOEXE GOHOSTARCHamd GOHOSTOSlinux GOOSlinux GOPATHhomebhupinderclairscanner GORACE GOROOTusrlibgo GOTMPDIR GOTOOLDIRusrlibgo pkgtoollinuxamd GCCGOgccgo CCgcc CXXg CGOENABLED CGOCFLAGSg O CGOCPPFLAGS CGOCXXFLAGSg O CGOFFLAGSg O CGOLDFLAGSg O PKGCONFIGpkgconfig GOGCCFLAGSfPIC m pthread fmessagelength fdebugprefixmaptmpgobuild tmpgobuild gnorecordgccswitches Vuls environment Hash To check the commit hash of HEAD vuls v or cd GOPATHsrcgithubcomfuturearchitectvuls git revparse short HEAD configtoml url gost type sqlite sqlite Path vulsgostsqlite url gost type http url exploit type sqlite sqlite Path vulsgoexploitdbsqlite cveDict type http url ovalDict type http url gost type http url exploit type http url type sqlite sqlite Path vulsgoexploitdbsqlite default servers servershost host port user bhupinder keyPath rootsshrsanopass scanMode fast type pseudo memo DB Server cpeNames cpearubyonrailsrubyonrails owaspDCXMLPath pathtodependencycheckreportxml ignoreCves CVE containerType docker containersIncluded running containersExcluded exploitdb gost govaldictionary gocvedictionary command What did you do required The issue will be closed when not provided I scanned docker image based on Alpine What did you expect to happen It has package sqlite r in the image which has vulnerability CVE This vulnerability is fixed in sqlite r But when I scan this image using Vuls this vulnerability is not flagged What happened instead Vuls is not detecting CVE vulnerability Current Output Please rerun the command using debug and provide the output below Steps to reproduce the behaviour Configuration MUST fill this out Go version go version go version go linuxamd Go environment go env GOARCHamd GOBIN GOCACHEhomebhupindercachegobuild GOEXE GOHOSTARCHamd GOHOSTOSlinux GOOSlinux GOPATHhomebhupinderclairscanner GORACE GOROOTusrlibgo GOTMPDIR GOTOOLDIRusrlibgo pkgtoollinuxamd GCCGOgccgo CCgcc CXXg CGOENABLED CGOCFLAGSg O CGOCPPFLAGS CGOCXXFLAGSg O CGOFFLAGSg O CGOLDFLAGSg O PKGCONFIGpkgconfig GOGCCFLAGSfPIC m pthread fmessagelength fdebugprefixmaptmpgobuild tmpgobuild gnorecordgccswitches Vuls environment Hash To check the commit hash of HEAD vuls v or cd GOPATHsrcgithubcomfuturearchitectvuls git revparse short HEAD configtoml cveDict type sqlite sqlite Path vulscvesqlite ovalDict type sqlite sqlite Path vulsovalsqlite gost type sqlite sqlite Path vulsgostsqlite exploit type sqlite sqlite Path vulsgoexploitdbsqlite default servers servershost host port user bhupinder keyPath rootsshrsanopass scanMode fast type pseudo memo DB Server cpeNames cpearubyonrailsrubyonrails owaspDCXMLPath pathtodependencycheckreportxml ignoreCves CVE containerType docker containersIncluded running containersExcluded exploitdb gost govaldictionary gocvedictionary command Hello Ive installed the latest version of vuls and id like to import results in ES and visualize them in Kibana Before the solution was to use vulslogconverter last update in but something change in the JSON results that cannot be parsed anymore and ive got some errors Is there a way to import the results in ES or do you plan to add the possibility in future Thanks for your help and for this great project Hello Im having issues running a remote scan the remote host is ubuntu What am I doing wrong here My configurations and error are below Configuration servers serversval host port user vas keyPath rootsshidrsa scanMode fastroot scanMode fast fastroot deep offline type pseudo memo DB Server cpeNames cpearubyonrailsrubyonrails owaspDCXMLPath pathtodependencycheckreportxml ignoreCves CVE containerType docker or lxd or lxc default docker containersIncluded running containersExcluded containernamea servers containerscontainernamea cpeNames cpearubyonrailsrubyonrails owaspDCXMLPath pathtodependencycheckreportxml ignoreCves CVE servers githubsownerrepo token yourToken servers wordpress cmdPath usrlocalbinwp osUser wordpress docRoot pathtoDocumentRoot wpVulnDBToken xxxxTokenxxxx ignoreInactive true servers optional key value Error Status Image is up to date for vulsvulslatest Oct INFO localhost Validating config Oct INFO localhost Detecting ServerContainer OS Oct INFO localhost Detecting OS of servers Oct ERROR localhost Failed val err Failed to detect OS githubcomfuturearchitectvulsscandetectOS gosrcgithubcomfuturearchitectvulsscanserverapigo Unable to connect via SSH Scan with vvv option to print SSH debugging messages and check SSH settings If you have never SSH to the host to be scanned SSH to the host before scanning in order to add the HostKey vas port execResult servername val cmd usrbinssh tt o StrictHostKeyCheckingyes o LogLevelquiet o ConnectionAttempts o ConnectTimeout o ControlMasterauto o ControlPathrootvulscontrolmasterrvalp o Controlpersist m vas p i rootsshidrsa o PasswordAuthenticationno stty cols ls etcdebianversion exitstatus stdout stderr err snil githubcomfuturearchitectvulsscandetectDebian gosrcgithubcomfuturearchitectvulsscandebiango Oct ERROR localhost Failed to init servers err No scannable base servers githubcomfuturearchitectvulsscanInitServers gosrcgithubcomfuturearchitectvulsscanserverapigo adminrootvulvulsctl Debug adminrootvulvulsctl scansh debug vvv Using default tag latest latest Pulling from vulsvuls Digest sha d c f fb cb f e ea e f fcbaac a f e Status Image is up to date for vulsvulslatest Oct INFO localhost Validating config Oct INFO localhost Detecting ServerContainer OS Oct INFO localhost Detecting OS of servers Oct DEBUG localhost Executing ls etcdebianversion Oct DEBUG localhost execResult servername val cmd usrbinssh tt o StrictHostKeyCheckingyes o LogLevelquiet o ConnectionAttempts o ConnectTimeout o ControlMasterauto o ControlPathrootvulscontrolmasterrvalp o Controlpersist m vvv vas p i rootsshidrsa o PasswordAuthenticationno stty cols ls etcdebianversion exitstatus stdout stderr OpenSSH p hpn v LibreSSL debug Reading configuration data etcsshsshconfig debug automux Trying existing master debug Control socket rootvulscontrolmastervasval does not exist debug resolving port debug sshconnectdirect needpriv debug Connecting to port debug fd setting ONONBLOCK debug fd clearing ONONBLOCK debug Connection established debug timeout ms remain after connect debug permanentlysetuid debug identity file rootsshidrsa type debug keyloadpublic No such file or directory debug identity file rootsshidrsacert type debug Enabling compatibility mode for protocol debug Local version string SSH OpenSSH p hpn v debug Remote protocol version remote software version OpenSSH p Ubuntu ubuntu debug match OpenSSH p Ubuntu ubuntu pat OpenSSH compat x debug Remote is NONHPN aware debug fd setting ONONBLOCK debug Authenticating to as vas debug send packet type debug SSH MSGKEXINIT sent debug receive packet type debug SSH MSGKEXINIT received debug local client KEXINIT proposal debug KEX algorithms curve sha curve sha libsshorgecdhsha nistp ecdhsha nistp ecdhsha nistp diffiehellmangroupexchangesha diffiehellmangroup sha diffiehellmangroup sha diffiehellmangroupexchangesha diffiehellmangroup sha diffiehellmangroup sha extinfoc debug host key algorithms ecdsasha nistp certv opensshcomecdsasha nistp certv opensshcomecdsasha nistp certv opensshcomsshed certv opensshcomsshrsacertv opensshcomecdsasha nistp ecdsasha nistp ecdsasha nistp sshed rsasha rsasha sshrsa debug ciphers ctos chacha poly opensshcomaes ctraes ctraes ctraes gcmopensshcomaes gcmopensshcomaes cbcaes cbcaes cbc debug ciphers stoc chacha poly opensshcomaes ctraes ctraes ctraes gcmopensshcomaes gcmopensshcomaes cbcaes cbcaes cbc debug MACs ctos umac etmopensshcomumac etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomumac opensshcomumac opensshcomhmacsha hmacsha hmacsha debug MACs stoc umac etmopensshcomumac etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomumac opensshcomumac opensshcomhmacsha hmacsha hmacsha debug compression ctos nonezlibopensshcomzlib debug compression stoc nonezlibopensshcomzlib debug languages ctos debug languages stoc debug firstkexfollows debug reserved debug peer server KEXINIT proposal debug KEX algorithms curve sha curve sha libsshorgecdhsha nistp ecdhsha nistp ecdhsha nistp diffiehellmangroupexchangesha diffiehellmangroup sha diffiehellmangroup sha diffiehellmangroup sha diffiehellmangroup sha debug host key algorithms sshrsarsasha rsasha ecdsasha nistp sshed debug ciphers ctos chacha poly opensshcomaes ctraes ctraes ctraes gcmopensshcomaes gcmopensshcom debug ciphers stoc chacha poly opensshcomaes ctraes ctraes ctraes gcmopensshcomaes gcmopensshcom debug MACs ctos umac etmopensshcomumac etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomumac opensshcomumac opensshcomhmacsha hmacsha hmacsha debug MACs stoc umac etmopensshcomumac etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomumac opensshcomumac opensshcomhmacsha hmacsha hmacsha debug compression ctos nonezlibopensshcom debug compression stoc nonezlibopensshcom debug languages ctos debug languages stoc debug firstkexfollows debug reserved debug kex algorithm curve sha debug kex host key algorithm ecdsasha nistp debug kex serverclient cipher chacha poly opensshcom MAC implicit compression none debug kex clientserver cipher chacha poly opensshcom MAC implicit compression none debug send packet type debug expecting SSH MSGKEXECDHREPLY debug receive packet type debug Server host key ecdsasha nistp SHA YTenEi rwI b Bxtq DGz DR GHN GAiu Fs No ECDSA host key is known for and you have requested strict checking Host key verification failed err snil Oct ERROR localhost Failed val err Failed to detect OS githubcomfuturearchitectvulsscandetectOS gosrcgithubcomfuturearchitectvulsscanserverapigo Unable to connect via SSH Scan with vvv option to print SSH debugging messages and check SSH settings If you have never SSH to the host to be scanned SSH to the host before scanning in order to add the HostKey vas port execResult servername val cmd usrbinssh tt o StrictHostKeyCheckingyes o LogLevelquiet o ConnectionAttempts o ConnectTimeout o ControlMasterauto o ControlPathrootvulscontrolmasterrvalp o Controlpersist m vvv vas p i rootsshidrsa o PasswordAuthenticationno stty cols ls etcdebianversion exitstatus stdout stderr OpenSSH p hpn v LibreSSL debug Reading configuration data etcsshsshconfig debug automux Trying existing master debug Control socket rootvulscontrolmastervasval does not exist debug resolving port debug sshconnectdirect needpriv debug Connecting to port debug fd setting ONONBLOCK debug fd clearing ONONBLOCK debug Connection established debug timeout ms remain after connect debug permanentlysetuid debug identity file rootsshidrsa type debug keyloadpublic No such file or directory debug identity file rootsshidrsacert type debug Enabling compatibility mode for protocol debug Local version string SSH OpenSSH p hpn v debug Remote protocol version remote software version OpenSSH p Ubuntu ubuntu debug match OpenSSH p Ubuntu ubuntu pat OpenSSH compat x debug Remote is NONHPN aware debug fd setting ONONBLOCK debug Authenticating to as vas debug send packet type debug SSH MSGKEXINIT sent debug receive packet type debug SSH MSGKEXINIT received debug local client KEXINIT proposal debug KEX algorithms curve sha curve sha libsshorgecdhsha nistp ecdhsha nistp ecdhsha nistp diffiehellmangroupexchangesha diffiehellmangroup sha diffiehellmangroup sha diffiehellmangroupexchangesha diffiehellmangroup sha diffiehellmangroup sha extinfoc debug host key algorithms ecdsasha nistp certv opensshcomecdsasha nistp certv opensshcomecdsasha nistp certv opensshcomsshed certv opensshcomsshrsacertv opensshcomecdsasha nistp ecdsasha nistp ecdsasha nistp sshed rsasha rsasha sshrsa debug ciphers ctos chacha poly opensshcomaes ctraes ctraes ctraes gcmopensshcomaes gcmopensshcomaes cbcaes cbcaes cbc debug ciphers stoc chacha poly opensshcomaes ctraes ctraes ctraes gcmopensshcomaes gcmopensshcomaes cbcaes cbcaes cbc debug MACs ctos umac etmopensshcomumac etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomumac opensshcomumac opensshcomhmacsha hmacsha hmacsha debug MACs stoc umac etmopensshcomumac etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomumac opensshcomumac opensshcomhmacsha hmacsha hmacsha debug compression ctos nonezlibopensshcomzlib debug compression stoc nonezlibopensshcomzlib debug languages ctos debug languages stoc debug firstkexfollows debug reserved debug peer server KEXINIT proposal debug KEX algorithms curve sha curve sha libsshorgecdhsha nistp ecdhsha nistp ecdhsha nistp diffiehellmangroupexchangesha diffiehellmangroup sha diffiehellmangroup sha diffiehellmangroup sha diffiehellmangroup sha debug host key algorithms sshrsarsasha rsasha ecdsasha nistp sshed debug ciphers ctos chacha poly opensshcomaes ctraes ctraes ctraes gcmopensshcomaes gcmopensshcom debug ciphers stoc chacha poly opensshcomaes ctraes ctraes ctraes gcmopensshcomaes gcmopensshcom debug MACs ctos umac etmopensshcomumac etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomumac opensshcomumac opensshcomhmacsha hmacsha hmacsha debug MACs stoc umac etmopensshcomumac etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomhmacsha etmopensshcomumac opensshcomumac opensshcomhmacsha hmacsha hmacsha debug compression ctos nonezlibopensshcom debug compression stoc nonezlibopensshcom debug languages ctos debug languages stoc debug firstkexfollows debug reserved debug kex algorithm curve sha debug kex host key algorithm ecdsasha nistp debug kex serverclient cipher chacha poly opensshcom MAC implicit compression none debug kex clientserver cipher chacha poly opensshcom MAC implicit compression none debug send packet type debug expecting SSH MSGKEXECDHREPLY debug receive packet type debug Server host key ecdsasha nistp SHA YTenEi rwI b Bxtq DGz DR GHN GAiu Fs No ECDSA host key is known for and you have requested strict checking Host key verification failed err snil githubcomfuturearchitectvulsscandetectDebian gosrcgithubcomfuturearchitectvulsscandebiango Oct ERROR localhost Failed to init servers err No scannable base servers githubcomfuturearchitectvulsscanInitServers gosrcgithubcomfuturearchitectvulsscanserverapigo adminrootvulvulsctl 