As I just spent hours trying to figure out why Firehol stopped working when upgrading to Buster I just want to reiterate the solution for others having the same problem updatealternatives set iptables usrsbiniptableslegacy updatealternatives set ip tables usrsbinip tableslegacy For multicast it looks like I have to insert two interfaces interface eth carpin src dst server ucarp accept interface eth carpout dst src server ucarp accept which gets me pointless iptables rules like Chain OUTPUT policy DROP target prot opt source destination ACCEPT all outcarpin all and Chain INPUT policy DROP target prot opt source destination ACCEPT all incarpout all Is there a way to prevent these Ive defined a service in etcfireholservicesucarpconf VRRPucarp sends to see here FHVER dit is rulesmulticast uit firehol binary rulesucarp local inin outout clientportsDEFAULTCLIENTPORTS mychain type shift if type client then inout outin fi match multicast packets in both directions rule out action chain outmychain dst proto return rule in reverse action chain inmychain src proto return echo FOO return but if I set helperallucarp in fireholconf this runs nothing for this interface interface eth eth internal dst policy reject server all accept client all accept got the suggestion from the deprecated warning rootosm etcfirehol firehol debug fgrep FireHOL Saving active firewall to a temporary file OK FireHOL Processing file etcfireholfireholconf OK iptables rules Adding server ucarp accept does work rootosm etcfirehol firehol debug fgrep FireHOL Saving active firewall to a temporary file OK FireHOL Processing file etcfireholfireholconf OK iptables rules A outinternal p d j ACCEPT A ininternal p d j ACCEPT Changing rulesucarp to helperucarp in etcfireholservicesucarpconf does not make a difference using it returns ALLSHOULDALSORUN has been deprecated Service all now runs all these conntrack helper overriding IPTABLESCMD in fireholconf for fail ban integration IPTABLESCMDsbiniptables w makes firehol complain on activation FireHOL Saving active firewall to a temporary file OK FireHOL Processing file etcfireholfireholconf ERROR etcfireholfireholconf contains sbiniptables or sbinip tables statements Replace these statements iptables or ip tables respectively without a path so that FireHOL can execute these commands at firewall activation Pretty much unavoidable I think hello i like to portforward http to a lxc container where a nginx proxy is waiting for connections i like to use firehol to forward over the bridge with this rule i am trying it dnat to proto tcp dport but after enabling it the container cant connect to the internet i get the default nginx website lxc proxy container from the host etcfireholfireholconf version wanenp s dnat to proto tcp dport interface any world protection badpackets server all accept client all accept router lxc inface virbr outface wan masquerade route all accept After looking at the KDE connect documention I added the rules serverkdeconnectportsudp tcp clientkdeconnectportsdefault to my config so that I could open this between my wifi and lan I dont know if this would be appropriate to include in the firehol list of services but I figured Id submit it in case it is The problem I use pihole for DNS on my network customized to send email DNSBL lookups directly to my active spam block lists When updating coinbl coinblhosts coinblhostsoptional coinblhostsbrowser or hphosts hphostsats hphostsdme hphostsexp hphostsfsa hphostsgrm hphostshfs hphostshjk hphostsmmt hphostspha hphostspsh hphostswrz pihole steps in and returns for hostnames that would be blocked or x for hostnames listed in any of my spam blocklists when doing dns lookups using the hphosts ips hostnameresolver functions to get IP addresses The question Is there an easy way to have updateipsets use a DNS resolver other than the system default Sorry for posting here I am looking to contribute to firehol and need communication channel details If any Can you please help me out Regards As reported bunder in the href for maxmindproxyfraud sample IPs has changed again diff u updateipsets updateipsets updateipsets updateipsets extract IPs from the maxmind proxy fraud page parsemaxmindproxyfraud GREPCMD href highriskipsample GREPCMD href enhighriskipsample CUTCMD d f CUTCMD d f 