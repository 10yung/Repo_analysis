I am working with the AFQSegmentCallosum function and could not find any documentation or rationale for the ROIs used in this function When mapping the ROI nifti files onto the MNI brain they largely terminate in areas of cortex that make intuitive sense However different ROIs are used for superior frontal cortex and motor cortex yet the ROI for the superior parietal cortex includes somatosensory cortex Are the AFQSegmentCallosum ROIs based on fiber groups observed in previous studies And additionally is it reasonable to modify the ROI for superior parietal cortex to create a separate ROI for somatosensory cortex Thank you James W Dias I am facing the similar NaN issue mainly from the bilateral Hippocampal Cingulum tracts The missing data were as high as even in my control adult dataset I have inspected them by overlaying the pair of ROIs and the cleaned FG on dtiFiberUI It seems like those hippocampal cingulum fibers can be tracked separately from ROI or ROI but not long enough to touch both ROI waypoints in the subjects with NaN Therefore it returned out no fibers for these tracts Since the NaN are far more than those from right AF I am wondering whether its common How can I dealt with it Shall I completely get rid of the Hippocampal Cingulum tracts for everybody from the fibers Thanks Cheng Hi is this repository still working on MATLAB a I keep getting an internal error at some stage and MATLAB is closed unexpectedly while Im trying to run AFQexamplem I would be greatful for any help Thank you I am running AFQrun with following options subdirs configpatient dti configcontrol dti subgroup afq AFQCreatesubdirs subdirs subgroup subgroup afq patientdata controldata norms abn abnTracts AFQrunsubdirs subgroup afq When I run this it crashes toward the end of processing with following error message dtiCleanFibers Keeping out of fibers dtiSplitInterhemisphericFibers Splitting every fiber below Z Computing Tract Profiles for subject mntscratchtestdatadtiinitdtiError using matlabgraphicsaxisAxesset Value must be a x vector of numeric type in which the second element is larger than the first and may be Inf Error in axis Error in axis Error in AFQplot line Error in AFQrun line Error in main line MATLABhgshapedarraysLimitsWithInfsPredicate Am I running this in a wrong way Hi AFQ team We have been analysing several AFQ processed datasets and we have a suggestion for how the clip rois parameter is working Right now for both the true and false options the resulting tract profile is normalized to divisions The main issue we find with this is that the profiles or averages coming from two different clip roi options cannot be compared although both have the same number of divisions We think that it could be useful if the clip roitrue option would have the divisions and the clip roifalse option maybe or divisions One way of getting rid completely of the parameter would be to assign divisions between the ROIs always and use divisions from the ROIs to the GM in both ends This way we always would have divisions and could easily select the middle for the clip roi segment of the tract profile maybe another option for backward compatibility would be to maintain always the divisions but make sure that the middle correspond to the clip roi section of the tract profile What do you think I can create a pull request if you think this change is worth implementing Thanks Gari As suggested by akeshavan at the AFQBrowser meeting on Mar We are trying to run AFQ in deployed compiled via mcc mode and having some issue inside AFQSegmentFiberGroupsm Its running whichmrDiffusionm that doesnt seem to work in compiled mode We basically made following patch to AFQ to make it work diff git afunctionsAFQSegmentFiberGroupsm bfunctionsAFQSegmentFiberGroupsm index a ccb afunctionsAFQSegmentFiberGroupsm bfunctionsAFQSegmentFiberGroupsm end Load fiber group Can be filename or the data if ischarfg fg dtiLoadFiberGroupfg end Set the directory where templates can be found tdir fullfilefilepartswhichmrDiffusionm templates tdir fullfilefilepartswhichmrDiffusionm templates fix for compiling tdir fullfilepwd templates Initialize spm defualts for normalization spmgetdefaults global defaults In my case it is not reading the estimate just the write copied this values I am wondering this piece of code can be updated to something like if isdeployed tdir something that works in deployed mode else tdir fullfilefilepartswhichmrDiffusionm templates end Hello I am encountering some issues when running AFQrun I preprocessed my data with FSL so I created the dt mat file using the dtiMakeDt FromFsl function Then I tried running AFQrun I have created this script to run AFQrun for one subject subdirs UsersImaging PreprocessedDTI afq AFQCreaterunmode subdirs subdirs afq abn abnTracts AFQrunsubdirs afq Here are the results and the errors of this script Performing wholebrain tractograpy for subject UsersImaging PreprocessedDTI scale mm track interp step mm fa angle deg puncture minLength mm maxLength mm Tracking fibers fibers per tick fibers passed length threshold of out of seeds Elapsed time is seconds fibers mean length mm max mm min mm You chose to recompute ROIs Fibers that get as close to the ROIs as mm will become candidates for the Mori Groups Smoothing by mm Coarse Affine Registration Fine Affine Registration D CT Norm iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var Computing inverse deformation dtiCleanFibers Keeping out of fibers dtiSplitInterhemisphericFibers Splitting every fiber below Z Computing Tract Profiles for subject UsersImaging PreprocessedDTIUndefined operator for input arguments of type struct Error in AFQset line afqnorms mean uppervalnamesii jj nanmeanafqvalsvalnamesiijjafqsubgroup Error in AFQComputeNorms line afq AFQsetafqnorms Error in AFQrun line norms patientdata controldata afq AFQComputeNormsafq Error in afqtest line afq abn abnTracts AFQrunsubdirs afq The outputs I get despite these errors are these fibersMoriGroupscleanD L mat MoriGroupsmat WholeBrainFGmat ROIsATRroi Lmat ATRroi Rmat ATRroi Lmat ATRroi Rmat CGCroi Lmat CGCroi Rmat etc Questions a Is there anything wrong in the syntax of my script b What are these errors I am getting and how can they be fixed c What is each file in the fibers folder d According to this example steps and did not run for me Is this correct Also I am not getting this message mesh can be rotated with arrow keys does this mean that something is not right Thank you Best Nasia M Hi Having problem here with Siemens Prisma T DTIT data dcm nii dtiniigz bvals bvecs and t niigz dtiInit AFQexample from dt mat Thanks for considering my request scale mm track interp step mm fa angle deg puncture minLength mm maxLength mm Tracking fibers fibers per tick fibers passed length threshold of out of seeds Elapsed time is seconds fibers mean length mm max mm min mm mesh can be rotated with arrow keys You chose to recompute ROIs Fibers that get as close to the ROIs as mm will become candidates for the Mori Groups Smoothing by mm Coarse Affine Registration Fine Affine Registration D CT Norm iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var iteration FWHM Var Computing inverse deformation dtiCleanFibers Keeping out of fibers dtiSplitInterhemisphericFibers Splitting every fiber below Z Fiber group is empty Left Corticospinal Fiber group is empty Left IFOF Fiber group is empty Left Uncinate Left Uncinate number of fibers No fibers in fiber groupFiber group is empty Left Uncinate Fiber group is empty Left Uncinate Left Thalamic Radiation number of fibers No fibers in fiber group Right Thalamic Radiation number of fibers No fibers in fiber group Left Corticospinal number of fibers No fibers in fiber group Right Corticospinal number of fibers No fibers in fiber group Left Cingulum Cingulate number of fibers No fibers in fiber group Right Cingulum Cingulate number of fibers No fibers in fiber group Left Cingulum Hippocampus number of fibers No fibers in fiber group Right Cingulum Hippocampus number of fibers No fibers in fiber group Callosum Forceps Major number of fibers No fibers in fiber group Callosum Forceps Minor number of fibers No fibers in fiber group Left IFOF number of fibers No fibers in fiber group Right IFOF number of fibers No fibers in fiber group Left ILF number of fibers Left ILF number of fibers Right ILF number of fibers Right ILF number of fibers Left SLF number of fibers Left SLF number of fibers Right SLF number of fibers Right SLF number of fibers Left Uncinate number of fibers No fibers in fiber group Right Uncinate number of fibers No fibers in fiber group Left Arcuate number of fibers Left Arcuate number of fibers Right Arcuate number of fibers No fibers in fiber group mesh can be rotated with arrow keys Fiber group is empty Left Corticospinal Fiber group is empty Left IFOF Fiber group is empty Left Uncinate Warning Error creating or updating Surface Error in value of property CData Array is wrong shape or size Warning Error creating or updating Surface Error in value of property CData Array is wrong shape or size Cheers Larry Just recently Ive not been able to use the AFQRenderFibers scripts because the command minmax can no longer be found matlab To use minmax you might need minmax Neural Network Toolbox Error in AFQRenderFibers line mx minmaxcoordsAll Any thoughts on why this may be happening Naomi