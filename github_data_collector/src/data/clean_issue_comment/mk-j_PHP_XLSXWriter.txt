Using a style of gets converted in numberFormatStandardized to and causes slashes to be visible in the cell Changing line to escaped c instead of escaped c fixed it Not sure what the intended purpose of escaping those characters was but it breaks custom formats mkj How to download file in post method without saving file at server If I add a style like this styles array array borderlefttopbottom bordertopbottom bordertopbottomright writerwriteSheetRowIota row styles MS Excel refuses to load the xlsx file while LibreOffice opens the xlsx file correctly If I remove the style from the code like this writerwriteSheetRowIota row Both MS Excel and LibrOffice load correctly The rows are cells wide I need to use R C notation for a particular formula but excel errors and removes the formula when the spreadsheet opens Ive tried the simplest test I could and it didnt work C any thoughts in BuildworkbookXML the sheetname output when autofilter set wraps the sheetname in single quotes but doesnt double up on any single quotes contained in the name and I may be wrong but I think that the localSheetId needs to be incremented for each sheet i foreachthissheets as sheetnamesheet if sheetautofilter sheetname strreplace selfsanitizesheetnamesheetsheetname special case single quotes need to be doubled up workbookxmldefinedName namexlnmFilterDatabase localSheetIdi hidden selfxmlspecialcharssheetname A selfxlsCellsheetrowcount countsheetcolumns true definedName i When you consider implementing repeatColsrepeatRowsPrintTitles they will also need to handle single quotes in the same way Having generated an xlsx from code mimetype detected as applicationzip and also creating one in Excel mimetype detected as applicationvndopenxmlformatsofficedocumentspreadsheetmlsheet writing the files in this order will fix it zipaddFromString ContentTypes xml selfbuildContentTypesXML zipaddEmptyDirrels zipaddFromStringrelsrels selfbuildRelationshipsXML zipaddEmptyDirxl zipaddFromStringxlworkbookxml selfbuildWorkbookXML zipaddEmptyDirxlrels zipaddFromStringxlrelsworkbookxmlrels selfbuildWorkbookRelsXML zipaddEmptyDirxlworksheets foreachthissheets as sheet zipaddFilesheetfilename xlworksheetssheetxmlname zipaddFilethiswriteStylesXML xlstylesxml zipaddFromStringxlstylesxml selfbuildStylesXML zipaddEmptyDirdocProps zipaddFromStringdocPropscorexml selfbuildCoreXML zipaddFromStringdocPropsappxml selfbuildAppXML As headings are cells just like data they should be able to contain duplicated text eg aCols aCols column aCols column durh obviously aCols column durh obviously aData datadatadata onew XLSXWriter owriteSheetHeadersheet aCols owriteSheetRowsheet aData owriteToFilepublictestxlsx Maybe a new function that uses the array without keys eg aCols aCols titlecolumn format aCols titlecolumn format aCols titlecolumn format aData datadatadata onew XLSXWriter owriteSheetHeadingssheet aCols owriteSheetRowsheet aData owriteToFilepublictestxlsx Ive faced with needs to explicitly set column types so Ive decided to separate set column types method and set header method Because it was impossible for example set types for columns with the same names See ex columntypesphp Hello I need to create a file with a huge number of columns and set the width for all of them When forming a file with more than columns I get an error when opening the file Excel found unreadable content in filename xls Do you want to recover the contents of this workbook If you trust the source of this workbook click Yes Most likely this is due to this code because if I increase the max parameter in this line then everything works for me No need to count columns to merge cells anymore The old merge cell way writermarkMergedCellsheet startrow startcol endrow endcol The new one writermergeCellssheet A E 