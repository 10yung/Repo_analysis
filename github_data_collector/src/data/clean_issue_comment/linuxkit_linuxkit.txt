When usernsremap is enabled in the Docker daemon on the host the isoefi format cannot be built A binlinuxkit build format isoefi linuxkityml fails with Add files etclinuxkitconfig Create outputs linuxkitefiiso FATA Error writing outputs Error writing isoefi output docker run linuxkitmkimageisoefi bd fd eaf d c ebfcedad failed exit status output While a binlinuxkit build linuxkityml successfully completes Ive tested this in both Arch Linux and Alpine Linux I tested this on the current master fce a aa a e fda a fe chmod R in the linuxkit directory does not help Description Currently we have version sprawl and a large delta to the latest release Circle CI Go Linuxkit GoCompile Go Latest Go As a contibutor this is annoying as Im seeing inconsistent errors with gofmt between go versions For example on master currently Steps to reproduce the issue make vs make localcheck Describe the results you received make localcheck gofmt srccmdlinuxkitrunopenstackgo srccmdlinuxkitgcpgo srccmdlinuxkitpushopenstackgo Makefile recipe for target localcheck failed make localcheck Error make tar cf C srccmdlinuxkit docker run rm netnone logdrivernone i linuxkitgocompile de e a e b a b d a b be ba package githubcomlinuxkitlinuxkitsrccmdlinuxkit ldflags X githubcomlinuxkitlinuxkitsrccmdlinuxkitversionGitCommitfce a aa a e fda a fe X githubcomlinuxkitlinuxkitsrccmdlinuxkitversionVersionv o binlinuxkit tmplinuxkitbintar gofmt gcpgo pushopenstackgo runopenstackgo sh pushopenstackgo unknown operand Makefile recipe for target tmplinuxkitbintar failed make tmplinuxkitbintar Error make Deleting file tmplinuxkitbintar Describe the results you expected The results should be consistent Additional information you deem important eg issue happens only occasionally We should probably have a conversation about how to best manage Go versions in the project before we start opening PRs to fix it Note as mentioned on the recent addition of devmapper as a snapshotter to containerd caused the coantainerd tests on LinuxKit to fail To fix this this PR compiles containerd without devmapper support cherry picks an upstream containerd commit to prevent devmapper tests to run see and goldenpheasant linuxkit documentation has been driven entirely through docs on this repo For many uses especially those looking not just to modify it that isnt enough We need a proper doc site oriented towards endusers Following on from this tweet from justinbarrick we need to document better how to use custom kernels Specifically how to package and use a different kernel where drivers areshould be installed how to overridechange the init system Reverts linuxkitlinuxkit This does not work and the CI fails building the GCP image see Enabling more logging in mkimagegcp gives the following error supermin build visiting usrlibx linuxgnuguestfssupermindpackages type uncompressed packages supermin build visiting usrlibx linuxgnuguestfssupermindpackageshfsplus type uncompressed packages supermin build visiting usrlibx linuxgnuguestfssupermindpackagesreiserfs type uncompressed packages supermin build visiting usrlibx linuxgnuguestfssupermindpackagesxfs type uncompressed packages supermin build visiting usrlibx linuxgnuguestfssupermindudevrulestargz type gzip base image tar supermin mapping package names to installed packages supermin resolving full list of package dependencies supermin build packages including dependencies supermin build files supermin build files after matching excludefiles supermin build files after adding hostfiles supermin build files after removing unreadable files supermin build files after munging supermin kernel picked kernel vmlinuz amd supermin kernel picked modules path libmodules amd supermin kernel kernelversion amd supermin kernel modules libmodules amd supermin ext creating empty ext filesystem vartmpguestfs appliancedfchyrekjroot supermin ext populating from base image supermin error statvfs No space left on device vartmpguestfs appliancedfchyrekjroot libguestfs error usrbinsupermin exited with error status see debug messages above libguestfs trace launch error Ive tried a number of different options for sizing and none seem to work I suggest to revert this PR for now Proposing to remove support for x and x kernels x is ancient and has not had several security fixes backported With x the new LTS and x as a mature LTS we dont really need x anymore If you are reporting a new issue make sure that we do not have any duplicates already open You can ensure this by searching the issue list for this repository If there is a duplicate please close your issue and add a comment to the existing issue instead If you suspect your issue is a bug please edit your issue description to include the BUG REPORT INFORMATION shown below If you fail to provide this information within days we cannot debug your issue and will close it We will however reopen it if you later provide the information For more information about reporting issues see BUG REPORT INFORMATION Use the commands below to provide key information from your environment You do NOT have to include this information if this is a FEATURE REQUEST Description When building linuxkit images I get WARN targetsjustin metadata is nearing expiry you should resign the role metadata WARN targetsriyaz metadata is nearing expiry you should resign the role metadata For at least linuxkitsysfsv linuxkitopenntpdv linuxkitnodeexporterv Since v is the latest major in most cases it seems they might all soon trigger this warning Steps to reproduce the issue linuxkit build format kernelinitrd buildyml Describe the results you received WARN targetsjustinriyaz metadata is nearing expiry you should resign the role metadata Describe the results you expected No warnings Additional information you deem important eg issue happens only occasionally The initrd image can now be generated with a prefix path to the root filesystem of the Docker image using the prefix option This is a useful feature when trying to create a custom ramfs build as it removes the constraint of placing the Docker filesystem at the root of the resulting image The code necessary for this is mostly already present it only needs to link with a CLI option Signedoffby Bogdan Neacsu bnneacsuamazoncom Please make sure youve read and understood our contributing guidelines Make sure all your commits include a signature generated with git commit s For additional information on our contributing process read our contributing guide If this is a bug fix make sure your description includes fixes xxxx or closes xxxx Please provide the following information What I did Per the discussion in having a working CI system is important to attract contributors to the project and reduce the burden on maintainers I have spent some time looking at consolidating our CI system sprawl CircleCI LinuxKitCI etc and replacing it with GitHub Actions This PR introduced a single worflow for CI It Builds binaries and runs unit tests on all supported platforms Runs all integration tests in parallel In future this can be extended to include anything and everything that is on the CI wishlist A few points of note Tests are run using containerized qemu no nested virt Overall CI time is still hr but that is mainly spent running the packages tests The GCP test that was running on LinuxKit CI has been ported to RTF but isnt running just yet due to security concerns around secrets Im not sure what the security model is around changes to workflowactions Ill clarify before merge How I did it Wrote lots of YAML and tested on my LinuxKit fork How to verify it You can see the latest green run on my fork Description for the changelog Write a short one line summary that describes the changes in this pull request for inclusion in the changelog A picture of a cute animal not mandatory but encouraged 