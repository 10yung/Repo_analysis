 sdsfree sds O zskiplistNode level zskiplistNode level sdscatvprintf C Try with buffers two times bigger every time we fail to fit the string in the current buffer size while buf buflen vacopycpyap T ON vsnprintfbuf buflen fmt cpy if buf buflen if buf staticbuf zfreebuf buflen buf zmallocbuflen if buf NULL return NULL continue break buf nlogn n fmt whileunsigned longp count redis bitcount bit p bit tcp read nread int redisBufferReadredisContext c char buf int nread Return early when the context has seen an error if cerr return REDISERR nread readcfdbufsizeofbuf if nread if errno EAGAIN cflags REDISBLOCK Try again later else redisSetErrorcREDISERRIONULL return REDISERR else if nread redisSetErrorcREDISERREOFServer closed the connection return REDISERR else if redisReaderFeedcreaderbufnread REDISOK redisSetErrorccreadererrcreadererrstr return REDISERR return REDISOK whilede uint t h nextde denext Get the index in the new hash table h dictHashKeyd dekey dht sizemask denext dht table h dht table h de dht used dht used de nextde int dictRehashdict d int n dht used de dht used 