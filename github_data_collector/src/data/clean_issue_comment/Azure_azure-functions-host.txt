An existing function that has been running for months was redeployed and it started failing on DI issues The function was pinned to an older version of the runtime that is no longer supported so after the deploy I noticed it was changed it to The reason I had it pinned was to address DI issues with version I never went back and unpinned it I updated my local environment to use the same version of the functions host that the portal specified and I am getting the same exceptions I tried to put a break point in startupcs and it never gets hit I have a different project that I can run locally and the startupcs break point is hit as expected Timestamp PM Local time Function App version or Function App name Function names as appropriate Invocation ID a c a f fa feb Region East US Repro steps Provide the steps required to reproduce the problem Register Dependency in Startup Specify dependency for a Queue Triggered Function in its ctor Execute the function by adding message to queue Expected behavior Dependency is injected and function method runs Actual behavior Exception thrown Executed function name MicrosoftExtensionsDependencyInjectionAbstractions Unable to resolve service for type dependency interface name while attempting to activate function class name All other functions in the same project fail as well they happen to specify different dependencies in their ctors Known workarounds none Related information Provide any related information Programming language used C Links to source Bindings used I tested that it works fine with Windows Elastic Premium plans The issue seems isolated to Linux App Service The problem occurs because the host doesnt restart on file updates A manual restart then fixes the issue There was a similar recent bug which affected Windows Elastic Premium function apps as well That bug was fixed This one seems different and looking at the logs I suspect that the file watcher is not picking up the changes I do not see filewatcher logs indicating that a change was detected I believe Kusto logging has length constraints such that if you try to log too large a string the log wont show For example in some investigations I see the log message written here isnt written while the following SyncTriggers call succeeded log is We should break the log up to ensure the important details are logged perhaps log the request URI and details on one line and the payload on another truncating as necessary We can have a helper method to do the log truncation to proper length so we can reuse elsewhere Currently on secret update paths we dont clear cache eagerly Instead we let the repository change notification mechanism fire the event based on shared file system sentinel files This can cause race conditions if a key is added and immediately a request comes in to list keys before the change notification had a chance to be processed the new key wont be returned also KeysController after doing an update immediately fires a SyncTriggers operation This operation queries SecretManager for keys and will also get stale results until cache is cleared These are temporary issues and clear themselves up after a bit However it can cause portal confusion when a customer adds a key and doesnt see it reflected immediately Encription keys hashes Encryption keys hashes What problem would the feature youre requesting solve Please describe When the Functions host is not able to connect to storage please surface more details for errors directly to help with investigations eg is the storage account not in the same VNET or is there a temporary error Please provide a succinct description of the issue Please make an effort to fill in the all the sections below or we may close your issue for being low quality Using the default http template for typescript the host crashes with a vague error message details summary Error message click for full log PM A host error has occurred during startup operation ef cd b c ba d d f PM MicrosoftAzureWebJobsScript Object reference not set to an instance of an object PM Stopping JobHost Value cannot be null Parameter name provider summary C w scratch funcbot func host start Azure Functions Core Tools Commit hash a ded ae c f f bb fb Function Runtime Version PM Building host startup suppressed False configuration suppressed False startup operation id ef cd b c ba d d f PM Reading host configuration file C w scratch funcbot hostjson PM Host configuration file read PM PM version PM PM Reading functions metadata PM functions found PM Initializing Host OperationId ef cd b c ba d d f PM Host initialization ConsecutiveErrors StartupCount OperationId ef cd b c ba d d f PM LoggerFilterOptions PM PM MinLevel None PM Rules PM PM ProviderName null PM CategoryName null PM LogLevel null PM Filter AddFilterb PM PM PM ProviderName MicrosoftAzureWebJobsScriptWebHostDiagnosticsSystemLoggerProvider PM CategoryName null PM LogLevel None PM Filter null PM PM PM ProviderName MicrosoftAzureWebJobsScriptWebHostDiagnosticsSystemLoggerProvider PM CategoryName null PM LogLevel null PM Filter AddFilterb PM PM PM PM FunctionResultAggregatorOptions PM PM BatchSize PM FlushTimeout PM IsEnabled true PM PM SingletonOptions PM PM LockPeriod PM ListenerLockPeriod PM LockAcquisitionTimeout PM LockAcquisitionPollingInterval PM ListenerLockRecoveryPollingInterval PM PM HttpOptions PM PM DynamicThrottlesEnabled false PM MaxConcurrentRequests PM MaxOutstandingRequests PM RoutePrefix api PM PM Starting JobHost PM Starting Host HostIddesktop fquqd InstanceId d c b aaf aa f c ba Version ProcessId AppDomainId InDebugModeFalse InDiagnosticModeFalse FunctionsExtensionVersionnull PM Loading functions metadata PM functions loaded PM A host error has occurred during startup operation ef cd b c ba d d f PM MicrosoftAzureWebJobsScript Object reference not set to an instance of an object PM Stopping JobHost Value cannot be null Parameter name provider Application is shutting down PM Initialization cancellation requested by runtime Hosting environment Production Content root path C w scratch funcbot Now listening on Application started Press CtrlC to shut down PM Stopping host PM Host shutdown completed details Investigative information Please provide the following Local issue does not apply strike Timestamp Function App version or Function App name Function names as appropriate Invocation ID Region strike If you dont want to share your Function App name or Functions names on GitHub please be sure to provide your Invocation ID Timestamp and Region we can use this to look up your Function AppFunction Provide an invocation id per Function See the wiki for more details Repro steps Provide the steps required to reproduce the problem unzip funcbotzip run func host start crash Expected behavior Provide a description of the expected behavior Id expect the default template to just work Id expect a nice error message if something is wrong such that I could do something Actual behavior Provide a description of the actual behavior observed Ambiguous error message Known workarounds Provide a description of any known workarounds Use JS instead Related information Provide any related information Programming language used TypeScript Links to source funcbotzip Bindings used HTTP TriggerResponse Uncomment this if you want to include your source wrap it in details to make browsing easier details summarySourcesummary csharp public static async TaskHttpResponseMessage Run HttpTriggerAuthorizationLevelAuthLevelValue get post Route null HttpRequestMessage req TraceWriter log logInfoC HTTP trigger function processed a request parse query parameter string name reqGetQueryNameValuePairs FirstOrDefaultq stringCompareqKey name true Value Get request body dynamic data await reqContentReadAsAsyncobject Set name to query string or body data name name dataname return name null reqCreateResponseHttpStatusCodeBadRequest Please pass a name on the query string or in the request body reqCreateResponseHttpStatusCodeOK Hello name details Is your question related to a specific version If so please specify azure function version What language does your question apply to eg C JavaScript Java All nodejs Question Hi My scenario is I have an event hub which triggers an azure function The azure function in this case is a simple rule engine based on which an IoT hub is triggered Currently the problem that I am facing is I am initiating request to the event hub per seconds After processing around messages the azure function stops or freezes After restarting it it again processes another messages and then again freezes I am executing in batches using this block eventHubMessagesforEachmessage index Its hosted on a premium plan Is your question related to a specific version If so please specify V What language does your question apply to eg C JavaScript Java All Java Question I am unable to switch my Function Runtime Version to X from version I followed all recommendations in to update my function Heres my setting in pomxml plugin groupIdcommicrosoftazuregroupId artifactIdazurefunctionsmavenpluginartifactId configuration resourceGroupfunctionResourceGroupresourceGroup appNamefunctionAppNameappName regionfunctionAppRegionregion appSettings Run Azure Function from package file by default property nameWEBSITERUNFROMPACKAGEname value value property property nameFUNCTIONSEXTENSIONVERSIONname value value property appSettings configuration executions execution idpackagefunctionsid goals goalpackagegoal goals execution executions plugin As a side note I can get this to work in NET Core but my project must be in Java