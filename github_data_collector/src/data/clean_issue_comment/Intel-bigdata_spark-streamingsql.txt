 WARN taskresultgetter orgapachesparkschedulerTaskSetManager Lost task in stage TID bdhi javalangAssertionError assertion failed Failed to get records for sparkexecutorgroupFxyoNDww s mmeeventtopic after polling for at scalaPredefassertPredefscala at orgapachesparkstreamingkafka CachedKafkaConsumergetCachedKafkaConsumerscala at orgapachesparkstreamingkafka KafkaRDDKafkaRDDIteratornextKafkaRDDscala at orgapachesparkstreamingkafka KafkaRDDKafkaRDDIteratornextKafkaRDDscala at scalacollectionIteratoranon nextIteratorscala at scalacollectionIteratoranon hasNextIteratorscala at scalacollectionIteratoranon hasNextIteratorscala at scalacollectionIteratoranon hasNextIteratorscala at scalacollectionIteratoranon hasNextIteratorscala at scalacollectionIteratoranon hasNextIteratorscala at orgapachesparksqlDataFrameanonfuntoJSON anon hasNextDataFramescala at orgapachesparksqlDataFrameanonfuntoJSON anon nextDataFramescala at orgapachesparksqlDataFrameanonfuntoJSON anon nextDataFramescala at scalacollectionIteratorclassforeachIteratorscala at orgapachesparksqlDataFrameanonfuntoJSON anon foreachDataFramescala at scalacollectiongenericGrowableclasspluspluseqGrowablescala at scalacollectionmutableListBufferpluspluseqListBufferscala at scalacollectionmutableListBufferpluspluseqListBufferscala at scalacollectionTraversableOnceclasstoTraversableOncescala at orgapachesparksqlDataFrameanonfuntoJSON anon toDataFramescala at scalacollectionTraversableOnceclasstoListTraversableOncescala at orgapachesparksqlDataFrameanonfuntoJSON anon toListDataFramescala at comasiainfoocdpstreamlabelLabelManageranonfunexecLabels applyLabelManagerscala at comasiainfoocdpstreamlabelLabelManageranonfunexecLabels applyLabelManagerscala at orgapachesparkrddRDDanonfunmapPartitions anonfunapply applyRDDscala at orgapachesparkrddRDDanonfunmapPartitions anonfunapply applyRDDscala at orgapachesparkrddMapPartitionsRDDcomputeMapPartitionsRDDscala at orgapachesparkrddRDDcomputeOrReadCheckpointRDDscala at orgapachesparkCacheManagergetOrComputeCacheManagerscala at orgapachesparkrddRDDiteratorRDDscala at orgapachesparkrddMapPartitionsRDDcomputeMapPartitionsRDDscala at orgapachesparkrddRDDcomputeOrReadCheckpointRDDscala at orgapachesparkrddRDDiteratorRDDscala at orgapachesparkrddMapPartitionsRDDcomputeMapPartitionsRDDscala at orgapachesparkrddRDDcomputeOrReadCheckpointRDDscala at orgapachesparkrddRDDiteratorRDDscala at orgapachesparkrddMapPartitionsRDDcomputeMapPartitionsRDDscala at orgapachesparkrddRDDcomputeOrReadCheckpointRDDscala at orgapachesparkrddRDDiteratorRDDscala at orgapachesparkschedulerShuffleMapTaskrunTaskShuffleMapTaskscala at orgapachesparkschedulerShuffleMapTaskrunTaskShuffleMapTaskscala at orgapachesparkschedulerTaskrunTaskscala at orgapachesparkexecutorExecutorTaskRunnerrunExecutorscala at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava at javalangThreadrunThreadjava always show this error but i cant find the reason Anyone meet this here is code val ssc new StreamingContextlocal test Duration val sc sscsparkContext val streamSqlContext new StreamSQLContextssc new SQLContextsc streamSqlContextcommand CREATE TEMPORARY TABLE kafka word string name string USING orgapachesparksqlstreamingsourcesKafkaSource OPTIONS zkQuorum xxxx groupId test topics test messageToRow orgapachesparksqlstreamingexamplesMessageDelimiter stripMargin streamSqlContextcommand CREATE TEMPORARY TABLE kafka word string name string USING orgapachesparksqlstreamingsourcesKafkaSource OPTIONS zkQuorum xxxxx groupId test topics test messageToRow orgapachesparksqlstreamingexamplesMessageDelimiter stripMargin val dataFrameDStream streamSqlContextsql SELECT t wordt namet name FROM kafka AS t JOIN kafka AS t ON t wordt word stripMargin dataFrameDStreamexplaintrue dataFrameDStreamforeachRDD r rforeachrow printrow sscstart sscawaitTerminationOrTimeout sscstop topictest input a row data eegg topictest input a row data eegg and print the plan Parsed Logical Plan Project unresolvedaliast wordunresolvedaliast nameunresolvedaliast name Join Inner Somet word t word UnresolvedRelation kafka Somet UnresolvedRelation kafka Somet Analyzed Logical Plan word string name string name string Project word name name Join Inner Someword word Subquery t Subquery kafka Relation word name KafkaRelation AppsbipwebpageaccessMapwebpageaccess NoneorgapachesparksqlstreamingexamplesMessageDelimiter e StructTypeStructFieldwordStringTypetrue StructFieldnameStringTypetrueorgapachesparksqlSQLContext ea Subquery t Subquery kafka Relation word name KafkaRelation AppsbipdolclientMapdolclient NoneorgapachesparksqlstreamingexamplesMessageDelimiter ec ecaStructTypeStructFieldwordStringTypetrue StructFieldnameStringTypetrueorgapachesparksqlSQLContext ea Optimized Logical Plan Project word name name Join Inner Someword word Relation word name KafkaRelation AppsbipwebpageaccessMapwebpageaccess NoneorgapachesparksqlstreamingexamplesMessageDelimiter e StructTypeStructFieldwordStringTypetrue StructFieldnameStringTypetrueorgapachesparksqlSQLContext ea Relation word name KafkaRelation AppsbipdolclientMapdolclient NoneorgapachesparksqlstreamingexamplesMessageDelimiter ec ecaStructTypeStructFieldwordStringTypetrue StructFieldnameStringTypetrueorgapachesparksqlSQLContext ea Physical Plan TungstenProject word name name SortMergeJoin word word TungstenSort word ASC false TungstenExchange hashpartitioningword ConvertToUnsafe PhysicalDStream word name orgapachesparkstreamingdstreamMappedDStreama d TungstenSort word ASC false TungstenExchange hashpartitioningword ConvertToUnsafe PhysicalDStream word name orgapachesparkstreamingdstreamMappedDStream a f d Code Generation true print the result nulleegg and throws exception javalangArrayIndexOutOfBoundsException at orgapachesparksqlcatalystexpressionsGenericInternalRowgenericGetrowsscala at orgapachesparksqlcatalystexpressionsBaseGenericInternalRowclassgetAsrowsscala at orgapachesparksqlcatalystexpressionsBaseGenericInternalRowclassisNullAtrowsscala at orgapachesparksqlcatalystexpressionsGenericInternalRowisNullAtrowsscala at orgapachesparksqlcatalystexpressionsGeneratedClassSpecificUnsafeProjectionapplyUnknown Source at orgapachesparksqlcatalystexpressionsGeneratedClassSpecificUnsafeProjectionapplyUnknown Source at scalacollectionIteratoranon nextIteratorscala at scalacollectionIteratoranon nextIteratorscala at orgapachesparkshufflesortBypassMergeSortShuffleWriterinsertAllBypassMergeSortShuffleWriterjava at orgapachesparkshufflesortSortShuffleWriterwriteSortShuffleWriterscala at orgapachesparkschedulerShuffleMapTaskrunTaskShuffleMapTaskscala at orgapachesparkschedulerShuffleMapTaskrunTaskShuffleMapTaskscala at orgapachesparkschedulerTaskrunTaskscala at orgapachesparkexecutorExecutorTaskRunnerrunExecutorscala at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava at javalangThreadrunThreadjava ERROR Executor Exception in task in stage TID I made the jar of project and trying to run my own defined streaming sql programusing hive context instead of sqlContext Im getting following exception when I registered the table Exception in thread main javalangNoClassDefFoundError orgapachesparksqlcatalystplanslogicalCreateTableAsSelect at orgapachesparksqlstreamingSchemaDStreaminitSchemaDStreamscala at orgapachesparksqlstreamingSchemaDStreaminitSchemaDStreamscala at orgapachesparksqlstreamingStreamSQLContextcreateSchemaDStreamStreamSQLContextscala at comyashtestcepOutliersFindermainOutliersFinderscala at comyashtestcepOutliersFindermainOutliersFinderscala at sunreflectNativeMethodAccessorImplinvoke Native Method at sunreflectNativeMethodAccessorImplinvokeNativeMethodAccessorImpljava at sunreflectDelegatingMethodAccessorImplinvokeDelegatingMethodAccessorImpljava at javalangreflectMethodinvokeMethodjava at orgapachesparkdeploySparkSubmitorgapachesparkdeploySparkSubmitrunMainSparkSubmitscala at orgapachesparkdeploySparkSubmitdoRunMain SparkSubmitscala at orgapachesparkdeploySparkSubmitsubmitSparkSubmitscala at orgapachesparkdeploySparkSubmitmainSparkSubmitscala at orgapachesparkdeploySparkSubmitmainSparkSubmitscala Caused by javalangClassNotFoundException orgapachesparksqlcatalystplanslogicalCreateTableAsSelect at javanetURLClassLoader runURLClassLoaderjava at javanetURLClassLoader runURLClassLoaderjava at javasecurityAccessControllerdoPrivilegedNative Method at javanetURLClassLoaderfindClassURLClassLoaderjava at javalangClassLoaderloadClassClassLoaderjava at javalangClassLoaderloadClassClassLoaderjava add support to apache spark add support to apache spark Hello I created a jar for this project and tried to execute the class UdafEnabledQuery I keep getting the following error Exception in thread main javalangNoClassDefFoundError orgapachesparksqlexecutionSparkPlan How do we resolve this Thank you Sai WARN TaskSetManager Lost task in stage TID xa engplatformlabibmcom javalangClassCastException javalangString cannot be cast to orgapachesparksqltypesUTF String 