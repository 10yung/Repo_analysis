Command runned sharphoundexe c group PrettyJson v OU OUXXOUXXDCXXDCcom d XXXXSkipPing Domain and OU changed to XX If i use other command i dont get any error but it never stops Emulating objects Let it run for over a month this also count if i use the ps nhandled Exception SystemAggregateException AggregateExceptionctorDefaultMessage SystemArgumentException Destination array is not long enough to copy all the required data Check array length and offset Parameter name binaryForm at SystemSecurityPrincipalSecurityIdentifierCreateFromBinaryFormByte binaryForm Int offset at Sharphound ExtensionsGetSidSearchResultEntry result at Sharphound ExtensionsResolveAdEntrySearchResultEntry result Boolean bypassDns at Sharphound EnumerationEnumerationRunnercDisplayClass StartRunnerb at SystemThreadingTasksTaskInnerInvoke at SystemThreadingTasksTaskExecute End of inner exception stack trace at SystemThreadingTasksTaskWaitAllTask tasks Int millisecondsTimeout CancellationToken cancellationToken at SystemThreadingTasksTaskWaitAllTask tasks Int millisecondsTimeout at SystemThreadingTasksTaskWaitAllTask tasks at Sharphound EnumerationEnumerationRunnerStartEnumeration at Sharphound SharphoundMainString args Inner Exception SystemArgumentException Destination array is not long enough to copy all the required data Check array length and offset Parameter name binaryForm at SystemSecurityPrincipalSecurityIdentifierCreateFromBinaryFormByte binaryForm Int offset at Sharphound ExtensionsGetSidSearchResultEntry result at Sharphound ExtensionsResolveAdEntrySearchResultEntry result Boolean bypassDns at Sharphound EnumerationEnumerationRunnercDisplayClass StartRunnerb at SystemThreadingTasksTaskInnerInvoke at SystemThreadingTasksTaskExecute sekurlsadcsync lsadumpdcsync As an example the following output is provided by PowerViews GetDomainObjectACL snipped ObjectDN CNXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXCNPoliciesCNSystemDCtestdom sDClocal ObjectSID ActiveDirectoryRights CreateChild DeleteChild ReadProperty WriteProperty GenericExecute BinaryLength AceQualifier AccessAllowed IsCallback False OpaqueLength AccessMask SecurityIdentifier S AceType AccessAllowed AceFlags ContainerInherit IsInherited False InheritanceFlags ContainerInherit PropagationFlags None AuditFlags None snipped But the SharpHound outputs json file looks like it Properties highvalue false domain TESTDOMLOCAL description null gpcpath testdomlocal SysVol testdomlocal Policies XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX Name VULN GPOTESTDOMLOCAL Guid XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX Aces PrincipalName DOMAIN ADMINSTESTDOMLOCAL PrincipalType group RightName Owner AceType PrincipalName DOMAIN ADMINSTESTDOMLOCAL PrincipalType group RightName WriteDacl AceType PrincipalName DOMAIN ADMINSTESTDOMLOCAL PrincipalType group RightName WriteOwner AceType PrincipalName ENTERPRISE ADMINSTESTDOMLOCAL PrincipalType group RightName WriteDacl AceType PrincipalName ENTERPRISE ADMINSTESTDOMLOCAL PrincipalType group RightName WriteOwner AceType As you can see the ACL for the group with SID S is not shown in the JSON file However this ACL gave me the possibility to edit it and exploit it to further move in the domain Ill check in SharpHounds code to see where it should be gathered Add pwdlastset and lastlogon on Computer nodes display map The hide info tab purposely hides pwdlastset for computers probably because it was considered useless Therefore accessing such info easily will help to detect potential AD configuration issues such as no automatic password change every days It would also help red teamers chosing a computer hash thats not going to expire tomorrow when building a silver ticket In a general way i think all infos should be displayed even when we think they have no purpose Hey guys Im trying to export a graph to JSON and it just does not work No errors How can I debug this Thanks Hello This simple query gives me all groups which have GenerilAll on all groups MATCH pmGroup rGenericAll tGroup RETURN mnameTYPErtname It works fine But this one which should do the same just for OUs gives me no results MATCH pmGroup rGenericAll tOU RETURN mnameTYPErtname Anyone know why The query will be more complex of course My thought is to exclude all groups which are privileged by default so that only normal groups are checked for privileges on OUs in the AD environment Thanks in advance Everyone is a wellknown Windows SID S that means all users DACLs can be set on AD objects to allow Everyone to perform security sensitive operations such as This DACL is properly collected by BloodHound which considers Everyone as a group but without any member as it is not really an AD group Therefore BloodHound fails to identify paths that could go through Everyone falsenegatives Proof that it is exploitable before and after enabling Full Control for Everyone Im wondering what is the better solution add special handling for this SID in cypher queries automatically populate this group with all objects as a special case at the end of import something else Hi BloodHound Team Fantastic work with the utility I use it extensively and increasingly use it to provide it as a service inside corporate environments This helps a lot of system administrators simply visualize and find problems faster within Active directory In order to provide BloodHound in this way I typically need to setup LDAP authentication against the Neo J database which works However the problem arises when users have the ability to tick Save Password in a LDAP scenario on the login page as BloodHound simply writes the plain text username and password into a file in their user profile for later retrieval Currently whenever a new BloodHound is released I rebuild it from source and remove the Save Password from the GUI which works It would be great if we could hide this box with some sort of configuration flag or alternatively encrypt the username and password on disk even encoding it somehow so people couldnt read it would be an improvement Thanks Hi You fixed the Export Graph functionality but now when I attempt to import the graph I just saved I get the following error bundlejs Uncaught TypeError ERRINVALIDARGTYPE The path argument must be one of type string Buffer or URL Received type undefined at readFile fsjs at fsreadFile electronjs casarjs at fsreadFile electronjs casarjs at tvalue bundlejs at lemit bundlejs at tvalue bundlejs at Objects bundlejs at h bundlejs at bundlejs at C bundlejs at P bundlejs at O bundlejs at j bundlejs at kn bundlejs at Ms bundlejs at Le bundlejs then it allows me to select the file to import but after that nothing happens Thanks