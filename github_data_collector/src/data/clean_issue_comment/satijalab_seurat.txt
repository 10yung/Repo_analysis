Hi Im interested in particular subset of gene expression in my dropseq dataset To correct for batch effect I first used FindIntegrationAnchors and IntegrateData to integrate the reads from different sequencing batches Then I ran FindAllMarkers but regardless the threshold I set even for logfcthreshold returnthresh I always got the markers from VariableFeatures I realized that the markers are only calculated from variable feature subset although on the documentation page it said it should be from all genes I wonder if it is due to the integrated data Because the genes Im interested are not in the variable features if there is anyway I can calculate markers from all genes Thanks Sylvia subsetobj idents Error subsetsubsetobj subset sample WT Error obj An object of class Seurat features across samples within assays Active assay SCT features other assay present Spatial dimensional reductions calculated pca harmony umap Hi I am encountering this error when I try Leidenalg Does anyone knows what is going on seu FindClustersseu algorithm randomseed resolution Error in leidenalgfindpartitionsnngraph leidenalgRBConfigurationVertexPartition attempt to apply nonfunction sessionInfo R version Platform x pclinuxgnu bit Running under Ubuntu LTS Matrix products default BLAS usrlibx linuxgnublaslibblasso LAPACK usrlibx linuxgnulapackliblapackso locale LCCTYPEenUSUTF LCNUMERICC LCTIMEenUSUTF LCCOLLATEenUSUTF LCMONETARYenUSUTF LCMESSAGESenUSUTF LCPAPERenUSUTF LCNAMEC LCADDRESSC LCTELEPHONEC LCMEASUREMENTenUSUTF LCIDENTIFICATIONC attached base packages parallel stats graphics grDevices utils datasets methods base other attached packages reticulate scales RColorBrewer slingshot Biobase BiocGenerics princurve dplyr plyr Seurat loaded via a namespace and not attached Rutils tidyselect RSQLite AnnotationDbi htmlwidgets grid BiocParallel Rtsne RNeXML munsell codetools mutoss ica miniUI future withr colorspace knitr uuid pspline zinbwave rstudioapi stats SingleCellExperiment ROCR ggsignif gbRd listenv NMF Rdpack labeling GenomeInfoDbData mnormt bit farver pheatmap rhdf vctrs THdata xfun R doParallel GenomeInfoDb rsvd locfit manipulateWidget bitops DelayedArray assertthat promises SDMTools multcomp gtable phylobase npsurv globals sandwich rlang genefilter zeallot splines lazyeval rgl BiocManager yaml reshape crosstalk backports httpuv tools gridBase ggplot gplots stabledist ggridges TFisher Rcpp base enc progress zlibbioc purrr RCurl prettyunits ggpubr pbapply cowplot S Vectors zoo SummarizedExperiment ggrepel cluster magrittr datatable RSpectra lmtest RANN mvtnorm fitdistrplus matrixStats gsl mime hms lsei evaluate xtable XML readxl shape IRanges gridExtra compiler tibble KernSmooth crayon Roo htmltools later pcaPP tidyr RcppParallel DBI howmany MASS rappdirs Matrix ade readr RmethodsS gdata metap igraph GenomicRanges pkgconfig rncl sn registry numDeriv locfdr plotly xml foreach annotate rngtools webshot pkgmaker multtest XVector bibtex stringr digest sctransform RcppAnnoy tsne copula ADGofTest softImpute rmarkdown cellranger leiden edgeR uwot kernlab shiny gtools lifecycle nlme jsonlite Rhdf lib clusterExperiment viridisLite limma pillar lattice fastmap httr plotrix survival glue png iterators glmnet bit HDF Array stringi blob memoise caTools irlba futureapply ape Hi Im using Seurat on a daily basis and came across an Error today that I havent gotten before and dont know how to solve When Im trying to plot eg using DimPlot or VariableFeaturePlot I get the following error Error in Calldecodec ascharactercolour alpha asintegerto Incorrect number of arguments expecting for decodec Ive tried simple things like restarting R reinstalling Seurat etc but nothing seems to work Have you seen this error before and know how to solve it Thanks Ida I ran across a bug in the package Seurat RStudio desktop running R when I work with a subset of my data newdatasubsetalldata cells chosen and run an analysis on newdata FindVariableFeatures ScaleData RunPCA RunUMAP DimPlot newdata calls the new umap coordinates however FeaturePlotnewdata nFeatureRNA calls the umap plot coordinates from the full dataset alldata rather than the revised plot This is resolved if I give the RunUMAP command a different output name and specify this in the FeaturePlot command RunUMAPnewdata dims c reductionname umapNew FeaturePlotnewdata nFeatureRNA reduction umapNew Hi when I ran FindTransferAnchors function to identify anchors between the scATACseq dataset and the scRNAseq dataset I met the same issue Error in dimnamesGetsx value invalid dimnames given for Graph object My command is transferanchors FindTransferAnchorsreference sample combinedsubset query xatac features variablegenes referenceassay RNA queryassay ACTIVITY reduction cca Here sample combinedsubset is a seurat object integrating two scRNA batches and xatac is a seurat object of scATACseq data Would you please show me how to fix it Thanks Hi I am attempting to project the allenreference onto a Seurat object created from multiple brain slices including Harmony correction Can you please advise on the following error For context the vignette data cortex worked correctly with this reference Thanks Alex anchors FindTransferAnchorsreference allenreference query obj normalizationmethod SCT Error All cells in the object being added must match the cells in this object In addition Warning message In Cellsx value Cellsx x longer object length is not a multiple of shorter object length obj An object of class Seurat features across samples within assays Active assay SCT features other assay present Spatial dimensional reductions calculated pca harmony umap allenreference An object of class Seurat features across samples within assays Active assay SCT features other assay present RNA dimensional reductions calculated pca umap sessionInfo R version Patched r Platform x pclinuxgnu bit Running under CentOS Linux Core Matrix products default BLASLAPACK SFSproductR centos x extlibsliblibopenblasnehalempr so locale LCCTYPEenUSUTF LCNUMERICC LCTIMEenUSUTF LCCOLLATEenUSUTF LCMONETARYenUSUTF LCMESSAGESenUSUTF LCPAPERenUSUTF LCNAMEenUSUTF LCADDRESSenUSUTF LCTELEPHONEenUSUTF LCMEASUREMENTenUSUTF LCIDENTIFICATIONenUSUTF attached base packages stats graphics grDevices utils datasets methods base other attached packages xlsx reticulate harmony Rcpp dplyr cowplot ggplot Seurat loaded via a namespace and not attached THdata Rtsne colorspace deldir ggridges spatstatdata leiden listenv npsurv ggrepel mvtnorm codetools splines RmethodsS mnormt lsei TFisher polyclip zeallot jsonlite rJava ica cluster png Roo uwot shiny sctransform compiler httr backports assertthat Matrix fastmap lazyeval later htmltools tools rsvd igraph gtable glue RANN reshape spatstat Biobase vctrs multtest gdata ape nlme crosstalk gbRd lmtest stringr xlsxjars globals mime lifecycle irlba gtools goftest future MASS zoo scales promises spatstatutils parallel sandwich RColorBrewer pbapply gridExtra rpart stringi mutoss plotrix caTools BiocGenerics bibtex Rdpack SDMTools rlang pkgconfig bitops lattice tensor ROCR purrr htmlwidgets tidyselect RcppAnnoy plyr magrittr R gplots multcomp withr mgcv pillar sn fitdistrplus abind survival tsne tibble futureapply crayon KernSmooth plotly grid datatable metap digest xtable tidyr httpuv numDeriv Rutils RcppParallel stats munsell viridisLite Hello I would like to run differential expression on the residuals from SCTransform following integration Integration was run using only a subset of features so I currently only have the residuals for a fraction of the total features in scaledata However I would like to perform the LRT using all genes Since the object was split by sample prior to SCTransform and integration the current residuals were calculated based on each sample independently Therefore running GetResidual on the integrated object generates different residuals for features that were originally calculated on the split object before SCTintegration Just wondering what is the most appropriate way of doing this Should I run GetResidual for all genes on the merged object and use these as input for differential expression or should I split the object again calculate residuals and then merge Thanks Marcus Hi all I have two different samples ctrl and yn I am trying to plot a Dotplot to show the changes in the expression levels of a given number of genes across the different clusters For some reason the average expression bar disappeared when picked colors red and green to plot the graph how do I bring it back the only bar showing is the Percent expressed I do not know how to bring back the average expression bar I thank you all in advance DotPlotMergedbig splitby yn cols cred green dotscale features revcgene gene RotatedAxis themeaxistext elementtextsize face bold When I used ReadH AD to read a h ad file generated from scanpy there was an error Pulling expression matrices and metadata Data is unscaled Error in file obs object of type environment is not subsettable Traceback and my code is adata ReadH ADfile adatarawh adverbose TRUE adatarawh ad information AnnData object with nobs nvars obs donor disease tissue celltype name protocol gseid ngenes var ncells When I used ReadH AD to read a smaller adatah ad x file it did not report an error AnnData object with nobs nvars obs batch celltype disease donor library name protocol gseid ngenes var ncells Does anyone give me some advice Thanks