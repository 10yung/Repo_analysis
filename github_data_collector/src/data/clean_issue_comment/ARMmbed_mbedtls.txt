getting an undefined reference to mbedtlsmdfile even if it is defined in the configh file Description This PR applies to IO callbacks used in ssl test suites and contains Fixed segmentation fault for some of sequences realized with mbedtlstestbuffer Changed behavior for nonblocking readwrite Previously the blocking error was used depending on blockingpatern which was preset by test designer Currently the blocking error for nonblocking functions is returned depending on whether buffer is empty or full Tests for both upper points Status READY Requires Backporting NO Migrations NO Todos Tests This PR is an implementation of IOTSSL It adds tests for a messagebased connection An additional layer of metadata is laid on the base of IO callbacks to perform as a message queue The receive function had to be modified to enable data dropping The changes themselves can be divided into two as are the tests for them The metadata layer only which can operate separately from the connection itself this lets the developers to approach it in a more TDD way The integration layer which uses the underlying mocked sendsreads and the metadata layer to provide a compound functionality hidden behind mbedtlsmessagesocketsetup mbedtlsmocktcpsendmsg mbedtlsmocktcprecvmsg and mbedtlsmessagesocketclose The only function thats used from the lower socket mock layer is mbedtlsmocksocketconnect but since if it was to be hidden the function that would be hiding it would only consist of a single line calling mbedtlsmocksocketconnect I figured it wouldnt be necessary especially for tests Description Move dummy rounds to the startend of the AES calculations This PR is made on top of Status READY Description Type Bug Priority Minor Raised in the forum by David Timber Bug mbed TLS build Version Expected behavior No typo in function description Actual behavior typo Load reasonnable default SSL configuration values Description This PR add test for prescribed states of handshake and gives endpoint structure which allows to future SSL communication simulation with the custom IO callbacks Status READY Requires Backporting NO Todos Tests Is there any reason why IP and URI subject names arent supported Description Type Bug Priority Minor Raised in the forum by pii Bug OS Android mbed TLS build Version OS version Androidsdkndkbundletoolchainsllvmprebuiltdarwinx Expected behavior Build finishes without any warning Actual behavior Build warning because neither if definedsocklentdefined definedSOCKLENT definedSOCKLENTDECLARED definedDEFINEDsocklent is defined Externalbuildareambedtls librarynetsocketsc warning passing int to parameter of type socklent aka unsigned int converts between pointers to integer types with different sign Wpointersign void type typelen UserspiLibraryAndroidsdkndkbundletoolchainsllvmprebuiltdarwinx sysrootusrincludesyssocketh note passing argument to parameter valuelength here socketcall int getsockoptint fd int level int option void value socklent valuelength Externalbuildareambedtls librarynetsocketsc warning passing int to parameter of type socklent aka unsigned int converts between pointers to integer types with different sign Wpointersign struct sockaddr clientaddr n getsockopt receives socklent aka unsigned int however since none of the precompilation checks is defined int is sent as parameter Description This PR fixes a gap in our testing we didnt test any build with zlib for TLS record compression enabled This is a deprecated option but it should nonetheless be tested until its removed for real The usefulness of these tests is illustrated by the fact that in their absence we introduced a bug in that caused us to fail to build with zlib enabled Status READY Requires Backporting This is the backport of Migrations NO Additional comments No ChangeLog entry as this is only a change in tests not in the library Steps to test or reproduce testsscriptsallsh testzlib Description This PR fixes a gap in our testing we didnt test any build with zlib for TLS record compression enabled This is a deprecated option but it should nonetheless be tested until its removed for real The usefulness of these tests is illustrated by the fact that in their absence we introduced two bug in that caused us to fail to build or run with zlib enabled plus another one that was found by the tests and is fixed in this PR Dependencies This PR is based on which fixes a bug in building with zlib the added test obviously wouldnt pass without that fix Status READY Requires Backporting Yes for the tests the bugfix is only applicable to development the LTS branches are free from the bug as the tests show x Mbed TLS x Mbed TLS Migrations NO Additional comments No ChangeLog entry as this is only a change in tests not in the library and the runtime bug probably doesnt need it own entry as it was hidden by the compile bug Steps to test or reproduce Run testsscriptsallsh testzlib and observe the result in particular the two lines with Default compression enabled in the output of ssloptsh 