csharp public class ProxyHttpClientFactory HttpClientFactory private string proxyUrl public ProxyHttpClientFactorystring proxyUrl proxyUrl proxyUrl protected override HttpMessageHandler CreateHandlerCreateHttpClientArgs args var proxy new WebProxyproxyUrl true UseDefaultCredentials true return new HttpClientHandler UseProxy true Proxy proxy var service new DriveServicenew BaseClientServiceInitializer HttpClientInitializer credential ApplicationName Automation App HttpClientFactory new ProxyHttpClientFactory I got a SystemNetSocketsSocketException error We are experiencing a error when a page tries to connect to a Google Sheet via service account The same code and authentication works on a different server so we suspect our proxy may be the problem The proxy is defined in the main webconfig is there a way to set the proxy host specific to the library Thanks Stacktrace SystemNetHttpHttpRequestException An error occurred while sending the request SystemNetWebException The remote server returned an error Forbidden at SystemNetHttpWebRequestEndGetRequestStreamIAsyncResult asyncResult TransportContext context at SystemNetHttpHttpClientHandlerGetRequestStreamCallbackIAsyncResult ar End of inner exception stack trace at GoogleApisHttpConfigurableMessageHandlerSendAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeCompilerServicesTaskAwaiterThrowForNonSuccessTask task at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at GoogleApisAuthOAuth RequestsTokenRequestExtenstionsExecuteAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeCompilerServicesTaskAwaiterThrowForNonSuccessTask task at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at GoogleApisAuthOAuth ServiceAccountCredentialRequestAccessTokenAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeCompilerServicesTaskAwaiterThrowForNonSuccessTask task at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at GoogleApisAuthOAuth TokenRefreshManagerRefreshTokenAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at GoogleApisAuthOAuth TokenRefreshManagerResultWithUnwrappedExceptions T Task task at GoogleApisAuthOAuth TokenRefreshManagercGetAccessTokenForRequestAsyncb Task task at SystemThreadingTasksContinuationResultTaskFromResultTask InnerInvoke at SystemThreadingTasksTaskExecute End of stack trace from previous location where exception was thrown at SystemRuntimeCompilerServicesTaskAwaiterThrowForNonSuccessTask task at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at GoogleApisAuthOAuth TokenRefreshManagerGetAccessTokenForRequestAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeCompilerServicesTaskAwaiterThrowForNonSuccessTask task at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at GoogleApisAuthOAuth ServiceAccountCredentialGetAccessTokenForRequestAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeCompilerServicesTaskAwaiterThrowForNonSuccessTask task at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at GoogleApisAuthOAuth ServiceCredentialInterceptAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeCompilerServicesTaskAwaiterThrowForNonSuccessTask task at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at SystemRuntimeCompilerServicesTaskAwaiterValidateEndTask task at GoogleApisHttpConfigurableMessageHandlerSendAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeCompilerServicesTaskAwaiterThrowForNonSuccessTask task at SystemRuntimeCompilerServicesTaskAwaiterHandleNonSuccessAndDebuggerNotificationTask task at GoogleApisRequestsClientServiceRequest ExecuteUnparsedAsyncd MoveNext End of stack trace from previous location where exception was thrown at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow at GoogleApisRequestsClientServiceRequest Execute at ASPsismainssoboardingaspxcheckGoogleSheetObject registerId in omittedboardingaspxline Hello Im having some trouble updating SMIME for a user via the NET SDK for Gmail every attempt results in a Bad Request response Im attempting to implement this from PowerShell as part of my module PSGSuite but have not had much luck with this particular API Issue tracking this in that repo Checking through the documentation and source code for various SDK languages as well as the REST API itself isnt too helpful as it appears the NET SDK is the only language that is expecting a String type for the Pkcs property on the SmimeInfo body object everything else expects the certificate bytes Attempting to pass in the byte array works but implicitly casts it to a single string which results in a Bad Request Ive also attempted to convert to both Base and URLSafeBase those fail with the same error Should the Pkcs property on the SMimeInfo object be expecting a Byte type instead of String Is there something Im doing wrong here I want to exchange the authorization code for an access token on a server side The web client sends authorization code Which classes do I have to use On this link there is only samples for Java and python I posted about this issue over on StackOverflow here Im running into an issue trying to send an email request from within a Unity D C script I am attempting to send email via the NET API for GMail from within a Unity D script Unfortunately Im having some trouble The following code is called whenever I press the R key ingame MEMBERS INCLUDED AT TOP OF CLASS TextAsset credFile static String AppName RedactedAppname Liststring Scopes new Liststring GMAILSEND if InputGetKeyDownKeyCodeR UserCredential emailerCredential Create Credential using MemoryStream credStream new MemoryStreamcredFilebytes string credPath tokenjson emailerCredential GoogleWebAuthorizationBrokerAuthorizeAsync GoogleClientSecretsLoadcredStreamSecrets Scopes myDoubleCheckedEmailAddressredactedcom CancellationTokenNone new FileDataStorecredPath trueResult Create Service using credential GmailService service new GmailServicenew BaseClientServiceInitializer HttpClientInitializer emailerCredential ApplicationName AppName Create Mail Message MailMessage message new MailMessage myDoubleCheckedEmailAddressredactedcom DoubleCheckedTOEmailAddressredactedcom Test Email Using GMail API This is a test of the emergency llama system Create Gmail Message Message emailmsg new Message ConvertMail Message to URL Encoded Base string and feed it into Gmail message emailmsgRaw HttpUtilityUrlEncodeConvertToBase StringEncodingASCIIGetBytesmessageToString string userId myDoubleCheckedEmailAddressredactedcom serviceUsersMessagesSendemailmsg userIdExecute As a result of this code I end up with the following exception ArgumentException Path userIdmessagessend misses a userId parameter UnityLoaderjs Parameter name userIdmessagessend UnityLoaderjs at GoogleApisRequestsRequestBuilderBuildRestPath x in UnityLoaderjs End of stack trace from previous location where exception was thrown UnityLoaderjs at SystemRuntimeExceptionServicesExceptionDispatchInfoThrow x in I believe that the Request builder is building userId into the REST request instead of inserting the actual username Looking for someone with more experience to confirmdeny this Is this a bug or am I doing it wrong I got this exception on EnvironmentsResourcelist method NewtonsoftJsonJsonSerializationException Error converting value AM to type GoogleApisTagManagerv DataTimestamp My method public Environment GetStagingEnvironment var envResponse environmentsResourceListConfigurationManagerAppSettings GTMApiURL Execute return envResponseEnvironmentSingleOrDefaultc cName Staging GoogleApisTagManagerv DataEnvironment Class Summary Represents a Google Tag Manager Environment Note that a user can create delete and update environments of type USER but can only update the enabledebug and url fields of environments of other types public class Environment IDirectResponseSchema public Environment Summary Default preview page url for the environment JsonPropertyurl public virtual string Url get set Summary The type of this environment JsonPropertytype public virtual string Type get set Summary Auto generated link to the tag manager UI JsonPropertytagManagerUrl public virtual string TagManagerUrl get set Summary GTM Environments API relative path JsonPropertypath public virtual string Path get set Summary The environment display name Can be set or changed only on USER type environments JsonPropertyname public virtual string Name get set Summary The fingerprint of the GTM environment as computed at storage time This value is recomputed whenever the environment is modified JsonPropertyfingerprint public virtual string Fingerprint get set Summary Represents a link to a quick preview of a workspace JsonPropertyworkspaceId public virtual string WorkspaceId get set Summary GTM Environment ID uniquely identifies the GTM Environment JsonPropertyenvironmentId public virtual string EnvironmentId get set Summary The environment description Can be set or changed only on USER type environments JsonPropertydescription public virtual string Description get set Summary Represents a link to a container version JsonPropertycontainerVersionId public virtual string ContainerVersionId get set Summary GTM Container ID JsonPropertycontainerId public virtual string ContainerId get set Summary The last update timestamp for the authorization code JsonPropertyauthorizationTimestamp public virtual Timestamp AuthorizationTimestamp get set Summary The environment authorization code JsonPropertyauthorizationCode public virtual string AuthorizationCode get set Summary GTM Account ID JsonPropertyaccountId public virtual string AccountId get set Summary Whether or not to enable debug by default for the environment JsonPropertyenableDebug public virtual bool EnableDebug get set Summary The ETag of the item public virtual string ETag get set If one may want to use a custom HttpClienthandler for ex to use Http or a proxy like socks sharpIHttpClientFactory has to be implemented The easiest way to do this would be to inherit from HttpClientFactory and override CreateSimpleClientHandler But currently it is not virtual and not overridable I would ask you kindly to fix this issue This comes from Basically this would involve creating a filewatching or possibly polling credential implementation so that if the service account file changes we pick up on those changes automatically We should consult with other language teams before implementing in order to come up with a consistent approach Using dotnet core version Preview results in the error SystemReflectionReflectionTypeLoadException Unable to load one or more of the requested types Method GetFallbackPolicyAsync in type GoogleApisAuthAspNetCoreGoogleScopedPolicyProvider from assembly GoogleApisAuthAspNetCore Version Cultureneutral PublicKeyToken b fa e db ab does not have an implementation What I am trying to do is pull back blog posts first and then I want to integrate with some other APIs I do have the latest GoogleApis libraries from NuGet It was working with Preview but ASPNET core has a new code that is replacing function in razor pages The full trace is at SystemReflectionRuntimeModuleGetTypesRuntimeModule module at SystemReflectionRuntimeAssemblygetDefinedTypes at MicrosoftAspNetCoreMvcApplicationPartsAssemblyPartgetTypes at MicrosoftAspNetCoreMvcControllersControllerFeatureProviderPopulateFeatureIEnumerable parts ControllerFeature feature at MicrosoftAspNetCoreMvcApplicationPartsApplicationPartManagerPopulateFeature TFeature TFeature feature at MicrosoftAspNetCoreMvcApplicationModelsControllerActionDescriptorProviderGetControllerTypes at MicrosoftAspNetCoreMvcApplicationModelsControllerActionDescriptorProviderGetDescriptors at MicrosoftAspNetCoreMvcApplicationModelsControllerActionDescriptorProviderOnProvidersExecutingActionDescriptorProviderContext context at MicrosoftAspNetCoreMvcInfrastructureDefaultActionDescriptorCollectionProviderUpdateCollection at MicrosoftAspNetCoreMvcInfrastructureDefaultActionDescriptorCollectionProviderInitialize at MicrosoftAspNetCoreMvcInfrastructureDefaultActionDescriptorCollectionProviderGetChangeToken at MicrosoftAspNetCoreMvcRoutingActionEndpointDataSourceBasecDisplayClass Subscribeb at MicrosoftExtensionsPrimitivesChangeTokenChangeTokenRegistration ctorFunc changeTokenProducer Action changeTokenConsumer TState state at MicrosoftExtensionsPrimitivesChangeTokenOnChangeFunc changeTokenProducer Action changeTokenConsumer at MicrosoftAspNetCoreMvcRoutingActionEndpointDataSourceBaseSubscribe at MicrosoftAspNetCoreMvcRazorPagesInfrastructurePageActionEndpointDataSourcectorIActionDescriptorCollectionProvider actions ActionEndpointFactory endpointFactory at SystemRuntimeMethodHandleInvokeMethodObject target Object arguments Signature sig Boolean constructor Boolean wrapExceptions at SystemReflectionRuntimeConstructorInfoInvokeBindingFlags invokeAttr Binder binder Object parameters CultureInfo culture at MicrosoftExtensionsDependencyInjectionServiceLookupCallSiteRuntimeResolverVisitConstructorConstructorCallSite constructorCallSite RuntimeResolverContext context at MicrosoftExtensionsDependencyInjectionServiceLookupCallSiteVisitor VisitCallSiteMainServiceCallSite callSite TArgument argument at MicrosoftExtensionsDependencyInjectionServiceLookupCallSiteRuntimeResolverVisitCacheServiceCallSite callSite RuntimeResolverContext context ServiceProviderEngineScope serviceProviderEngine RuntimeResolverLock lockType at MicrosoftExtensionsDependencyInjectionServiceLookupCallSiteRuntimeResolverVisitRootCacheServiceCallSite singletonCallSite RuntimeResolverContext context at MicrosoftExtensionsDependencyInjectionServiceLookupCallSiteVisitor VisitCallSiteServiceCallSite callSite TArgument argument at MicrosoftExtensionsDependencyInjectionServiceLookupCallSiteRuntimeResolverResolveServiceCallSite callSite ServiceProviderEngineScope scope at MicrosoftExtensionsDependencyInjectionServiceLookupDynamicServiceProviderEnginecDisplayClass RealizeServiceb ServiceProviderEngineScope scope at MicrosoftExtensionsDependencyInjectionServiceLookupServiceProviderEngineGetServiceType serviceType ServiceProviderEngineScope serviceProviderEngineScope at MicrosoftExtensionsDependencyInjectionServiceLookupServiceProviderEngineGetServiceType serviceType at MicrosoftExtensionsDependencyInjectionServiceProviderGetServiceType serviceType at MicrosoftExtensionsDependencyInjectionServiceProviderServiceExtensionsGetService T IServiceProvider provider at MicrosoftAspNetCoreBuilderRazorPagesEndpointRouteBuilderExtensionsEnsureRazorPagesServicesIEndpointRouteBuilder endpoints at MicrosoftAspNetCoreBuilderRazorPagesEndpointRouteBuilderExtensionsMapFallbackToPageIEndpointRouteBuilder endpoints String page I am trying to use google net client from a serverside Blazor application but I cant get it to work If I use GoogleWebAuthorizationBroker it works while running on local but not when deployed to Azure or IIS The other alternative I tried is using GoogleAuthorizationCodeFlow but that is for ASPNET MVC If anyone have some recommendation or sample on how to make this work with ServerSide Blazor Application it will be very helpful 