your PnL calculation for the exit scenario is wrong python elif abszscore i money countS S i S i countS count not sure what you are resetting count for since it was never used in the code and why is countS making a negative impact to PnL if you fix these two issues the strategy is not profitable at all In cell can you make the print statement python compatible the rest of the print statements are Also in cell Adj Close should be adjClose On the notebook Integration Cointegration The chart just above the title Testing for cointegration is wrong on the github preview I think it just needs reuploading This is mine In block we have obtained aic order But why do we end up with the conclusion that the best fit is ARIMA then Shouldnt it be ARIMA 