i need to testing the InvokePasswordSprayEWS but using list of password and single username command will connect to the Exchange Web Services server at and attempt to password spray a list of password with a single username i cannot make the changes in this code so please help me I just jumped into my local code base of MailSniper and added this before every InvokeWebRequest NetServicePointManager SecurityProtocol NetSecurityProtocolType Ssl bor NetSecurityProtocolType Ssl bor NetSecurityProtocolType Tls bor NetSecurityProtocolType Tls bor NetSecurityProtocolType Tls Been useful for engagements where the client has had older systems in play Using latest release dl today running under Powershell on Win both elevated and nonelevated on importmodule Im seeing multiple errors such as operator reserved for future use and ampersand character not allowed unexpected tokens and missing file specs after redirection Im sure its something basic with powershell perhaps it needs bit vs bit Need an older version Something to modify in source file Suggestions would be appreciated Thanks Steve Updated GetGlobalAddressList to use more granular queries in ResolveName if required to avoid incomplete results due to result limit Output two likely domain names and modify regex to account for domain names containing underscores base decoded SystemTextEncoding UnicodeGetString SystemConvert FromBase Stringwwwheader Modify regex to match on underscoresx F to accomodate domain names like domainname commasep base decoded replace x x x x A x x A x F ntlmresparray ntlmresparray commasep split Include array index as a viable domain name WriteHost The domain appears to be ntlmresparray or ntlmresparray I am getting following error when running InvokePasswordSprayEWS InvokePasswordSprayEWS ExchHostname outlookoffice com UserList userlisttxt Password Pssw rd Threads OutFile ewssprayed txt Exception calling ctor with arguments Cannot process argument because the value of argument userName is not valid Change the value of the userName argument and run the operation again CategoryInfo InvalidOperation NewObject MethodInvocationException FullyQualifiedErrorId ConstructorInvokedThrowExceptionMicrosoftPowerShellCommandsNewObjectCommand PSComputerName localhost You cannot call a method on a nullvalued expression CategoryInfo InvalidOperation RuntimeException FullyQualifiedErrorId InvokeMethodOnNull PSComputerName localhost PS C demo psversiontable Name Value PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion in userlisttxt I have two usernames johndoemydomaincom johnhuttonmydomaincom Hi I came accross your tool a few days ago and it looks great Im having some trouble getting it to work though Im currently testing with my AD user account to ensure that it exists and works When I import the module and run the InvokeSelfSearch command I get this output PS C Users Desktop powershell MailSniper InvokeSelfSearch Mailbox testexamplecom Trying Exchange version Exchange Autodiscovering email server for testexamplecom PS C Users Desktop powershell MailSniper I tried setting the Exchange server explicitly tried all the versions etc I dont get any additionnal output to point me in the right direction Do you have any ideas Thanks PowerShell uses TLS by default in older versions which doesnt work with some websites Apparently Microsoft is enforcing TLS moving forward on their services This update also fixes Having some trouble with the module looks like there is something missing in the code several places Havent seen this one before any ideas