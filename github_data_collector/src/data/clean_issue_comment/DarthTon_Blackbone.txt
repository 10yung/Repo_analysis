 sample auto handler AsmFactoryGetAssembler auto asmCore handler asmCorejmpasmCoreintptrptrabsMAXDWORD auto func reinterpretcastvoidasmCoremake printfssize zu n asmCoregetCodeSize printfshex code for sizet i i asmCoregetCodeSize i printfs X reinterpretcastPBYTEfunc i x Compile size hex code FF x Compile size hex code FF jmp a ff bit absolute jmp rel a ff e ff ff ff RIP bit displacement jmp rdi ff base pointer jmp rdi rsi a ff a b base pointer index displacement OS Win x Compile x samlpe code blackboneProcess process ASSERTNTSUCCESSprocessAttachGetCurrentProcess auto m processmodulesGetMainModule m empty First error if procbarrierx OS Maybe it should be procbarrier TargetWow Second error The cause of the error is because NativeWow ReadProcessMemoryT hProcess GetCurrentProcess return STATUSINVALIDHANDLE Maybe when true targetWow or GetCurrentProcess hProcess call ReadProcessMemory is better associate ReadProcessMemoryT WriteProcessMemoryT QueryProcessInfoT The asmjit in the project is obsolete and some required instructions are missing for example loop Hope you can update in your free time Failed to load BlackBone driver The request is not supported Is the error I get whenever I try to switch the the kernel apc inject option can I use blackboneDetour without knowing their typedefs or only when its running like is typedef struct PEB UCHAR InheritedAddressSpace UCHAR ReadImageFileExecOptions UCHAR BeingDebugged UCHAR BitField UINT PADDING Add PVOID Mutant PVOID ImageBaseAddress PPEBLDRDATA Ldr PVOID ProcessParameters PVOID SubSystemData PVOID ProcessHeap PVOID FastPebLock PVOID AtlThunkSListPtr PVOID IFEOKey PVOID CrossProcessFlags PVOID KernelCallbackTable ULONG SystemReserved ULONG AtlThunkSListPtr PVOID ApiSetMap PEB PPEB struct PEB union struct BYTE InheritedAddressSpace x BYTE ReadImageFileExecOptions x BYTE BeingDebugged x BYTE SYSTEMDEPENDENT x flags QWORD dummyalign dword QWORD Mutant x QWORD ImageBaseAddress x PTR Ldr x PTR ProcessParameters x pointer to RTLUSERPROCESSPARAMETERS QWORD SubSystemData x QWORD ProcessHeap x QWORD FastPebLock x QWORD SYSTEMDEPENDENT x QWORD SYSTEMDEPENDENT x QWORD SYSTEMDEPENDENT x L add dummy byte add uchar byte bit peb type address calculation is weird bytes are missing source code typedef struct PEB UCHAR InheritedAddressSpace UCHAR ReadImageFileExecOptions UCHAR BeingDebugged UCHAR BitField x Padding UChar Padding Add Data PVOID Mutant PVOID ImageBaseAddress PPEBLDRDATA Ldr x Error offset No Error Offset x PVOID ProcessParameters PVOID SubSystemData PVOID ProcessHeap PVOID FastPebLock PVOID AtlThunkSListPtr PVOID IFEOKey PVOID CrossProcessFlags PVOID KernelCallbackTable ULONG SystemReserved ULONG AtlThunkSListPtr PVOID ApiSetMap PEB PPEB dt ntdllPEB x InheritedAddressSpace UChar x ReadImageFileExecOptions UChar x BeingDebugged UChar x BitField UChar x ImageUsesLargePages Pos Bit x IsProtectedProcess Pos Bit x IsImageDynamicallyRelocated Pos Bit x SkipPatchingUser Forwarders Pos Bit x IsPackagedProcess Pos Bit x IsAppContainer Pos Bit x IsProtectedProcessLight Pos Bit x IsLongPathAwareProcess Pos Bit x Padding UChar Padding data Add x Mutant Ptr Void x ImageBaseAddress Ptr Void x Ldr Ptr PEBLDRDATA x ProcessParameters Ptr RTLUSERPROCESSPARAMETERS x SubSystemData Ptr Void x ProcessHeap Ptr Void x FastPebLock Ptr RTLCRITICALSECTION x AtlThunkSListPtr Ptr SLISTHEADER x IFEOKey Ptr Void x CrossProcessFlags Uint B x ProcessInJob Pos Bit x ProcessInitializing Pos Bit x ProcessUsingVEH Pos Bit x ProcessUsingVCH Pos Bit x ProcessUsingFTH Pos Bit x ProcessPreviouslyThrottled Pos Bit x ProcessCurrentlyThrottled Pos Bit x ReservedBits Pos Bits x Padding UChar x KernelCallbackTable Ptr Void x UserSharedInfoPtr Ptr Void x SystemReserved Uint B x AtlThunkSListPtr Uint B x ApiSetMap Ptr Void Besides Windows I worked very well when I tried manualmapping using xenos and blackbone However mmap does not work after Windows xenos printed out error code xC Please share the information you know about this problem up date