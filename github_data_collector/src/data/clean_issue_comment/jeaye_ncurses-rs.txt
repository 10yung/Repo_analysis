When compiling ncspot from git I have this linker error at the end pe lxcbxfixes lncursesw ltinfo lutil lutil ldl lrt lpthread lgccs lc lm lrt lpthread lutil lutil note usrlib gccx suselinux x suselinuxbinld homeaplanasncspottargetreleasedepslibncurses c c be rlibncurses c c be ncurses tisobd cgu rcguo in function ncursesconstantsCOLORS ncurses tisobd cgu textZN ncurses constants COLORS h f c a E x undefined reference to COLORS collect error ld returned exit status I have openSUSE Tumbleweed rpm qa grep ncurses ncursesdevel x ncursesutils x libncurses x rpm qa grep terminfo terminfoscreen x terminfo x terminfobase x Hi Im masahikoofgp I tried using the example of ncursesrs However since printw was displayed as being deprecated I changed printw to addstr Im sorry if it was unnecessary my environment Manjaro Linux Rust edition Using the FFI is unsafe but simply putting unsafe around the call is not enough to get rid of the problem Its unsafe for a reason Its unsafe because it can do horrible things and cause UB You need to adjust the library so that only functions that cannot possibly cause UB no matter what are wrapped in an unsafe block and marked as safe All other functions must be left as unsafe functions hopefully with explanations in the docs of what to do to avoid problems example I have run ex rs sample with valgrind tool LEAK SUMMARY definitely lost bytes in blocks indirectly lost bytes in blocks possibly lost bytes in blocks still reachable bytes in blocks suppressed bytes in blocks For counts of detected and suppressed errors rerun with v ERROR SUMMARY errors from contexts suppressed from Cannot crosscompile ncursesrs because it compiles test program for armv and tries to execute it on x How to disable that vlisivkavlisivka ncursesrs TARGETCCoptscel sysrootsx scelsdklinuxusrbinarmscellinuxgnueabiarmscellinuxgnueabigcc TARGETCFLAGSsysrootoptscel sysrootsarmv ahfneonscellinuxgnueabi mcpucortexa mfpuneon mfloatabihard marm RUSTBACKTRACE cargo build example ex target armv unknownlinuxgnueabihf Compiling ncurses v homevlisivkatmprustuincursesrs error failed to run custom build command for ncurses v homevlisivkatmprustuincursesrs process didnt exit successfully homevlisivkatmprustuincursesrstargetdebugbuildncursesb d a a c b buildscriptbuild exit code stdout cargorerunifenvchangedPKGCONFIGPATH cargorustclinklibncurses OPTLEVEL Some TARGET Somearmv unknownlinuxgnueabihf HOST Somex unknownlinuxgnu CCarmv unknownlinuxgnueabihf None CCarmv unknownlinuxgnueabihf None TARGETCC Someoptscel sysrootsx scelsdklinuxusrbinarmscellinuxgnueabiarmscellinuxgnueabigcc CFLAGSarmv unknownlinuxgnueabihf None CFLAGSarmv unknownlinuxgnueabihf None TARGETCFLAGS Somesysrootoptscel sysrootsarmv ahfneonscellinuxgnueabi mcpucortexa mfpuneon mfloatabihard marm CRATECCNODEFAULTS None DEBUG Sometrue CARGOCFGTARGETFEATURE None stderr thread main panicked at homevlisivkatmprustuincursesrstargetarmv unknownlinuxgnueabihfdebugbuildncurses eeeed b outchtypesize failed Os code kind Other message Exec format error srclibcoreresultrs stack backtrace stdsysunixbacktracetracingimpunwindbacktrace at srclibstdsysunixbacktracetracinggccsrs stdsyscommonbacktraceprint at srclibstdsyscommonbacktracers stdpanickingdefaulthookclosure at srclibstdsyscommonbacktracers at srclibstdpanickingrs stdpanickingdefaulthook at srclibstdpanickingrs stdpanickingrustpanicwithhook at srclibstdpanickingrs stdpanickingcontinuepanicfmt at srclibstdpanickingrs rustbeginunwind at srclibstdpanickingrs corepanickingpanicfmt at srclibcorepanickingrs coreresultunwrapfailed at rustcfc f b b b ff d a srclibcoremacrosrs coreresultResultT Eexpect at rustcfc f b b b ff d a srclibcoreresultrs buildscriptbuildcheckchtypesize at buildrs buildscriptbuildmain at buildrs stdrtlangstartclosure at rustcfc f b b b ff d a srclibstdrtrs stdpanickingtrydocall at srclibstdrtrs at srclibstdpanickingrs rustmaybecatchpanic at srclibpanicunwindlibrs stdrtlangstartinternal at srclibstdpanickingrs at srclibstdpanicrs at srclibstdrtrs stdrtlangstart at rustcfc f b b b ff d a srclibstdrtrs main libcstartmain at csulibcstartc start I tried to get it to work with Rust stable for days and had to find out that its unfortunately not possible right now All menu library functions are behind a feature gate meaning that ncursesrs as it is right now still compiles with Rust stable and wont break for anyone Its like an optin extra feature for those using rust nightly But if you really dont want any unstable code in ncursesrs you may also wait until the CString reform lands in Rust stable Originally posted by tsurai in Being new to Rust I cant be sure but it looks like CString is stable now Can we remove the nightly requirement Problems I encountered so far with this lib Msys ncurses is a bit different It needs includencursesncursesh or includencurseswncursesh And the deltion of the test binary doesnt work because exe is missing rust let bin format Pathnew outdirjoinchtypesizedisplay needs to be rust let bin format Pathnew outdirjoinchtypesizeexedisplay Currently on macOS HighSierra Version Trying to get example to run properly but Im receiving this message when I try This example requires wide character support Which tells me that I probably havent set up ncursesw properly Heres what Ive done as per the readme brew install ncurses brew link force ncurses cargo run example ex What am I missing here Are there additional steps I should be taking to get this to work Trying to install following these instructions Receiving the following build error cargo build Compiling pkgconfig v Compiling randcore v Compiling libc v Compiling gcc v Compiling rand v Compiling ncurses v error E mismatched types homesamuelcargoregistrysrcgithubcom ecc db ec ncurses buildrs if let Somelib ncurseslib expected reference found enum stdoptionOption note expected type stdoptionOptionpkgconfigLibrary found type stdoptionOption error aborting due to previous error error Could not compile ncurses warning build failed waiting for other jobs to finish error build failed Any ideas Hi Jeaye I recently ran into a segmentation fault when displaying text from a file with ncurses After playing around a bit I found out that percentage signs in the strings to be displayed caused this behaviour Now Im wondering if this is a feature of which I havent heard before or if it is a bug If its a feature the could you please point me to some doc I can study I found the following funny output When my string contains p then something that looks like an address is printed When my string contains s the whole string seems to be repeated where the s is When my string contains twice a s I get the segmentation fault maybe some recursion Heres an example to reproduce uncommenting the killer line leads to segmenation fault extern crate ncurses fn main ncursesinitscr ncurseskeypadncursesstdscr true ncursesclear let texts vec Hello World A line with a p percentage sign Another funny s example The killer s s maybe a recursion Bye bye let mut y for t in texts ncursesmvprintwy t y ncursesgetch ncursesendwin This produces the following output Hello World A line with a x b d ae percentage sign Another funny Another funny s example example Bye bye I run all that on Fedora Linux Kind regards Peter