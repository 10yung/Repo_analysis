 Runed inside docker container bash runsh roottorchinstallbinluajit roottorchinstallsharelua treplinitlua module cunn not foundNo LuaRocks module found for cunn How to fix roottorchinstallbinlua mainlua expected near continue stack traceback C in function dofile torchinstalllibluarocksrockstreplscm binth in main chunk C ls txt roottorchinstallbinlua roottorchinstallsharelua torchFilelua read error read blocks instead of at roottorchpkgtorchlibTHTHDiskFilec stack traceback C in function read roottorchinstallsharelua torchFilelua in function roottorchinstallsharelua torchFilelua C in function read roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua nnModulelua in function read roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua nnModulelua in function read roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua nnModulelua in function read roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua torchFilelua in function load processlua in main chunk C in function dofile torchinstalllibluarocksrockstreplscm binth in main chunk C ls raw root ac abvrn root ac abvrn root ac abvrn root ac abvrn runsh roottorchinstallbinlua mainlua expected near continue stack traceback C in function dofile torchinstalllibluarocksrockstreplscm binth in main chunk C ls txt roottorchinstallbinlua roottorchinstallsharelua torchFilelua read error read blocks instead of at roottorchpkgtorchlibTHTHDiskFilec stack traceback C in function read roottorchinstallsharelua torchFilelua in function roottorchinstallsharelua torchFilelua C in function read roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua nnModulelua in function read roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua nnModulelua in function read roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua nnModulelua in function read roottorchinstallsharelua torchFilelua in function readObject roottorchinstallsharelua torchFilelua in function load processlua in main chunk C in function dofile torchinstalllibluarocksrockstreplscm binth in main chunk C ls raw Hi AaronJackson could you please help me Got this when runsh Followed your installation manual precisely homegladtorchinstallsharelua matioffilua libmatioso cannot open shared object file No such file or directory stack traceback C in function load homegladtorchinstallsharelua matioffilua in function homegladtorchinstallsharelua matioffilua C in function xpcall homegladtorchinstallsharelua matioffilua in main chunk C at x b a C in function pcall homegladtorchinstallsharelua treplinitlua in function require homegladtorchinstallsharelua matioinitlua in main chunk C at x b a C in function pcall homegladtorchinstallsharelua treplinitlua in function require homegladtorchinstallsharelua xluainitlua in function homegladtorchinstallsharelua xluainitlua C in function pcall homegladtorchinstallsharelua xluainitlua in function xrequire mainlua in main chunk C in function dofile gladtorchinstalllibluarocksrockstreplscm binth in main chunk C at x homegladtorchinstallsharelua treplinitlua homegladtorchinstallsharelua treplinitlua homegladtorchinstallsharelua matioffilua Could not find libmatio Please make sure that you installd MatIO and you have the shared libraries libmatioso or libmatiodylib in your library path warning matio could not be loaded is it installed homegladtorchinstallsharelua treplinitlua module npy th not foundNo LuaRocks module found for npy th no field packagepreload npy th no file homegladluarockssharelua npy thlua no file homegladluarockssharelua npy thinitlua no file homegladtorchinstallsharelua npy thlua no file homegladtorchinstallsharelua npy thinitlua no file homegladGoServerdistroinstallsharelua npy thlua no file homegladGoServerdistroinstallsharelua npy thinitlua no file npy thlua no file homegladGoServerdistroinstallshareluajit beta npy thlua no file usrlocalsharelua npy thlua no file usrlocalsharelua npy thinitlua no file homegladluarocksliblua npy thso no file homegladtorchinstallliblua npy thso no file homegladtorchinstalllibnpy thso no file homegladGoServerdistroinstalllibnpy thso no file homegladGoServerdistroinstallliblua npy thso no file npy thso no file usrlocalliblua npy thso no file usrlocalliblua loadallso warning npy th could not be loaded is it installed Scanning directory for data Found images images require a face detector Initialising python libs Initialising detector homegladtorchinstallbinluajit mainlua Invalid numpy data type stack traceback C in function detect mainlua in main chunk C in function dofile gladtorchinstalllibluarocksrockstreplscm binth in main chunk C at x runsh line croptmp Permission denied ls cannot access txt No such file or directory cat croptmp No such file or directory rm cannot remove croptmp No such file or directory THCudaCheck FAIL filehomegladtorchextracutorchlibTHCgenericTHCStoragecu line error out of memory homegladtorchinstallbinluajit homegladtorchinstallsharelua nnutilslua cuda runtime error out of memory at homegladtorchextracutorchlibTHCgenericTHCStoragecu stack traceback C in function resize homegladtorchinstallsharelua nnutilslua in function torchStoragetype homegladtorchinstallsharelua nnutilslua in function recursiveType homegladtorchinstallsharelua nnModulelua in function type homegladtorchinstallsharelua nnutilslua in function recursiveType homegladtorchinstallsharelua nnutilslua in function recursiveType homegladtorchinstallsharelua nnModulelua in function type homegladtorchinstallsharelua nnutilslua in function recursiveType homegladtorchinstallsharelua nnutilslua in function recursiveType homegladtorchinstallsharelua nnModulelua in function type homegladtorchinstallsharelua nnutilslua in function recursiveType homegladtorchinstallsharelua nnutilslua in function recursiveType homegladtorchinstallsharelua nnModulelua in function type homegladtorchinstallsharelua nnutilslua in function recursiveType homegladtorchinstallsharelua nnutilslua in function recursiveType homegladtorchinstallsharelua nnModulelua in function cuda processlua in main chunk C in function dofile gladtorchinstalllibluarocksrockstreplscm binth in main chunk C at x ls cannot access raw No such file or directory ImportError numpycoremultiarray failed to import hometangousrlocaltorchinstallbinluajit ngousrlocaltorchinstallsharelua treplinitlua ngousrlocaltorchinstallsharelua treplinitlua ngousrlocaltorchinstallsharelua treplinitlua Python error import numpy array module ImportError numpycoremultiarray failed to import Could you please help me AaronJackson hometangousrlocaltorchinstallbinluajit facedetectiondliblua Python error opaque ref call RuntimeError Unsupported image type must be bit gray or RGB image Hello I went through the threads about not being able to run vrnsh and getting a segmentation fault but I could not find a solution there After two weeks of trying to run the script I am giving up and reaching for help I installed a fresh Ubuntu for this purpose on an i machine with GeForce GTX I followed the install instructions to the letter including the supported CudaCudnn versions In particular the required Python libraries where installed this way in case the fresh installation comes with conflicting Python modules sudo apt remove pythonmatplotlib sudo apt remove pythonnumpy sudo apt autoremove pip install user dlib matplotlib numpy visvis imageio When everything finished I got the following error running vrnsh amineDellOptiplex Workvrn runsh runsh line Segmentation fault core dumped th mainlua model DFAN Wt input INPUT detectFaces true mode generate output INPUT device gpu outputFormat txt ls cannot access txt No such file or directory Found Environment variable CUDNNPATH usrlocalcudalib libcudnnso ls cannot access raw No such file or directory Stepping through the code in Torch yields amineDellOptiplex Workvrnfacealignment th mainlua Segmentation fault core dumped amineDellOptiplex Workvrnfacealignment th Torch Scientific computing for Lua Type for help th require torch Stuff s th require nn Stuff s th require nngraph Stuff s th require paths Stuff s th require image Stuff s th require xlua Stuff s th local utils require utils Fatal Python error ceval tstate mixup Segmentation fault core dumped Another Torch stepping right after the previous one yields Notice that the error tstate mixup disappears amineDellOptiplex Workvrnfacealignment th Torch Scientific computing for Lua Type for help th require torch Stuff s th require nn Stuff s th require nngraph Stuff s th require paths Stuff s th require image Stuff s th require xlua Stuff s th local utils require utils Segmentation fault core dumped amineDellOptiplex Workvrnfacealignment Another Torch run complained about some null state but I could not reproduce the error to attach it here So my conclusion was that I am unable to get passed line of Mainlua I decided to install the Python libraries using another route installing numpy and matplotlib through apt Ignore the unnecessary steps after two weeks of being annoyed I developed the habit of not trusting the PythonLinux relationship pip uninstall dlib pip uninstall matplotlib pip uninstall numpy pip uninstall visvis pip uninstall imageio sudo apt remove pythonmatplotlib sudo apt remove pythonnumpy sudo apt autoremove pip install user dlib visvis imageio sudo apt install pythonmatplotlib pythonnumpy After this I reinstalled Torch THPP and Fblualib and when I run the script vrnsh I get amineDellOptiplex Workvrn runsh Found Environment variable CUDNNPATH usrlocalcudalib libcudnnso orkusrlocaltorchinstallsharelua treplinitlua module matio not foundNo LuaRocks module found for matio no field packagepreload matio no file homeamineluarockssharelua matiolua no file homeamineluarockssharelua matioinitlua no file homeamineWorkusrlocaltorchinstallsharelua matiolua no file homeamineWorkusrlocaltorchinstallsharelua matioinitlua no file matiolua no file homeamineWorkusrlocaltorchinstallshareluajit beta matiolua no file usrlocalsharelua matiolua no file usrlocalsharelua matioinitlua no file homeamineluarocksliblua matioso no file homeamineWorkusrlocaltorchinstallliblua matioso no file homeamineWorkusrlocaltorchinstalllibmatioso no file matioso no file usrlocalliblua matioso no file usrlocalliblua loadallso warning matio could not be loaded is it installed orkusrlocaltorchinstallsharelua treplinitlua module npy th not foundNo LuaRocks module found for npy th no field packagepreload npy th no file homeamineluarockssharelua npy thlua no file homeamineluarockssharelua npy thinitlua no file homeamineWorkusrlocaltorchinstallsharelua npy thlua no file homeamineWorkusrlocaltorchinstallsharelua npy thinitlua no file npy thlua no file homeamineWorkusrlocaltorchinstallshareluajit beta npy thlua no file usrlocalsharelua npy thlua no file usrlocalsharelua npy thinitlua no file homeamineluarocksliblua npy thso no file homeamineWorkusrlocaltorchinstallliblua npy thso no file homeamineWorkusrlocaltorchinstalllibnpy thso no file npy thso no file usrlocalliblua npy thso no file usrlocalliblua loadallso warning npy th could not be loaded is it installed Scanning directory for data Found images images require a face detector Initialising python libs Initialising detector homeamineWorkusrlocaltorchinstallbinluajit mainlua Invalid numpy data type stack traceback C in function detect mainlua in main chunk C in function dofile ocaltorchinstalllibluarocksrockstreplscm binth in main chunk C at x d ls cannot access txt No such file or directory Found Environment variable CUDNNPATH usrlocalcudalib libcudnnso ls cannot access raw No such file or directory So now the script executes up to line of Mainlua then complains about Invalid numpy data type an error for which I found exactly two Googlesearch entries none of which were terribly useful for my limited understanding At this stage I could not think anymore It looks as if the numpymayplotlib libraries installed through apt get me further in code execution but the complaint in line is mysterious For the sake of completeness or verbosity I show the initial install process Install NVIDIA Driver sudo aptget purge nvidia sudo addaptrepository ppagraphicsdrivers sudo aptget update sudo apt remove libappstream If previous command complains sudo aptget update If previous command needed sudo aptget install nvidia At the time of doing this is the latest driver reboot lsmod grep nvidia Install Cuda Cudnn sudo cuda linuxrun sudo cuda linuxrun sudo cp cudaincludecudnnh usrlocalcudainclude sudo cp cudalib libcudnn usrlocalcudalib sudo chmod ar usrlocalcudaincludecudnnh sudo chmod ar usrlocalcudalib libcudnn VRN Install some dependencies for later sudo apt install libgoogleglogdev libboostalldev sudo apt update sudo apt y upgrade sudo apt install pythonpip sudo apt install cmake sudo apt remove pythonmatplotlib sudo apt remove pythonnumpy sudo apt autoremove pip install user dlib matplotlib numpy visvis imageio Install the Torch distribution mkdir p HOMEWorkusrlocalsrc cd HOMEWorkusrlocal sudo apt install git git clone mv distro torch cd torch sudo installdeps sudo installsh source HOMEWorkusrlocaltorchinstallbintorchactivate Install THPP and fbpython for the face alignment code cd HOMEWorkusrsrc git clone cd thppthpp sudo THPPNOFB buildsh Install fbpython cd HOMEWorkusrsrc git clone cd fblualibfblualibpython luarocks make rockspec vrn cd HOMEWork git clone recursive cd vrn downloadsh runsh SOS