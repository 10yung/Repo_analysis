 Dear Rafa Thank you for your previous help As you mentioned the estimator for linear elasticity should read hQ intQ f div sigmau f div sigmau I think displacement field is the error estimator in above equation I would like to know how we can make one of the components of stress or von Mises stress as our error estimator Best Hamid Dear Rafa Two different posteriori error indicators have been introduced in your paper entitled Algorithms for the implementation of adaptive isogeometric methods using hierarchical splines for the scalar field Are these indicators applicable to the vector field approximations like elasticity problems I mean without the exact solution at hand can we estimate the residual error for the vector field using the abovementioned error estimators Dear Rafa Thank you for your previous help I would like to implement HB splines related computationI have read the documents in the appendix and GeoPDEs code libraries this weekHowevermy code level is very limited I feel a little embrassed Would you please give me a example like how to compute and plot the HB basis functions with the GeoPDEs source codeIf the GeoPDEs source code has the above functionplease tell me about thatSryI cant understand this code very well Would you give me some guidanceplease Deeply grateful Jim Dear Rafa Hi First thank you for the time you provide me I have solved Fichera corner example and I could capture the singularity and the results for three steps of refinement are as follows Capture Now I want to compare the results of the energy norm with GeoPDE would you mind telling me how I should provide the input data My input data is as follows PHYSICAL DATA OF THE PROBLEM clear problemdata Physical domain defined as NURBS map given in a text file problemdatageoname geoficheratxt Type of boundary conditions for each side of the domain problemdatanmnnsides problemdatadrchltsides Physical parameters problemdatacdiff x y z onessizex problemdatagradcdiff x y z cat reshape zerossizex sizex reshape zerossizex sizex reshape zerossizex sizex Source and boundary terms radius xyz x y z uex xyz radiusxyz problemdataf xyz radiusxyz problemdatah xyzind uexxyz Exact solution optional problemdatauex uex problemdatagraduex x y z cat reshape x x y z sizex reshape y x y z sizex reshape z x y z sizex CHOICE OF THE DISCRETIZATION PARAMETERS Coarse mesh clear methoddata methoddatadegree Degree of the splines methoddataregularity Regularity of the splines methoddatansubcoarse Number of subdivisions of the coarsest mesh methoddatansubrefine Number of subdivisions for each refinement methoddatanquad Points for the Gaussian quadrature rule methoddataspacetype standard simplified only children functions or standard methoddatatruncated False True ADAPTIVITY PARAMETERS clear adaptivitydata adaptivitydataflag elements adaptivitydataflag functions adaptivitydataC est adaptivitydatamarkparam adaptivitydatamarkstrategy MS adaptivitydatamaxlevel adaptivitydatamaxndof adaptivitydatanummaxiter adaptivitydatamaxnel adaptivitydatatol e Best regards Hamid Dear Rafa I appreciate the time you spend guiding me I am writing to ask if you could help me with how I can translate control points between different hierarchical levels suppose I have control points of level one how can I calculate the control points of THB space I have written the following code to calculate all control points of each level is there any way to directly calculate the control points of each element separately coefflev cellsizehmshnelperlevel CntrlPts cellsizehspacespaceoflevel Control points of first level CntrlPts geometrynurbscoefs Control points of other levels using subdivision matrix for i numelhspaceProj CntrlPtsi CntrlPtsihspaceProji end for ilev numelhspacespaceoflevel jj findhspaceCsubilevhspaceactiveilev coefflevilev CntrlPtsilevhspaceactiveilevhspaceCsubilevhspaceactiveilevjj end Best Regards Hamid Hi Rrafavzqz I want to construct a hierarchical vector space from a hierachical scalar space obtained from your package But I can not get the right stiffness matrix and the matrix operation is singular if I construct the hierarchical vector space as the following code Moreover if the level of the hierachical vector space equals to the matrix is right and the matrix operation is no longer singular Could you help me to fix it for ilev numelhspacespaceoflevel msh hmshmeshoflevelilev spacescalar hspacespaceoflevelilev scalarspaces repmat spacescalar mshrdim spaces spvector scalarspaces msh if ilev sphierspaceoflevel spaces else sphierspaceoflevelilev spaces end clear spaces end for ilev numelhspacespaceoflevel cumsumndof cumsumndof hmshrdim cumsum cellfun x xndof sphierspaceoflevelilevscalarspaces if isemptyhspaceactiveilev sphieractiveilev repmathspaceactiveilev mshrdimrepmatcumsumndof mshrdimnumelhspaceactiveilev else sphieractiveilev end if isemptyhspacedeactivatedilev sphierdeactivatedilev repmathspacedeactivatedilev mshrdimrepmatcumsumndof mshrdimnumelhspacedeactivatedilev else sphierdeactivatedilev end sphieractiveilev sphieractiveilev sphierdeactivatedilev sphierdeactivatedilev Id zerossizehspaceCsubilev Id zerossizehspaceCsubilev sphierCsubilev hspaceCsubilev Id Id hspaceCsubilev end Best didadidadada 