 Please ensure that your PR points to our develop branch If not please retarget the branch in the upper left corner Please ensure that the develop branch of your fork is up to date a git checkout develop b git remote add upstream c git pull rebase upstream develop d Work on any merge conflicts and follow the onscreen instructions of the git client e git push force overwriting any changes you did to develop that were not part of our branch f git checkout YOURBRANCH g git pull rebase origin develop h Work on any merge conflicts and git push again i Open PR Please provide a meaningful title for the PR If you fix an issue please reference it with Fixes nnn Description Please describe your changes in detail unless the title is already descriptive enough x I have tested my changes I have updated CHANGELOGmd and added my change to the Unreleased section The PR has a meaningful title x I updated my forkbranch and have integrated all changes from AutomatedLabdevelop before creating the PR Type of change Check all that apply Bug fix New functionality Breaking change x Documentation How was the change tested Please describe what you did to test your change if applicable We are aware that there are currently no unit and integration tests so we need your help By letting us know how you tested we can better judge what we need to test in addition to that Description Ive deployed a Sample Lab with the expected results Now I wanted to deploy a new Lab with three machines which fails with a strange error message Expected behavior The deployment and configuration of the treee machines Actual behavior PS C WINDOWS system H LabSources SampleScripts HyperV SfBStdLabps Initialization Host operating system version Creating new lab definition with name SfBSmallLab Location of lab definition files will be C ProgramData AutomatedLab Labs SfBSmallLab Location of LabSources folder is H LabSources Autoadding ISO files found OS images in the cache Added H LabSources ISOs SkypeforBusinessServer EvaluationenUSiso Added H LabSources ISOs SQLServer SP FullSlipstreamx ENUiso Added H LabSources ISOs Windows EnterpriseEVALenusiso Added H LabSources ISOs WindowsServer R DatacenterEVALenusiso Added H LabSources ISOs WindowsServer DatacenterEVALenusiso Added H LabSources ISOs WindowsServer DatacenterEVALenusiso Done Added H LabSources ISOs SQLServer SP FullSlipstreamx ENUiso Adding HyperV machine definition SfBADC Roles RootDC WebServer CaRoot Done Adding HyperV machine definition SfBFES Done Adding HyperV machine definition SfBSQL Roles SQLServer Done Estimated additional local drive space needed for all machines GB Location of HyperV machines will be H AutomatedLabVMs Done Validating lab definition Cannot convert argument c with value for AddRange to type SystemCollectionsICollection Cannot convert the value of type SystemString to type SystemCollectionsICollection At C Program Files WindowsPowerShell Modules HostsFile HostsFilepsm char hostContentAddRangecurrentHostContent CategoryInfo NotSpecified MethodException FullyQualifiedErrorId MethodArgumentConversionInvalidCastArgument Cannot convert argument c with value for AddRange to type SystemCollectionsICollection Cannot convert the value of type SystemString to type SystemCollectionsICollection At C Program Files WindowsPowerShell Modules HostsFile HostsFilepsm char hostContentAddRangecurrentHostContent CategoryInfo NotSpecified MethodException FullyQualifiedErrorId MethodArgumentConversionInvalidCastArgument Cannot convert argument c with value for AddRange to type SystemCollectionsICollection Cannot convert the value of type SystemString to type SystemCollectionsICollection At C Program Files WindowsPowerShell Modules HostsFile HostsFilepsm char hostContentAddRangecurrentHostContent CategoryInfo NotSpecified MethodException FullyQualifiedErrorId MethodArgumentConversionInvalidCastArgument Could not invoke validator AutomatedLabUnknownRoleProperties Success Lab SfBSmallLab hosted on HyperV imported with machines Creating virtual networks Creating HyperV virtual network SfBSmallLab The network switch SfBSmallLab already exists no changes will be made to configuration Done done Creating base images All base images were created previously Done done Creating Additional Disks Done Creating VMs GetHostFile Cannot convert argument c with value for AddRange to type SystemCollectionsICollection Cannot convert the value of type SystemString to type SystemCollectionsICollection At C Program Files WindowsPowerShell Modules HostsFile HostsFilepsm char hostContent hostEntries GetHostFile CategoryInfo NotSpecified GetHostFile MethodException FullyQualifiedErrorId MethodArgumentConversionInvalidCastArgumentGetHostFile Installing Root Domain Controllers Machines with RootDC role to be installed SfBADC Waiting for machines to start upGetVM HyperV was unable to find a virtual machine with name SfBADC At C Program Files WindowsPowerShell Modules AutomatedLabWorker AutomatedLabWorkerVirtualMachinespsm char vms GetVM Name ComputerName CategoryInfo InvalidArgument SfBADC String GetVM VirtualizationException FullyQualifiedErrorId InvalidParameterMicrosoftHyperVPowerShellCommandsGetVM Could not start HyperV machine SfBADC HyperV was unable to find a virtual machine with name SfBADC At C Program Files WindowsPowerShell Modules AutomatedLabWorker AutomatedLabWorkerVirtualMachinespsm char throw ex CategoryInfo OperationStopped Exception FullyQualifiedErrorId Could not start HyperV machine SfBADC HyperV was unable to find a virtual machine with name SfBADC Steps to reproduce labName SfBSmallLab NewLabDefinition Name labName DefaultVirtualizationEngine HyperV AddLabIsoImageDefinition Name SQLServer Path labSources ISOs SQLServer SP FullSlipstreamx ENUiso AddLabVirtualNetworkDefinition Name labName AddressSpace SetLabInstallationCredential Username Install Password Pa w rd f AddLabDomainDefinition Name uandmede AdminUser Peter AdminPassword Pa w rd f role role GetLabMachineRoleDefinition Role RootDC role GetLabMachineRoleDefinition Role WebServer role GetLabMachineRoleDefinition Role CaRoot AddLabMachineDefinition Name SfBADC Memory MB Network labName DomainName uandmede IpAddress DnsServer Roles role ToolsPath labSources Tools OperatingSystem Windows Server Datacenter Evaluation Desktop Experience AddLabMachineDefinition Name SfBFES Memory MB Network labName DomainName uandmede IpAddress DnsServer ToolsPath labSources Tools OperatingSystem Windows Server Datacenter Evaluation Desktop Experience AddLabMachineDefinition Name SfBSQL Memory MB Network labName DomainName uandmede IpAddress DnsServer Roles SQLServer ToolsPath labSources Tools OperatingSystem Windows Server Datacenter Evaluation Desktop Experience InstallLab InstallLabSoftwarePackage ComputerName GetLabVM Path labSources SoftwarePackages npp Installerexe CommandLine S InstallLabSoftwarePackage ComputerName GetLabVM Path labSources SoftwarePackages Wiresharkwin exe CommandLine S EnableLabCertificateAutoenrollment Computer User CodeSigning ShowLabDeploymentSummary Detailed Environment details PowerShell Version Name Value PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion AutomatedLab components Name Version AutomatedLab AutomatedLabCommon AutomatedLabDefinition AutomatedLabNotifications AutomatedLabUnattended AutomatedLabWorker Please ensure that your PR points to our develop branch If not please retarget the branch in the upper left corner Please ensure that the develop branch of your fork is up to date a git checkout develop b git remote add upstream c git pull rebase upstream develop d Work on any merge conflicts and follow the onscreen instructions of the git client e git push force overwriting any changes you did to develop that were not part of our branch f git checkout YOURBRANCH g git pull rebase origin develop h Work on any merge conflicts and git push again i Open PR Please provide a meaningful title for the PR If you fix an issue please reference it with Fixes nnn Description See issue removes a hardcoded path for SQL configuration file x I have tested my changes x I have updated CHANGELOGmd and added my change to the Unreleased section x The PR has a meaningful title x I updated my forkbranch and have integrated all changes from AutomatedLabdevelop before creating the PR Type of change Check all that apply x Bug fix New functionality Breaking change Documentation How was the change tested Please describe what you did to test your change if applicable We are aware that there are currently no unit and integration tests so we need your help By letting us know how you tested we can better judge what we need to test in addition to that Created a machine lab installing SQL instance using a SQL configuration file Description I was troubleshooting something and I noticed this line Should the path be hard coded to be D SQLConfigini I feel it would make more sense if it were rolePropertiesConfigurationFile looking at where else configurationFileContent is referenced Expected behavior Actual behavior If you intend to provide error messages try to format them in a code block To make troubleshooting easier unless the issue is easy to reproduce the verbose output of InstallLab Verbose will also be helpful in a code block Steps to reproduce powershell Please add all PowerShell Code necessary to reproduce your issue here Environment details PowerShell Version code Name Value PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion AutomatedLab components code Name Version AutomatedLab AutomatedLabCommon AutomatedLabRecipe AutomatedLabShips AutomatedLabDefinition AutomatedLabNotifications AutomatedLabTest AutomatedLabUnattended AutomatedLabWorker Description Some output from jobs is returned to console for SQL role see image Expected behavior No blank lines Some messages missing WriteScreenInfo lovely stuff Actual behavior Blank lines and some messages missing WriteScreenInfo stuff Steps to reproduce Install using SQL role Environment details PowerShell Version code Name Value PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion AutomatedLab components code Name Version AutomatedLab AutomatedLabCommon AutomatedLabRecipe AutomatedLabShips AutomatedLabDefinition AutomatedLabNotifications AutomatedLabTest AutomatedLabUnattended AutomatedLabWorker Description When adding a SQL ISO to my lab AL throws this nonterminating exception when calling InstallLab In the labs XML C ProgramData AutomatedLab Labs CMLab Labxml I do see IsoImage NameSQLServer Name PathC LabSources ISOs ensqlserver standardx dvd isoPath Size Size OperatingSystems IsoImage I expect its not related but the closing OperatingSystems does seem to be not needed here Link to whole XML on paste bin Expected behavior Not to print error to screen Actual behavior If you intend to provide error messages try to format them in a code block To make troubleshooting easier unless the issue is easy to reproduce the verbose output of InstallLab Verbose will also be helpful in a code block Printing error to screen I dont think its an issue with installing the SQL role so the media seems to be used fine Steps to reproduce Link Environment details PowerShell Version code Name Value PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion AutomatedLab components code Name Version AutomatedLab AutomatedLabCommon AutomatedLabRecipe AutomatedLabShips AutomatedLabDefinition AutomatedLabNotifications AutomatedLabTest AutomatedLabUnattended AutomatedLabWorker Please ensure that your PR points to our develop branch If not please retarget the branch in the upper left corner Please ensure that the develop branch of your fork is up to date a git checkout develop b git remote add upstream c git pull rebase upstream develop d Work on any merge conflicts and follow the onscreen instructions of the git client e git push force overwriting any changes you did to develop that were not part of our branch f git checkout YOURBRANCH g git pull rebase origin develop h Work on any merge conflicts and git push again i Open PR Please provide a meaningful title for the PR If you fix an issue please reference it with Fixes nnn Description New custom role for ConfigMgr including updates to or Moving forward for every baseline release of ConfigMgr I intend to rerelease this script and a new custom role with the corresponding name of the released basline eg the next release in Q of this year will be called CM assuming is the version number of the next current branch release This custom role is hugely influenced by the current SCCM custom role The most noticeable difference is the accompanying CM ps script that Ive placed in the Scenarios folder of Samples Scripts Its a different approach compared to the other sample scripts in the sense that the AutomatedLab build is configured via parameters rather than the user modifying the scripts body Im open to discussions on this approach I cant imagine it being a deal breaker for you From my experience theres a reasonably sized portion of ConfigMgr admins who arent comfortable with PowerShell and I wrote this with the intention to reduce their exposure to the body of code Hopefully just calling a script with or without parameters encourages wider use x I have tested my changes x The PR has a meaningful title x I updated my forkbranch and have integrated all changes from AutomatedLabdevelop before creating the PR Type of change Check all that apply Bug fix x New functionality Breaking change Documentation How was the change tested Please describe what you did to test your change if applicable We are aware that there are currently no unit and integration tests so we need your help By letting us know how you tested we can better judge what we need to test in addition to that Initiate build from calling CM ps with various combinations of parameters rinse and repeat I know this might sound vague but its true Apologies if its unhelpful thats not my intention Description I made my own version based on the script VpnConnectedLabps If I start the script now it sometimes works and sometimes it doesnt I cant find a regularity Ive done it about times in the past few days and it worked in about runs The error always occurs when the domain is set up on Azurebased VMs and always at the same time Does somebody have any idea How could I isolate the problem Expected behavior Log code Installing Root Domain Controllers Machines with RootDC role to be installed AZTOADDC Waiting for machines to start up Waiting for Root Domain Controllers to complete installation of Active Directory and restartdone Root Domain Controllers have now restarted Waiting for Active Directory to start up Done Installing Additional Domain Controllers Machines with DC role to be installed AZTOADDC Waiting for machines to start up Waiting for additional Domain Controllers to complete installation of Active Directory and restartdone Additional Domain Controllers have now restarted Waiting for Active Directory to start up Done Starting remaining machines Waiting for machines to start up Done Performing postinstallations tasks defined for each machine Postinstallations done Actual behavior code Installing Root Domain Controllers Machines with RootDC role to be installed AZTOADDC Waiting for machines to start up Waiting for Root Domain Controllers to complete installation of Active Directory and restartWaitLabVMRestart The following machines have not restarted in the timeout of minutes AZTOADDC In C Program Files WindowsPowerShell Modules AutomatedLab AutomatedLabADDSpsm Zeichen WaitLabVMRestart ComputerName machinesName StartMachines CategoryInfo NotSpecified WriteError WriteErrorException FullyQualifiedErrorId MicrosoftPowerShellCommandsWriteErrorExceptionWaitLabVMRestart Steps to reproduce powershell Tenant xxxxxxxxonmicrosoftcom TenantID SubscriptionID DisableAzContextAutosave Scope Process OutNull Account ConnectAzAccount TenantId TenantID If TenantID eq AccountContextTenantId WriteVerbose Message Log in on Tenant Tenant with Account AccountContextAccountId currentAzureContext GetAzContext tenantId currentAzureContextTenantId accountId currentAzureContextAccountId AzureAD ConnectAzureAD TenantId tenantId AccountId accountId ActiveTenantName GetAzureADDomain WhereObject Name like onmicrosoft and Name notlike mailonmicrosoftName WriteVerbose Message Log in on Azure AD ActiveTenantName with Account AzureADAccountId Context SetAzContext Scope Process Tenantid Tenantid SubscriptionId SubscriptionID SubscriptionId GetAzContextSubscriptionId labs labName AzureOneSite labShortName AZTO labSubnet labRootDomain lablocal labGateway labDns labDns labLocation West Europe labLocationShort EUWE labUserName Install labPassword Somepa labSources GetLabSourcesLocation labDrive EnvProgramData AutomatedLab Labs Use the default path if you use another path some issue can happen labVMDrive C AutomatedLabsVMs this is the drive where to create the VMs foreach lab in labsGetEnumerator Create the folder path for the lab using JoinPath labPath JoinPath Path labDrive ChildPath lablabName labVMPath JoinPath Path labVMDrive ChildPath lablabName Create the target directory if it does not exist if not TestPath labPath NewItem labPath ItemType Directory OutNull if not TestPath labVMPath NewItem labVMPath ItemType Directory OutNull NewLabDefinition Name lablabName DefaultVirtualizationEngine Azure AddLabAzureSubscription Path labDrive lablabName DefaultLocation lablabLocation SyncLabAzureLabSources SkipIsos AddLabVirtualNetworkDefinition Name lablabName AddressSpace lablabSubnet AddLabDomainDefinition Name lablabRootDomain AdminUser Install AdminPassword lablabPassword SetLabInstallationCredential Username Install Password lablabPassword First DC the root domain gets a first domain controller DefaultParamDC DefaultParamDC Network lablabName DefaultParamDC ToolsPath labSources Tools DefaultParamDC Gateway lablabGateway DefaultParamDC DnsServer lablabDns DefaultParamDC DnsServer lablabDns DefaultParamDC DomainName lablabRootDomain DefaultParamDC Memory MB DefaultParamDC OperatingSystem Windows Server Datacenter Desktop Experience DefaultParamDC AzureRoleSize StandardB ms roles GetLabMachineRoleDefinition Role RootDC ForestFunctionalLevel Default DomainFunctionalLevel Default SiteName lablabName SiteSubnet lablabSubnet postInstallActivity postInstallActivity GetLabPostInstallationActivity ScriptFileName PrepareRootDomainps DependencyFolder labSources PostInstallationActivities PrepareRootDomain postInstallActivity GetLabPostInstallationActivity ScriptFileName NewADLabAccounts ps DependencyFolder labSources PostInstallationActivities PrepareFirstChildDomain AddLabMachineDefinition Name lablabShortName ADDC IpAddress Roles roles PostInstallationActivity postInstallActivity DefaultParamDC Second DC the root domain gets a second domain controller roles GetLabMachineRoleDefinition Role DC AddLabMachineDefinition Name lablabShortName ADDC IpAddress Roles roles DefaultParamDC InstallLab StopLabVM All Wait Environment details PowerShell Version code Name Value PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion AutomatedLab components code Name Version AutomatedLab AutomatedLabCommon AutomatedLabDefinition AutomatedLabNotifications AutomatedLabUnattended AutomatedLabWorker Az components code Name Version AzSK AzAccounts AzAdvisor AzAks AzAnalysisServices AzApiManagement AzApplicationInsights AzAutomation AzBatch AzBilling AzCdn AzCognitiveServices AzCompute AzContainerInstance AzContainerRegistry AzDataFactory AzDataLakeAnalytics AzDataLakeStore AzDeploymentManager AzDevTestLabs AzDns AzEventGrid AzEventHub AzFrontDoor AzHDInsight AzIotHub AzKeyVault AzLogicApp AzMachineLearning AzManagedServices AzMarketplaceOrdering AzMedia AzMonitor AzNetwork AzNotificationHubs AzOperationalInsights AzPolicyInsights AzPowerBIEmbedded AzRecoveryServices AzRedisCache AzRelay AzResources AzServiceBus AzServiceFabric AzSignalR AzSql AzStorage AzStorageSync AzStreamAnalytics AzTrafficManager AzWebsites AzTable AzureAD AzureAutomationAuthoringToolkit AzureInformationProtection Description Please create a function to enable azure bastion for labs hosted in azure Expected behavior ability for RDP in the Browser The performance of GetLabInternetFile could be better if didnt use WriteProgress or at least offered option to suppress it and using SystemNetWebClient instead The operator to append to bytesProcessed is also killer on performance Id like to submit PR but before I make changes I wanted to understand if there was a particular reason why this method to download was used Perhaps theres history to it