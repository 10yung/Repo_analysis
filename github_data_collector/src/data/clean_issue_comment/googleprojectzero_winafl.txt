Hi In my previous issues I managed to run winafl successfully on x platform But actually my target platform is windows Qualcomm ARM so I copied everything to the windows arm device and ran again When I ran the following command in DynamoRIOWindows bin directory drrunexe c winafldll debug targetmodule testmainexe targetoffset x B fuzziterations nargs testmainexe myfiletxt Nothing print out When I ran my program alone testmainexe myfiletxt It works as expected When I try to ran drrunexe without arguments drrunexe It could print out the usage info I dont know what is the problem here Do you know if DynamoRIOWindows also works on windowsarm devices Do you know the targetoffset would change on x against arm platform Thanks for your help Guilan i am running winafl and dynamorio DynamoRIOWindows on core machine and every few hours i am getting this issue Screen Shot at PM i am running winafl and dynamorio DynamoRIOWindows on core machine and every few hours i am getting this issue Windows it seems that curinput file is also increasing to around gb actual input files are around kb only so looks like input file are not getting closed and data is just getting appended to it Windows any ideas when i use fuzzinterations it shows ASSERT FAILURE c work winafl source winaflc invalid options Hi I tried to fuzz IrfanView and I have found the correct offset but there was an error as the title so what is the cause of this problem Hi ivanfratric I was trying to fuzz ffmpeg on Windows First I used drrunexe to find correct targetoffset I set the offset of main as the targetoffset but there was waring as title what caused this problem I made sure that the the exit function is called in main Hi I am not understanding about how winafl implements persistent fuzzing for a target program I think winafl saves the registersp and cp value in function prefuzzhandle function and restores the registersp and value in function postfuzzhandlebut there is nothing operations about restoring memory data Is my understanding correct Sorry this is a question rather than an issue I reposted it here since there were no replies on aflusers list I was trying WinAFL and followed the tutorials from READMEmd I had a simple program fromfileexe zipped source code fromfilec attached below which was built with clexe fromfilec and a mingw command file fromfileexe tells that fromfileexe PE executable console Intel for MS Windows fromfileczip And I confirmed that when executing C Users hchen tools DynamoRIO bin drrunexe fromfileexe fromfileexe it can correctly output the expected results CASE nread common However when I tried to fuzz it with any of the following commands where inputs are the input directory with a simple seed file and outputs is an empty directory it always reports the usage message which indicates that these command options are incorrect C Users hchen tools winafl bin aflfuzzexe i inputs o outputs t D C Users hchen tools DynamoRIO bin nargs C Users hchen tools targets simple fromfileexe C Users hchen tools winafl bin aflfuzzexe i inputs o outputs t D C Users hchen tools DynamoRIO bin nargs C Users hchen tools targets simple fromfileexe C Users hchen tools winafl bin aflfuzzexe i inputs o outputs t D C Users hchen tools DynamoRIO bin C Users hchen tools targets simple fromfileexe C Users hchen tools winafl bin aflfuzzexe i inputs o outputs t D C Users hchen tools DynamoRIO bin C Users hchen tools targets simple fromfileexe And by adding some printfs in source code I noticed that the value of i argc is true So where Ive got wrong Hello The application crashes when I try to make sure that the target is working correctly under DynamoRIO with c WinAFLdll client module I try this DDynamoRIOWindows bin drrunexe c winafldll debug targetmodule UnityPlayerdll targetoffset x DB coveragemodule UnityPlayerdll fuzziterations nargs SCPSLexe batchmode nographics By running the same thing and connecting the debugger to the application I get an exception in different places where there is an attempt to write some data to a segment that does not have write permissions FF D movaps xmmword ptr rcx h xmm Exception here WINDBGr rax b ec rbx b bc rcx b ec rdx fc rsi rdi b ec rip ff d rsp b fea rbp b c r r r b r b ec r af e d r b f a r r b dbf iopl nv up ei pl nz na pe cy cs ss b ds b es b fs gs b efl ff d f f movaps xmmword ptr rcx h xmm ds b ec Address x B EC belongs to a segment with a base address of x b which doesnt have write permission BaseAddress EndAddress RegionSize Type State Protect Usage b b MEMPRIVATE MEMCOMMIT PAGEEXECUTEREAD unknown UHHPHuH Address x B EC belong to this segment which doesnt have write permission b b b MEMPRIVATE MEMCOMMIT PAGEREADWRITE unknown H As a result I get exception code c ACCESS VIOLATION aflSCPSLexe proclog Module loaded dynamoriodll Module loaded UnityPlayerdll Module loaded winafldll Module loaded drxdll Module loaded drregdll Module loaded drmgrdll Module loaded drwrapdll Module loaded SCPSLexe Module loaded AcGenraldll Module loaded OPENGL dll Module loaded GLU dll Module loaded WINHTTPdll Module loaded WindowsCodecsdll Module loaded VERSIONdll Module loaded MPRdll Module loaded WINMMBASEdll Module loaded WINMMdll Module loaded apphelpdll Module loaded HIDDLL Module loaded dxcoredll Module loaded SspiClidll Module loaded USERENVdll Module loaded UMPDCdll Module loaded POWRPROFdll Module loaded AppCoredll Module loaded MSASN dll Module loaded profapidll Module loaded bcryptdll Module loaded WindowsStoragedll Module loaded ucrtbasedll Module loaded CRYPT dll Module loaded CRYPTSPdll Module loaded CFGMGR dll Module loaded msvcpwindll Module loaded win udll Module loaded bcryptPrimitivesdll Module loaded gdi fulldll Module loaded KERNELBASEdll Module loaded SECHOSTdll Module loaded KERNEL dll Module loaded WS dll Module loaded ADVAPI dll Module loaded IMM dll Module loaded combasedll Module loaded msvcrtdll Module loaded OLEAUT dll Module loaded RPCRT dll Module loaded SHLWAPIdll Module loaded SHELL dll Module loaded SETUPAPIdll Module loaded GDI dll Module loaded SHCOREdll Module loaded USER dll Module loaded ole dll Module loaded ntdlldll Instrumenting UnityPlayerdll with the bb mode Module loaded UxThemedll In OpenFileW reading DSteamsteamappscommonSCP Secret LaboratorySCPSLDatabootconfig In OpenFileW reading D Steam steamapps common SCP Secret Laboratory SCPSLData appinfo Module loaded MSWSOCKdll Module loaded PSAPIDLL Module loaded CRYPTBASEdll Module loaded mono bdwgcdll In OpenFileW reading D Steam steamapps common SCP Secret Laboratory SCPSLData Managed mscorlibdll In OpenFileW reading D Steam steamapps common SCP Secret Laboratory SCPSLData Managed mscorlibdlldllla In OpenFileW reading D Steam steamapps common SCP Secret Laboratory SCPSLData Managedmonoaotcacheamd mscorlibdlldllla In OpenFileW reading D Steam steamapps common SCP Secret Laboratory SCPSLData Managed mscorlibdllconfig In OpenFileW reading D Steam steamapps common SCP Secret Laboratory MonoBleedingEdge etc mono assemblies mscorlib mscorlibconfig In OpenFileW reading C Users User mono assemblies mscorlib mscorlibconfig In OpenFileW reading D Steam steamapps common SCP Secret Laboratory MonoBleedingEdge etc mono config In OpenFileW reading D Steam steamapps common SCP Secret Laboratory SCPSLData globalgamemanagers Module loaded AudioPluginDissonancedll Module loaded MSCTFdll In OpenFileW reading C Users User AppData LocalLow Hubert Moszka SCPSL outputlogtxt In OpenFileW reading C Users User AppData LocalLow Hubert Moszka SCPSL outputlogtxt In OpenFileW reading D Steam steamapps common SCP Secret Laboratory SCPSLData Resources unity default resources Module loaded CLBCatQDLL Module loaded DEVOBJdll Module loaded MMDevAPIDLL Module loaded WinTypesdll Module loaded AudioSesDLL Module loaded ResourcePolicyClientdll Module loaded AVRTdll In OpenFileW reading D Steam steamapps common SCP Secret Laboratory SCPSLData Managed UnityEnginedll Module loaded discordrpcdll In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading D Steam steamapps common SCP Secret Laboratory SCPSLData Managed advapi dllla In OpenFileW reading D Steam steamapps common SCP Secret Laboratory SCPSLData Managed advapi dllla In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc In OpenFileW reading pipe discordipc Exception caught c crashed WARNING Target function was never called Incorrect targetoffset Coverage map follows I dont get any crash when I try this D mysrcDynamoRIOWindows bin drrunexe SCPSLexe batchmode nographics Not sure if the problem is WinAFL DynamoRIO or something else Versions Windows Pro version build DynamoRIOWindows MSVC Im trying to fuzz an application that starts up spawns a lot of threads and both connects to a server and acts as a server Using drrun with the debug mode it hits my target function if I manually send data to it that hits the correct function However when using winafl with the custom net fuzzer plugin the application seems to hang Winafl will continually call the net fuzzer plugin to send data but the application itself hangs and never fully finishes fully initializing to bring up all its network connections Checking the application logs I can see it only seems to output a few of the lines related to its initialization but otherwise isnt continuing I have no idea how to even debug this to see what could be the cause of the hang and it the application runs correctly under drrun and drcov