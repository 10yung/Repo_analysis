 Why i am getting the issue while trying to connect with rabbit mq ActorRabbitMQSystemakkaactordefaultdispatcher akkaActorRabbitMQSystemusera connection failed javanetConnectException Connection refused connect i simply took the code and try to connect but not able to connect and get the below error akkaActorRabbitMQSystemusera connection failed javanetConnectException Connection refused connect orgapachesparkSparkException Job aborted due to stage failure Task in stage failed times most recent failure Lost task in stage TID localhost executor driver javalangAbstractMethodError at orgapachesparkinternalLoggingclassinitializeLogIfNecessaryLoggingscala at orgapachesparkstreamingrabbitmqconsumerConsumerinitializeLogIfNecessaryConsumerscala at orgapachesparkinternalLoggingclasslogLoggingscala at orgapachesparkstreamingrabbitmqconsumerConsumerlogConsumerscala at orgapachesparkstreamingrabbitmqconsumerConsumeranonfunsetUserPassword applyConsumerscala at orgapachesparkstreamingrabbitmqconsumerConsumeranonfunsetUserPassword applyConsumerscala at scalaOptionforeachOptionscala at orgapachesparkstreamingrabbitmqconsumerConsumersetUserPasswordConsumerscala at orgapachesparkstreamingrabbitmqconsumerConsumerapplyConsumerscala at orgapachesparkstreamingrabbitmqreceiverRabbitMQReceiveranonfun applyRabbitMQInputDStreamscala at orgapachesparkstreamingrabbitmqreceiverRabbitMQReceiveranonfun applyRabbitMQInputDStreamscala at scalautilTryapplyTryscala at orgapachesparkstreamingrabbitmqreceiverRabbitMQReceiveronStartRabbitMQInputDStreamscala at orgapachesparkstreamingreceiverReceiverSupervisorstartReceiverReceiverSupervisorscala at orgapachesparkstreamingreceiverReceiverSupervisorstartReceiverSupervisorscala at orgapachesparkstreamingschedulerReceiverTrackerReceiverTrackerEndpointanonfun applyReceiverTrackerscala at orgapachesparkstreamingschedulerReceiverTrackerReceiverTrackerEndpointanonfun applyReceiverTrackerscala at orgapachesparkSparkContextanonfun applySparkContextscala at orgapachesparkSparkContextanonfun applySparkContextscala at orgapachesparkschedulerResultTaskrunTaskResultTaskscala at orgapachesparkschedulerTaskrunTaskscala at orgapachesparkexecutorExecutorTaskRunnerrunExecutorscala at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava at javalangThreadrunThreadjava Driver stacktrace at orgapachesparkschedulerDAGSchedulerorgapachesparkschedulerDAGSchedulerfailJobAndIndependentStagesDAGSchedulerscala at orgapachesparkschedulerDAGScheduleranonfunabortStage applyDAGSchedulerscala at orgapachesparkschedulerDAGScheduleranonfunabortStage applyDAGSchedulerscala at scalacollectionmutableResizableArrayclassforeachResizableArrayscala at scalacollectionmutableArrayBufferforeachArrayBufferscala at orgapachesparkschedulerDAGSchedulerabortStageDAGSchedulerscala at orgapachesparkschedulerDAGScheduleranonfunhandleTaskSetFailed applyDAGSchedulerscala at orgapachesparkschedulerDAGScheduleranonfunhandleTaskSetFailed applyDAGSchedulerscala at scalaOptionforeachOptionscala at orgapachesparkschedulerDAGSchedulerhandleTaskSetFailedDAGSchedulerscala at orgapachesparkschedulerDAGSchedulerEventProcessLoopdoOnReceiveDAGSchedulerscala at orgapachesparkschedulerDAGSchedulerEventProcessLooponReceiveDAGSchedulerscala at orgapachesparkschedulerDAGSchedulerEventProcessLooponReceiveDAGSchedulerscala at orgapachesparkutilEventLoopanon runEventLoopscala Caused by javalangAbstractMethodError at orgapachesparkinternalLoggingclassinitializeLogIfNecessaryLoggingscala at orgapachesparkstreamingrabbitmqconsumerConsumerinitializeLogIfNecessaryConsumerscala at orgapachesparkinternalLoggingclasslogLoggingscala at orgapachesparkstreamingrabbitmqconsumerConsumerlogConsumerscala at orgapachesparkstreamingrabbitmqconsumerConsumeranonfunsetUserPassword applyConsumerscala at orgapachesparkstreamingrabbitmqconsumerConsumeranonfunsetUserPassword applyConsumerscala at scalaOptionforeachOptionscala at orgapachesparkstreamingrabbitmqconsumerConsumersetUserPasswordConsumerscala at orgapachesparkstreamingrabbitmqconsumerConsumerapplyConsumerscala at orgapachesparkstreamingrabbitmqreceiverRabbitMQReceiveranonfun applyRabbitMQInputDStreamscala at orgapachesparkstreamingrabbitmqreceiverRabbitMQReceiveranonfun applyRabbitMQInputDStreamscala at scalautilTryapplyTryscala at orgapachesparkstreamingrabbitmqreceiverRabbitMQReceiveronStartRabbitMQInputDStreamscala at orgapachesparkstreamingreceiverReceiverSupervisorstartReceiverReceiverSupervisorscala at orgapachesparkstreamingreceiverReceiverSupervisorstartReceiverSupervisorscala at orgapachesparkstreamingschedulerReceiverTrackerReceiverTrackerEndpointanonfun applyReceiverTrackerscala at orgapachesparkstreamingschedulerReceiverTrackerReceiverTrackerEndpointanonfun applyReceiverTrackerscala at orgapachesparkSparkContextanonfun applySparkContextscala at orgapachesparkSparkContextanonfun applySparkContextscala at orgapachesparkschedulerResultTaskrunTaskResultTaskscala at orgapachesparkschedulerTaskrunTaskscala at orgapachesparkexecutorExecutorTaskRunnerrunExecutorscala at javautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava at javautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava at javalangThreadrunThreadjava INFO schedulerReceiverTracker Restarting Receiver val receiverStream RabbitMQUtilscreateStreamssc Map hosts hosts queueName queueName exchangeName exchangeName exchangeType exchangeType vHost vHost userName userName password password vhost is wrong The correct variable name is virtualHost Please release a version with support for Apache Spark x Fixed correct link to Coverage so it looks nicer Updated example code for RabbitMQUtilscreateDistributedStream with correct parameters Changing from pom to jar packaging to be able to build jar file Uncertain why this was left as pom since the project does not contain any other modules I couldnt find how to acknowledge a message suggestion channelbasicAck