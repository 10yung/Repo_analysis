Hi all I was wondering if anyone had any guidance regarding how I would implement a control method WDAF MCWS etc to minimise the effects of unwanted room reverberations I have modelled the room reverberations using a simplified Image Source Method as shown in my code I believe that the basic approach of the control method should be to alter the driving signals to the array of loudspeakers however as I am relatively new to this field I am struggling to make much progression in my thesis If anyone has also dealt with the implementation of WDAF MCWS in applications not involving SFStoolbox I would also be very interested in hearing their approach Thanks for any help Jack Williams ISM CODE Room reverberations modelled as their own sources Based off ISM Image positions are calculated with a driving signal the same as its respective secondary source Listening area is central ring of speakers In order to see effect of room absorption manually change value of wabs before main loop Value of all sound absorbed anechoic Value of shows modest room reverberations visually affecting quality of of sound field in listening area Jack Williams SFSToolbox HWierstorf et al Notes WORK IN PROGRESS Wabs is in no means an accurate representation of how walls reflect sound and is to be altered in the future clear clc conf SFSconfig load default configuration settings from SFSconfigm file Simulation Resolution ie means x grid of pressure values confresolution input parameters for soundfieldmononfchoaXYZxssrcfconf X Y Z axes INCLUDING image sources xs position of point source src source type pw plane wave ps point source f monochromatic frequency R room dimensions R X R Y R Z xs src ps f Calculating Positions of Primary Sources within unshifted listening room centreX X centreY Y confsecondarysourcesnumber confsecondarysourcessize confsecondarysourcescenter centreX centreY confsecondarysourcesgeometry circle xprimary secondarysourcepositionsconf driving signals calculated for initial speaker set up x xprimary Dprimary drivingfunctionmononfchoax xssrcfconf listening position to consider reflections from centre of speaker set up Xl centreX centreY number of speakers to find images for inmax confsecondarysourcesnumber creating matrix of ones for position and driving signals of images ximage onesinmax Dimages onesinmax Initialising ISM Loop jn image number with images modelled per secondary source jn Weight of image sources Not finalised wabs jn image source number in primary source number For each i primary positions im are calculated for their corresponding image source For each i primary source driving signals Dimages are set for their corresponding image sources for in inmax columns not considered yet all directions are column weight needs to be considered through difference in pos SEE IMAGESOURCELOCATIONS code for calculations im R xprimaryin xprimaryin xprimaryin xprimaryin wabs jn jn ximagejn im Dimagesjn Dprimaryin im xprimaryin xprimaryin xprimaryin xprimaryin wabs jn jn ximagejn im Dimagesjn Dprimaryin im xprimaryin R xprimaryin xprimaryin xprimaryin wabs jn jn ximagejn im Dimagesjn Dprimaryin im xprimaryin xprimaryin xprimaryin xprimaryin wabs jn jn ximagejn im Dimagesjn Dprimaryin end finding max min XY values of image sources maximage maxximage minimage minximage combining image sources and primary sources x ximage xprimary shifting entire x x x minimage x x minimage assigning new limits of simulation area X maximage minimage Y maximage minimage Z Assigning driving signals for image sources D Dimages Dprimary Calculating sound Field Pxyz soundfieldmonoXYZx srcDfconf Plotting sound field confplotnormalisation center confplotusenormalisation true plotsoundfieldPxyzx conf As during the last years nobody contacted us via email and only I have access at least my guess to it I would propose to remove it and disable it in two years together with the sfstoolboxorg domain Still WIP Predictions are possible for single positions or as the mininum over extended listening areas only circles at the moment lines and ellipses are planned The algorithm sets the according parameters for the prediction of the aliasing frequency based on the SFS method WFS NFCHOA LWFSSBL or LWFSVSS and its parametrisation As the structure of the configuration struct undergoes continual changes it might be a good idea to add a validation script that compares the given struct against the current output of SFSconfig It should check for additional and missing entries in the struct One may use Some of the figures in the documentation are generated by using the implicit plotting functionality of some functions eg Matlab timeresponsewfsXxssrcconf Since Matlab has changed its default colors the output will no longer look the same as before and it will also deviate between Octave and Matlab We should find a way to avoid this but still show the cool automatic plotting functionality of the toolbox Note for changing the color in Matlab after the plot was done one could use the following Matlab hline findobjgcf type line sethlineColorred This includes two points Update the documentation on local WFS as soundfieldmonolocalwfs is now deprecated Repeat the structure of WFS NFCHOA LWFS for the Time Domain See For the start of the discussion have a look at As discussed in we have some inconsistencies in the description of dimension length in the function header For example Matlab x position and direction of secondary sources N x m d matrix of driving signals NxN in drivingfunctionimpnfchoa as opposed to Matlab x positions and directions of secondary sources m nx d driving signals mxn in drivingfunctionimpwfs We should agree on a common naming scheme and create a pull request in order to fix this We might add the driving functions of plane wave pointline source of the unified D WFS framework for different referencing schemes positions of amplitude correct synthesis PCS into the toolbox based on the findings see also nd Audio Eng Soc Conv Berlin for general vector notation of these driving functions Then only the referencing function must be adapted to work in general vector notation for desired reference curves I encountered a problem when using dummyirs and Matlabs resample function together resample does not work properly when the to be resampled vector does not contain some zeros at the start and end This happens since we moved the impulse to the first sample in commit b bd An example where this matters Simulating the impulse response of a linear WFS array with irwfs leads to ripples in the frequency response below the aliasing frequency in this case about Hz Setting confdelaylineresampling none shows the expected behaviour Matlab SFSstart SOFAstart conf SFSconfig confN secondary sources confsecondarysourcesgeometry line confsecondarysourcessize confsecondarysourcesnumber hrtf dummyirsconf wfs confwfshprefhigh confxref interpolation delaying weighting confirhrirpredelay predelay in samples confdelaylineresampling matlab confdelaylineresamplingfactor confdelaylinefilter integer irx irwfsconfxrefpi pshrtfconf plot N lengthir f N Nconffs TF fftir figure semilogxfdbabsTF grid setgcaXLim conffs xlabelfrequency Hz ylabeldB My suggestion would be to move the position of the dirac in dummyirs to eg sample from my experience the resample problem is not noticable for this value and then the additional delay can be substracted by setting confirhrirpredelay if this is important to the user for time alignment of stimuli This procedure would be in accordance with the handling of predelays in HRTFBRIRs 