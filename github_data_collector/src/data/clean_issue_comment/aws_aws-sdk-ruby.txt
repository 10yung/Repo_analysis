Issue Description When attempting to deletevoiceconnector I am getting the following error AwsChimeErrorsBadRequestException Service received a bad request Gem Name awssdkchime Version of Ruby OS environment docker container running Debian GNULinux stretch Code Snippets Steps to Reproduce clientlistvoiceconnectorsaccountseach do voiceconnector clientdeletevoiceconnectorvoiceconnectorid voiceconnectorvoiceconnectorid end Error Message AwsChimeErrorsBadRequestException Service received a bad request usrlocalbundlegemsawssdkcore libseahorseclientpluginsraiseresponseerrorsrb in call usrlocalbundlegemsawssdkcore libawssdkcorepluginsjsonvalueconverterrb in call usrlocalbundlegemsawssdkcore libawssdkcorepluginsidempotencytokenrb in call usrlocalbundlegemsawssdkcore libawssdkcorepluginsparamconverterrb in call usrlocalbundlegemsawssdkcore libawssdkcorepluginsresponsepagingrb in call usrlocalbundlegemsawssdkcore libseahorseclientpluginsresponsetargetrb in call usrlocalbundlegemsawssdkcore libseahorseclientrequestrb in sendrequest usrlocalbundlegemsawssdkchime libawssdkchimeclientrb in deletevoiceconnector appappservicesactorsawsactorschimevoiceconnectorsactorrb in delete By submitting this pull request I confirm that my contribution is made under the terms of the Apache license To make sure we include your contribution in the release notes please make sure to add description entry for your changes in the unreleased changes section of the CHANGELOGmd file at corresponding gem For the description entry please make sure it lives in one line and starts with Feature or Issue in the correct format For generated code changes please checkout below instructions first Thank you for your contribution Please fill out the sections below to help us address your issue Issue description We got a random NoMethodError from awssdkcoreendpointcacherb in our production app during a DynamoDB query request through the Ruby SDK We have never seen this before and saw it only once yesterday Im opening this issue as an FYI to you if its not useful feel free to close it I can reopen the issue if I start to see this more often Gem name awssdk awssdkresources or service gems like awssdks and its version gem awssdk Here is what is installed in my Gemfilelock awssdkcore Version of Ruby OS environment Ruby Amazon Linux EC instance managed by Opsworks Code snippets steps to reproduce AwsDynamoDBClientnewquery tablename tablename indexname indexname keyconditionexpression id id expressionattributevalues id s id projectionexpression d expressionattributenames d details Stack trace UTC Exception NoMethodError undefined method credentials for nilNilClass Details homedeploybundlermyappruby gemsawssdkcore libawssdkcoreendpointcacherb in extractkey homedeploybundlermyappruby gemsawssdkcore libawssdkcorepluginsendpointdiscoveryrb in discoverendpoint homedeploybundlermyappruby gemsawssdkcore libawssdkcorepluginsendpointdiscoveryrb in call homedeploybundlermyappruby gemsawssdkcore libseahorseclientpluginsendpointrb in call homedeploybundlermyappruby gemsawssdkcore libawssdkcorepluginsparamvalidatorrb in call homedeploybundlermyappruby gemsawssdkcore libseahorseclientpluginsraiseresponseerrorsrb in call homedeploybundlermyappruby gemsawssdkcore libawssdkcorepluginsjsonvalueconverterrb in call homedeploybundlermyappruby gemsawssdkcore libawssdkcorepluginsidempotencytokenrb in call homedeploybundlermyappruby gemsawssdkcore libawssdkcorepluginsparamconverterrb in call homedeploybundlermyappruby gemsawssdkcore libawssdkcorepluginsresponsepagingrb in call homedeploybundlermyappruby gemsawssdkcore libseahorseclientpluginsresponsetargetrb in call homedeploybundlermyappruby gemsawssdkcore libseahorseclientrequestrb in sendrequest homedeploybundlermyappruby gems Issue Description When attempting to listrooms or listroommemberships for team accounts I am getting the following error AwsChimeErrorsForbiddenException Chime Account provided is not an Enterprise Chime Account AWS Account ID xxxxxxxxxxxx Chime Account ID f a e c bd b e ac adbd Gem Name awssdkchime Version of Ruby OS environment docker container running Debian GNULinux stretch Code Snippets Steps to Reproduce clientlistaccountsaccountseach do account clientlistroomsaccountid accountaccountidroomseach do room clientlistroommembershipsaccountid accountaccountid roomid roomroomidroommembershipseach do membership puts Account ID accountaccountid Room ID roomroomid Member ID membershipmember accountid end end end Changing listaccounts to the following will let me get past the error clientlistaccountsaccountsselect account accountaccounttype Team each do account Error Message AwsChimeErrorsForbiddenException Chime Account provided is not an Enterprise Chime Account AWS Account ID xxxxxxxxxxxx Chime Account ID f a e c bd b e ac adbd usrlocalbundlegemsawssdkcore libseahorseclientpluginsraiseresponseerrorsrb in call usrlocalbundlegemsawssdkcore libawssdkcorepluginsjsonvalueconverterrb in call usrlocalbundlegemsawssdkcore libawssdkcorepluginsidempotencytokenrb in call usrlocalbundlegemsawssdkcore libawssdkcorepluginsparamconverterrb in call usrlocalbundlegemsawssdkcore libawssdkcorepluginsresponsepagingrb in call usrlocalbundlegemsawssdkcore libseahorseclientpluginsresponsetargetrb in call usrlocalbundlegemsawssdkcore libseahorseclientrequestrb in sendrequest usrlocalbundlegemsawssdkchime libawssdkchimeclientrb in listrooms Please fill out the sections below to help us address your issue Issue description Ruby SDK does not honor explicit profile in client when credentials from AWS environment variables are present whereas Golang SDK supports this I have AWS environment variables setup Gem name awssdkcore latest Code snippets steps to reproduce testrb ruby require awssdkcore p AwsSTSClientnewprofile ENV PROFILE getcalleridentity bash awscredentialsenv bundle exec ruby testrb struct AwsSTSTypesGetCallerIdentityResponse useridAIDAT A account arnarnawsiam usernoelgeorgi awscredentialsenv PROFILEstatic bundle exec ruby testrb struct AwsSTSTypesGetCallerIdentityResponse useridAIDAT A account arnarnawsiam usernoelgeorgi sharedgo golang package main import fmt os githubcomawsawssdkgoawssession githubcomawsawssdkgoservicests func main create a session opts sessionOptions optsProfile osGetenvPROFILE optsSharedConfigState sessionSharedConfigEnable session err sessionNewSessionWithOptionsopts if err nil fmtPrintlnerr create a service client stsClient stsNewsession create a request request stsGetCallerIdentityInput call the service operation id err stsClientGetCallerIdentity request if err nil fmtPrintlnerr else handle the response fmtPrintfAccountId s Arn s UserId s idAccount idArn idUserId fmtPrintln bash awscalleridentity go run sharedgo AccountId Arn arnawsiam usernoelgeorgi UserId AIDAT A awscalleridentity PROFILEstatic go run sharedgo AccountId Arn arnawsiam usernoelgeorgi UserId AIDAV Y Golang SDK honors passing in explicit profile even with ENV vars set whereas ruby SDK uses the ENV vars only Side note Ruby SDK also does not support credentialsource as Enviroment Please fill out the sections below to help us address your issue Issue description IAM Roles for Service Accounts has been released in AWS for Kubernetes clusters running v In the linked article it mentions a minimum version of the Ruby SDK required to interact natively with this service without manually making a STS call via the command line and setting env variables is Ruby The issue I am seeing is that when I pass a region parameter to instantiate a Client as part of my code this region is not being passed to the STS call this error occurs in all three of the clients I have tried IAM S EC I assume this is something to do with the new handling of the assumerolewebidentitycredentials released by AWS as part of this When using our original IAM implementation with kube IAM the same code does not cause any errors only when using IAM roles for Service Accounts A workaround for anyone reading prefix is to set Awsconfigupdate region region at the start of your code rather than set it as part of the client eg ec AwsEC Clientnewregion uswest but this would not be a solution for large codebases this might affect Configuration options available Error usrlocalbundlegemsawssdkcore libawssdkcorepluginsregionalendpointrb in afterinitialize missing region use region option or export region name to ENV AWSREGION AwsErrorsMissingRegionError from usrlocalbundlegemsawssdkcore libseahorseclientbaserb in block in afterinitialize from usrlocalbundlegemsawssdkcore libseahorseclientbaserb in each from usrlocalbundlegemsawssdkcore libseahorseclientbaserb in afterinitialize from usrlocalbundlegemsawssdkcore libseahorseclientbaserb in initialize from usrlocalbundlegemsawssdkcore libawssdkstsclientrb in initialize from usrlocalbundlegemsawssdkcore libseahorseclientbaserb in new from usrlocalbundlegemsawssdkcore libawssdkcoreassumerolewebidentitycredentialsrb in initialize from usrlocalbundlegemsawssdkcore libawssdkcorecredentialproviderchainrb in new from usrlocalbundlegemsawssdkcore libawssdkcorecredentialproviderchainrb in assumerolewebidentitycredentials from usrlocalbundlegemsawssdkcore libawssdkcorecredentialproviderchainrb in block in resolve from usrlocalbundlegemsawssdkcore libawssdkcorecredentialproviderchainrb in each from usrlocalbundlegemsawssdkcore libawssdkcorecredentialproviderchainrb in resolve from usrlocalbundlegemsawssdkcore libawssdkcorepluginscredentialsconfigurationrb in block in classCredentialsConfiguration from usrlocalbundlegemsawssdkcore libseahorseclientconfigurationrb in call from usrlocalbundlegemsawssdkcore libseahorseclientconfigurationrb in block in resolvedefaults from usrlocalbundlegemsawssdkcore libseahorseclientconfigurationrb in each from usrlocalbundlegemsawssdkcore libseahorseclientconfigurationrb in each from usrlocalbundlegemsawssdkcore libseahorseclientconfigurationrb in resolvedefaults from usrlocalbundlegemsawssdkcore libseahorseclientconfigurationrb in valueat from usrlocalbundlegemsawssdkcore libseahorseclientconfigurationrb in block in resolve from usrlocallibruby setrb in eachkey from usrlocallibruby setrb in each from usrlocalbundlegemsawssdkcore libseahorseclientconfigurationrb in resolve from usrlocalbundlegemsawssdkcore libseahorseclientconfigurationrb in applydefaults from usrlocalbundlegemsawssdkcore libseahorseclientconfigurationrb in build from usrlocalbundlegemsawssdkcore libseahorseclientbaserb in buildconfig from usrlocalbundlegemsawssdkcore libseahorseclientbaserb in initialize from usrlocalbundlegemsawssdkec libawssdkec clientrb in initialize from usrlocalbundlegemsawssdkcore libseahorseclientbaserb in new from apprb in main This PR may be a fix but I am not sure enough of how the gems work to make that assumption Gem name awssdk awssdkresources or service gems like awssdks and its version Has been observed using the following gems but may affect others awssdks awssdkec awssdkiam Version of Ruby OS environment Ruby Running on the ruby Docker base image Running inside a Kubernetes Cluster with v and an OIDC provider for IRSA Code snippets steps to reproduce Needs to be using the IRSA features as a pod in AWS EKS or another Cluster Causes an issue require awssdks require awssdkec require awssdkiam require yaml region useast Logging for Docker if ENV DOCKERLOGS fd IOsysopenproc fd w else fd IOsysopendevstdout w end a IOnewfdw async true begin clientEC AwsEC Clientnew region region Causes the issue aputs n Getting Worker Nodes resp clientEC describeinstances filters name tagKubernetesCluster values klustername name vpcid values vpcid respreservationseach do r rinstanceseach do i aputs iinstanceid aputs iprivatednsname aputs isecuritygroups groupname end end aputs n Getting Tags for single Worker Node resp clientEC describetags filters name resourceid values amiid aputs YAMLdump resptoh rescue AwsEC ErrorsServiceError e aputs e end Working scenario require awssdks require awssdkec require awssdkiam require yaml region useast Logging for Docker if ENV DOCKERLOGS fd IOsysopenproc fd w else fd IOsysopendevstdout w end a IOnewfdw async true Awsconfigupdate region region begin clientEC AwsEC Clientnew No error aputs n Getting Worker Nodes resp clientEC describeinstances filters name tagKubernetesCluster values klustername name vpcid values vpcid respreservationseach do r rinstanceseach do i aputs iinstanceid aputs iprivatednsname aputs isecuritygroups groupname end end aputs n Getting Tags for single Worker Node resp clientEC describetags filters name resourceid values amiid aputs YAMLdump resptoh rescue AwsEC ErrorsServiceError e aputs e end Consider an API Gateway endpoint with a required HTTP request header for AcceptLanguage eg OpenAPI def paths jobsid get operationId getById produces applicationjson parameters name AcceptLanguage in header required true type string The generated Ruby SDK does not provide a way to pass the required parameter to the endpoint Gem name awssdk awssdkresources or service gems like awssdks and its version API Gateway generated awssdkv Thanks Please fill out the sections below to help us address your issue Issue description In a rails application Im using Cognito to manage user authentication I recently noticed that calls logs are automatically added to the logs but there is an issue Cognito initiateauth method with authflow USERPASSWORDAUTH is exposing the password provided by the user AwsCognitoIdentityProviderClient retries initiateauthclientid FILTERED authflowUSERPASSWORDAUTHauthparametersUSERNAMEtestgmailcomPASSWORDTest Gem name awssdk awssdkresources or service gems like awssdks and its version awssdkcore awssdkcognitoidentityprovider Version of Ruby OS environment ruby Mac OS Code snippets steps to reproduce my code COGNITOCLIENT AwsCognitoIdentityProviderClientnew COGNITOCLIENTinitiateauth clientid ENV AWSCOGNITOCLIENTID authflow USERPASSWORDAUTH authparameters USERNAME username PASSWORD password The issue is related to the filter methods in def filterhashvalues filtered valueseachpair do key value filtered key filtersincludekey FILTERED filtervalue end filtered end During parsing authparameters hash keys of this hash are actually string written in the capital letters so they do not match symbols form SENSITIVE constant My suggestion is to include PASSWORD or authparameters in SENSITIVE constant or to add some parsing to the key in this method to make it more universal like def filterhashvalues filtered valueseachpair do key value key keydowncasetosym filtered key filtersincludekey FILTERED filtervalue end filtered end This change produces log like AwsCognitoIdentityProviderClient retries initiateauthclientid FILTERED authflowUSERPASSWORDAUTHauthparametersusername FILTERED password FILTERED Issue description Would it be feasible to prepopulate Awsconfig from the runtime environment For example if ENV AWSREGION is set and nonempty then by default Awsconfig region ENV AWSREGION Likewise for any settings picked up from aws or elsewhere This would enable inapp configuration code like the following ruby Awsconfig region useast Where a reasonable default is provided but can overridden from the outside without code modification Additionally it may be useful when one wants to test what config values are being picked up from the environment for example when debugging Gem name awssdk awssdkresources or service gems like awssdks and its version awssdk Version of Ruby OS environment any Code snippets steps to reproduce NA Please fill out the sections below to help us address your issue Issue description When exporting job settings utilizing getjob the word FILTERED is showing up in the output It was originally HLSGROUPSETTINGS when the job ran successfully but the export is replacing that when its output through the api call Gem name awssdk awssdkresources or service gems like awssdks and its version require awssdks require awssdkmediaconvert Version of Ruby OS environment Code snippets steps to reproduce outputgroups customname HLSOutput name FILTERED outputgroupsettings cmafgroupsettings dashisogroupsettings filegroupsettings hlsgroupsettings admarkers baseurl captionlanguagemappings captionlanguagesetting OMIT clientcache ENABLED codecspecification RFC destination s samplevideooutputHLSTestVideo destinationsettings directorystructure SINGLEDIRECTORY encryption manifestcompression NONE manifestdurationformat INTEGER minfinalsegmentlength minsegmentlength outputselection MANIFESTSANDSEGMENTS programdatetime EXCLUDE programdatetimeperiod segmentcontrol SEGMENTEDFILES segmentlength segmentspersubdirectory streaminfresolution INCLUDE timedmetadataid frame PRIV timedmetadataid period timestampdeltamilliseconds mssmoothgroupsettings type FILTERED outputs