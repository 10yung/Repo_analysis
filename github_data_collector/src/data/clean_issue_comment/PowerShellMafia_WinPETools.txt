When NewPartition is called in ExpandWinPEImage it uses UseMaximumSize which will result in an attempt to create a FAT partition greater than what FAT will allow GB The solution would be to use UseMaximumSize if the disk is GB Otherwise Size GB should be used 