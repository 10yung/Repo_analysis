In AppDeployToolkitMainps lines the code prevents the name of the product being displayed in the dialog if CloseApps is specified which is confusing for the enduser if the application is deployed to them as Required via SCCM Initial form layout Close Applications Allow Deferral If showCloseApps labelAppNameText configClosePromptMessage ElseIf showDefer or forceCountdown labelAppNameText configDeferPromptWelcomeMessage ninstallTitle Changing line to the following fixes this issue The escape characters are messing it up a bit but you get the idea labelAppNameText configDeferPromptWelcomeMessage ninstallTitlennconfigClosePromptMessage Hi I am testing PSAppDeployToolkit with Windows Defender Application control The following line in executeprocess fails stdOutBuilder NewObject TypeName SystemTextStringBuilder ArgumentList I replaced it with stdOutBuilder NewObject TypeName SystemTextStringBuilder ArgumentList String Empty See error message below Installation ExecuteProcess Function failed setting exit code to Error Record Message Cannot validate argument on parameter ArgumentList Cannot process input The argument SystemObject is not trusted InnerException SystemManagementAutomationValidationMetadataException Cannot process input The argument SystemObject is not trusted at SystemManagementAutomationValidateTrustedDataAttributeValidateObject arguments EngineIntrinsics engineIntrinsics at SystemManagementAutomationParameterBinderBaseBindParameterCommandParameterInternal parameter CompiledCommandParameter parameterMetadata ParameterBindingFlags flags FullyQualifiedErrorId ParameterArgumentValidationErrorMicrosoftPowerShellCommandsNewObjectCommand ScriptStackTrace at ExecuteProcessProcess C Users kimoppalfens Downloads Putty AppDeployToolkit AppDeployToolkitMainps line at ExecuteMSIProcess C Users kimoppalfens Downloads Putty AppDeployToolkit AppDeployToolkitMainps line at ScriptBlock C Users kimoppalfens Downloads Putty DeployApplicationps line at ScriptBlock No file line PositionMessage At C Users kimoppalfens Downloads Putty AppDeployToolkit AppDeployToolkitMainps char r NewObject TypeName SystemTextStringBuilder ArgumentList Error Inner Exceptions Message Cannot process input The argument SystemObject is not trusted InnerException Add logic to allow ExecuteProcessAsUser to run PowerShell scriptblocks SetPinnedApplication does not work anymore on Windows When using pin action to Start menu in the SetPinnedApplication function the FilePath parameter is case sensitive on Windows This is caused by StartsWith being case sensitive FilePathStartsWithenvUserStartMenu or FilePathStartsWithenvCommonStartMenu Solution is to make StartsWith not case sensistive FilePathStartsWithenvUserStartMenu CurrentCultureIgnoreCase or FilePathStartsWithenvCommonStartMenu CurrentCultureIgnoreCase Hi I have create a simple package that will enable Net Framework on Windows machine using the command ExecuteProcess Path envSystem Directory Dismexe Parameters Online DisableFeature FeatureNameNetFX WindowStyle Hidden The package runs well when I launch it with DeployApplicationexe However if renew the DeployApplicationexe to another any other name I will get the Windowss Prompt to enable Net Framework I did not rename the DeployApplicationexeconfig and DeployApplicationps files Cheers Stanley Lim Id like to extend the ToolkitHelpps with my own functions Other people can quickly find help for these functions when needed its all at one place AppDeployToolkitMainps does not dot source AppDeployToolkitExtensionsps when called from AppDeployToolkitHelpps This needs to be changed or dot source directly from the AppDeployToolkitHelpps file scriptDirectory AppDeployToolkitExtensionsps edit Maybe split of function pane to seperate customs from original default prefix for function or names in different color CustomFunctionHelp Hi All Ive been using PSADT for a little while now and its been awesome I think I just found a bug in the ShowInstallationPrompt dialog when using the Timeout and PersistPrompt Basically after attempting to close using the X in the top right corner of the dialog the dialog reappears as expected but the timeout now does not work the dialog sits there forever Here is a code example of what Im doing Main Function DisplayPopup messageA critical update needs to be applied in math RoundTimeLeftTotalMinutes after which forced restart will occur Select Defer to defer this message for minutes or select Install Now to apply the update immediately ButtonPressedShowInstallationPrompt title Critical Update message message ButtonLeftText Defer ButtonRightText InstallNow Icon None PersistPrompt timeout ExitOnTimeout false MessageAlignment Left MinimizeWindows true return ButtonPressed StartTimeGetDate DurationNewTimeSpan Minutes TimeLeft Duration NewTimeSpan Start StartTime End GetDate do switch DisplayPopup Defer TimeLeft Duration NewTimeSpan Start StartTime End GetDate Timer math RoundTimeLeftTotalMinutes WriteHost User selected Defer time left is timer StartSleep s InstallNow WriteHost User selected InstallNow Duration NewTimeSpan Minutes Break TimeLeft Duration NewTimeSpan Start StartTime End GetDate Timer math RoundTimeLeftTotalMinutes WriteHost Timer timer minutes While timer ge Ive already updated to PSADT and the issue persists Cheers Captain Hello I do NOT use a deploymentsolution like SCCM I call the PSAppDeployToolkit from a PowerShellscript It is not important but the call looks somehow like this Powershell StartProcess FilePath PowerShellexe WorkingDirectory C Temp MyPackage PassThru Wait ArgumentList ExecutionPolicy ByPassNoProfileNoLogoFile C Temp MyPackage DeployApplicationps DeploymentType InstallDeployMode Silent The PowerShellwindow opens and the installation of the package starts Unfortunately the window has no meaningful title WindowTitle When installing a lot of packages in a sequence I would love to see the packagename in the windowtitle somehow like this WindowsTitlemod Getting the title like in the example above is a oneliner Powershell HostUIRawUIWindowTitle DeploymentType installTitle I would love if you could implement this Thank you I have Discovered this when using ExecuteMSI uninstall PRODUCTCODE the logname is generatet by using the data from the registry entry of this software By using this characters like are not removed from the LogName and the when using Zipcompression for the logs the operation fails due bad filenames So for this Software I get an error after the uninstall Window 