Hi Guangchuang When i run the followed code i can not obtain the clade subtree Do you know the reason Thanks for your help libraryggtree librarytidytree nwk systemfileextdata samplenwk packagetreeio tree readtreenwk p ggtreetree geomtiplab viewCladep MRCAp tipcI L The error information is as followed Error in UseMethodMRCA no applicable method for MRCA applied to an object of class cggtree gg ggplot In addition Warning messages In getcladepositiontreeviewdata node restarting interrupted promise evaluation In getcladepositiontreeviewdata node restarting interrupted promise evaluation In getcladepositiontreeviewdata node restarting interrupted promise evaluation Prerequisites Have you read Feedback and follow the guide make sure your are using the latest release version read the documents google your questionissue Describe you issue Make a reproducible example eg your code should contain comments to describe the problem eg what expected and actually happened Ask in right place for bugs or feature requests post here github issue for questions please post to google group Hello Respect DrYu Im appreciated your masterpiece of ggtree while there is a problems perplex me and i sincerely looking forward to your reply Question Alouthgh i got my result with my codes i recived a Warning message when i used gheatmap of ggtree Warning message attributes are not identical across measure variables they will be dropped I had verified the name of tree file and the name of data for gheatmap The row names of attributes and variables of tree file dons make any different the code is below CODES trereadnewickGENE nwknodelabel support datareadcsvGENETYPECSVsep rownames header T pp ggtreetre geomtiplabsize align T geomnodepointaescolorsupport scalecolorgradientML Tree Bootstrap ValuehighPink loworange themelegendpositionleft geomtreescalefontsize linesize offset gheatmapppdataoffset color BLACK Addition There is my screen shot of my datagene typecsv and tree And I apologize for Mosaic because personal reasons QQ QQ How can i fix it Thanks for your time Dear Guangchuang I am a huge fan of ggtree thanks for developing this amazing tool I just tried to annotate my tree with some additional metadata according to In principle it is working but R throws an error at me for the length of the aestetics Error Aesthetics must be either length or the same as the data colour I dont understand why this is happening I have a newick file and a metadata file and the metadata file only contains columns tailmeta name category SV nondatabase CP Enterococcus cecorum database CP Enterococcus cecorum database CP Enterococcus cecorum database CP Enterococcus cecorum database SV nondatabase Now since I derived the metadata from the alignemnt file that was used to create the newick tree the number of sequences must be the same Yet the newick file data seems to be longer as the metadata Why is that and is there a work around How else can I annotate the two different categories I need to have each individual leaf annotated Thank you so much for your help Best wishes Tse PS Also depending on what parameters I change I get the following error message Error Must request at least one colour from a hue palette But If the length was the same I could solve this easily And if you have the chance to reply today I would appreciate that very much Im a bit in a hurry geomtreescale interacts oddly with the fan layout If you give x and y they are actually interpreted as r and theta polar coordinates The units for y are are not degrees radians or anything else standard but based on the number of tips in the tree ie point of y is n degrees where the tree has n tips The scale line rotates as y changes The above two points are manageable but this means tinkering with a vector graphics package is basically essential if you want to place the scale MWE libraryape libraryggtree atree rtree small and large x values scale the tree ggtreeatree layoutfan geomtreescalex ggtreeatree layoutfan geomtreescalex y values rotate the line ggtreeatree layoutfan geomtreescalex y Hello Codeml does not produce separate mlc files anymore the data are merged with the general output file defined in codemlctl I was wondering if I could see an actual mlc output file so I could make my own that I can then use with ggtree I need to plot the dNdS values along branches and readcodeml does not seem to work with my rst file or general output files Thanks Prerequisites x Have you read Feedback and follow the guide x make sure your are using the latest release version x read the documents x google your quesionissue Describe you issue x Make a reproducible example eg x your code should contain comments to describe the problem eg what expected and actually happened Hi brj I wanted to use your density trees plot as requested in that has not made it yet into ggtree Sadly already the installation of it fails r Sure weve installed tidytree librarytidytree Install brj s for of ggtree devtoolsinstallgithubbrj ggtree This results in an error Downloading GitHub repo brj ggtreemaster checking for file tmpRtmpfu zfCremotes d b b brj ggtree d cf DESCRIPTION preparing ggtree checking DESCRIPTION metainformation checking for LF lineendings in source and make files and shell scripts checking for empty or unneeded directories building ggtree targz Installing package into homerichelRx pclinuxgnulibrary as lib is unspecified installing source package ggtree R inst bytecompile and prepare package for lazy loading Error object asdataframe is not exported by namespacetidytree ERROR lazy loading failed for package ggtree removing homerichelRx pclinuxgnulibrary ggtree restoring previous homerichelRx pclinuxgnulibrary ggtree Error in ip converted from warning installation of package tmpRtmpfu zfCfile d d f baggtree targz had nonzero exit status Apparently the tidytree has its interface changed I hope you brj can fix it Ask in right place x for bugs or feature requests post here github issue for questions please post to google group Sorry Guangchuang for using your repo for this Issue It is just that forks do not have their own Issues Prerequisites x Have you read Feedback and follow the guide x make sure your are using the latest release version x read the documents x google your quesionissue Describe you issue x Make a reproducible example eg x your code should contain comments to describe the problem eg what expected and actually happened Hi GuangchuangYu thanks for ggtree There is some behavior that I think may be incorrect I hope you can fix that or my misunderstanding Cheers richelbilderbeek Here is the reprex r libraryape libraryggplot Here I create two trees In one tree taxon C is the outlier In the other tree taxon B is the outlier tree apereadtreetext A B C tree apereadtreetext A C B Show it in a picture plottree plottree tree tree Combine the trees trees ctree tree Show them overlapping ggtreeggtreetrees ggtreegeomtiplab The tree created by ggtree shows that C is the outlier in both cases treecreated This is a plot I would have expected in which B and C are outliers each once treeexpected Ask in right place x for bugs or feature requests post here github issue for questions please post to google group Hello First of all thanks for making this super awesome package Not sure how I havent discovered it before now but I love it Thanks I was wondering if it would be possible to add a feature in the msaplot function to color the residues by similarity Even just a white to black gradient showing which residues are more conserved within the alignment would be really helpful to have Not sure how complicated it would be to implement but it would be very helpful Thanks again Regards Ben Hi there I would find very useful if it would be possible to add values to gheatmap cells The gheatmap function allows to easily display a matrix of cells colored from values taken in a dataframe However I cant find a way to display the values from which the colors are drawn As an example the regular heatmap function include the cellnote argument which read a list of strings that will be displayed within each color cell Looking forward to hear back from this suggestion Let me know if this require more details All the best and thanks for the great work you guys are doing Adrien Code to reproduce the bug with error log R librarytidyverse libraryRNeXML Loading required package ape librarytreeio Attaching package treeio The following object is masked from packageape droptip libraryggtree ggtree v For help If you use ggtree in published research please cite Guangchuang Yu David Smith Huachen Zhu Yi Guan Tommy TsanYuk Lam ggtree an R package for visualization and annotation of phylogenetic trees with their covariates and other associated data Methods in Ecology and Evolution doi X Attaching package ggtree The following object is masked from packageape rotate The following object is masked from packagetidyr expand f systemfileexamples companalysisxml packageRNeXML nexml nexmlreadf Found more than one class tree in cache using the first from namespace cli Also defined by RNeXML Found more than one class tree in cache using the first from namespace cli Also defined by RNeXML Found more than one class tree in cache using the first from namespace cli Also defined by RNeXML Error in validObjectObject invalid class MethodWithNext object invalid object for slot nextMethod in class MethodWithNext got class NULL should be or extend class PossibleMethod 