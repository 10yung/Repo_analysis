Summary could not write command to device but could read from device Actual Result Bluejay main Started write to Characteristic FFB F B FB Service FFB F B FB on E D EE B CC D DF DB Bluejay main Failed writing to Characteristic FFB F B FB Service FFB F B FB on E D EE B CC D DF DB with error Writing is not permitted Failed to write to sensor location with error Writing is not permitted Bluejay main Queue has removed BluejayWriteCharacteristicSwiftString because it has finished Bluejay main Queue is empty nothing to update data Optional ReturnTemp n return temp data Optional ReturnTemp n return temp data Optional ReturnTemp n return temp data Optional ReturnTemp n return temp data Optional ReturnTemp n return temp data Optional ReturnTemp n return temp Device Build OS bt Xcode iOS Fixes Summary of Problem Wed like to be able to add and manage services created with Dittojay through JSON instead of having to add them in code Proposed Solution Created a simple JSON schema that can be parsed to create services from A couple questions I noticed that the CBMutableService constructor calls the UUID param type is there a reason we should do this as well or is it clearer to just stick with uuid Is it helpful to have some sort of userdefined name attribute for keeping track of services once theyre loaded Do we need to require UUIDs be set ahead of the time or can they be optional and generated at runtime by Dittojay Does it make sense to have value passed in as a String that we can then convert into Data Fixes Fixed bug in start with mode use added missing restoration centralManager delegate and then added queuestart Summary of Problem There is a missing delegation restoration when using start with mode use we were forced to use start with mode use because in iOS bluejaystart and connect no longer work after another cbCentralManager has completed a scan prior to iOS another scan with another cbCentralManager was not required For further info about this issue feel free to contact me Proposed Solution When recycling a cbCentralManager we need to restore its delegation to bluejay Also it is necessary to add queuestart to solve the issue in Queue is paused because CBCentralManager is not ready yet as JeremyChiang proposed Testing Completed and Required Screenshots Currently i dont see any API to disable logging permanently to the file although there is exposed function to clear logs Am i missing something or there is no such functionality In case of not having such option could i propose PR with Bluejay Configuration structure to toggle it This issue is related about how iOS caches peripherals and how it updates its cached data one the device is connected Once you do scan iOS caches all the peripherals names in advertising packets along with a the assigned UUIDs Once you connect to a peripheral the name property is updated with the name in the GAP sometime advertising name and GAP name could differ due to size reason Cached names and peripheral identifiers persist until a full erase on the iOS devices If another device changes the name of peripheral some inconsistency could arise The connection mechanism on Bluejay works on peripheral identifier once we pass the peripheral identifier extracts the UUID call the method retrievePeripherals and obtain the related CBPeripheral This peripheral is passed to a Connection operation that also set the connectingPeripheral property Once the device is connected in the didConnect delegate method of CBCentralManager the connectingPeripheral is passed to the connectedPeripheral basically avoiding any possibility to the name to be updated also on the bluejay side since the connectingPeripheral represent the old state Summary I found this doing the same testing that I mention in Steps to Reproduce Press the connectdisconnect button very quickly causing fast sequences of connecting and disconnecting Actual Result Crashes on Bluejay main BluejayConnection added to queue with UUID FD F F D B D Bluejay main Init Peripheral BluejayPeripheral x ad OptionalCBPeripheral x e dc identifier BC C F A A F A D EB D name Peripheral state disconnected Bluejay main Queue will start BluejayConnection Bluejay main Started connecting to Peripheral Bluejay main Explicit disconnect called Bluejay main Cancel everything called with error Explicit disconnect shouldDisconnect true Bluejay main Cancel everything called while still connecting Bluejay main Should autoreconnect false Bluejay main Queue will now cancel all operations with error Explicit disconnect Bluejay main Cancelling a pending connection to Peripheral Bluejay main Interrupting cancel all to terminate a pending connection Bluejay main Central manager did connect to Peripheral Bluejay main Should autoreconnect true Bluejay main Connected to Peripheral Bluejay main Queue has removed BluejayConnection because it has finished Bluejay main Queue is empty nothing to update Bluejay main Connection deinitialized Bluejay main Requesting read on Characteristic D E D D C D A FCFE B B Service D E B D D DC B EDDF AD Bluejay main Queue will start BluejayDiscoverService Bluejay main Central manager did disconnect from Peripheral without errors Bluejay main Peripheral was connected before centralManagerdidDisconnectPeripheralerror Bluejay main Cleared all restoration peripheral references Bluejay main Cleared all non restoration peripheral references Bluejay main The disconnect is expected Bluejay main Should autoreconnect false Bluejay main Deinit Peripheral BluejayPeripheral x c OptionalCBPeripheral x e dc identifier BC C F A A F A D EB D name Peripheral state disconnected Bluejay main Starting disconnect clean up Crash occurs here Expected Result The connectsdisconnects happen as expected Device Build OS iPhone Xs Bluejay iOS 