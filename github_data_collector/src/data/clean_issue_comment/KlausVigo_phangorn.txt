Essentially the job optimpml function just continues to run I have left if for hours and when I finally give up and stop it it returns the error below The same piece of code was working perfectly a month ago and would only take a couple of minutes to run Im still relatively new to the world of R and dont know whats happening under the hood with the function so I am not sure how to interpret the error I have tried the basics like uninstalling and reinstalling packages both current and old versions and done the same with R I have also tried saving the optimpml output as a new object as was advised by someone else I am stuck so any help would be appreciated Thank you optim pml Hello Im trying to plot a network imported from SplitsTree When I simply plot the network all tips appear to be labeled plottest D showtiplabel T edgewidth cex net pdf However if I initially omit the tip labels and try to add them back later some of the tips are skipped An example node is circled in the plot above plottest D showtiplabel F edgewidth tiplabelspch col red net pdf The tip originally labeled E does not get a red circle Ive only noticed this with the very shortest of tip edges but I may have missed other instances Is there a workaround Am I missing something Im using phangorn R and SplitsTree on a Mac The network file Im using is attached Thanks for any help Tim boodenovowestc mac spl hwerep nolowphynexzip I was wondering if anyone encountered this error while running the Appendix Standard scripts for amino acid analysis At the last line of code I sometimes get this error working with exact same sequences and sometimes not What I do is run the script a couple of times and find the one that turns out fine which is a waste of resources not ideal for automatization of a larger script and also hard to reproduce unfortunately Thanks in advance Here is the truncated code for ease of access libraryphangorn filemyfile dat readphyDatfile type AA dm distmldat modelJTT tree NJdm parallel will only work safely from command line and not at all windows mt modelTestdat modelcJTT LG WAG multicoreTRUE run all available amino acid models mt modelTestdat modelall multicoreTRUE fitStart evalgetmtModel whichminmtBIC env env fitNJ pmltree dat modelJTT k inv fit optimpmlfitNJ rearrangement stochastic optInvTRUE optGammaTRUE fit bs bootstrappmlfit bs optNniTRUE multicoreTRUE Where the error occurs optimize topology optimize edge weights Error in FUNX i one tree has a different number of tips Calls ebiTreeCreate bootstrappml compressTipLabel lapply FUN Execution halted sessionInfo R version Platform x pclinuxgnu bit Running under Ubuntu LTS Matrix products default BLAS usrlibx linuxgnublaslibblasso LAPACK usrlibx linuxgnulapackliblapackso locale LCCTYPEenUSutf LCNUMERICC LCTIMEenUSutf LCCOLLATEenUSutf LCMONETARYenUSutf LCMESSAGESenUSutf LCPAPERenUSutf LCNAMEC LCADDRESSC LCTELEPHONEC LCMEASUREMENTenUSutf LCIDENTIFICATIONC attached base packages tools stats parallel stats graphics grDevices utils datasets methods base other attached packages datatable ggtree treeio ggplot DECIPHER RSQLite rphast phangorn ape msa seqinr stringr Biostrings XVector IRanges S Vectors BiocGenerics loaded via a namespace and not attached Rcpp pillar compiler zlibbioc digest bit jsonlite tibble memoise nlme gtable lattice pkgconfig rlang Matrix fastmatch igraph DBI rvcheck withr dplyr tidyselect ade bit grid glue R tidyr purrr blob magrittr scales MASS assertthat colorspace quadprog stringi lazyeval munsell crayon With commit e a d e f eba d b cdbe aae there is a bracket error that breaks the package and all its dependencies for example here I submitted an earlier Pull Request but that turned out to be only a halfway fix New PR is here I have a nexus file which I opened and subsequently saved on Splitstree I have therefore confirmed that this file can be read by Splitstree However when I tried to open it using phangorn in R I am unable to I have tried the readnexusnetworx command but it gives me the error NAs introduced by coercion Opening it by readnexus gives me Error in startend argument of length However I do not get an error when I print only the splits with the readnexussplits command Is there any reason why I get this error Is there a problem with the file itself Sorry about this I am very new to programming Hello I have sequences which I align them with DECIPHER packages AlignSeqs function Then I try to convert it phyDat object using phyDat function and run a ML based method to create a phylogenetic tree Code is attached below I think the error is with convertion of DECIPHERAlignSeqs output which is AAStringSet to phyDat object fastaDecipherAligned DECIPHERAlignSeqsfastaRefined savefastaDecipherAligned file fastaDecipherAlignedRData fastaphyDat phyDatasfastaDecipherAligned matrix type AA Guessing this is not working rmfastaDecipherAligned namesfastaphyDat homologySummary lengthfastaphyDat SequenceFullName dm distmlfastaphyDat modelJTT tree NJdm catTesting all models n mt modelTestfastaphyDat modelall multicoremultiCoreBool env attrmt env fitStart evalgetmtModel whichminmtBIC env env fitNJ pmltree fastaphyDat modelfitStartmodel k inv fitNJ pmltree fastaphyDat model JTT k inv fit optimpmlfitNJ rearrangement stochastic optInvTRUE optGammaTRUE fit Code truncated and also commented out modelTest as it also returned memory not mapped error The code is run on the server and the following is the complete output nohup ignoring input Loading required package methods Loading required package BiocGenerics Loading required package parallel Attaching package BiocGenerics The following objects are masked from packageparallel clusterApply clusterApplyLB clusterCall clusterEvalQ clusterExport clusterMap parApply parCapply parLapply parLapplyLB parRapply parSapply parSapplyLB The following objects are masked from packagestats IQR mad sd var xtabs The following objects are masked from packagebase anyDuplicated append asdataframe cbind colMeans colnames colSums docall duplicated eval evalq Filter Find get grep grepl intersect isunsorted lapply lengths Map mapply match mget order paste pmax pmaxint pmin pminint Position rank rbind Reduce rowMeans rownames rowSums sapply setdiff sort table tapply union unique unsplit which whichmax whichmin Loading required package S Vectors Loading required package stats Attaching package S Vectors The following object is masked from packagebase expandgrid Loading required package IRanges Loading required package XVector Attaching package Biostrings The following object is masked from packagebase strsplit Attaching package seqinr The following object is masked from packageBiostrings translate Attaching package ape The following objects are masked from packageseqinr asalignment consensus The following object is masked from packageBiostrings complement Attaching package rphast The following object is masked from packageape complement The following object is masked from packagemsa msa The following object is masked from packageBiostrings complement Loading required package RSQLite Loading required package ggplot Loading required package treeio Attaching package treeio The following object is masked from packagephangorn getRoot The following objects are masked from packageape droptip Nnode Ntip The following object is masked from packageBiostrings mask ggtree v For help If you use ggtree in published research please cite Guangchuang Yu David Smith Huachen Zhu Yi Guan Tommy TsanYuk Lam ggtree an R package for visualization and annotation of phylogenetic trees with their covariates and other associated data Methods in Ecology and Evolution doi X Attaching package ggtree The following object is masked from packageape rotate The following object is masked from packageBiostrings collapse The following object is masked from packageIRanges collapse The following object is masked from packageS Vectors expand negative edges length changed to caught segfault address x e c cause memory not mapped Traceback CallPML dlist data el asdoubleg nr nc k eig asdoublebf node edge nTips nco contrast N asintegerlengthedge pmlfittree data bf shape shape k k Q Q levels attrdata levels inv inv rate rate g g w w eig eig INV INV ll ll llMix llMix wMix wMix site TRUE pmltree fastaphyDat model JTT k inv phylogeneticTreeCreatehomologySummary homologyResults uniprotdb uniprotsprotfasta numberOfSeq multiCoreBool TRUE useExistingAlignment TRUE alignmentType DECIPHER An irrecoverable exception occurred R is aborting now mtArtG caught segfault address x c ac cause memory not mapped Traceback pmlfittree data bf shape shape k k Q Q levels attrdata levels inv inv rate rate g g w w eig eig INV INV ll ll llMix llMix wMix wMix site TRUE updatepmlfittmp k k updatefittmp k k FUNX i lapplyX S FUN FUN doTryCatchreturnexpr name parentenv handler tryCatchOneexpr names parentenv handlers L tryCatchListexpr classes parentenv handlers tryCatchexpr error functione call conditionCalle if isnullcall if identicalcall L quotedoTryCatch call syscall L dcall deparsecall L prefix pasteError in dcall LONG L msg conditionMessagee sm strsplitmsg n L w L nchardcall type w ncharsm L type w if isnaw w L nchardcall type b ncharsm L type b if w LONG prefix paste prefix n else prefix Error msg paste prefix conditionMessagee n Internalseterrmessagemsg L if silent identicalgetOptionshowerrormessages TRUE catmsg file outFile InternalprintDeferredWarnings invisiblestructuremsg class tryerror condition e trylapplyX S FUN FUN silent TRUE sendMastertrylapplyX S FUN FUN silent TRUE FUNX i lapplyseqlencores innerdo mclapplymodel fitPar fit G I k FREQ mccores mccores modelTestfastaphyDat model all multicore multiCoreBool phylogeneticTreeCreatehomologySummary homologyResults uniprotdb uniprotsprotfasta numberOfSeq multiCoreBool TRUE useExistingAlignment TRUE alignmentType DECIPHER An irrecoverable exception occurred R is aborting now HIVwG caught segfault address x c ac cause memory not mapped Traceback pmlfittree data bf shape shape k k Q Q levels attrdata levels inv inv rate rate g g w w eig eig INV INV ll ll llMix llMix wMix wMix site TRUE updatepmlfittmp k k updatefittmp k k FUNX i lapplyX S FUN FUN doTryCatchreturnexpr name parentenv handler tryCatchOneexpr names parentenv handlers L tryCatchListexpr classes parentenv handlers tryCatchexpr error functione call conditionCalle if isnullcall if identicalcall L quotedoTryCatch call syscall L dcall deparsecall L prefix pasteError in dcall LONG L msg conditionMessagee sm strsplitmsg n L w L nchardcall type w ncharsm L type w if isnaw w L nchardcall type b ncharsm L type b if w LONG prefix paste prefix n else prefix Error msg paste prefix conditionMessagee n Internalseterrmessagemsg L if silent identicalgetOptionshowerrormessages TRUE catmsg file outFile InternalprintDeferredWarnings invisiblestructuremsg class tryerror condition e trylapplyX S FUN FUN silent TRUE sendMastertrylapplyX S FUN FUN silent TRUE FUNX i lapplyseqlencores innerdo mclapplymodel fitPar fit G I k FREQ mccores mccores modelTestfastaphyDat model all multicore multiCoreBool phylogeneticTreeCreatehomologySummary homologyResults uniprotdb uniprotsprotfasta numberOfSeq multiCoreBool TRUE useExistingAlignment TRUE alignmentType DECIPHER An irrecoverable exception occurred R is aborting now Error in x jj iseq vjj replacement has length zero Calls phylogeneticTreeCreate modelTest dataframe Execution halted sessionInfo sessionInfo R version Platform x pclinuxgnu bit Running under Ubuntu LTS Matrix products default BLAS usrlibx linuxgnublaslibblasso LAPACK usrlibx linuxgnulapackliblapackso locale LCCTYPEenUSUTF LCNUMERICC LCTIMEenUSUTF LCCOLLATEenUSUTF LCMONETARYenUSUTF LCMESSAGESenUSUTF LCPAPERenUSUTF LCNAMEC LCADDRESSC LCTELEPHONEC LCMEASUREMENTenUSUTF LCIDENTIFICATIONC attached base packages stats parallel stats graphics grDevices utils datasets methods base other attached packages ggtree treeio ggplot phangorn ape DECIPHER RSQLite msa Biostrings XVector IRanges S Vectors BiocGenerics loaded via a namespace and not attached Rcpp pillar compiler tools zlibbioc digest bit jsonlite memoise tibble nlme gtable lattice pkgconfig rlang Matrix fastmatch igraph DBI rvcheck withr dplyr tidyselect bit grid glue R tidyr purrr blob magrittr scales assertthat colorspace quadprog lazyeval munsell crayon After updating to phangorn a codon tree with nodes that previously converged quickly with optimpmlmodelcodon optBfToptNniT now iterates forever without any visible changes in the likelihood Ive tried to reduce the number of nodes but the problem persists and if I remove the topology optimization it converges quickly optimize base frequencies optimize rate matrix optimize edge weights optimize topology optimize topology optimize topology optimize base frequencies optimize rate matrix optimize edge weights optimize topology optimize topology optimize topology optimize base frequencies optimize rate matrix optimize edge weights optimize topology optimize topology optimize topology optimize base frequencies optimize rate matrix optimize edge weights optimize topology optimize topology optimize topology optimize base frequencies optimize rate matrix optimize edge weights optimize topology optimize topology optimize topology Hello When Im trying to use optimpml for certain datasets using the following code segment dmh disthammingdata startingtree NJdmh startingtree rootstartingtree outgroup outgroupresolveroot TRUE Lf pmlstartingtree data LfJC optimpmlLfoptNni TRUE optEdge TRUE model JC I get the error message Error in if anybetahat missing value where TRUEFALSE needed Ive tried to reinstall R and phangorn but the same problem appears again R version phangorn ape Allows user to call phangorndensiTree without doing libraryape first In this way it always works Hi Klaus I was wanting to plot some ancestral states in ggtree which uses a data frame to plot Would you be amenable to me making a pull request that adds a dataframe return type for the ancestral state methods I dont want to clutter your pull requests if youd rather me not do this