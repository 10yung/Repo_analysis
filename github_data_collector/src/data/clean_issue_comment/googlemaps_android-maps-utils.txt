Please do not merge workinprogress This PR adds a new demo activity that includes the following to a single map to test multiple layer interactions a cluster manager with markers a GeoJSON polyline layer KML layers polyline and polygon a normal marker unclustered This PR is currently being used to test PR This PR is also based on branch when user select a marker I save a reference to it but when user zoom out and marker goes into cluster and I want to do anything to marker get NullPointerException How can I find that the marker is in cluster or is null or have any listener to it when it cluster Version of comgooglemapsandroidandroidmapsutils in Android Studio GeoJsonFeaturemarkerOptions has title snippet But there can be an overhead in determining what title and snippet values should be To set this in thousands of features as they are plotted is wasteful in time and machine resources Better to be able to simply add a link to the GeoJsonFeature in a tag attribute as GeoJsonPoints are plotted and only determine the title and snippet for a single feature when a GeoJsonPoint marker is tapped Note that taps of GeoJsonPoints do not go through the GeoJsonLayer listener geojsonLayersetOnFeatureClickListenerobject LayerOnFeatureClickListener override fun onFeatureClickfeature comgooglemapsandroiddataFeature code here That is have GeoJsonFeaturemarkerOptions title snippet tag Version of comgooglemapsandroidandroidmapsutils in Android Studio Testing on Nexus x Android Activity set up like so class MainActivity FragmentActivity OnMapReadyCallback OnMapClickListener OnMapLongClickListener OnCameraMoveListener OnCameraIdleListener GoogleMapOnPolylineClickListener ActivityCompatOnRequestPermissionsResultCallback OnInfoWindowClickListener OnInfoWindowCloseListener PurchasesUpdatedListener In onMapReady mMapsetOnPolylineClickListenerthis After geojson is read from file geojsonLayersetOnFeatureClickListenerobject LayerOnFeatureClickListener override fun onFeatureClickfeature comgooglemapsandroiddataFeature displayGeojsonPopupfeature geojsonLayeraddLayerToMap When I click on a Polyline after plotting the Polylines on app start my code works as it has for a couple of years this is a production system After I retrieve and plot Geoson data on the same map view the GeojsonLayer listener works as expected but there is no response from clicking any of the Polylines Hi API ver androidmapsutils OS android issue when adding multiple KmlLayers the app crashes when clicking on any item in the KmlLayer How to reproduce add KmlLayers for example using new KmlLayer twice click on any item It will crash since feature is null in the onFeatureClick KmlLayer kmlLayer new KmlLayermMap new ByteArrayInputStreambyteArr KmlDemoActivitythis kmlLayeraddLayerToMap kmlLayersetOnFeatureClickListenernew KmlLayerOnFeatureClickListener Override public void onFeatureClickFeature feature ToastmakeTextKmlDemoActivitythis Feature clicked featuregetId ToastLENGTHSHORTshow Unfortunately tests using orgjson orgxmlpull and androidgraphicsColor remain instrumented It is possible to provide JSON and XML dependencies and offload even more tests to JVM but it feels like cheating since it is unknown which versions are bundled in the Android framework A better approach would be unbundle from Android and use own JSON and XML dependencies At this point tests are instrumented are on JVM I am currently getting black polygon straight lines in maps after adding the KML layer and it was not at all looking good But in ios it was loaded with nice colors and without any black lines showing the KML layer like a heat map which is looking good So is the KML utility for android not yet fully rolled or is this a bug I am trying to add KML layer on to the maps It was working okay with just a ms of freeze when i try to load the small size KML file But some files are large with size more than Mb Mb in these all cases app is getting frozen for some time while the layer is adding to the map Below is the Asynctask class i am using to read the kml file from local storage path and adding it to maps I tried this in many ways using handlers threads asynctasks as i cannot update the UI in background thread this is causing my app to freeze for some time Eventhough it freezes I wouldnt mind but in some device while the app is frozen if the user interacts with the app then app is getting crashed In some devices it is displaying wait dialog Please help me out private static class AddKMLLayerToMaps extends AsyncTaskString String KmlLayer added weakreference to avoid memory leaks private WeakReferenceCoverageFragment weakReferencedFragment AddKMLLayerToMapsCoverageFragment reference thisweakReferencedFragment new WeakReferencereference weakReferencedFragmentgetshowLoading Override protected KmlLayer doInBackgroundString strings try TraceUtilslogECoverage kml Path strings FileInputStream fileInputStream new FileInputStreamstrings CoverageFragment fragment weakReferencedFragmentget if fragment null fragmentgetActivity null fragmentgetActivityisFinishing return null KmlLayer kmlLayer new KmlLayerfragmentmMap fileInputStream getApplicationContext fileInputStreamclose File file new Filestrings if fileexists filedelete return kmlLayer catch Exception e weakReferencedFragmentgethideLoading TraceUtilslogExceptione return null Override protected void onPostExecuteKmlLayer kmlLayer superonPostExecutekmlLayer if kmlLayer null add the KML layer to map using the UI thread weakReferencedFragmentgetmActivityrunOnUiThread try kmlLayeraddLayerToMap catch Exception e weakReferencedFragmentgethideLoading TraceUtilslogExceptione zoom to the center of KML layer containers new MoveMapToKMLLayerweakReferencedFragmentgetexecutekmlLayer Hello When we clearItems in ClusterManager it seems the markers cache of DefaultClusterRenderer is not cleared Calling getMarker on it will return a marker not matching the current Map causing an exception I resorted to recreate the whole renderer on each clear to avoid that Thank you Hello The following function protected CollectionQuadItemT getClusteringItemsPointQuadTreeQuadItemT quadTree float zoom return mItems cant be overriden in another package because QuadItem is of visibility internal I wanted to override this function to return items based on their density so that the cluster center item selection is not random Thank you