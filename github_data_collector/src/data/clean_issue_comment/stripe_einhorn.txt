address flag contains u means UDP for example einhorn b ru b r m manual p webserverrb n webserverrb config seems to be a noop at least for the maxunacked and maxupgradeadditional settings To reproduce sudo einhornsh c SERVICE e state sudo einhornsh c SERVICE e config maxunacked where is any new value sudo einhornsh c SERVICE e state and see that nothing changed evanstripe pointed out that it looks like config is merging changed values into the wrong place Id like to use einhorn to do seamless reloading of some processes but Im using various programs that expect something different than a SIGUSR for a graceful shutdown It would be nice if the graceful shutdown signal could be specified on the command line Thoughts Also removing nowunused READMEmdin For some time now the usage has been carefully described in READMEmd rather than extracted from bineinhorn h Hi do you have plans to publish v to rubygemsorg Thanks As mentioned in this adds support for bound sockets being UNIX domain sockets This is something that I needed for an application on our end and think might be generally useful This works by extending the regex in argument parsing to accept filenames that dont have colons in them as UNIX domain sockets The statebind stuff is then modified to be inet or unix bind objects which abstracts out the logic of how to createbind each type of socket properly If binding the socket results in EADDRINUSE well do the connect stat unlink dance to try and clean up old dead sockets The address family is added to the child environment for each socket so that workers can know which family to bind with more easily Issuesquestions I cant get the tests to run locally without errors with or without this patch so Im not clear on their status Will check with Travis once that runs It looks like the tests are failing to install packages etc on various versions but where they install everything is checking out Theres some duplication between the command socket bindingcleanup code and the unix socket cleanup code in this patch I wasnt clear how I could deduplicate this and maintain the descriptive error messages Im not super fond of the bindrb file or how that stuff is structured if youve any alternatives Im all ears Ive tested in place upgrades but there might be more cases Im not thinking about there Ive an application that Id like to run under Einhorn It currently binds a UNIX socket and then an SSLterminating nginx sitting on the same box talks to the service over that socket This is a websocket service so its designed to have tonnes of open sockets and using UNIX domain sockets for the nginxservice bridge gives us a lot more headroom Would it be possible for Einhorn to be able to bind UNIX sockets as well Im happy to write the code for this have taken a short crack at it already but Im a not great at ruby and b would probably need some handholding on making sure the inplace upgrades are OK with the changes If I do write it would this be something youd want to merge Hello I do not know how to achieve a seamless restart Goliath Please give me some advice thank you einhorn n b ruby apprb einhorn MASTER INFO Writing PID to varfoldersnc jhfmrs fz qkqddw cvtkw gnTeinhornpid MASTER INFO Binding to with flags MASTER INFO Launching new workers MASTER INFO Launched index WORKER INFO About to exec Userstumayunrvmrubiesruby binruby apprb einhorn MASTER INFO Worker has been up for s so we are considering it alive MASTER INFO Up to timer ACKs Userstumayunrvmgemsruby bundlergemsgoliath d b libgoliathrunnerrb in initialize invalid option einhorn OptionParserInvalidOption from Userstumayunrvmgemsruby bundlergemsgoliath d b libgoliathapplicationrb in new from Userstumayunrvmgemsruby bundlergemsgoliath d b libgoliathapplicationrb in run from Userstumayunrvmgemsruby bundlergemsgoliath d b libgoliathapplicationrb in block in moduleGoliath MASTER INFO Exited worker MASTER INFO Launched index WORKER INFO About to exec Userstumayunrvmrubiesruby binruby apprb einhorn Userstumayunrvmgemsruby bundlergemsgoliath d b libgoliathrunnerrb in initialize invalid option einhorn OptionParserInvalidOption from Userstumayunrvmgemsruby bundlergemsgoliath d b libgoliathapplicationrb in new from Userstumayunrvmgemsruby bundlergemsgoliath d b libgoliathapplicationrb in run from Userstumayunrvmgemsruby bundlergemsgoliath d b libgoliathapplicationrb in block in moduleGoliath MASTER INFO Exited worker before it was ACKed And einhorn n b ruby apprb sv MASTER INFO Writing PID to varfoldersnc jhfmrs fz qkqddw cvtkw gnTeinhornpid MASTER INFO Binding to with flags MASTER INFO Launching new workers MASTER INFO Launched index WORKER INFO About to exec Userstumayunrvmrubiesruby binruby apprb sv MASTER INFO Launched index WORKER INFO About to exec Userstumayunrvmrubiesruby binruby apprb sv INFO Starting server on in development mode Watch out for stones INFO Starting server on in development mode Watch out for stones Userstumayunrvmgemsruby bundlergemseventmachine de d e fe libeventmachinerb in starttcpserver no acceptor port is in use or requires root privileges RuntimeError from Userstumayunrvmgemsruby bundlergemseventmachine de d e fe libeventmachinerb in startserver from Userstumayunrvmgemsruby bundlergemsgoliath d b libgoliathserverrb in block in start from Userstumayunrvmgemsruby gemsemsynchrony libemsynchronyrb in block levels in synchrony MASTER INFO Exited worker before it was ACKed MASTER INFO Worker has been up for s so we are considering it alive MASTER INFO Up to timer ACKs breaking the streak of consecutive unacked workers dying C MASTER INFO Exited worker I now see this pretty consistently MASTER ERROR Could not find any config for exited child This probably indicates a bug in Einhorn Looks like it was introduced in Sounds like we had a race before but I think this means we have a race still ebroder what would you think about deracing by making the statepasser live past the SIGCHLD handler install Id guess that would mean either a installing the SIGCHLD handle before loading state though I havent checked if theres a chicken and an egg there or b having some coordination mechanism between the statepasser and the master Thoughts Saw the following in logs when trying to kick off einhorns at the same time cc zenazn WORKER INFO About to exec my command stuffvendorbundleruby gemseinhorn libeinhorneventrb in writenonblock closed stream IOError from stuffvendorbundleruby gemseinhorn libeinhorneventrb in breakloop from stuffvendorbundleruby gemseinhorn libeinhorncommandinterfacerb in block in trapasync from stuffvendorbundleruby gemseinhorn libeinhorncommandinterfacerb in call from stuffvendorbundleruby gemseinhorn libeinhorncommandinterfacerb in commandserver from stuffvendorbundleruby gemseinhorn libeinhorneventcommandserverrb in deregister from stuffvendorbundleruby gemseinhorn libeinhorneventcommandserverrb in close from stuffvendorbundleruby gemseinhorn libeinhorneventrb in block levels in closeall from usrlibrbenvversions libruby setrb in eachkey from usrlibrbenvversions libruby setrb in each from stuffvendorbundleruby gemseinhorn libeinhorneventrb in block in closeall from stuffvendorbundleruby gemseinhorn libeinhorneventrb in each from stuffvendorbundleruby gemseinhorn libeinhorneventrb in closeall from stuffvendorbundleruby gemseinhorn libeinhorneventrb in closeallforworker from stuffvendorbundleruby gemseinhorn libeinhorncommandrb in block in spinup from stuffvendorbundleruby gemseinhorn libeinhorncommandrb in fork from stuffvendorbundleruby gemseinhorn libeinhorncommandrb in spinup from stuffvendorbundleruby gemseinhorn libeinhorncommandrb in block in replenishimmediately from stuffvendorbundleruby gemseinhorn libeinhorncommandrb in times from stuffvendorbundleruby gemseinhorn libeinhorncommandrb in replenishimmediately from stuffvendorbundleruby gemseinhorn libeinhorncommandrb in replenish from stuffvendorbundleruby gemseinhorn libeinhornrb in run from stuffvendorbundleruby gemseinhorn bineinhorn in top required from stuffvendorbundleruby bineinhorn in load from stuffvendorbundleruby bineinhorn in main 