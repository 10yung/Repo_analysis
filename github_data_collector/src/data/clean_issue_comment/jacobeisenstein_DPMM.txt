Hi all in line derivup is defined as n k while derivdown is defined as k n n k Has anyone actually tried to derive these equations since author mentioned it is guaranteed to produce positive and negative derivative I tried deriving myself thinking they are linked to the equation of hprime However if I tried to let hprime I will get stuck with the harmonic series Unless my direction is wrong such that those two equation are not related to hprime Update Here is what I tried If I have to let HPrime be more than I would have to approximate the harmonic series as na and eventually derive the equation that a must be bigger than nk which I can easily assume that derivup n k or derivup n k as written in the code which are both bigger than nk Whereas for HPrime be less than ak a digammaaa digammaan Firstly a must be a postive value for MATLAB psi to work and digammaa must produce a positive number so no matter how big k is as long as a is bigger than k then we would get a negative derivative So letting derivdown k would produce a negative derivative as well However I am not sure if my assumptions are correct though