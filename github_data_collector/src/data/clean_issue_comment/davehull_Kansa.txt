When using the autorun module to get the autorunscexe output the file only contains a header but no content is there I have had to rewrite large portions of Kansa to allow for it to run in my weaker machine Just running against machines required gigs of RAM due to it opening PSsessions with all of them Due to this I had to rewrite the gettarget function calls to listen to your throttle limit I also had to rewrite the log collections to even make log parser work for analysis And rewrite the getanalysis function to handle errors Because running something that takes hours for only machines and then have an analysis fail is wasteful Please update Kansa to actually be useful for weaker machines and scale larger than machines with out failure And not quit on analysis Or at least allow for an analysis option to run on a folder after targetdata has been acquired No options allow me to post analyze I had to fake the outputfolder so it had to rerun on machine and then do analysis davehull Please DM me at your earliest convenience I am an employee at a large financial institution and we have been continuing development of the Kansa project internally for the last years Weve made a lot of really cool enhancements and were interested in contributing them back to the community Our IPlegalopenSource teams have asked me to reach out to you to start a dialog about the best way for us to contribute pullmerge vs fork vs other Id love to talk with you about it We have successfully achieved running Kansa realtime against up to K endpoints with integration in our ELK stack and live metricsdashboards new IR modules etcwe think the InfoSec community could really benefit from this work and we could benefit from other contributors adding modules that fit in our enhanced framework You can reach me on Twitter Jon I ran PS C Tools Kansamaster ls r ps UnblockFile PS C Tools Kansamaster SetExecutionPolicy Unrestricted PS C Tools streams sd Kansamaster I have SysInternals on my Path PS C Tools Kansamaster kansaps Target envCOMPUTERNAME ModulePath Modules Verbose But it errors out saying VERBOSE Found Modules Modulesconf VERBOSE Running modules GetPrefetchListing GetWMIRecentApps GetNetstat GetDNSCache GetProcsWMI GetLogUserAssist GetSvcFail GetSvcTrigs GetWMIEvtFilter GetWMIFltConBind GetWMIEvtConsumer GetPSProfiles GetSchedTasks GetFile GetLocalAdmins VERBOSE Found loggingconf Caught Cannot validate argument on parameter Session The argument is null or empty Provide an argument that is not null or empty and then try the command again Script completed with warnings or errors See C Tools Kansamaster Output ErrorLog for details Here are the contents of the error log Connecting to remote server failed with the following error message The client cannot connect to the destination specified in the request Verify that the service on the destination is running and is accepting requests Consult the logs and documentation for the WSManagement service running on the destination most commonly IIS or WinRM If the destination is the WinRM service run the following command on the destination to analyze and configure the WinRM service winrm quickconfig For more information see the aboutRemoteTroubleshooting Help topic ExitScript function was passed an error this may be a duplicate that wasnt previously cleared or Kansaps has crashed Cannot validate argument on parameter Session The argument is null or empty Provide an argument that is not null or empty and then try the command again Hello all Im getting this WARNING in my Kansa output during analysis Ive been trying to play with where to put the DATADIR directive and how to populate it The netstat collector is running and collecting data Can anyone lend any insight please WARNING Analysis script Analysis Net GetNetstatDistinctLocal ps missing DATADIR directive skipping analysis A simple module to read remote systems registry keys I usually use it to baseline registry keys used usually for persistence I have also complied a list of keys listed in the MITRE ATT CK framework Not sure if these keys should be hardcoded in the module I was having trouble getting this to run After switching from tsv to csv it began working properly C Users user Desktop Kansamaster Kansamaster Modules Log GetAppCompatCache Originalps AppCompatCacheParserexe not found on CSCDURAMVM At line char GetAppCompatCache Originalps CategoryInfo NotSpecified WriteError WriteErrorException FullyQualifiedErrorId MicrosoftPowerShellCommandsWriteErrorExceptionGetAppCompatCache Originalps SYNOPSIS GetAppCompatCacheps When run via Kansaps with Pushbin flag this module will copy AppCompatCacheParserexe to the remote system then run AppCompatCacheParserexe csv AppCompatCacheParserOutputPath on the remote system and return the output data as a powershell object AppCompatCacheParserexe can be downloaded from NOTES Kansaps directives OUTPUT CSV BINDEP Modules bin AppCompatCacheParserexe Setup Variables AppCompatCacheParserPath envSystemRoot AppCompatCacheParserexe Runtime String GetDate Format yyyyMMddHHmmss suppress NewItem Name ACCPRuntime ItemType Directory Path envTemp Force AppCompatCacheParserOutputPath envTemp ACCPRuntime if TestPath AppCompatCacheParserPath Run AppCompatCacheParserexe suppress AppCompatCacheParserPath csv AppCompatCacheParserOutputPath Output the data ImportCsv Delimiter t AppCompatCacheParserOutputPath csv Delete the output folder suppress RemoveItem AppCompatCacheParserOutputPath Force Recurse else WriteError AppCompatCacheParserexe not found on envCOMPUTERNAME Updated SVCAll module and analysis files Added modules and analysis files for Scheduled Tasks and a series of Registry and File locations relevant to Malware persistence mechanisms documented by MITREs ATT CK matrix I get an error running Log GetLogOpenSavePidlMRUps I changed line GetRegKeyValueNData HKU S Software Microsoft Windows CurrentVersion Explorer ComDlg OpenSavePidlMRU to GetRegKeyValueNData HKCU Software Microsoft Windows CurrentVersion Explorer ComDlg OpenSavePidlMRU and that appeared to fix it and return a value property list Im not sure if this is correct or not though Let me know if that looks correct to you and I will add it to PR Hello I just downloaded kansa today and used the ASEP GetAutorunscps The output does not contain the autorun output i expect See the output below Kindly advise PSComputerNameRunspaceIdPSShowComputerNameLength Machinename d e b e a bdTrue 