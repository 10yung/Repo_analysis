GetDSCParamType uses ForEachObject loops ForEachObject doesnt breakend the function when return is called because it gets the next item from the pipeline Under the right circumstances an array will be returned Subsequently getdscBlock will fail to work properly as the returned paramType wont match as intended How to reproduce powershell DSCModule GetModule Name xWebAdministration ListAvailable DSCPath DSCModule SelectObject ExpandProperty modulebase modulePath DSCPath DSCResources MSFTxWebsite MSFTxWebsitepsm paramType GetDSCParamType ModulePath ModulePath ParamName BindingInfo MicrosoftManagementInfrastructureCimInstance eq paramType Returns False MicrosoftManagementInfrastructureCimInstance eq paramType Returns True paramType is an array which equals MicrosoftManagementInfrastructureCimInstance To Resolve use foreach instead of foreachobject powershell function GetDSCParamType CmdletBinding param parameterMandatory true SystemString ModulePath parameterMandatory true SystemString ParamName tokens null errors null ast SystemManagementAutomationLanguageParser ParseFileModulePath ref tokens ref errors functions astFindAll args is SystemManagementAutomationLanguageFunctionDefinitionAst true ForEachfunction in functions if functionName eq SetTargetResource functionAst SystemManagementAutomationLanguageParser ParseInputfunctionBody ref tokens ref errors parameters functionAstFindAll args is SystemManagementAutomationLanguageParameterAst true ForEachparameter in parameters if parameterNameExtentText eq ParamName attributes parameterAttributes ForEachattribute in attributes if attributeTypeNameFullName like System return attributeTypeNameFullName elseif attributeTypeNameFullNameToLower eq microsoftmanagementinfrastructureciminstance return SystemCollectionsHashtable elseif attributeTypeNameFullNameToLower eq string return SystemString elseif attributeTypeNameFullNameToLower eq boolean return SystemBoolean elseif attributeTypeNameFullNameToLower eq bool return SystemBoolean elseif attributeTypeNameFullNameToLower eq string return SystemString elseif attributeTypeNameFullNameToLower eq microsoftmanagementinfrastructureciminstance return MicrosoftManagementInfrastructureCimInstance We would like to use ReverseDSC to help newcomers to DSC get a leg up on setting up their service Primary use case would be to run ReverseDSC on a new unconfigured system with no reference DSC to get ALL of the configurations Then the admin sets the system up in the old way and reruns ReverseDSC Then I could take the output files and find the deltas which should contain the DSC specific to setting up their service with the settings they need and gives them a way to start to the finish line