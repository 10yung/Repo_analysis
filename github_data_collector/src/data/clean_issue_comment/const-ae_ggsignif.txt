Hi As described in issue annotation that contain duplicate contents does not work for grouped plots Lets start by some reproducible examples Demo data and plot r libraryggplot libraryggsignif p ggplotToothGrowth aessupp len geomboxplotaescolor dose s stattest dataframe stringsAsFactorsFALSE padj c e e e e signif c signif ca b c d e f yposition c xmin c xmax c group rep each supp asfactorrepcOJ VC each s pre padj signif signif yposition xmin xmax group supp e a OJ e b OJ e c OJ e d VC e e VC e f VC pre Th following R code works because all annotation contents are distinct r p geomsignif aesxmin xmin xmax xmax yposition yposition annotations signif data stattest manual TRUE tiplength Rplot This one does not work because annotation contents are duplicated r p geomsignif aesxmin xmin xmax xmax yposition yposition annotations signif data stattest manual TRUE tiplength Rplot A workaround has been provided in discussion r p geomsignif xmin sxmin xmax sxmax yposition syposition annotation ssignif tiplength Rplot My problem is that the above solution does not work when facet is used r p geomsignif xmin sxmin xmax sxmax yposition syposition annotation ssignif tiplength facetwrapsupp Rplot Aesthetic mapping is better for faceting but annotations are not displayed correctly r p geomsignif aesxmin xmin xmax xmax yposition yposition annotations signif data stattest manual TRUE tiplength facetwrapsupp Rplot Any suggestions Hello when I try to plot a bar chart Im finding that the annotations disappear when I try to use add scalexdiscrete to switch around the order of the groups on the xaxis Heres the data Im trying to plot df structurelistcontrast structurec L L L Label near far class factor trtmt structure Label cconstant pulsedfood pulsednofood class factor ratio c SE c df c lowerCL c upperCL c class dataframe rownames cNA L And here is the code and the plot without the scalexdiscrete active ggplotdf aesxtrtmt yratio geombarstatidentity size fillgray colorblack geomerrorbaraesyminlowerCL ymaxupperCL width labsyDifference of Estimated Marginal Mean nwith Confidence Intervals xTreatment themebw themepanelborder elementblank panelgridmajor elementblank panelgridminor elementblank axisline elementlinecolourblack themetext elementtextsize scaleycontinuouslimitsc breaksseq scalexdiscretelimits cpulsednofoodpulsedfoodconstant labelscpulsednofood Pulsed No Food constant Constantpulsedfood Pulsed Food geomsignifyposition c xmin c xmax c tiplength annotation producing this plot When I uncomment the scalexdiscrete then the lines and asterisks go away This is very confusing because on another dataset almost identical to this one the scalexdiscrete doesnt seem to interfere df structurelistcontrast structurec L L L Label near far class factor trtmt structure Label cpulsednofood constant pulsedfood class factor ratio c SE c df c lowerCL c upperCL c class dataframe rownames cNA L ggplotdf aesxtrtmt yratio geombarstatidentity size fillgray colorblack geomerrorbaraesyminlowerCL ymaxupperCL width labsyEstimated Marginal Mean nwith Confidence Intervals xTreatment themebw themepanelborder elementblank panelgridmajor elementblank panelgridminor elementblank axisline elementlinecolourblack themetext elementtextsize scaleycontinuouslimitsc breaksseq scalexdiscretelimits cpulsednofoodpulsedfoodconstant labelscpulsednofood Pulsed No Food constant Constantpulsedfood Pulsed Food geomsignifyposition c xmin c xmax c tiplength annotation Hello I met some questions when used this packagesCould you help me This is my code mycomparisons listcA B cB C cC D ggplotdistance aesxGroupyDistance colorMethodshapeMethod geomboxplotfillcornflowerblue colorblack notchTRUE geompointposition jitter colorblue alpha geomrugside colorblackthemebw geomsignifcomparisons mycomparisonstest ttest facetgridMethod This is my data structures Group Distance Method A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance A Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance B Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance C Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance D Hamming distance I want to draw a picture like this b f c e c b d But I used above data and code cant get similar picture Rplot And I got some warning messages Warning messages Computation failed in statsignif missing value where TRUEFALSE needed Computation failed in statsignif missing value where TRUEFALSE needed Computation failed in statsignif missing value where TRUEFALSE needed Could you help me Thank you Hi I really love this package and have been using it extensively of late Ive recently written a piece of code that allows you to run a test like a twofactor anova followed by a posthoc like a TukeyHSD and then automatically passes those values to geomsignif using the manual override The x and y values are all calculated without user input It relies on broom Ive been using it for large numbers of graphs at once I was wondering if Id be able to contribute to the package to save some other folks the work Best Margot Hi I am using this wonderful package which I found very useful to my work and I am faced with a little problem here I am trying to do a violin plot using Seurat package R librarySeurat libraryggsignif fig VlnPlotobject pbmcsmall featuresplot PC doreturn TRUE fig geomsignifxmin xmax yposition annotations plot It needs a bit of refinement because the annotation overlaps other part of the plot so I set yposition from to R librarySeurat libraryggsignif fig VlnPlotobject pbmcsmall featuresplot PC doreturn TRUE coordcartesianylim c fig geomsignifxmin xmax yposition annotations plot However the annotation disappeared and I do not know how to fix this Thank you very much in advance Hi Constantin Thank you for your work in developing the geomsignif extension to ggplot It is a great tool I want to bring to your attention an issue I have run into using geomsignif specifically that the geomsignif layer will not render in the plot if factor levels are reassigned within ggplot I found this while using geomsignif to annotate some bar plots Here is an example libraryplyr libraryggplot libraryggsignif generate some data mtcarsmeanMPG ddply mtcars carb am summarize meanMPG roundmeanmpg This works ggplot datamtcarsmeanMPG aes xfactorcarb ymeanMPG fillam groupam geombar stat identity position positiondodgepreserve single geomsignif annotationp yposition xmin xmax tiplength c This does not ggplot datamtcarsmeanMPG aes xfactorcarb levels uniquerevmtcarsmeanMPGcarb ymeanMPG fillam groupam geombar stat identity position positiondodgepreserve single geomsignif annotationp yposition xmin xmax tiplength c Nor does this mtcarsmeanMPGcarb factormtcarsmeanMPGcarb levels uniquerevmtcarsmeanMPGcarb ggplot datamtcarsmeanMPG aes xcarb ymeanMPG fillam groupam geombar stat identity position positiondodgepreserve single geomsignif annotationp yposition xmin xmax tiplength c I often find myself reassigning factor levels in order to get figures to rendering correctly Just letting you know in case this is something you want to look into Thanks Joe Dear Constantin Thank you very much for your package ggsignif I very appreciate it I try to add results from chisquare test to a ggplot and it was mentioned that I could use ggsignif Moreover I found your adivce to use geomsignif However If i add this to my plot geomsignifdata annotationdf aesannotations annotations xmin xmin xmax xmax yposition yposition manual TRUE df dataframetimepointrep each responsecABAAAAAABBAAAAAAABBBABBBBBABBBvariablerepcvar var each subjectrep dftimepoint factordftimepoint levelc labelscmethodAbaselinemethodB df addcounttimepointvariableresponse addcounttimepointvariable mutatefreqnnn mutatetotal df stats dataframexmaxcrepcbaselinemethodB stats mutatexminasfactorcrepcmethodAbaseline mutateannotationsc mutateyposition mutatevariableasfactorcvar var var var annotationdf ggplotdf aesx timepoint stratum response alluvium subject y total fill response label pastefreq geomflow geomstratumalpha geomtextstat stratum size themelegendposition none geomsignifdata annotationdf aesannotations annotations xmin xmin xmax xmax yposition yposition manual TRUE facetwrapvariable I get this error Warning Ignoring unknown aesthetics annotations xmin xmax yposition Error in FUNX i object response not found If i leave out geomsignif everything works Thank you for any advice Jacob When using coord flip one usually wants to put the labels at the right of the bracket Is there any way to do this Great library thanks Is there a way to rotate the labels When using geomsignif on a ggplot plot that has color aesthetics I get the error below However it works if the color aesthetics are specified in another geom It took me a bit to find the cause and workaround for the problem not sure if I was using ggplot not correctly here The minimal example test data R requireggplot requireggsignif df dataframe data c group crepgroup repgroup This results in an error R p ggplotdf aesy data x group group group color group geomboxplot p geomsignifcomparisons listcgroup group yposition Error in checklengthgparname gpar element fontsize must not be length In addition Warning message In isnacolour isna applied to nonlist or vector of type NULL while this works as expected R p ggplotdf aesy data x group group group geomboxplotcolor group p geomsignifcomparisons listcgroup group yposition 