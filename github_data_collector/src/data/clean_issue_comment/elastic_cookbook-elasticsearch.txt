Updated cookbook to the latest version and now see issue with es on Ubuntu Systemd stuck when tries to run elasticsearch and then fails with timeout after some time Reviewed all changes and found its because of recently added changes to systemd init script template templatesdefaultsystemduniterb Service Typenotify after removing Typenotify it works fine Review the blog post about moving to Cookstyle and begin cleaning up cops in rubocopyml and removing the Foodcriticrelated tasksgemsetc We should investigate CentOS support as well as consider dropping CentOS support in both testkitchen and fauxhai Heres a list of versions We should take a look at any major changes needed to support and also update our test suites both fauxhai and testkitchen Heres a list of releases Wed like to add support for Chef x At a minimum well need to investigate new testkitchen settings like provisioner name chefzero cheflicense accept The log j properties shipped compresses some logs but not slow query logs Expected would be that all log files are handled similarly either all compressed with same settings or none compressed Upstream configuration turns on compression also for slow logs When I set the initsource to nil it just uses the default value This looks like it never would have worked I need to be able to provide my own init scripts and since this cookbook doesnt do that well doesnt let me pass my own variables in the init script I provide I have to be able to turn off the init scripts altogether Having issue with Elasticsearch version any version while installing on Centos below is the service status elasticsearchservice Elasticsearch Loaded loaded usrlibsystemdsystemelasticsearchservice enabled vendor preset disabled Active failed Result signal since Mon EDT min s ago Docs Process ExecStartusrshareelasticsearchbinelasticsearch p PIDDIRelasticsearchpid quiet codekilled signalKILL Main PID codekilled signalKILL Jun ip ec internal systemd Started Elasticsearch Jun ip ec internal elasticsearch OpenJDK Bit Server VM warning Option UseConcMarkSweepGC was deprecated in version release Jun ip ec internal systemd elasticsearchservice main process exited codekilled status KILL Jun ip ec internal systemd Unit elasticsearchservice entered failed state Jun ip ec internal systemd elasticsearchservice failed sudo journalctl u elasticsearch Logs begin at Fri EDT end at Mon EDT Jun ip ec internal systemd Starting Elasticsearch Jun ip ec internal systemd Started Elasticsearch Jun ip ec internal elasticsearch OpenJDK Bit Server VM warning If the number of processors is expected to increase from one then Jun ip ec internal systemd elasticsearchservice main process exited codekilled status KILL Jun ip ec internal systemd Unit elasticsearchservice entered failed state Jun ip ec internal systemd elasticsearchservice failed Jun ip ec internal systemd Starting Elasticsearch Jun ip ec internal systemd Started Elasticsearch Jun ip ec internal elasticsearch OpenJDK Bit Server VM warning If the number of processors is expected to increase from one then y Jun ip ec internal systemd elasticsearchservice main process exited codekilled status KILL Jun ip ec internal systemd Unit elasticsearchservice entered failed state Jun ip ec internal systemd elasticsearchservice failed Jun ip ec internal systemd Starting Elasticsearch Jun ip ec internal systemd Started Elasticsearch Jun ip ec internal elasticsearch OpenJDK Bit Server VM warning If the number of processors is expected to increase from one then Jun ip ec internal systemd elasticsearchservice main process exited codekilled status KILL Jun ip ec internal systemd Unit elasticsearchservice entered failed state Jun ip ec internal systemd elasticsearchservice failed Jun ip ec internal systemd Starting Elasticsearch Jun ip ec internal systemd Started Elasticsearch Jun ip ec internal elasticsearch OpenJDK Bit Server VM warning If the number of processors is expected to increase from one then Jun ip ec internal systemd elasticsearchservice main process exited codekilled status KILL Jun ip ec internal systemd Unit elasticsearchservice entered failed state Jun ip ec internal systemd elasticsearchservice failed Jun ip ec internal systemd Started Elasticsearch Jun ip ec internal elasticsearch OpenJDK Bit Server VM warning Option UseConcMarkSweepGC was deprecated in version and will li Jun ip ec internal systemd elasticsearchservice main process exited codekilled status KILL Jun ip ec internal systemd Unit elasticsearchservice entered failed state Jun ip ec internal systemd elasticsearchservice failed Jun ip ec internal systemd Started Elasticsearch Jun ip ec internal elasticsearch OpenJDK Bit Server VM warning Option UseConcMarkSweepGC was deprecated in version and will li Jun ip ec internal systemd elasticsearchservice main process exited codekilled status KILL Jun ip ec internal systemd Unit elasticsearchservice entered failed state Jun ip ec internal systemd elasticsearchservice failed Help me on this issue For inplace upgrades we have written a method for plugin removal when installed plugins do not match the version of ES specified by the version attribute prior to installing new plugins that align with that version ruby node elasticsearch plugin each do pluginname pluginvalue properties ElasticSearchWrapperPropertyFileparsenode elasticsearch install dir elasticsearchpluginspluginnameplugindescriptorproperties elasticsearchplugin pluginname do sendaction remove notif properties elasticsearchversion nil properties elasticsearchversion node elasticsearch install version end end This method worked with cookbook version x and ES x but no longer uninstalls the plugins for cookbook version x and ES x The plugin removal resource is being executed without error for the client run but the plugin is not being removed When using the cookbook to perform an inplace major version upgrade x x the service file usrlibsystemdsystemelasticsearchservice is not being overwritten unless manually deleted This results in errors on startup since the ENV variables and other parameters may differ between major versions The service should be overwritten if the new configuration differs from what is currently on disk for the server being configured templatesdefaultsystemduniterb