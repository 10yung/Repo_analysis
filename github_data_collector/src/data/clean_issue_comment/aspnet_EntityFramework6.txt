Query for the TargetFrameworkMonikers in the project and use that if available to allow projects that target both NET Standard and full framework to use the EF cmdlets Fixes AddMigration and presumably its friends fail from on in the PMC if the host project for the migrations targets both netstandard and full framework EntityFramework psm only takes into consideration the TargetFrameworkMoniker rather than TargetFrameworkMonikers if available Exception message The Entity Framework Package Manager Console Tools dont support this framework Steps to reproduce Create a project with TargetFrameworksnet netstandard TargetFrameworks and attempt to AddMigration Further technical details EF version Operating system Windows IDE Visual Studio Using Entity Framework with MySQL we have been able to dodge most OUTER APPLY that happens in some situations OUTERCROSS APPLY is not supported by MySQL In and Entity Framework seems to be much more eager to emit OUTER APPLY queries which causes the MySql provider not being able to generate a query Steps to reproduce I have included two projects We use Devart which is a licensed product but I provided another version that is using MySqlData where the problem appears differently but is having the same limits Devart fails with SystemNotSupportedException OUTER APPLY is not supported by MySQL OuterApplyDevartMySqlzip OuterApplyMySqlDatazip Digging into the commits I found that the setting MaxNodeCountForTransformations seems to be whats changed ea b d fa bab d cebc fde which I can change the setting for back to the previous value it had in But I wonder if theres a way to avoid just OUTERCROSS APPLY without losing the performance benefits of that change for other queries Further technical details EF version and Database Provider DevartMySql and MySqlData Operating system Windows Windows Server IDE Visual Studio Followed the steps mentioned below to build the tool However getting the error while executing the command BuildEFTools tInstall Here is the output of the command execution E ef BuildEFTools tInstall Microsoft R Build Engine version Microsoft NET Framework version Copyright C Microsoft Corporation All rights reserved Restoring NuGet packages All packages listed in packagesconfig are already installed All packages listed in packagesconfig are already installed EntityFramework E ef bin Debug EntityFrameworkdll EntityFrameworkSqlServer E ef bin Debug EntityFrameworkSqlServerdll Restoring NuGet packages To prevent NuGet from downloading packages during build open the Visual Studio Options dialog click on the Package Manager node and uncheck Allow NuGet to download missing packages All packages listed in packagesconfig are already installed EntityFrameworkSqlServerCompact E ef bin Debug EntityFrameworkSqlServerCompactdll XmlCore E ef bin Debug MicrosoftDataToolsDesignXmlCoredll Running Code Analysis Code Analysis Complete errors warnings DesignXmlCore E ef bin Debug MicrosoftVisualStudioDataToolsDesignXmlCoredll Running Code Analysis Code Analysis Complete errors warnings EntityDesignerVersioningFacade E ef bin Debug MicrosoftDataEntityDesignVersioningFacadedll Running Code Analysis Code Analysis Complete errors warnings EntityDesignModel E ef bin Debug MicrosoftDataEntityDesignModeldll Running Code Analysis Code Analysis Complete errors warnings EntityDesignExtensibility E ef bin Debug MicrosoftDataEntityDesignExtensibilitydll Running Code Analysis EntityDesignDatabaseGeneration E ef bin Debug MicrosoftDataEntityDesignDatabaseGenerationdll Running Code Analysis Code Analysis Complete errors warnings Code Analysis Complete errors warnings EntityDesign E ef bin Debug MicrosoftDataEntityDesigndll Running Code Analysis One or more indirectlyreferenced assemblies could not be found These assemblies are not required for analysis However without them analysis results could be incomplete Code Analysis Complete errors warnings EntityDesignBootstrapPackage E ef bin Debug MicrosoftDataEntityDesignBootstrapPackagedll Running Code Analysis Code Analysis Complete errors warnings EntityDesigner E ef bin Debug MicrosoftDataEntityDesignEntityDesignerdll Running Code Analysis Code Analysis Complete errors warnings EntityDesignPackage EntityDesignPackage EntityDesignPackage E ef bin Debug MicrosoftDataEntityDesignPackagedll Running Code Analysis Code Analysis Complete errors warnings Creating intermediate PkgDef file VsIdeTestHostFramework E ef bin Debug MicrosoftVisualStudioQualityToolsVsIdeTestHostFrameworkdll TestInfrastructure E ef test EFTools TestInfrastructure bin Debug EFDesignerTestInfrastructuredll InProcTests E ef test EFTools InProcTests bin Debug EFDesignerInProcTestsdll Restoring NuGet packages To prevent NuGet from downloading packages during build open the Visual Studio Options dialog click on the Package Manager node and uncheck Allow NuGet to download missing packages All packages listed in packagesconfig are already installed E ETests E ef test EFTools E ETests bin Debug EFDesignerE ETestsdll Restoring NuGet packages To prevent NuGet from downloading packages during build open the Visual Studio Options dialog click on the Package Manager node and uncheck Allow NuGet to download missing packages All packages listed in packagesconfig are already installed FunctionalTests E ef test EFTools FunctionalTests bin Debug EFDesignerFunctionalTestsdll Restoring NuGet packages To prevent NuGet from downloading packages during build open the Visual Studio Options dialog click on the Package Manager node and uncheck Allow NuGet to download missing packages All packages listed in packagesconfig are already installed UnitTests E ef test EFTools UnitTests bin Debug EFDesignerUnitTestsdll VsIdeTestHostAddin E ef bin Debug MicrosoftVisualStudioQualityToolsHostAdaptersVsIdeAddIndll Installer E ef bin Debug VsIdeTestHostmsi Restoring NuGet packages All packages listed in packagesconfig are already installed All packages listed in packagesconfig are already installed Restoring NuGet packages To prevent NuGet from downloading packages during build open the Visual Studio Options dialog click on the Package Manager node and uncheck Allow NuGet to download missing packages All packages listed in packagesconfig are already installed EntityFramework E ef bin DebugNet EntityFrameworkdll Restoring NuGet packages To prevent NuGet from downloading packages during build open the Visual Studio Options dialog click on the Package Manager node and uncheck Allow NuGet to download missing packages All packages listed in packagesconfig are already installed EntityFrameworkSqlServerCompact E ef bin DebugNet EntityFrameworkSqlServerCompactdll Migrate E ef bin DebugNet migrateexe EntityFrameworkSqlServer E ef bin DebugNet EntityFrameworkSqlServerdll EntityFrameworkSqlServerCompactLegacy E ef bin DebugNet EntityFrameworkSqlServerCompactLegacydll EntityFrameworkPowerShellUtility E ef bin DebugNet EntityFrameworkPowerShellUtilitydll EntityFrameworkPowerShell E ef bin DebugNet EntityFrameworkPowerShelldll Restoring NuGet packages To prevent NuGet from downloading packages during build open the Visual Studio Options dialog click on the Package Manager node and uncheck Allow NuGet to download missing packages All packages listed in packagesconfig are already installed Restoring NuGet packages To prevent NuGet from downloading packages during build open the Visual Studio Options dialog click on the Package Manager node and uncheck Allow NuGet to download missing packages All packages listed in packagesconfig are already installed EntityFramework E ef bin Debug EntityFrameworkdll EntityFrameworkSqlServer E ef bin Debug EntityFrameworkSqlServerdll EntityFrameworkSqlServerCompact E ef bin Debug EntityFrameworkSqlServerCompactdll EntityFrameworkSqlServerCompactLegacy E ef bin Debug EntityFrameworkSqlServerCompactLegacydll Migrate E ef bin Debug migrateexe EntityFrameworkPowerShellUtility E ef bin Debug EntityFrameworkPowerShellUtilitydll EntityFrameworkPowerShell E ef bin Debug EntityFrameworkPowerShelldll Attempting to build package from EntityFrameworkCodeTemplatesCSharpnuspec Successfully created package E ef bin Debug Packages EntityFrameworkCodeTemplatesCSharp nupkg Attempting to build package from EntityFrameworkCodeTemplatesVisualBasicnuspec Successfully created package E ef bin Debug Packages EntityFrameworkCodeTemplatesVisualBasic nupkg Attempting to build package from EntityFrameworkSqlServerCompactLegacynuspec Successfully created package E ef bin Debug Packages EntityFrameworkSqlServerCompactLegacy nupkg Successfully created package E ef bin Debug Packages EntityFrameworkSqlServerCompactLegacy symbolsnupkg Attempting to build package from EntityFrameworkSqlServerCompactnuspec Successfully created package E ef bin Debug Packages EntityFrameworkSqlServerCompact nupkg Successfully created package E ef bin Debug Packages EntityFrameworkSqlServerCompact symbolsnupkg Attempting to build package from EntityFrameworknuspec Successfully created package E ef bin Debug Packages EntityFramework nupkg Successfully created package E ef bin Debug Packages EntityFramework symbolsnupkg Restoring NuGet packages To prevent NuGet from downloading packages during build open the Visual Studio Options dialog click on the Package Manager node and uncheck Allow NuGet to download missing packages Installing MicrosoftSqlServerCompact Successfully installed MicrosoftSqlServerCompact E ef nuget NuGettargets error Unable to find version of package EntityFramework E ef src EFTools setup GenerateMsiInputs GenerateMsiInputsmsbuild E ef nuget NuGettargets error Unable to find version of package EntityFrameworkde E ef src EFTools setup GenerateMsiInputs GenerateMsiInputsmsbuild E ef nuget NuGettargets error Unable to find version of package EntityFrameworkes E ef src EFTools setup GenerateMsiInputs GenerateMsiInputsmsbuild E ef nuget NuGettargets error Unable to find version of package EntityFrameworkfr E ef src EFTools setup GenerateMsiInputs GenerateMsiInputsmsbuild E ef nuget NuGettargets error Unable to find version of package EntityFrameworkit E ef src EFTools setup GenerateMsiInputs GenerateMsiInputsmsbuild E ef nuget NuGettargets error Unable to find version of package EntityFrameworkja E ef src EFTools setup GenerateMsiInputs GenerateMsiInputsmsbuild E ef nuget NuGettargets error Unable to find version of package EntityFrameworkko E ef src EFTools setup GenerateMsiInputs GenerateMsiInputsmsbuild E ef nuget NuGettargets error Unable to find version of package EntityFrameworkru E ef src EFTools setup GenerateMsiInputs GenerateMsiInputsmsbuild E ef nuget NuGettargets error Unable to find version of package EntityFrameworkzhHans E ef src EFTools setup GenerateMsiInputs GenerateMsiInputsmsbuild E ef nuget NuGettargets error Unable to find version of package EntityFrameworkzhHant E ef src EFTools setup GenerateMsiInputs GenerateMsiInputsmsbuild E ef nuget NuGettargets error MSB The command E ef nuget NuGetexe install packagesconfig source NonInteractive RequireConsent solutionDir E ef bin Debug MsiRuntimeInputs exited with code E ef src EFTools setup GenerateMsiInputs GenerateMsiInputsmsbuild Thanks Tapan I detected changes in the release branch which have not been merged yet to master Im a robot and am configured to help you automatically keep master up to date so Ive opened this PR This PR merges commits made on release by the following committers JunTaoLuo mmitche dotnetbot Instructions for merging from UI This PR will not be automerged When pull request checks pass complete this PR by creating a merge commit not a squash or rebase commit img altmerge button instructions src width If this repo does not allow creating merge commits from the GitHub UI use command line instructions Instructions for merging via command line Run these commands to merge this pull request from the command line sh git fetch git checkout release git pull ffonly git checkout master git pull ffonly git merge noff release If there are merge conflicts resolve them and then run git merge continue to complete the merge Pushing the changes to the PR branch will retrigger PR validation git push HEADmergerelease tomaster details summaryor if you are using SSHsummary git push gitgithubcomdotnetmaestrobotEntityFramework HEADmergerelease tomaster details After PR checks are complete push the branch git push Instructions for resolving conflicts warning If there are merge conflicts you will need to resolve them manually before merging You can do this using GitHub resolvegithub or using the command line resolvecli resolvegithub resolvecli Instructions for updating this pull request Contributors to this repo have permission update this pull request by pushing to the branch mergerelease tomaster This can be done to resolve conflicts or make other changes to this pull request before it is merged git checkout b mergerelease tomaster master git pull mergerelease tomaster make changes git commit m Updated PR with my changes git push HEADmergerelease tomaster details summaryor if you are using SSHsummary git checkout b mergerelease tomaster master git pull gitgithubcomdotnetmaestrobotEntityFramework mergerelease tomaster make changes git commit m Updated PR with my changes git push gitgithubcomdotnetmaestrobotEntityFramework HEADmergerelease tomaster details Contact NET Core Engineering if you have questions or issues Also if this PR was generated incorrectly help us fix it See This issue has been moved from a ticket on Developer Community The user instance databases are a pain to manage The ones autocreated during development to your userprofile folder when youre doing work with Entity Framework Theyre easy to create but also easy to lockup due to their process only limitation Creates all kinds of headaches Original Comments Visual Studio Feedback System on AM pWe have directed your feedback to the appropriate engineering team for further evaluation The team will review the feedback and notify you about the next stepsp Original Solutions no solutions This issue has been moved from a ticket on Developer Community Hi I very often getting Out Of memory Exception when I use code first commands on Package Manager Console like this PM updatedatabase Specify the Verbose flag to view the SQL statements being applied to the target database SystemOutOfMemoryException Exception of type SystemOutOfMemoryException was thrown at SystemReflectionRuntimeAssemblynLoadAssemblyName fileName String codeBase Evidence assemblySecurity RuntimeAssembly locationHint StackCrawlMark stackMark IntPtr pPrivHostBinder Boolean throwOnFileNotFound Boolean forIntrospection Boolean suppressSecurityChecks at SystemReflectionRuntimeAssemblynLoadAssemblyName fileName String codeBase Evidence assemblySecurity RuntimeAssembly locationHint StackCrawlMark stackMark IntPtr pPrivHostBinder Boolean throwOnFileNotFound Boolean forIntrospection Boolean suppressSecurityChecks at SystemReflectionRuntimeAssemblyInternalLoadAssemblyNameAssemblyName assemblyRef Evidence assemblySecurity RuntimeAssembly reqAssembly StackCrawlMark stackMark IntPtr pPrivHostBinder Boolean throwOnFileNotFound Boolean forIntrospection Boolean suppressSecurityChecks at SystemReflectionRuntimeAssemblyInternalLoadString assemblyString Evidence assemblySecurity StackCrawlMark stackMark IntPtr pPrivHostBinder Boolean forIntrospection at SystemReflectionRuntimeAssemblyInternalLoadString assemblyString Evidence assemblySecurity StackCrawlMark stackMark Boolean forIntrospection at SystemReflectionAssemblyLoadString assemblyString at SystemDataEntityMigrationsDesignToolingFacadeBaseRunnerLoadAssemblyString name at SystemDataEntityMigrationsDesignToolingFacadeBaseRunnerFindConfiguration at SystemDataEntityMigrationsDesignToolingFacadeBaseRunnerGetMigrator at SystemDataEntityMigrationsDesignToolingFacadeUpdateRunnerRunCore at SystemDataEntityMigrationsDesignToolingFacadeBaseRunnerRun Exception of type SystemOutOfMemoryException was thrown After restart VS everything works I dont know if problem begin after upgrade my computer GB RAM from or in new version VS Event manager and ActivityLogxsl don t have any detailed information s Can you advise me how I can resolve the problem Thanks Tom Original Comments Visual Studio Feedback System on AM pWe have directed your feedback to the appropriate engineering team for further evaluation The team will review the feedback and notify you about the next stepsp Original Solutions no solutions As a first step towards the work describe here were planning on migrating the EntityFramework repo to the dotnet org and renaming it to ef Wed like to get this done ASAP We dont expect any significant issues for contributors GitHub is great about adding redirects However it may impact our ability to produce nightly builds and flow dependencies for a few days Please let us know if you run into any other issues I am not sure if this is a bug but the following behavior is not what I was expecting Here is how my models look like A Branch belongs to an Organisation An Organisation belongs to a User Tablebranch public class Branch public long BranchId get set public string BranchName get set public long OrganisationId get set ForeignKeyOrganisationId public Organisation Organisation get set Tableorganisation public class Organisation public long OrganisationId get set public string OrganisationName get set public long UserId get set ForeignKeyUserId public UserProfile UserProfile get set Tableuserprofileview UserProfile is representing a view public class UserProfile public long UserId get set public string Name get set UserProfile entity is representing a view and is not insertable because it has a left join I want to add a new Branch to an existing Organisation which belongs to an existing User the following code gives me an error public void AddOrUpdateBranchAsAdminUserBranch branch if branchBranchId code to update branch else contextBranchAddbranch contextEntrybranchOrganisationState EntityStateUnchanged Dont update Organisation uncommenting this line will fix the problem contextEntrybranchOrganisationUserProfileState EntityStateUnchanged contextSaveChanges This is the error that I get The target table userprofileview of the INSERT is not insertableinto If I uncomment the line that sets the state of UserProfile then it works fine I would have expected that changing Organisation state parent entity should change the state of UserProfile too Fix of memory leak test reproducing memory leak with WeakReference