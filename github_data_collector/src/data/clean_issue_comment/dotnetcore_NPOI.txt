 Class XSSFWorkbook is not implementing the IDispose So cant be use in using Statement When using GetColumnStyle method of ISheet interface getting the error Nullable object must have a value var workbook new XSSFWorkbookfileStreem var worksheet packageGetSheetAt var columnStyle worksheetGetColumnStyle Getting error Nullable object must have a value here if style for the column doesnt exists Could not open display XServer required Check your DISPLAY environment variable at SystemDrawingGraphicsFromHwndIntPtr hwnd at NPOISSUtilSheetUtilgetDefaultCharWidthIWorkbook wb at NPOISSUtilSheetUtilGetColumnWidthISheet sheet Int column Boolean useMergedCells at NPOIHSSFUserModelHSSFSheetAutoSizeColumnInt column Boolean useMergedCells at NPOIHSSFUserModelHSSFSheetAutoSizeColumnInt column csharp using var stream new MemoryStream workbookWritestream ERROR NPOIUtilRuntimeException Buffer overrun i endIndex writeIndex at NPOIUtilLittleEndianByteArrayOutputStreamCheckPositionSystemInt i at offset at NPOIUtilLittleEndianByteArrayOutputStreamWriteSystemByte b at offset at NPOIHSSFRecordAutoFilterAutoFilterRecordSerializeNPOIUtilILittleEndianOutput out at offset at NPOIHSSFRecordStandardRecordSerializeSystemInt offset SystemByte data at offset at NPOIHSSFRecordAutoFilterAutoFilterRecordSerializeSystemInt offset SystemByte data at NPOIHSSFUserModelHSSFWorkbookSheetRecordCollectorSerializeSystemInt offset SystemByte data at offset at NPOIHSSFUserModelHSSFWorkbookGetBytes at offset at NPOIHSSFUserModelHSSFWorkbookWriteSystemIOStream stream at offset I have found in an application that the border formatting in XSSFCellStyle is a bit broken It results in accidentally sharing a CTBorder instance From public BorderStyle BorderBottom get if cellXfapplyBorder return BorderStyleNone int idx intcellXfborderId CTBorder ct stylesSourceGetBorderAtidxGetCTBorder if ctIsSetBottom return BorderStyleNone else return BorderStylectbottomstyle set CTBorder ct GetCTBorder CTBorderPr pr ctIsSetBottom ctbottom ctAddNewBottom if value BorderStyleNone ctUnsetBottom else prstyle STBorderStylevalue int idx stylesSourcePutBordernew XSSFCellBorderct theme cellXfborderId uintidx cellXfapplyBorder true Each of the border setters has the same but I have chosen BorderBottom as an example The first time you assign a value to a border property Eg cellBorderBottom BorderStyleThin it will create a CTBorder object assign the border to it and then call stylesSourcePutBordernew XSSFCellBorderct theme which will store the border object and return an ID If it finds a matching CTBorder it will return that instances id causing it to be shared This seems to be from here public int PutBorderXSSFCellBorder border int idx bordersIndexOfborder if idx return idx bordersAddborder borderSetThemesTabletheme return bordersCount Using bordersIndexOfborder will search by the current value of the border The XSSFCellBorder class implements equality based on the XML value of the CTBorder I think the easiest and possibly best solution would be to delete the lines int idx bordersIndexOfborder if idx return idx Im not a regular contributer here but if it would help I can try and put together a PR Warm Regards Stuart When I change row height the image height also grows My code is as the following private void AddImageToWorkBookImage img int colIndex int rowIndex XSSFWorkbook workbook ISheet sheet var ms new MemoryStream imgSavems ImageFormatPng byte data msToArray int pictureIndex workbookAddPicturedata PictureTypePNG ICreationHelper helper workbookGetCreationHelper IDrawing drawing sheetCreateDrawingPatriarch IClientAnchor anchor helperCreateClientAnchor anchorAnchorType AnchorTypeMoveDontResize anchorCol colIndex index based column anchorRow rowIndex index based row IPicture picture drawingCreatePictureanchor pictureIndex pictureResize When I change the row height before or after calling this function then the generated image will grow too while Ive set the AnchorType to MoveDontResize Expected behavior Image size should not grow with row height Caching implemented for the result of HSSFCellStyleGetDataFormatString uses unguarded statics and is not thread safe In a multithreaded environment you may receive the format string for a different cell Hi I am trying to use NPOI in my aspnet core library but I get a warning sign on the package when I installed it but it does not really tell me what the warning is It wont let me import anything in though TargetFrameworknetcoreapp TargetFramework the ICSharpCodeSharpZipLibdll under version is in GPL license we can not use it in our software however the new version had changed to MIT license So can ugrade the ICSharpCodeSharpZipLibdll to new version