When I make a call through the Beanstalk Client to describe environments the API returns an empty list if I explicitly deny IAM permissions for Beanstalk It should throw an exception so we can detect the difference between not having any environments vs not having permissions Note looks like using aws elasticbeanstalk describeenvironments exhibits the same behavior Im using the awsjavasdkapigatewaymanagementapi and getting the exception below when the connectionId is expired According to the docs we should get an instance of GoneException when the id no longer exists It seems the SDK is having a NullPointerException when trying to unmarshal the response comamazonawsSdkClientException Unable to unmarshall error response null Response Code Response Text Gone at comamazonawshttpAmazonHttpClientRequestExecutorhandleErrorResponseAmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutorhandleServiceErrorResponseAmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutorexecuteOneRequestAmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutorexecuteHelperAmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutordoExecuteAmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutorexecuteWithTimerAmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutorexecuteAmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutoraccess AmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutionBuilderImplexecuteAmazonHttpClientjava at comamazonawshttpAmazonHttpClientexecuteAmazonHttpClientjava at comamazonawshttpAmazonHttpClientexecuteAmazonHttpClientjava at comamazonawsservicesapigatewaymanagementapiAmazonApiGatewayManagementApiClientdoInvokeAmazonApiGatewayManagementApiClientjava at comamazonawsservicesapigatewaymanagementapiAmazonApiGatewayManagementApiClientinvokeAmazonApiGatewayManagementApiClientjava at comamazonawsservicesapigatewaymanagementapiAmazonApiGatewayManagementApiClientinvokeAmazonApiGatewayManagementApiClientjava at comamazonawsservicesapigatewaymanagementapiAmazonApiGatewayManagementApiClientexecutePostToConnectionAmazonApiGatewayManagementApiClientjava at comamazonawsservicesapigatewaymanagementapiAmazonApiGatewayManagementApiClientpostToConnectionAmazonApiGatewayManagementApiClientjava omitted at javabasejdkinternalreflectNativeMethodAccessorImplinvokeNativeMethodAccessorImpljava at javabasejdkinternalreflectDelegatingMethodAccessorImplinvokeDelegatingMethodAccessorImpljava at javabasejavalangreflectMethodinvokeMethodjava at orgspringframeworkmessaginghandlerinvocationInvocableHandlerMethoddoInvokeInvocableHandlerMethodjava at orgspringframeworkmessaginghandlerinvocationInvocableHandlerMethodinvokeInvocableHandlerMethodjava at orgspringframeworkjmslisteneradapterMessagingMessageListenerAdapterinvokeHandlerMessagingMessageListenerAdapterjava at orgspringframeworkjmslisteneradapterMessagingMessageListenerAdapteronMessageMessagingMessageListenerAdapterjava at orgspringframeworkjmslistenerAbstractMessageListenerContainerdoInvokeListenerAbstractMessageListenerContainerjava at orgspringframeworkjmslistenerAbstractMessageListenerContainerinvokeListenerAbstractMessageListenerContainerjava at orgspringframeworkjmslistenerAbstractMessageListenerContainerdoExecuteListenerAbstractMessageListenerContainerjava at orgspringframeworkjmslistenerAbstractPollingMessageListenerContainerdoReceiveAndExecuteAbstractPollingMessageListenerContainerjava at orgspringframeworkjmslistenerAbstractPollingMessageListenerContainerreceiveAndExecuteAbstractPollingMessageListenerContainerjava at orgspringframeworkjmslistenerDefaultMessageListenerContainerAsyncMessageListenerInvokerinvokeListenerDefaultMessageListenerContainerjava at orgspringframeworkjmslistenerDefaultMessageListenerContainerAsyncMessageListenerInvokerrunDefaultMessageListenerContainerjava at javabasejavautilconcurrentThreadPoolExecutorrunWorkerThreadPoolExecutorjava at javabasejavautilconcurrentThreadPoolExecutorWorkerrunThreadPoolExecutorjava at javabasejavalangThreadrunThreadjava Caused by javalangNullPointerException null at comamazonawsinternalhttpJsonErrorMessageParserparseErrorMessageJsonErrorMessageParserjava at comamazonawshttpJsonErrorResponseHandlerhandleJsonErrorResponseHandlerjava at comamazonawshttpJsonErrorResponseHandlerhandleJsonErrorResponseHandlerjava at comamazonawshttpAwsErrorResponseHandlerhandleAseAwsErrorResponseHandlerjava at comamazonawshttpAwsErrorResponseHandlerhandleAwsErrorResponseHandlerjava at comamazonawshttpAwsErrorResponseHandlerhandleAwsErrorResponseHandlerjava at comamazonawshttpAmazonHttpClientRequestExecutorhandleErrorResponseAmazonHttpClientjava common frames omitted Versions awsjavasdkapigatewaymanagementapi java sdk Steps to reproduce Do a call to API Gateway using amazonGatewayManagementApipostToConnection with an expired connectionId Issue if available Description of changes By submitting this pull request I confirm that you can use modify copy and redistribute this contribution under the terms of your choice Fixing a possible simple typo error causing java project error in Ecipse and JDK nThe error message received is Syntax error on token delete this token Issue if available Description of changes By submitting this pull request I confirm that you can use modify copy and redistribute this contribution under the terms of your choice When I instance a ProfileCredentialsProvider with a valid file path and a profile name it doesnt take that profile to push to a S bucket String profileName myProfile ProfilesConfigFile profilesConfigFile new ProfilesConfigFilesrcmainresourcesconfig AWSCredentialsProvider credentialsProvider new ProfileCredentialsProviderprofilesConfigFile profileName return AmazonS ClientBuilderstandard withCredentialsawsStaticCredentialsProvider withRegionregion build So I have to use the method assumeRole with temporary credentials to create a BasicSessionCredentials And then it works Context I need to take a different profile from the default and the configuration is on the awsconfig file the role arn I need The code is running inside a docker container in a EC instance in account A and the S in account B bucket has a trusted relation with that instance AmazonDocDBClient docDBClient AmazonDocDBClient AmazonDocDBClientBuilderstandardwithCredentialsnew AWSStaticCredentialsProvidertemporaryCredentialswithRegionregiongetNamebuild ListDBCluster clusterList docDBClientdescribeDBClustersnew DescribeDBClustersRequestgetDBClusters Above code returns RDS clusters not DocDB clusters as expected Same behavior is observed for Neptune as well I originally reported this in as I wasnt sure if this was an issue with the Prometheus cloudwatch exporter or the underlying AWS Java SDK which it uses Im trying to run the promcloudwatchexportercloudwatchexporter Docker container on AWS ECS The ECS Service is using an IAM Role Policy which includes the permissions cloudwatchListMetrics cloudwatchGetMetricStatistics tagGetResources The following error occurs when starting the exporter ec useripXXXX sudo docker logs f dbc dade WARNING An illegal reflective access operation has occurred WARNING Illegal reflective access by comamazonawsutilXpathUtils filecloudwatchexporterjar to method comsunorgapachexpathinternalXPathContextgetDTMManager WARNING Please consider reporting this to the maintainers of comamazonawsutilXpathUtils WARNING Use illegalaccesswarn to enable warnings of further illegal reflective access operations WARNING All illegal access operations will be denied in a future release Dec PM ioprometheuscloudwatchCloudWatchCollector collect WARNING CloudWatch scrape failed comamazonawsservicescloudwatchmodelAmazonCloudWatchException User arnawsstsxxxxxxxxxxxxassumedrolexxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx is not authorized to perform cloudwatchListMetrics Service AmazonCloudWatch Status Code Error Code AccessDenied Request ID xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx at comamazonawshttpAmazonHttpClientRequestExecutorhandleErrorResponseAmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutorexecuteOneRequestAmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutorexecuteHelperAmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutordoExecuteAmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutorexecuteWithTimerAmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutorexecuteAmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutoraccess AmazonHttpClientjava at comamazonawshttpAmazonHttpClientRequestExecutionBuilderImplexecuteAmazonHttpClientjava at comamazonawshttpAmazonHttpClientexecuteAmazonHttpClientjava at comamazonawshttpAmazonHttpClientexecuteAmazonHttpClientjava at comamazonawsservicescloudwatchAmazonCloudWatchClientdoInvokeAmazonCloudWatchClientjava at comamazonawsservicescloudwatchAmazonCloudWatchClientinvokeAmazonCloudWatchClientjava at comamazonawsservicescloudwatchAmazonCloudWatchClientinvokeAmazonCloudWatchClientjava at comamazonawsservicescloudwatchAmazonCloudWatchClientexecuteListMetricsAmazonCloudWatchClientjava at comamazonawsservicescloudwatchAmazonCloudWatchClientlistMetricsAmazonCloudWatchClientjava at ioprometheuscloudwatchCloudWatchCollectorlistDimensionsCloudWatchCollectorjava at ioprometheuscloudwatchCloudWatchCollectorgetDimensionsCloudWatchCollectorjava at ioprometheuscloudwatchCloudWatchCollectorscrapeCloudWatchCollectorjava at ioprometheuscloudwatchCloudWatchCollectorcollectCloudWatchCollectorjava at ioprometheusclientCollectorRegistrycollectorNamesCollectorRegistryjava at ioprometheusclientCollectorRegistryregisterCollectorRegistryjava at ioprometheusclientCollectorregisterCollectorjava at ioprometheusclientCollectorregisterCollectorjava at ioprometheuscloudwatchWebServermainWebServerjava INFOmain Logging initialized ms to orgeclipsejettyutillogStdErrLog INFOoejsServermain jetty zSNAPSHOT built T Z git eb b fcf abbd af d c fa b jvm INFOoejshContextHandlermain Started oejsServletContextHandler a d dffnullAVAILABLE INFOoejsAbstractConnectormain Started ServerConnector HTTP http INFOoejsServermain Started ms It seems as if the assumed IAM Role attached to the container is not honored correctly I then tried adding the same IAM Role policy permissions noted above to the underlying EC hosts IAM Role and ran the exporter directly on the EC instance This starts cleanly ec useripxxxx java jar cloudwatchexporterjar etcconfigcloudwatchexporterconfigyml INFOmain Logging initialized ms to orgeclipsejettyutillogStdErrLog INFOoejsServermain jetty zSNAPSHOT built T Z git eb b fcf abbd af d c fa b jvm b INFOoejshContextHandlermain Started oejsServletContextHandler eb b nullAVAILABLE INFOoejsAbstractConnectormain Started Serv I searched through the awssdkjava issues looking for issues pertaining to assumed roles within an ECS container and didnt find anything but perhaps I missed it When I am trying to start taskrunner using proxy I am getting the below error when I submit jobs in the datapipeline Dec ERROR TaskRunnerServicetestworkgroup privatecomamazonawsservicesdatapipelinepollerPollWorker Poller threw exception privatecomamazonawsAmazonClientException Unable to execute HTTP request connect timed out at privatecomamazonawshttpAmazonHttpClientexecuteHelperAmazonHttpClientjava at privatecomamazonawshttpAmazonHttpClientdoExecuteAmazonHttpClientjava at privatecomamazonawshttpAmazonHttpClientexecuteWithTimerAmazonHttpClientjava at privatecomamazonawshttpAmazonHttpClientexecuteAmazonHttpClientjava at privatecomamazonawsservicesdatapipelineDataPipelineClientdoInvokeDataPipelineClientjava at privatecomamazonawsservicesdatapipelineDataPipelineClientinvokeDataPipelineClientjava at privatecomamazonawsservicesdatapipelineDataPipelineClientpollForTaskDataPipelineClientjava at sunreflectNativeMethodAccessorImplinvoke Native Method at sunreflectNativeMethodAccessorImplinvokeNativeMethodAccessorImpljava at sunreflectDelegatingMethodAccessorImplinvokeDelegatingMethodAccessorImpljava at javalangreflectMethodinvokeMethodjava at privatecomamazonawsservicesdatapipelineretrierRetryProxyinvokeInternalRetryProxyjava at privatecomamazonawsservicesdatapipelineretrierRetryProxyinvokeRetryProxyjava at comsunproxyProxy pollForTaskUnknown Source at amazonawsdatapipelineclientDataPipelineWsClientImplpollForTaskDataPipelineWsClientImpljava at amazonawsdatapipelinetaskrunnerTaskPollerpollTaskPollerjava at amazonawsdatapipelinetaskrunnerTaskRunnerServiceTaskRunnerPolleractualPollTaskRunnerServicejava at privatecomamazonawsservicesdatapipelinepollerIntervalPollerpollIntervalPollerjava at privatecomamazonawsservicesdatapipelinepollerPollWorkerpollForWorkPollWorkerjava at privatecomamazonawsservicesdatapipelinepollerPollWorkerrunPollWorkerjava at javalangThreadrunThreadjava Caused by javanetSocketTimeoutException connect timed out at javanetPlainSocketImplsocketConnectNative Method at javanetAbstractPlainSocketImpldoConnectAbstractPlainSocketImpljava at javanetAbstractPlainSocketImplconnectToAddressAbstractPlainSocketImpljava at javanetAbstractPlainSocketImplconnectAbstractPlainSocketImpljava at javanetSocksSocketImplconnectSocksSocketImpljava at javanetSocketconnectSocketjava at sunsecuritysslSSLSocketImplconnectSSLSocketImpljava at orgapachehttpconnsslSSLSocketFactoryconnectSocketSSLSocketFactoryjava at orgapachehttpconnsslSSLSocketFactoryconnectSocketSSLSocketFactoryjava at privatecomamazonawshttpconnsslSdkTLSSocketFactoryconnectSocketSdkTLSSocketFactoryjava at orgapachehttpimplconnDefaultClientConnectionOperatoropenConnectionDefaultClientConnectionOperatorjava at orgapachehttpimplconnManagedClientConnectionImplopenManagedClientConnectionImpljava at orgapachehttpimplclientDefaultRequestDirectortryConnectDefaultRequestDirectorjava at orgapachehttpimplclientDefaultRequestDirectorexecuteDefaultRequestDirectorjava at orgapachehttpimplclientAbstractHttpClientdoExecuteAbstractHttpClientjava at orgapachehttpimplclientCloseableHttpClientexecuteCloseableHttpClientjava at orgapachehttpimplclientCloseableHttpClientexecuteCloseableHttpClientjava at privatecomamazonawshttpAmazonHttpClientexecuteOneRequestAmazonHttpClientjava at privatecomamazonawshttpAmazonHttpClientexecuteHelperAmazonHttpClientjava Hi I need to call the PutMedia operation for Kinesis Video Streams behind a corporate proxy Unfortunately since the AmazonKinesisVideoPutMediaClientBuilder does not extend the AwsClientBuilder there is no way to set the ClientConfiguration Additionally setting Javasystem environment variables doesnt seem to work either because the PutMedia client uses Netty as transport and would based on some research require adding a proxy handler first in the channel pipeline Let me know if Im seeing this correctly Thanks