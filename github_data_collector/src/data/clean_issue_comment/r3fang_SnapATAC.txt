Hello When I try to create a snap object with the following command xsp createSnap filecRJATACseqfromcellrangersnap samplecPancreas numcores it gives me the following error Error in dataframebarcode TN UM PP UQ CM arguments imply differing number of rows stopgettextfarguments imply differing number of rows s pasteuniquenrows collapse domain NA dataframebarcode TN UM PP UQ CM readMetaDatadefaultfile readMetaDatafile createSnapSinglefile fileList i sample sampleList i FUNX i lapplyaslistseqfileList functioni createSnapSinglefile fileList i sample sampleList i createSnapdefaultfile cRJATACseqfromcellrangersnap sample cPancreas numcores createSnapfile cRJATACseqfromcellrangersnap sample cPancreas numcores In addition in the console it is showing the following error Epoch reading the barcode session Warning readSnap BDname not found in RJATACseqfromcellrangersnap An open HDF file handle exists If the file has changed on disk meanwhile the function may not work properly Run h closeAll to close all open HDF object handlesAn open HDF file handle exists If the file has changed on disk meanwhile the function may not work properly Run h closeAll to close all open HDF object handles I ran the h closeAll command but the problem continues I looked into and updated rhdf to rhdf but the problem continues Can you please let me know how to solve the issue Hi When creating gmat is it possible to just make counts under a promoter region of a gene instead of everywhere on the gene Thanks xsp addPmatToSnapxsp Epoch reading cellpeak count matrix session Error in mcolsx usenames FALSE name this S class is not subsettable can anyone help with this kind of emergent analysismuch appreciated Hi Is there any way to find DARs between different samples ie compare DARs between different samples as opposed to different clusters Ive read in my different samples into one snap file and called peaks for each sample but cant figure out how to get the DARs because there is a clusterpos option but not a sample option in the findDAR step Thank you Hi I got my databam file at And I generated snap file using the bam file according to your instruction But I dont have a CSV file that conatin the information as your example atacv adultbrainfresh ksinglecellcsv Im wondering how can I perform barcode selection under this circumstance Best Shitao Dear developer Rongxin I am impressed by the package that it can compute the peaktogene link You mentioned in the tutorial that convert the pair to genome browser arc plot format What is the visualization tool you used Many thanks qingnanl Dear developer I used the runMACS to get the aggregated peaks for each cluster and the question is whether the peaks are normalized by the cell numbers or total reads in the cluster For example if I want to show differential peaktogene connection and the cell numbers among clusters are quite different the overall peak values are already quite different Thus I have a concern that the comparison may not be as unbiased at least in visualization Is it possible that normalization could be made after the aggregation of the peak Thanks for creating such a great package it is efficient versatile and well documented Hi I am having trouble running the function runJDA I was looking at the man and pretty much searching everywhere in your repo and online but I havent found a solution Was this function discontinued on the last SnapATAC update Thats the one I am currently running Thank you Cynthia Hi Do anyone know why I identified no DARs under the threshold of FDR using snapATAC I analyzed my human x genomics scATACseq data according to X Adult Mouse Brain tutorial and tried to find DARs by DARs findDAR objxsp inputmatpmat clusterposclusteri clusternegNULL clusternegmethod DARmethod knn or random bcv testmethodexactTest seeduse However no significant DARs were identified for each cluster Do anyone have the same problem Thanks Hi Rongxin SnapATAC is an awesome package for single cell ATACseq analysis After peak calling by MACS I am wondering how can I generate the bdg or bigwig file of a subset of nuclei based on combined peaks Thanks Peng 