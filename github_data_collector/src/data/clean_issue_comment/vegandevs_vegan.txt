Hi Im quite new to R and hope somebody can help me I would like to plot only the top eg five species in an RDA figure as the other species are all overlapping and make the figure messy see example I tried to use select abssumrdasp However it doesnt work but also does not show any error message datavarespec datavarechem ord rdavarespec summaryord sumrda summaryord plotord scaling mainTriplot RDA typenone xlabcRDA ylabcRDA xlimc ylimc pointsscoresord displaysites choicesc scaling pch colblack cex arrows scoresord select abssumrdasp displayspecies choicesc scaling scoresord select abssumrdasp displayspecies choicesc scaling colblacklength lty textscoresord select abssumrdasp displayspecies choicesc scaling scoresord select abssumrdasp displayspecies choicesc scaling labelsrownamesscoresord displayspecies scaling colblack cex Thanks for considering my request Hi Im using permanova tests to evaluate the significance of a given factor in my dataset Everything runs but I get surprising results and Im wondering if its correct or if there could potentially be an issue with either the package or with the data itself Using adonis I was able to test that my factor color was significant However I want to have more details about the significance and compare each pair of levels For example I want to test whether the sample in the Red color group are statistically different from the samples in the Purple color group To do that I extract from my data all samples corresponding to given colors and I run adonis on the subset condition metadatacolor Blue metadatacolor Purple adonisotutable condition metadatacolor condition perm condition metadatacolor Blue metadatacolor Red adonisotutable condition metadatacolor condition perm condition metadatacolor Red metadatacolor Purple adonisotutable condition metadatacolor condition perm My problem is that for all comparisons I get exactly the same pvalue everything else is different R Fmodel It looks very suspicious to me since Im comparing different sample groups Do you have an idea what could cause this issue I also tried the pairwiseadonis package to do these pairwise comparisons but I got the same problem and exactly the same pvalue Thank you for your help Hello I am relatively new to using vegan and to analyzing microbiome data in general I apologize if this seems like a silly question I am using adonis to test for significance between unifrac measures for two groups over time treatment and controls However I also want to take into account the variance due to cage effects My model looks like this r adonis distrarefied unifrac Time Group Cage datamiceV permutations methodunifrac bymargin From what I could tell by reading information about adonis adding bymargin seems to allow for all variables to be taken into account evenly not sequentially as with byterms Therefore I would assume that the output would be similar to that of a standard regression However the degrees of freedom for the degrees of freedom and the Rsquared value for my Group variable is zero and the Fvalue is Inf Further the degrees of freedom for my Cage variable is one less than it should be I thought that maybe the zeros for the Group variable simply meant that it does not contribute to or explain any of the observed variance However this doesnt explain the discrepancy with the degrees of freedom I hope this makes sense Any help in understanding how this function works with the bymargin option would be much appreciated Suppose I have a distance matrix created by applying the weighted unifrac measure For instance using a phyloseq object weightedunifrac UniFrac physeqps weightedT normalizedT parallelT fastT weightedunifrac is now a distance matrix Then I perform PERMANOVA using adonis and showing the default method parameter permanova adonis formulaweightedunifrac CaseString datasampledata permutations methodbray What is method doing here I think of BrayCurtis as a way to generate the distance matrix itself How would my choice of another method value affect my PERMANOVA analysis Hi there I am trying to run what is seemingly turning out to be a very large PERMANOVA by calling adonis in vegan in R In the script which I am running off of our institutions large server I first include a reduced version of the adonis using the same data Next I include the adonis which includes all variables that I am testing each of which has been meticulously scanned for missing data to remove When I read the output file the first small adonis works great but the full adonis terminates with the note Error protect protection stack overflow I have tried using both maxppsize at startup of R and optionsexpressions e from within R before the analysis to no avail Always the same error Has anyone experienced this before How did you get around it Unfortunately our research group has decided that it is not statistically sound to analyze the variables in chunks although that works in the adonis Also is there a difference between adonis and adonis that could be useful Thank you so much I very much appreciate it I can send you my script and files if requested Cheers Katie I have done beta diversity analysis using phyloseq PCoA on rarefying OTU data with bray distance and now for statistical significance I want to use adonis function from vegan so should I use the same rarefying table in vegan with below command pmv adoniswerrasprerefy Region data werraenv permutations method bray Is it be Ok or should I do PCoA analysis in vegan itself I am not sure how to do PCoA analysis in vegan could you please suggest the command for it thank color the ordilabel figured below Updated version for Hi I have a question regarding the calculation of fisher alpha when abundance and number of species are probably a question more conceptual than practical When I compute fisher alpha with the fisheralpha function the result is R libraryvegan a dataframe of columns with the first row filled with and the second filled with The second row serves as control for my calculation see below The third row is filled with that returns an alpha equal to ex asdataframe t matrix c rep rep rep ncol ex result for the first and third columns is fisheralphaex The problem is that the first and the third rows have exactly the same result despite the first row consisting of s only Then I came across the book from Magurran Ecological Diversity and its measurement where she propose to calculate alpha following SN x x ln x alpha N x x where S is the number of species N the number of individuals and x the log series distribution parameter I tried to calculate alpha according to Magurran and the results for the first columns is while those for the second and the third columns are nearly the same of fisheralpha results R function for calculating fisher alpha according to Magurran et al famag functionz abu sum z ntaxa sumz fn function r n x abs x n x log x r temp optimize f fn interval c n abu r ntaxa tol alpha abu temp temp applyex famag Results are more understandable for me now but I m not sure if I interpreted the fisher alpha in the right way The drawback for the Magurran et al calculation is that when abundance become very high x approaches and alpha become greater than again probably is a problem of my bad coding The behaviour of the functions for large numbers is showed below R Seq cseqfrom to by seqfrom to by ex asdataframematrix nrow lengthSeq ncol fori in lengthSeq ex i repSeq i vegres fisheralphaex magres applyex famag parmfrow c plotvegres ylim c type l ablineh lty col red plotmagres ylim c type l ablineh lty col red What the value of fisher alpha should be when both abundance and species richness are This could happen when a user use a subset of a dataframe Thank you very much regards Alex R sessionInfo R version Platform x pclinuxgnu bit Running under Ubuntu LTS Matrix products default BLAS usrliblibblaslibblasso LAPACK usrliblapackliblapackso locale LCCTYPEitITUTF LCNUMERICC LCTIMEitITUTF LCCOLLATEitITUTF LCMONETARYitITUTF LCMESSAGESitITUTF LCPAPERitITUTF LCNAMEC LCADDRESSC LCTELEPHONEC LCMEASUREMENTitITUTF LCIDENTIFICATIONC attached base packages stats graphics grDevices utils datasets methods base other attached packages vegan lattice permute loaded via a namespace and not attached MASS compiler Matrix parallel tools mgcv nlme grid cluster First I want to thank for making such a great package for multivariate and ecological community analyses I use vegan a lot in my work One thing I constantly miss is the possibility to quickly glance the inertia explained by axes in CA and CCA plots Therefore I normally have to modify the plots Something that takes time if you want to mass produce biplots to look at your data from several different angles I thought of sharing my solution here in the hope that something similar would appear in the package in the future r title Get percent of total inertia explained by principal or constrained axes param mod ccaobject param axes A numeric vector indicating the axes for which percent explained inertia should be returned for return Returns a named vector containing explained inertia as percentages Returns constrained inertia fo CCA and unconstrained for CA axisexpl functionmod axes ifisnullmodCCA sapplyaxes functioni modCAeig i modtotchi else sapplyaxes functioni modCCAeig i modtotchi Lets try it datadune x ccadune labs axisexplx CA CA Add to plot plotx xlab ylab titlexlab paste nameslabs sprintf f labs titleylab paste nameslabs sprintf f labs If there already is such a feature please correct me tpoisot comment on Twitter how verbose the outputs from some summary methods are for ordination models These dont so much as summarise a fit but provide detailed output including lots of axis score data I copied vegan when writing summary methods for my cocorresp pkg and am not changing those because the verbosity of output just isnt useful to anyone Would anyone freak out too much if I took a look at vegans summary methods for ordination objects and propose changes that would shorten them 