Hi Ive been playing around with some xy docker version previously which seemed to work just find As I found out a new release was on the fly and pulled the current docker version and started from scratch Externally theres Nginx location nextcloud proxysetheader XRealIP remoteaddr proxysetheader XForwardedFor remoteaddr proxysetheader Host host proxypass clientmaxbodysize M Nextcloud is started like this exec docker run volume pwdnextclouddatavarwwwhtml env POSTGRESDBPOSTGRESDB env POSTGRESUSERPOSTGRESUSER env POSTGRESPASSWORDPOSTGRESPASSWORD env POSTGRESHOSTPOSTGRESHOST env NEXTCLOUDADMINUSERNEXTCLOUDADMINUSER env NEXTCLOUDADMINPASSWORDNEXTCLOUDADMINPASSWORD publish nextcloudapache configphp was changed at two places Add as a trusted domain needed for Nginx reverse proxy I failed to get it working using NEXTCLOUDTRUSTEDDOMAINS probably due to quoting issues I added overwritewebroot nextcloud for the reverse proxy as well With the current version Docker nextcloudapache ef f bbd Im getting an error popup telling This directory is unavailable please check the logs or contact the administrator and after login my URL looks like I guess that appsfiles might be an issue whereever it is coming from Looking through settingsadminoverview there are a number of issues that seem to be new compared to xy Your web server is not yet properly set up to allow file synchronization because the WebDAV interface seems to be broken Missing index calendarobjectcalidindex in table occalendarobjectsprops Missing index schedulobjprincipuriindex in table ocschedulingobjects Missing bigint conversion mountsstorageid mountsrootid mountsmountid I dropped the PostgreSQL database beforehand and wiped the supplied varwwwhtml directory so this is a completely new installation I would have expected that for a fresh installation the column types and indices were readily created Most probably each of the issues is only a small thing to fix please let me know ifhow I can assist The previous Docker worked quite well for testing I quite like that setup would be perfect to get that upnrunning for the release as well And maybe fix the issues with trusted domain and overwritewebroot as mentioned before so no further manual config file editing would be needed Thanks a lot JanBenedict Just using the default dockercompose from the readme only changes are the mysql passwords ERROR for d e c a nextcloudweb a byteslike object is required not str ERROR for web a byteslike object is required not str Traceback most recent call last File sitepackagesdockerapiclientpy line in raiseforstatus File sitepackagesrequestsmodelspy line in raiseforstatus requestsexceptionsHTTPError Client Error Bad Request for url httpdockerlocalhostv containers c f d ec da ac c a d d fab c c bfb fstart During handling of the above exception another exception occurred Traceback most recent call last File composeservicepy line in startcontainer File composecontainerpy line in start File sitepackagesdockerutilsdecoratorspy line in wrapped File sitepackagesdockerapicontainerpy line in start File sitepackagesdockerapiclientpy line in raiseforstatus File sitepackagesdockererrorspy line in createapierrorfromhttpexception dockererrorsAPIError Client Error Bad Request bOCI runtime create failed containerlinuxgo starting container process caused processlinuxgo container init caused rootfslinuxgo mounting rootnextcloudnginxconf to rootfs varlibdockeroverlay ce e b e ee d fa e f cd a dc d fmerged at varlibdockeroverlay ce e b e ee d fa e f cd a dc d fmergedetcnginxnginxconf caused not a directory unknown Are you trying to mount a directory onto a file or viceversa Check if the specified host path exists and is the expected type During handling of the above exception another exception occurred Traceback most recent call last File bindockercompose line in module File composeclimainpy line in main File composeclimainpy line in performcommand File composeclimainpy line in up File composeclimainpy line in up File composeprojectpy line in up File composeparallelpy line in parallelexecute File composeparallelpy line in producer File composeprojectpy line in do File composeservicepy line in executeconvergenceplan File composeservicepy line in executeconvergencerecreate File composeparallelpy line in parallelexecute File composeparallelpy line in producer File composeservicepy line in recreate File composeservicepy line in recreatecontainer File composeservicepy line in startcontainer TypeError a byteslike object is required not str Failed to execute script dockercompose People are deploying Nextcloud more and more on kubernetes this is our case the VOLUME directive and the fact that it is not stateless is on the way This PR is to make the image on the road for stateless there is still the redis part that I solved on my fork in a different fashion but Id like to keep this PR reasonably small The env var with the is because in my fork I have to override them and I prefer that the databaseconfigphp is called to be sure it is loaded before configphp so that it overwrite it closes I build indiepaasnextcloud fpmalpine to test it out you can do the same if needed From today Tail end of Dockerfile is COPY supervisordconf ENV NEXTCLOUDUPDATE CMD usrbinsupervisord c supervisordconf Build reports COPY failed stat varlibdockertmpdockerbuilder supervisordconf no such file or directory logs I have installed the docker version of nextcloudlatest and am trying to get it running I have specified volumes to mount as such volume pwdImagesnextcloudhtmlvarwwwhtml volume pwdImagesnextcloudconfig varwwwhtmlconfig volume pwdImagesnextclouddata varwwwhtmldata volume pwdImagesnextcloudcustomappsvarwwwhtmlcustomapps When I hit the webpage I get Cannot write into config directory This can usually be fixed by giving the webserver write access to the config directory See Or if you prefer to keep configphp file read only set the option configisreadonly to true in it See Cannot write into apps directory This can usually be fixed by giving the webserver write access to the apps directory or disabling the appstore in the config file See I have verified that the wwwdata user in the container has write access to those directories however so Im not sure what the problem is this is after manual stuffing around with the container if you are wondering how I am logged in as wwwdata su wwwdata wwwdatanextcloud pwd varwww wwwdatanextcloud cd html wwwdatanextcloudhtml ls rdparty COPYING config core customapps indexhtml lib ocmprovider ocsprovider remotephp robotstxt statusphp versionphp AUTHORS apps consolephp cronphp data indexphp occ ocs publicphp resources settings themes wwwdatanextcloudhtml touch foo wwwdatanextcloudhtml rm foo wwwdatanextcloudhtml cd config wwwdatanextcloudhtmlconfig touch foo wwwdatanextcloudhtmlconfig ls l foo rwrr wwwdata wwwdata Jan foo wwwdatanextcloudhtmlapps cd customapps wwwdatanextcloudhtmlcustomapps touch foo wwwdatanextcloudhtmlcustomapps ls l foo rwrr wwwdata wwwdata Jan foo wwwdatanextcloudhtmlcustomapps rm foo wwwdatanextcloudhtmlcustomapps Where do I look next please After updating my dockercompose to nextcloud I started getting a lot of errors and the message Problem loading page reloading in seconds in the frontend After reading this issue I figured it would be a session problem After disabling redis in my dockercompose everything worked again Im currently running nextcloud fpmalpine and redis alpine Here my dockercomposeyml file note that I use traefik as a reverse proxy for ssl termination version services nextcloud image nextcloud fpmalpine restart always environment MYSQLHOSTdb NEXTCLOUDADMINUSERadmin NEXTCLOUDADMINPASSWORDcensored NEXTCLOUDTRUSTEDDOMAINScensored REDISHOSTredis envfile dbenv volumes volumesnextcloudvarwwwhtmlvarwwwhtml db image mariadb restart always volumes volumesdbvarlibmysql volumesdbbackupbackup environment MYSQLROOTPASSWORDcensored envfile dbenv collabora image collaboracode restart always labels traefikenabletrue traefikfrontendruleHostcensored traefikfrontendpassHostHeadertrue traefikprotocolhttp traefikport traefikdockernetworknetworkweb traefikfrontendheadersSTSSeconds environment domaincensored servernamecensored usernameadmin passwordcensored extraparamsosslenablefalse osslterminationtrue DONTGENSSLCERTtrue capadd MKNOD tty true networks networkweb default redis image redis alpine restart always cron image nextcloud fpmalpine restart always volumesfrom nextcloud entrypoint cronsh nginx image nginx alpine restart always labels traefikenabletrue traefikfrontendruleHostcensored traefikprotocolhttp traefikport traefikdockernetworknetworkweb traefikfrontendredirectpermanenttrue traefikfrontendredirectregex traefikfrontendredirectreplacement traefikfrontendheadersSTSSeconds traefikfrontendheaderscustomFrameOptionsValuesameorigin traefikfrontendpassHostHeadertrue volumes nginxconfetcnginxnginxconfro volumesfrom nextcloud networks networkweb default networks networkweb name networkweb default name networkdefault hello do you have a solution for local external storage and uidgid i made this dockerfile to change the uid and gid of wwwdata but a cleaner solution would be appreciated Dockerfiletxt Hi I would like to add multiple configphp in the config folder This folder in fact its parent is a volume as detailed here services ncfpm image nextcloudfpm restart always networks nc dependson ncdb ncredis envfile envprodncncdbenv envprodncncfpmenv volumes ncappvarwwwhtmlrw sourcesncfpmmimetypemappingjsonvarwwwhtmlconfigmimetypemappingjsonro If I start the container from scratch I get Cannot write into config directory But if I comment the line start the container uncomment the line and dockecompose up I get the config in the right place Do you have any idea how to solve this By advance thank you Hello I cannot connect to my server with nextcloud running on port or Firewall Settings When I log in it says that it cannot find the database Im using the exact code from the Github and Ive set the database password The Postgress version works great so I assume the issue is with the MariaDB docker image It probably got changed in a recent update Im just going to stick to Postgress but I though you should know that the example is broken 