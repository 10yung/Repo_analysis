The acl plugin has metrics there is a metricsgo but it doesnt describe them in the README Please use this template while reporting a bug and provide as much info as possible Not doing so may result in your bug not being addressed in a timely manner Thanks If the matter is security related please disclose it privately via securitycorednsio What happened I keep seeing warning messages although logs is configured for error only Here is an example WARNING No files matching import glob pattern customoverride WARNING No files matching import glob pattern customserver What you expected to happen No warning messages should be shown if the log plugin is in error mode Environment the version of CoreDNS coredns Corefile n errors n log n class error n n health n ready n kubernetes clusterlocal inaddrarpa ip arpa n pods insecure n upstream n fallthrough inaddrarpa ip arpa n ttl n n prometheus n forward etcresolvconf n cache n loop n reload n loadbalance roundrobin n import customoverride n nimport customserver Others kubernetes version I have installed a k s cluster on a physical machine Bute the log of coredns pod show Readiness probe failed Get dial tcp connect connection refusedwho can help me my coredns version is and here is my config Corefile errors health kubernetes clusterlocal inaddrarpa ip arpa pods insecure upstream fallthrough inaddrarpa ip arpa prometheus proxy etcresolvconf cache loop reload loadbalance can anybody tell me the difference between upstream and proxy This issue is to keep track of release Specifically we want to add the releasing support for mips le arch Thank you for contributing to CoreDNS Please provide the following information to help us make the most of your pull request Why is this pull request needed and what does it do Although the connection between coredns and apiserver is broken but the HasSynced method of reflector will not report the error If this is connection refused error it means that most likely apiserver is not responsive It doesnt make sense to relist all objects because most likely we will be able to restart watch where we ended If thats the case wait and resend watch request Which issues if any are related Which documentation changes if any need to be made none Does this introduce a backward incompatible change or deprecation none What happened I have coredns pod running about months then I found of them can not lookup new services created by k s allen kubectl n corednswlcbprod get svcpo o wide NAME TYPE CLUSTERIP EXTERNALIP PORTS AGE SELECTOR svccoredns ClusterIP TCP UDP TCP d namecoredns NAME READY STATUS RESTARTS AGE IP NODE pocorednsbb dbc e ff zzb Running d pocorednsbb dbc e ff rdx Running d pocorednsbb dbc e ffpbfqm Running d pocorednsbb dbc e ffrfqbt Running d pocorednsbb dbc e ffvx dx Running d the problem pod rootdnschecke b de ac dd j dig coretitandevopensvcclusterlocal DiG P Ubuntu coretitandevopensvcclusterlocal server found global options cmd Got answer HEADER opcode QUERY status NXDOMAIN id flags qr aa rd QUERY ANSWER AUTHORITY ADDITIONAL WARNING recursion requested but not available OPT PSEUDOSECTION EDNS version flags udp QUESTION SECTION coretitandevopensvcclusterlocal IN A AUTHORITY SECTION clusterlocal IN SOA nsdnsclusterlocal hostmasterclusterlocal Query time msec SERVER WHEN Sat Jan CST MSG SIZE rcvd pod works well rootdnschecke b de ac dd j dig coretitandevopensvcclusterlocal DiG P Ubuntu coretitandevopensvcclusterlocal server found global options cmd Got answer HEADER opcode QUERY status NOERROR id flags qr aa rd QUERY ANSWER AUTHORITY ADDITIONAL WARNING recursion requested but not available OPT PSEUDOSECTION EDNS version flags udp QUESTION SECTION coretitandevopensvcclusterlocal IN A ANSWER SECTION coretitandevopensvcclusterlocal IN A Query time msec SERVER WHEN Sat Jan CST MSG SIZE rcvd the bad pod is not always bad it can resolve kubernetesdefault and other services created before However it can not resolve new created k s service So it seems there is some thing wrong for syncing machinism I got so many domain resolve logs but no helpful logs of k s related What you expected to happen coredns worker normally can syncing all changes from k s and I also want to know how I can get coredns logs about k s resource syncing How to reproduce it as minimally and precisely as possible I think restart pod could resolve the problem but still not find the steps to reproduce Anything else we need to know Environment the version of CoreDNS Corefile errors health kubernetes clusterlocal inaddrarpa ip arpa endpoint pods insecure upstream fallthrough inaddrarpa ip arpa prometheus forward maxfails expire s policy sequential healthcheck s log class denial class error cache loop reload loadbalance logs if applicable OS eg cat etcosrelease Ubuntu Others What happened servestale does not update NXDOMAIN status if it gets constantly hammered by requests What you expected to happen CoreDNS updates the record once an upstream DNS starts to return an A record after returning NXDOMAIN How to reproduce it as minimally and precisely as possible Begin the exercise by repeatedly hammering a CoreDNS instance with requests to the nonexistent domain It correctly returns NXDOMAIN bash while sleep do dig testdefaultsvcclusterlocal done Create an appropriate Ive just created a Service in Kubernetes A record on the upstream DNS Verify dig testdefaultsvcclusterlocal short The aforementioned while loop will return NXDOMAIN indefinitely Removing the servestale option alleviates the issue Anything else we need to know Notice that these tests are performed not against the primary CoreDNS of a Kubernetes cluster but against a secondary one that forwards requests to the primary a nodelevel caching mechanism Environment the version of CoreDNS Corefile errors consolidate s io timeout consolidate s write operation not permitted cache success denial prefetch m servestale reload s loop bind forward maxfails prometheus health logs if applicable OS eg cat etcosrelease NAMEUbuntu VERSION LTS Bionic Beaver IDubuntu IDLIKEdebian PRETTYNAMEUbuntu LTS VERSIONID HOMEURL SUPPORTURL BUGREPORTURL PRIVACYPOLICYURL VERSIONCODENAMEbionic UBUNTUCODENAMEbionic Others Signedoffby zouyee zounyee gmailcom Thank you for contributing to CoreDNS Please provide the following information to help us make the most of your pull request Why is this pull request needed and what does it do To optimize the monitoring test we should not simply confirm the existence of metrics but compare the results of metrics deeply Which issues if any are related Which documentation changes if any need to be made NONE Does this introduce a backward incompatible change or deprecation NONE Please only use this template for submitting enhancement requests What would you like to be added compare the results of metrics deeply Why is this needed To optimize the monitoring test we should not simply confirm the existence of metrics but compare the results of metrics deeply 