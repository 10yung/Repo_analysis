Hi We are thinking to adopt onion for our commercial embedded system which runs on linux based operating system Just to be sure does LGPLv licence of onion is also valid when we use the option dependecies of onion gnutls and gcrypt SSL support pthreads threading support libxml WebDAV support libpam HTTP Basic Auth support using PAM C compiler Systemd support for listening on systemd sockets sqlite sqlite session backend hiredis Redis session backend We mean can we develop webserverwebsoket serverrest api using onion and keep source code closed Thanks Alex Hello I start onion like this onion oonionnewOONELOOP But in this mode it seems to close connection after each request I would like to keep the connection alive Is this possible thanks I was looking for a simple library written in C for handling HTTP and I was feeling stressed because the only one I found had a very complex API Then I found this I am looking forward to using it and hopefully it will smoothly integrate with my software Thanks for this awesome product Hi At the ti arm tool chain armaragolinuxgnueabigccg try to compile error Building C object srconionCMakeFilesoniondirhandlersopackco Building C object srconionCMakeFilesoniondirhandlerspathco Building C object srconionCMakeFilesoniondirhandlersinternalstatusco Building C object srconionCMakeFilesoniondirversionco Building C object srconionCMakeFilesoniondirpollerco Building C object srconionCMakeFilesoniondirrandomdefaultco Linking C shared library libonionso Built target onion Building CXX object srcbindingscppCMakeFilesonioncppstaticdirdictcppo In file included from homeworkonionsrcbindingscppdictcpp homeworkonionsrcbindingscppdicthpp error expected nestednamespecifier before internalpointer homeworkonionsrcbindingscppdicthpp error usingdeclaration for nonmember at class scope homeworkonionsrcbindingscppdicthpp error expected before token homeworkonionsrcbindingscppdicthpp error expected unqualifiedid before token homeworkonionsrcbindingscppdicthpp error internalpointer does not name a type homeworkonionsrcbindingscppdicthpp error expected before noexcept homeworkonionsrcbindingscppdicthpp error expected before noexcept homeworkonionsrcbindingscppdicthpp error looser throw specifier for virtual OnionDictkeynotfoundkeynotfound optarmaragolinuxgnueabibinlibgccarmaragolinuxgnueabi armaragolinuxgnueabiincludec exception error overriding virtual stdexceptionexception throw homeworkonionsrcbindingscppdicthpp error expected before noexcept homeworkonionsrcbindingscppdicthpp error expected before noexcept homeworkonionsrcbindingscppdicthpp error expected before noexcept homeworkonionsrcbindingscppdicthpp error expected before Dict homeworkonionsrcbindingscppdicthpp error expected before noexcept homeworkonionsrcbindingscppdicthpp error expected before noexcept homeworkonionsrcbindingscppdicthpp error expected before noexcept homeworkonionsrcbindingscppdicthpp error expected before noexcept homeworkonionsrcbindingscppdicthpp error expected before std homeworkonionsrcbindingscppdicthpp error expected before noexcept homeworkonionsrcbindingscppdicthpp error expected before noexcept homeworkonionsrcbindingscppdicthpp error expected before noexcept homeworkonionsrcbindingscppdicthpp error expected before noexcept homeworkonionsrcbindingscppdictcpp error expected at end of input homeworkonionsrcbindingscppdictcpp error expected at end of input In file included from homeworkonionsrcbindingscppdictcpp homeworkonionsrcbindingscppdicthpp In constructor OnionDictlocklockOnionDictlock homeworkonionsrcbindingscppdicthpp error nullptr was not declared in this scope homeworkonionsrcbindingscppdicthpp In constructor OnionDictDict homeworkonionsrcbindingscppdicthpp error class OnionDict does not have any field named ptr homeworkonionsrcbindingscppdicthpp In member function stdstring OnionDictoperator const stdstring const homeworkonionsrcbindingscppdicthpp error ptr was not declared in this scope homeworkonionsrcbindingscppdicthpp At global scope homeworkonionsrcbindingscppdicthpp error expected unqualifiedid at end of input homeworkonionsrcbindingscppdicthpp error expected at end of input srcbindingscppCMakeFilesonioncppstaticdirbuildmake recipe for target srcbindingscppCMakeFilesonioncppstaticdirdictcppo failed make srcbindingscppCMakeFilesonioncppstaticdirdictcppo Error CMakeFilesMakefile recipe for target srcbindingscppCMakeFilesonioncppstaticdirall failed make srcbindingscppCMakeFilesonioncppstaticdirall Error Makefile recipe for target all failed make all Error I have discovered that all programs written with libonion that receive at least one request leak bytes after being closed Steps to reproduce download current version of onion compile exampleshellohelloc run it with valgrind I used params leakcheckfull showleakkindsall keepstacktracesalloc trackoriginsyes make at least one request access in your browser stop the program with Control C done valgrind should output still reachable bytes in blocks in its leak summary When string with empty lines between lines with text is sent as a param of request eg data from webform the second and every next line with text begins with duplicated characters Furthermore the empty lines get deleted Example we send request through webform with methodpost test test test test test test test test test the program calls onionrequestgetpost which returns test test tetest test test tetest test test test Version Code of a simple program that triggers the bug is attached Its txt instead of c as GitHub doesnt allow that Steps to trigger the bug are outlined above and in the program Im running Linux on i architecture in case it would turn out to be architecturebound codetxt Hello when I try to make onion on openBSD with the freebsd branch I always end up with this Generating fileserverhtmlc ERROR loadc Could not load external library i n Check plugin location rules at otemplate help and do not know what to do with i n builds succesfully and libi nso is in onionbuildtoolotemplatetemplatetags Do you have any ideas It seems like the websockets code when in single threaded mode sits inside its own loop and doesnt service any of the other HTTP requests Is this correct or did I miss something in how to call the code How hard would it be to change it so that it returns to the main poll loop between websocket messages in header i tlen x FF I am pretty sure the should be a header i tlen x FF There may also be a vs bit problem on systems where int isnt bits In summary the ofileserver example with WebDAV support behaves funny from both WinSCP and Gnome Files Ive spent over a day experimenting with Onions WebDAV support and was able to explore a WebDAV endpoint using Gnome Files on Linux but only on subfolders but WinSCP behaves funny I tried the ofileserver example compiling on Linux accessed from a client on Windows and though WinSCP does connect and handles subdirectories and their contents the root directory displays a entry for every file in the server root path and no real files or folders When WinSCP opens a subfolder using the folder open tool files and folders are valid and working albeit with Size and Changed date set to but the previous directory entry shows a drive icon with no text in the label and clicking it navigates to the root which has all the entries Feel free to ask any other questions about my environment or debugging information this should be reproducable on the master branch