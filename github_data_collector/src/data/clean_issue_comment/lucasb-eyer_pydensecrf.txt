Hi is it possible to extract the filters weights kfi fj before the inference Thank youu My Code def masksmoothenimg mask nclasses mask maskastypenpfloat maskastypenpuint image img height width channels imageshape d dcrfDenseCRF Dheight width nclasses labels maskT U unaryfromsoftmaxlabels U npascontiguousarrayU printUdtype Ushape dsetUnaryEnergyU daddPairwiseBilateralsxy srgb rgbimimage compat Q dinference finemask npargmaxQ axis reshapeheight width return finemask I get the error Bad shape for unary energy Need got My image and masks are large x Can some one help me understand what is happening here Running pip install pydensecrf under python produces the following information pydensecrfeigencpp error no member named exctype in ts type tstateexctype pydensecrfeigencpp error no member named excvalue in ts did you mean curexcvalue value tstateexcvalue curexcvalue usrlocalCellarpython FrameworksPythonframeworkVersions includepython mpystateh note curexcvalue declared here PyObject curexcvalue pydensecrfeigencpp error no member named exctraceback in ts did you mean curexctraceback tb tstateexctraceback curexctraceback usrlocalCellarpython FrameworksPythonframeworkVersions includepython mpystateh note curexctraceback declared here PyObject curexctraceback pydensecrfeigencpp error no member named exctype in ts tmptype tstateexctype pydensecrfeigencpp error no member named excvalue in ts did you mean curexcvalue tmpvalue tstateexcvalue curexcvalue usrlocalCellarpython FrameworksPythonframeworkVersions includepython mpystateh note curexcvalue declared here PyObject curexcvalue pydensecrfeigencpp error no member named exctraceback in ts did you mean curexctraceback tmptb tstateexctraceback curexctraceback usrlocalCellarpython FrameworksPythonframeworkVersions includepython mpystateh note curexctraceback declared here PyObject curexctraceback pydensecrfeigencpp error no member named exctype in ts tstateexctype type pydensecrfeigencpp error no member named excvalue in ts did you mean curexcvalue tstateexcvalue value curexcvalue usrlocalCellarpython FrameworksPythonframeworkVersions includepython mpystateh note curexcvalue declared here PyObject curexcvalue pydensecrfeigencpp error no member named exctraceback in ts did you mean curexctraceback tstateexctraceback tb curexctraceback usrlocalCellarpython FrameworksPythonframeworkVersions includepython mpystateh note curexctraceback declared here PyObject curexctraceback pydensecrfeigencpp error no member named exctype in ts tmptype tstateexctype pydensecrfeigencpp error no member named excvalue in ts did you mean curexcvalue tmpvalue tstateexcvalue curexcvalue usrlocalCellarpython FrameworksPythonframeworkVersions includepython mpystateh note curexcvalue declared here PyObject curexcvalue pydensecrfeigencpp error no member named exctraceback in ts did you mean curexctraceback tmptb tstateexctraceback curexctraceback usrlocalCellarpython FrameworksPythonframeworkVersions includepython mpystateh note curexctraceback declared here PyObject curexctraceback pydensecrfeigencpp error no member named exctype in ts tstateexctype localtype pydensecrfeigencpp error no member named excvalue in ts did you mean curexcvalue tstateexcvalue localvalue curexcvalue usrlocalCellarpython FrameworksPythonframeworkVersions includepython mpystateh note curexcvalue declared here PyObject curexcvalue pydensecrfeigencpp error no member named exctraceback in ts did you mean curexctraceback tstateexctraceback localtb curexctraceback usrlocalCellarpython FrameworksPythonframeworkVersions includepython mpystateh note curexctraceback declared here PyObject curexctraceback pydensecrfeigencpp error no member named exctype in ts tmptype tstateexctype pydensecrfeigencpp error no member named excvalue in ts did you mean curexcvalue tmpvalue tstateexcvalue curexcvalue usrlocalCellarpython FrameworksPythonframeworkVersions includepython mpystateh note curexcvalue declared here PyObject curexcvalue pydensecrfeigencpp error no member named exctraceback in ts did you mean curexctraceback tmptb tstateexctraceback curexctraceback usrlocalCellarpython FrameworksPythonframeworkVersions includepython mpystateh note curexctraceback declared here PyObject curexctraceback pydensecrfeigencpp error no member named exctype in ts tstateexctype type fatal error too many errors emitted stopping now ferrorlimit errors generated error command clang failed with exit status This seems to relate to the problem of cython as mentioned here However updating to the lastest version of cython did not solve this problem Im using python with Cython version First of all thanks a lot for packaging this Ive noticed some interesting errors when creating a pairwise potential with very small stddev for the feature comparison Minimal example python import sys import numpy as np from pydensecrf import densecrf utils n intsysargv s floatsysargv x nprandomrand n n d densecrfDenseCRF Dn n B utilscreatepairwisebilateral s x chdim printaddPairwiseEnergy daddPairwiseEnergyB printworked When passing a small scale parameter e and smaller I can provoke different crashes python crfbugpy e addPairwiseEnergy worked python crfbugpy e addPairwiseEnergy worked double free or corruption out Aborted core dumped python crfbugpy e addPairwiseEnergy corrupted size vs prevsize Aborted core dumped python crfbugpy e addPairwiseEnergy free invalid pointer Aborted core dumped python crfbugpy e addPairwiseEnergy Segmentation fault core dumped The error message is not completely deterministic Relevant part of the backtrace for one of those GIraise sigsigentry at sysdepsunixsysvlinuxraisec x ffff a in GIabort at abortc x ffff a d in libcmessage actionactionentrydoabort fmtfmtentry x ffff b ab a s n at sysdepsposixlibcfatalc x ffff a a in mallocprinterr strstrentry x ffff b c double free or corruption out at mallocc x ffff a be in intfree havelock p xecc b av x ffff dcfc mainarena at mallocc GIlibcfree mem xecc c at mallocc x fffe e in Permutohedralinit this xe dc feature at pydensecrfdensecrfsrcpermutohedralcpp x fffe d d in DenseKernelinitLattice f this xe dc at pydensecrfdensecrfsrcpairwisecpp DenseKernelDenseKernel ntypeoptimized out ktypeoptimized out f this xe dc at pydensecrfdensecrfsrcpairwisecpp PairwisePotentialPairwisePotential this xb a features compatibilityoptimized out ktypeoptimized out ntypeoptimized out at pydensecrfdensecrfsrcpairwisecpp x fffe d e in DenseCRFaddPairwiseEnergy thisthisentry xea a features functionfunctionentry xb kerneltypekerneltypeentryDIAGKERNEL normalizationtypenormalizationtypeentryNORMALIZESYMMETRIC at pydensecrfdensecrfsrcdensecrfcpp So in this case it crashed at I also get crashes at line or All this seems like some memory is overwritten somewhere Running valgrind toolmemcheck suppressionsvalgrindpythonsupp python crfbugpy e the first two relevant errors are detailssummaryan invalid readsummary addPairwiseEnergy Invalid read of size at x A PermutohedralinitEigenMatrixfloat const permutohedralcpp by x CD initLattice pairwisecpp by x CD DenseKernel pairwisecpp by x CD PairwisePotentialPairwisePotentialEigenMatrixfloat const LabelCompatibility KernelType NormalizationType pairwisecpp by x DF DenseCRFaddPairwiseEnergyEigenMatrixfloat const LabelCompatibility KernelType NormalizationType densecrfcpp by x C D pyxpf pydensecrf densecrf DenseCRF addPairwiseEnergy densecrfcpp by x C D pyxpw pydensecrf densecrf DenseCRF addPairwiseEnergyobject object object densecrfcpp by x ABC in usrbinpython by x C PyEvalEvalFrameDefault in usrbinpython by x D in usrbinpython by x B A PyEvalEvalCode in usrbinpython by x in usrbinpython by x PyRunFileExFlags in usrbinpython by x EE PyRunSimpleFileExFlags in usrbinpython by x PyMain in usrbinpython Address x b c is bytes before a block of size allocd at x C F operator new unsigned long in usrlibvalgrindvgpreloadmemcheckamd linuxso by x C PermutohedralinitEigenMatrixfloat const permutohedralcpp by x CD initLattice pairwisecpp by x CD DenseKernel pairwisecpp by x CD PairwisePotentialPairwisePotentialEigenMatrixfloat const LabelCompatibility KernelType NormalizationType pairwisecpp by x DF DenseCRFaddPairwiseEnergyEigenMatrixfloat const LabelCompatibility KernelType NormalizationType densecrfcpp by x C D pyxpf pydensecrf densecrf DenseCRF addPairwiseEnergy densecrfcpp by x C D pyxpw pydensecrf densecrf DenseCRF addPairwiseEnergyobject object object densecrfcpp by x ABC in usrbinpython by x C PyEvalEvalFrameDefault in usrbinpython by x D in usrbinpython by x B A PyEvalEvalCode in usrbinpython by x in usrbinpython by x PyRunFileExFlags in usrbinpython by x EE PyRunSimpleFileExFlags in usrbinpython details detailssummaryshortly followed by an invalid writesummary Invalid write of size at x A PermutohedralinitEigenMatrixfloat const permutohedralcpp by x CD initLattice pairwisecpp by x CD DenseKernel pairwisecpp by x CD PairwisePotentialPairwisePotentialEigenMatrixfloat const LabelCompatibility KernelType NormalizationType pairwisecpp by x DF DenseCRFaddPairwiseEnergyEigenMatrixfloat const LabelCompatibility KernelType NormalizationType densecrfcpp by x C D pyxpf pydensecrf densecrf DenseCRF addPairwiseEnergy densecrfcpp by x C D pyxpw pydensecrf densecrf DenseCRF addPairwiseEnergyobject object object densecrfcpp by x ABC in usrbinpython by x C PyEvalEvalFrameDefault in usrbinpython by x D in usrbinpython by x B A PyEvalEvalCode in usrbinpython by x in usrbinpython by x PyRunFileExFlags in usrbinpython by x EE PyRunSimpleFileExFlags in usrbinpython by x PyMain in usrbinpython Address x b c is bytes after a block of size allocd at x C F operator new unsigned long in usrlibvalgrindvgpreloadmemcheckamd linuxso by x BD PermutohedralinitEigenMatrixfloat const permutohedralcpp by x CD initLattice pairwisecpp by x CD DenseKernel pairwisecpp by x CD PairwisePotentialPairwisePotentialEigenMatrixfloat const LabelCompatibility KernelType NormalizationType pairwisecpp by x DF DenseCRFaddPairwiseEnergyEigenMatrixfloat const LabelCompatibility KernelType NormalizationType densecrfcpp by x C D pyxpf pydensecrf densecrf DenseCRF addPairwiseEnergy densecrfcpp by x C D pyxpw pydensecrf densecrf DenseCRF addPairwiseEnergyobject object object densecrfcpp by x ABC in usrbinpython by x C PyEvalEvalFrameDefault in usrbinpython by x D in usrbinpython by x B A PyEvalEvalCode in usrbinpython by x in usrbinpython by x PyRunFileExFlags in usrbinpython by x EE PyRunSimpleFileExFlags in usrbinpython details Focusing on the latter in its writing beyond the array allocated in which is the barycentric array So barycentric jd p seems to be used with a too large index This probably means that the rank array contained negative values Anyway thats all I can do quickly without delving into the algorithm andor compiling the package myself And I realize this is outside the scope of the Python wrapper so you may not want to deal with this but maybe at least it will help someone searching for this error Hi there thanks for this fantastic wrapper Is there a way to construct a pairwise Gaussian potential with nonzero mean As in pfi fj exp mu fi fj sigma Thanks Hi author is it possible to build this project on ARM architecture i want to use it on the Jetson Nano Added a requirementstxt and fixed setup file so that it will install cython if it is not already installed This resolves issue my image test result mask I use the code like this python d dcrfDenseCRF D prediction prediction reshape dsetUnaryEnergyprediction astypenpfloat daddPairwiseGaussiansxy compat cv imwritetestjpg image i astypenpuint daddPairwiseBilateralsxy srgb rgbimimage i astypenpuint compat prediction dinference prediction npargmaxprediction axis prediction npreshapeprediction predictio npstackytype ytype ytype axis cv imwritemaskjpg prediction astypenpuint Hi I am wondering how many parameters does the model have I am trying to list the end to end complexity for my model but I cant seem to figure out how many parameters were trained for densecrf Thanks Hi I am curious that since the learning step is not wrapped where do the parameters of densecrf come from Are the parameters hardcoded Thank you in advance 