Hi i am using the keras API and would like to initialize a layer at the first iteration of the first epoch and then update this layer by one of the output layer output something like this model function inputs layerinputshape inputshape if iteration epoch output inputs inputs layerconcatenateinputs listinputs output axis output layerconv dup filters kernelsize c activation sigmoid Any idea on how to do this Thank you very much Hi all New to github Im currently working on a side project using the neural style transfer code with Keras Just encountered an error when i got to the line referenced below Here is the log of the detailed traceback Detailed traceback File C Users mts AppData Local rminiconda envs rreticulate lib sitepackages tensorflowcore python keras backendpy line in batchflatten x arrayopsreshapex arrayopsstack prodshapex File C Users mts AppData Local rminiconda envs rreticulate lib sitepackages tensorflowcore python util dispatchpy line in wrapper return targetargs kwargs File C Users mts AppData Local rminiconda envs rreticulate lib sitepackages tensorflowcore python ops arrayopspy line in stack return genarrayopspackvalues axisaxis namename File C Users mts AppData Local rminiconda envs rreticulate lib sitepackages tensorflowcore python ops genarrayopspy line in pack Pack valuesvalues axisaxis namename File C Users mts AppData Local rminiconda envs rreticulate lib sitepackages tensorflowcore p Called from pycallimplcallable dotsargs dotskeywords Im still a beginner in neural networks so I havent delved much into the specifics of the code and what each package ie keras R purrr tensorflow etc does In either case any help would be much appreciated AG Im using the code for the Keras R tutorial to attempt to classify a sample set of tweets The data structure is as follows TweetText Tag Tag some tweet text different tweet text Im just using the first set of tags for this classification When I attempt to adapt the text vectorization layer I get the following error textvectorization adaptcodedcleancleantext Error in pycallimplcallable dotsargs dotskeywords ValueError adapt requires a Dataset or a Numpy array as input got class list Detailed traceback File UsersmboogieLibraryrminicondaenvsrreticulatelibpython sitepackagestensorflowcorepythonkeraslayerspreprocessingtextvectorizationpy line in adapt typedata Here is my session info sessionInfo R version Platform x appledarwin bit Running under macOS Catalina Matrix products default BLAS SystemLibraryFrameworksAccelerateframeworkVersionsAFrameworksvecLibframeworkVersionsAlibBLASdylib LAPACK LibraryFrameworksRframeworkVersions ResourcesliblibRlapackdylib locale enUSUTF enUSUTF enUSUTF CenUSUTF enUSUTF attached base packages stats graphics grDevices utils datasets methods base other attached packages plyr tensorflow forcats stringr tidyr tibble tidyverse readr purrr ggplot dplyr keras loaded via a namespace and not attached reticulate tidyselect haven lattice colorspace vctrs generics base enc rlang pillar glue withr DBI dbplyr modelr readxl lifecycle munsell gtable cellranger rvest tfruns fansi broom Rcpp scales backports jsonlite fs hms stringi grid cli tools magrittr lazyeval crayon whisker pkgconfig zeallot xml reprex lubridate assertthat httr rstudioapi R nlme compiler And the results of my tfconfig tfconfig TensorFlow v Python v Libraryrminicondaenvsrreticulatebinpython In connection with the new version of reticulate v and after quite a few problems to get Keras available I encountered a rather serious problem In an existing program written under keras v reticulate v and tensorflow v and since then run successfully many times the command model compile optimizer adam loss listlossmeansquarederror losscategoricalcrossentropy now run under reticulate tensorflow and keras produce the following error message error in UseMethod compile not applicable method compile applied for object of class ckerasimplkerasenginetrainingModel kerasimplkerasenginetopologyNetwork tensorflowpythonlayersnetworkGraphNetwork kerasimplkerasenginetopologyLayer tensorflowpythonlayersbaseLayer pythonbuiltinobject Similarly the command model fitx x y listy y sampleweight listsampleweights sampleweights epochs produces the error message error in UseMethod fit not applicable method compile applied for object of class ckerasimplkerasenginetrainingModel kerasimplkerasenginetopologyNetwork tensorflowpythonlayersnetworkGraphNetwork kerasimplkerasenginetopologyLayer tensorflowpythonlayersbaseLayer pythonbuiltinobject So which method would then be applicable for compilation Consulting the keras index wrt command compile shows that compile as such doesnt exist as entry in the index any more but only compilekerasenginetrainingModel Configure a Keras model for training However under this symbolic headline I find the same description as earlier under keyword compile and I cannnot detect anything wrong within the command used as above Correspondingly the situation for fit Moreover the function tocategoricaly numclasses NULL now seems to require specification of numclasses explicitely since without this specification as it was used up to now a mysterious error message Error Keras loaded from tensorflow v however version is required Please update with tensorflowinstalltensorflow appears And really the command tensorflowtfconfig shows much to my surprise TensorFlow v C Local conda conda envs RTENS lib sitepackages tensorflow initp Python v CLocalcondacondaenvsrtensorflowpythonexe Note that in my case actually tensorflow v has been installed the recommended command to install tensorflow v sic at this point sounds like a dire reminiscence to my lost previous era with Keras And there is no way back an attempt to reinstall tensorflow automatically leads to reinstallation of tensorflow since tensorflow is not available for R Catch so to speak I am really at a loss how to proceed Any useful hint would be highly appreciated Tnx in advance Leo Faltin I want to learn how to perform LSTM of multivariate time series data to predict Y Data have the following shape Day Y x x x x Ive found this tutorial for Python Online but nothing for R Is there a template for achieving this in R Hi I managed to solve the problem if I install the rstudio environment from anaconda it solves the problem conda create y name rtensorflow tensorflow keras python and if I run librarykeras librarytensorflow librarytfestimators librarytfdatasets libraryreticulate librarydplyr libraryggplot usecondaenvrtensorflow sys importsys np importnumpy If we were working with the boston dataset bostonhousing datasetbostonhousing ctraindata trainlabels bostonhousingtrain tfresetdefaultgraph ksetsessiontfSession model kerasmodelsequential layerdenseunits activation relu inputshape c layerdropoutrate layerdenseunits activation relu layerdropoutrate layerdenseunits activation softmax model compileloss mse optimizer rmsprop metrics listmeanabsoluteerror everything works fine but then when I try to fit the model I receive the following error historyinit model fittraindata trainlabels epochs validationsplit verbose Error in pycallimplcallable dotsargs dotskeywords Evaluation error ModuleNotFoundError No module named rpytools Do you know what is the problem Thank you Tullio Im learning Keras for regression I want to figure out which of the input variables have relatively stronger predictive importance with the output variable How may I achieve that technically with code in Keras I am building a multilabel keras model in R where the number of labels is stored in an integer My goal is to create the last layer in a forloop somethign like this for i in numberoutputvars modelkeras i modelkeraspre layerdenseunits kernelinitializer zeros layeractivationrelu modelkeraspre is output from a deep model However the above code generates an error Error in modelkeras i modelkeraspre layerdenseunits object of type closure is not subsettable I want to have different loss function for different labels hence need some kind of forloop to create the last layer Is there a better way to create layers in a forloop Im learning Keras in R and want to test a NN regression model on a multivariate time series data set The goal is to predict Y as a function of its lag and all the other X variables and their corresponding lags The dataset has variables and daily observations in the following format Y Y day Y days Y days X day X days X days As a st step I split the dataset between Predictors Y dayX days and Predict only Y matrixes Then I normalize minmax Predictors between Finally I pass the matrixes to Keras model with the implemented code below Create the model buildmodel function model kerasmodelsequential layerdenseunits activation relu inputshape dimPredictors layerdenseunits activation relu layerdenseunits model compile loss meanabsolutepercentageerror optimizer optimizerrmsprop metrics listmeanabsolutepercentageerror model model buildmodel model summary Fit and train the model printdotcallback callbacklambda onepochend functionepoch logs if epoch cat n cat epochs earlystop callbackearlystoppingmonitor valloss patience model buildmodel history model fit Predictors Predict epochs epochs validationsplit verbose callbacks listearlystop printdotcallback plothistory metrics meanabsolutepercentageerror smooth FALSE coordcartesianxlim c ylim c After training is done the last code line plots MAPE error for training and validation as shown below We can notice that the MAPE on validation decreased down to which looks great However Im am a bit skeptical as I dont see validation loss to increase despite the high number of epochs Does this indicate a hidden error or overlooked implementation in my model How shall I interpret this G h Is there a way in Rkeras to generate CAMs or Saliency Maps for onedimensional input eg a vector as described for example for the kerasvis package for python I trained a CNN using RKeras and now want to visualize where the CNN is focusing on when performing class predictions PS Once I asked for the D option in RKeras maybe the code proposed there is useful