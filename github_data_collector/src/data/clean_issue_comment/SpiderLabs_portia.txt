Portia fails to verify credentials due to the fact that portia does not parse the d parameter instead uses the default WORKGROUP I make a temporary validation check on line by printing my inputs username password domain portiacheck Editing the portiapy file and manually specifying the domain value it seems to work only for account verifying function and next keep using the WORKGOUP value for the rest of the code portiacheck portiacheck I have identified also on lines number and domain value is assigned with the value WORKGROUP instead taking the users input Maybe domainWORKGROUP parameters exists also in multiple lines on py file Hi I think that will be interesting to add the possibility to obfuscate the powershell cmd executed on the remote host Ive tested your script on host protected by KASPERSKY and all the cmd executed on the remote host are dropped by the AV Ive tested some manually obfuscated cmd and its are not dropped by the AV Thank you Hi I think it will be cool to add an option to specify the group admin In French Windows the domain admin group is named Admins du domaine Thank you add missing cd impacket Looks very useful After installing I unfortunately am receiving the following Traceback most recent call last File portiapy line in module from depssecretsdump import File rootportiadepssecretsdumppy line in module from impacketexamplessecretsdump import LocalOperations RemoteOperations SAMHashes LSASecrets NTDSHashes ImportError No module named secretsdump any thoughts Thanks My first impression was a great tool But after I saw the list of dependencies I started to wonder Do you really expect it to be installed on a compromised machine First of all it might be no internet in the intranet Second you will not be allowed to install all these on a clients machine unless you developed a tool for hackers which is totally illegal Is any solution for this problem The change of directory cd impacket was missing it causes an execution error portiapy Traceback most recent call last File portiapy line in module from depspsexec import File optportiadepspsexecpy line in module from impacketexamples import logger ImportError No module named impacketexamples When running the tool against my own Windows machine I get the following error Traceback most recent call last File portiapy line in module mountSysvolusernamepassword File portiapy line in mountSysvol statusfoundAdmintestDomainCredentialsusernamepasswordNonedcList WORKGROUPTrue IndexError list index out of range Am I missing a dependency or something