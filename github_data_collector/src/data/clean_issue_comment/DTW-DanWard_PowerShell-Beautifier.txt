When given the input netsh int ip set interface index metric metric You end up with netsh int ip SetVariable interface index metric metric For example Uri sessionRootServiceLinksSessionsodataid results in Uri sessionRootServiceLinksSessions odataid If the file being processed refers to a custom type that is defined elsewhere the beautifier barfs For example as used in Microsofts AzSK framework code in Constantsps class Constants in ConfigurationHelperps rootConfigPath Constants AzSKAppFolderPath Then editdtwBeautifyScript Verbose sourcepath srcAzSKFrameworkHelpersConfigurationHelperps DestinationPath tmpfoops will produce many errors see below and no output Hacky workaround If I add this line to DTWPSBeautifierMainpsm line Err Err where not MessageStartsWithUnable to find type Then it works better A few errors generated InvokeTokenizeSourceScriptContent An error occurred is there invalid PowerShell or some formatting syntax issue in the script See error record below At localsharepowershellModulesPowerShellBeautifier srcDTWPSBeautifierMainpsm char InvokeTokenizeSourceScriptContent EV Err CategoryInfo NotSpecified WriteError WriteErrorException FullyQualifiedErrorId MicrosoftPowerShellCommandsWriteErrorExceptionInvokeTokenizeSourceScriptContent InvokeTokenizeSourceScriptContent Unable to find type Constants Content Constants line column At localsharepowershellModulesPowerShellBeautifier srcDTWPSBeautifierMainpsm char InvokeTokenizeSourceScriptContent EV Err CategoryInfo NotSpecified WriteError WriteErrorException FullyQualifiedErrorId MicrosoftPowerShellCommandsWriteErrorExceptionInvokeTokenizeSourceScriptContent InvokeTokenizeSourceScriptContent Unable to find type Constants Content Constants line column At localsharepowershellModulesPowerShellBeautifier srcDTWPSBeautifierMainpsm char test First Name Bob Last Name Smith WriteHost First Name testFirst Name WriteHost Last Name testLast Name gets changed to test First Name Bob Last Name Smith WriteHost First Name test First Name WriteHost Last Name test Last Name it puts a space between test and First NameLast Name The attached file is encoded in SystemTextEncoding Default but the function GetDTWFileEncoding reports it as UTF lstxt Hello there I had a quick look into the script and it appears that the acceloratortype names are found using psobject AssemblyGetTypeSystemManagementAutomationTypeAcceleratorsget However if you look into the hashtable that this returns the casing is correct Table psobject AssemblyGetTypeSystemManagementAutomationTypeAcceleratorsget TableKeys Table select Name BaseType Maybe it would be better to use these values Ive encountered an issue where the following snippet netsh interface ipv set address blabla gets transformed to netsh interface ipv SetVariable address blabla Is there a nice way to fix it It seems to be handled in CommandArgument handler function I dont see a way to differentiate it from legitimate scenarios though This is a known issue for Docker for Windows on Windows running a Windows container ie nanoserver not Ubuntu or any Linux OS It would be most ideal to be able to copy into the container regardless of runningstopped in case user already has a separate session connection to triage an issue dont want to kill that session Unfortunately we cant bummer so perhaps we localize this only for Windows containers and explicitly check within the copy function before the copy host OS and container server daemon OS and stop before copy and restart after Bummer but probably necessary Also this is lower priority issue most testing is done on Linux OSes and I have a VM of Nano running as well so not a huge deal Rather than recopying over preexisting content on a container delete the container and recreate each time if user passes switch param If performance tests are good rather than specifying param could make deleterecreate the default Downside is if user is also connected to container manually poking about running tests etc stopping and deleting container might not be a wise could prompt user Refactor code that identifies whether or not to add whitespace currently not ideal for adding userconfigurable options Change to lambdabased design 