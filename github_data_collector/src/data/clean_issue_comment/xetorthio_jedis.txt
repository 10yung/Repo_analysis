original code srcmainjavaredisclientsjedisutilShardedjava private void initializeListS shards nodes new TreeMapLong S for int i i shardssize i final S shardInfo shardsgeti if shardInfogetName null for int n n shardInfogetWeight n nodesputthisalgohashSHARD i NODE n shardInfo else for int n n shardInfogetWeight n nodesputthisalgohashshardInfogetName n shardInfo resourcesputshardInfo shardInfocreateResource proposal private void initializeListS shards nodes new TreeMapLong S for int i i shardssize i final S shardInfo shardsgeti int N shardInfogetWeight if shardInfogetName null for int n n N n nodesputthisalgohashSHARD i NODE n shardInfo else for int n n N n nodesputthisalgohashshardInfogetName n shardInfo resourcesputshardInfo shardInfocreateResource it avoid repeattly call shardInfogetWeight unnecessarily and new code shorter and terse Fixes Added support for client id command Reference clientid command doc Command client id Return Integer id of the client Test response from client id should match the client list self filter Expected behavior when kill master node the code will appear exception wait a moment the slave instead of master node the exception should be disappear but still pose exception Java code public static void clusterConnJedis SetHostAndPort clusterNodes new HashSetHostAndPort HostAndPort hp new HostAndPort HostAndPort hp new HostAndPort HostAndPort hp new HostAndPort HostAndPort hp new HostAndPort HostAndPort hp new HostAndPort HostAndPort hp new HostAndPort clusterNodesaddhp clusterNodesaddhp clusterNodesaddhp clusterNodesaddhp clusterNodesaddhp clusterNodesaddhp JedisCluster clusterPool null while true try clusterPool new JedisClusterclusterNodes new JedisPoolConfig int index new RandomnextInt String key k index String value v index clusterPoolsetkey value Systemoutprintlnkeyvalue key clusterPoolgetkey TimeUnitMILLISECONDSsleep catch Exception e eprintStackTrace finally if null clusterPool clusterPoolclose Actual behavior and Steps to reproduce Redis cluster just installed and runing run TestClassclusterConnJedis in main method everything is ok I find the right pint keyvaluekRandomNumvRandomNum per MILLISECONDS in conole But when I command kill p hp pid master node be killed I find the console print JedisClusterMaxAttemptsException several normal print intervals exception details redisclientsjedisexceptionsJedisClusterMaxAttemptsException No more cluster attempts left at redisclientsjedisJedisClusterCommandrunWithRetriesJedisClusterCommandjava at redisclientsjedisJedisClusterCommandrunWithRetriesJedisClusterCommandjava at redisclientsjedisJedisClusterCommandrunWithRetriesJedisClusterCommandjava at redisclientsjedisJedisClusterCommandrunWithRetriesJedisClusterCommandjava at redisclientsjedisJedisClusterCommandrunWithRetriesJedisClusterCommandjava at redisclientsjedisJedisClusterCommandrunWithRetriesJedisClusterCommandjava at redisclientsjedisJedisClusterCommandrunJedisClusterCommandjava at redisclientsjedisJedisClustersetJedisClusterjava at TestclusterConnJedisTestjava at TestmainTestjava exception picture Redis Jedis Configuration see code clusterConnJedis Jedis version jedis Redis version redis cluster Java version jdk Expected behavior we have a redis cluster in aws elasticacheit has multi endpoint our service should be connect different endpoint when service restart Actual behavior in our service node A it alway connected redis cluster endpoint B always Steps to reproduce we found jedis getaddress use InetAddressgetByNamehostnameit always return same ipif dns server return ip listit happend in ipv environmentif we close ipv its not problem we found the result import javanetInetAddress import javautilRandom public class JavaInetAddressGetByAddressExample public static void mainString args try InetAddress ia InetAddressgetAllByNamebusssubsribemainl pqk clustercfgapse cacheamazonawscom forint i i ialength i Systemoutprintlnia i getHostAddress Systemoutprintln int a new RandomnextIntialength InetAddress randomip ia a SystemoutprintlnrandomipgetHostAddress Systemoutprintln InetAddress ip InetAddressgetByNamebusssubsribemainl pqk clustercfgapse cacheamazonawscom Systemoutprintlnip getHostAddress catch Exception ex Systemerrprintlnex so we can use Random to get ipadddr as above run in Redis Jedis Configuration Jedis version Redis version Java version JDK The docs imply that we should somehow at runtime detect that master has gone down and we should promote a slave Im creating a pretty traditional REST API server with Ktor and using jedis to cache API responses This means that before every access to jedis I have to confirm whether the instances are up and manage masterslave promotions This would not be ideal when handling thousands of API callsminute Also is there a way to dynamically create new instances This would be great for development on localhost whereas during deployment to eg AWS Elasticache manages the pool on its own please implements clientId method thank you very much Jedis version Java version javalangClassCastException B cannot be cast to javautilList at redisclientsjedisBuilderFactory buildBuilderFactoryjava jedis jarna at redisclientsjedisBuilderFactory buildBuilderFactoryjava jedis jarna at redisclientsjedisResponsebuildResponsejava jedis jarna at redisclientsjedisResponsegetResponsejava jedis jarna avoid getting redisclientsjedisJedisDataExceptionNOAUTH Authentication required Expected behavior Successful increment or get Actual behavior Thrown exception redisclientsjedisexceptionsJedisDataException ERR Command disallowed Steps to reproduce I have a code which when connects to local Redis doesnt have this exception thrown although many others are occasionally When I connect to AWS Redis this happens very often when running commands Redis Jedis Configuration JedisPool with min max idle Jedis version Redis version Java version x please implements xinfo method