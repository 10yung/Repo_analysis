 It looks like when creating an external charge we are not verifying the validity between the accountId and the invoiceId specified in the json leading to data integrity issue Given the catalog below Dryrun invoicing with a target date in the middle of the DISCOUNT period only invoices for that month instead of catchingup Actual invoicing past the DISCOUNT phase doesnt reflect the EVERGREEN price Heres a simple catalog to reproduce it we also have ReducedSpyCarAdvancedWithThreePhasesAddOnsxml in our Ruby integration tests xml version encodingUTF standaloneno catalog xmlnsxsi xsinoNamespaceSchemaLocation effectiveDate T effectiveDate catalogNameExampleCatalogcatalogName recurringBillingModeINADVANCErecurringBillingMode currencies currencyUSDcurrency currencies products product nameStandard categoryBASEcategory product products rules changePolicy changePolicyCase policyENDOFTERMpolicy changePolicyCase changePolicy cancelPolicy cancelPolicyCase policyENDOFTERMpolicy cancelPolicyCase cancelPolicy rules plans plan namestandardmonthly productStandardproduct initialPhases phase typeTRIAL duration unitDAYSunit number number duration fixed fixedPrice price currencyUSDcurrency value value price fixedPrice fixed phase phase typeDISCOUNT duration unitMONTHSunit number number duration recurring billingPeriodMONTHLYbillingPeriod recurringPrice price currencyUSDcurrency value value price recurringPrice recurring phase initialPhases finalPhase typeEVERGREEN duration unitUNLIMITEDunit duration recurring billingPeriodMONTHLYbillingPeriod recurringPrice price currencyUSDcurrency value value price recurringPrice recurring finalPhase plan plans priceLists defaultPriceList nameDEFAULT plans planstandardmonthlyplan plans defaultPriceList priceLists catalog PaymentApigetPayment called from InvoiceResourcegetPaymentsForInvoice for instance would not populate the accountId Creating the PR so we keep track of it If we decide to not merge it at least we have the closed PR as a reference and we can update such PR with details on the decision When creating an external charge for instance createdExternalChargesJson has startDate and endDate populated as instead of being null This could affect other endpoints eg createTaxItems While running a test doing s SOT cancellation our code throws an exception depending on when the test is ran in the day All JAXRS APIs return a multiversioned catalog even when a version is specified which we dont know how to deserialize yet we cannot upload a multiversion one