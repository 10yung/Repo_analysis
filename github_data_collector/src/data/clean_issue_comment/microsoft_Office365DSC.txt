 Pull Request PR description Fix an issue where SafeAttachments and Safe Links properties were not all extracted This Pull Request PR fixes the following issues Fixes Fixes Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend Details of the scenario you tried and the problem that is occurring I created some safe links policies at it appears as if not everything regarding the corresponding rules is loaded I can see that the schema has these properties defined and the configured rule data is visible in the security and compliance admin portal but it is not extracted Verbose logs showing the problem Suggested solution to the issue The DSC configuration that is used to reproduce the issue as detailed as possible The operating system the target node is running Version of the DSC module that was used dev if using current dev branch Details of the scenario you tried and the problem that is occurring I created some safe attachment policies at it appears as if not everything regarding the corresponding rules is loaded I can see that the schema has these properties defined and the configured rule data is visible in the security and compliance admin portal but it is not extracted Verbose logs showing the problem Suggested solution to the issue The DSC configuration that is used to reproduce the issue as detailed as possible The operating system the target node is running Version of the DSC module that was used dev if using current dev branch Several DSC modules do have VSCode launch settings in place With these settings its a lot easier to have reproducible actions for all developers There should be settings for running unit tests and generating unit test coverage reports This would lower the need of CI runs within this repo as code changes could be testes locally with ease Your feedback and support is greatly appreciated thanks for contributing ISSUE TITLE Please prefix the issue title with the resource name eg ResourceName Short description of my issue ISSUE DESCRIPTION this template Please provide information regarding your issue under each header below Write NA under any headers that do not apply to your issue or if the information is not available NOTE Sensitive information should be obfuscated PLEASE KEEP THE HEADERS You may remove this comment block and the other comment blocks but please keep the headers Details of the scenario you tried and the problem that is occurring Running a TestDscConfiguration against spam settings returns an error Verbose logs showing the problem PowerShell DSC resource MSFTEXOHostedContentFilterPolicy failed to execute TestTargetResource functionality with error message Cannot validate argument on parameter EndUserSpamNotificationCustomFromAddress The argument does not match the azAZ azAZ azAZ pattern Supply an argument that matches azAZ azAZ azAZ and try the command again CategoryInfo InvalidOperation rootMicrosoftgurationManagerString CimException FullyQualifiedErrorId ProviderOperationExecutionFailure PSComputerName localhost Suggested solution to the issue The DSC configuration that is used to reproduce the issue as detailed as possible The operating system the target node is running Please provide as much as possible about the target node for example edition version build and language On OS with WMF the following command can help get this information GetComputerInfo Property OsName OsOperatingSystemSKU OSArchitecture WindowsVersion WindowsBuildLabEx OsLanguage OsMuiLanguages Version of the DSC module that was used dev if using current dev branch Steps to reproduce Configure the O tenant to have at least one Distribution List Create the DSC files and compile the mof file run a TestDscConfiguration against the mof file Details The TestDscConfiguration will return that a noncomplaint setup was found as it expects the DL members property to by nonempty Current Values Description DisplayNameDLo test EnsurePresent GlobalAdminAccountSystemManagementAutomationPSCredential MailNickNamedlo test ManagedBy Membersnull Target Values Description DisplayNameDLo test EnsurePresent GlobalAdminAccountSystemManagementAutomationPSCredential MailNickNamedlo test ManagedBy Members VerboseTrue Expected to find an array value for property Members in the current values but it was either not present or was null This has caused the test method to return false Detected Drifted Parameter MSFTO Group Members No changes have been made to the tenant btw pulling the reference configuration and running the TestDscConfiguration command Details of the scenario you tried and the problem that is occurring I created some custom categories and subcategories in the compliance center It seems that subcategories of custom categories are not handled correctly and not extracted The extraction process completes and everything can be compiled but some of the subcategories are missing Verbose logs showing the problem GetTargetResource Cannot bind argument to parameter Category because it is an empty string At C GitProjects Office DSC Modules Office DSC DSCResources MSFTSCFilePlanPropertySubCategory MSFTSCFilePlanProp ertySubCategorypsm char result GetTargetResource params CategoryInfo InvalidData GetTargetResource ParameterBindingValidationException FullyQualifiedErrorId ParameterArgumentValidationErrorEmptyStringNotAllowedGetTargetResource Suggested solution to the issue The issue seems to be that the parent categories are matched by id and the id of custom categories is something like FFOextestmicrosoftcomMicrosoft Exchange Hosted OrganizationsM x onmicrosoftcomConfigurationcategory and not CNguidThatIsTheSameAsParentId that the current code seems to expect I think that it would be better to match by the Guid or the ExchangeObjectId of the parent category since these appear to correspond wit subcategoryParentId The DSC configuration that is used to reproduce the issue as detailed as possible The operating system the target node is running Version of the DSC module that was used dev if using current dev branch dev Details of the scenario you tried and the problem that is occurring I added some custom domains to my tenant and there seems to be an issue with the extraction process here I added a domain and i also added a subdomain this causes problems for the extraction process since the match operator is usedMSFTEXOAcceptedDomainps The bug could also manifest if I had two custom domains ie mydomaincom and somethingmydomaincom Verbose logs showing the problem Suggested solution to the issue GetAcceptedDomain has an Identity paramer so this could be used directly to single out the accepted domain instead of filtering the retrieved accepted domains list The DSC configuration that is used to reproduce the issue as detailed as possible powershell EXOAcceptedDomain e e b b f a c aa f c c e ff DomainType AuthoritativeAuthoritative Ensure Present GlobalAdminAccount Credsglobaladmin Identity test envtestingiotestingio MatchSubDomains FalseFalse OutboundOnly FalseFalse The operating system the target node is running Version of the DSC module that was used dev if using current dev branch dev Details of the scenario you tried and the problem that is occurring On one of our enviroments the SPOSiteAuditSettings resource is causing problems because it has different AuditFlags than what is defined in the schema Verbose logs showing the problem Office DSC SPOSiteAuditSettings At least one of the values is not supported or valid for property AuditFlags on class SPOSiteAuditSettings Please specify only supported values All None At C ProgramData SysKit Trace DSCWORK e dfc accc eac bd Copy Office TenantConfigps char SPOSiteAuditSettings e c d b d dc ae CategoryInfo InvalidOperation WriteError ParentContainsErrorRecordException FullyQualifiedErrorId UnsupportedValueForPropertyOffice DSC SPOSiteAuditSettings Suggested solution to the issue When i go to layouts AuditSettingsaspx is the following message We no longer support choosing specific events to edit Audit Log Reports will still be available as usual but powered by the Unified Audit Pipeline Please refer to this document for complete list of audited events Please note that we do not support list items as of now Maybe this resource is no longer required if not configurable Alternatively add support for other values except All None if its possible The DSC configuration that is used to reproduce the issue as detailed as possible powershell SPOSiteAuditSettings fbf f a b bedad d cb b AuditFlags GlobalAdminAccount Credsglobaladmin Url SPOSiteAuditSettings b cc c d d a e AuditFlags GlobalAdminAccount Credsglobaladmin Url The operating system the target node is running Please provide as much as possible about the target node for example edition version build and language On OS with WMF the following command can help get this information GetComputerInfo Property OsName OsOperatingSystemSKU OSArchitecture WindowsVersion WindowsBuildLabEx OsLanguage OsMuiLanguages Version of the DSC module that was used dev if using current dev branch Details of the scenario you tried and the problem that is occurring We noticed that exporting the configuration on some of our tenants generates invalid powershell powershell O Group fce c c db d fce a Description DisplayName Cash Ensure Present GlobalAdminAccount Credsglobaladmin MailNickName ash ManagedBy jsmithsyskitdonmicrosoftcommsummerssyskitdonmicrosoftcomstockhamstensethsyskitdonmicrosoftcomdiestelschirpkesyskitdonmicrosoftcomsuellshadricksyskitdonmicrosoftcom Members The problem is in the members field After some analysis we came to the conclusion that the problem occurs because the group has another group in the members collection When calling GetTargetResource for the group we get the following powershell Name Value ManagedBy jsmithsyskitdonmicrosoftcom msummerssyskitdonmicrosoftcom stockhamstenseth DisplayName Cash Ensure Present Description MailNickName ash GlobalAdminAccount SystemManagementAutomationPSCredential Members null annebellecalaoutlookcomEXTsyskitdonmicrosoftcom AdeleVM x O The null in the members collection then kills everything null is here because the object in the actual members of the group is a group and does not have the UPN property DeletionTimestamp ObjectId f d f bb f c c ObjectType Group Description DirSyncEnabled DisplayName Accrued Expenses LastDirSyncTime Mail MailEnabled False MailNickName ccruedxpenses OnPremisesSecurityIdentifier ProvisioningErrors ProxyAddresses SecurityEnabled True Verbose logs showing the problem VERBOSE Setting configuration of Office Group Cash VERBOSE Found Existing Instance of Group Cash VERBOSE Found Members for Group Cash VERBOSE Found Owners for Group Cash VERBOSE Retrieved the following instance of the Group VERBOSE ManagedBy jsmithsyskitdonmicrosoftcom msummerssyskitdonmicrosoftcom stockhamstensethsyskitdonmicrosoftcom diestelschirpkesyskitdonmicrosoftcom suellshadricksyskitdonmicrosoftcom VERBOSE DisplayName Cash VERBOSE Ensure Present VERBOSE Description VERBOSE MailNickName ash VERBOSE GlobalAdminAccount SystemManagementAutomationPSCredential VERBOSE Members annebellecalaoutlookcomEXTsyskitdonmicrosoftcom AdeleVM x OnMicrosoftcomEXTsyskitdonmicrosoftcom AldoMM x onmicrosoftcomEXTsyskitdonmicrosoftcom albareslatzkesyskitdonmicrosoftcom You cannot call a method on a nullvalued expression At C Program Files WindowsPowerShell Modules ReverseDSC ReverseDSCCorepsm char if arrayLength gt and array GetTypeName eq S CategoryInfo InvalidOperation RuntimeException FullyQualifiedErrorId InvokeMethodOnNull Suggested solution to the issue Add support for groups as members of groups Or filter out the groups if only users are to be supported In any case i believe that some changes to the setter logic will also be required The DSC configuration that is used to reproduce the issue as detailed as possible The operating system the target node is running Version of the DSC module that was used dev if using current dev branch dev 