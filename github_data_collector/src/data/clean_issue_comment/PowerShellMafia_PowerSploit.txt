GetCurrentUserDomain encounter with Exception calling GetCurrentUserDomain with arguments Current security context is not associated with an Active Directory domain or forest At line char SystemDirectoryServicesActiveDirectoryDomain GetCurrentDomain CategoryInfo NotSpecified MethodInvocationException FullyQualifiedErrorId ActiveDirectoryOperationException In updated windows and Net framework now but when changing to GetcomputerDomain while we have logged in with a domain user the problem will be resolved Hi I am running Powerviewps on a machine which is member of a domain and I have logged with a domain user but unfortunately when I run the Powerviewps with InvokeShareFinder or any argument who run GetCurrentDomain function it encounter with Exception calling GetCurrentDomain with arguments Current security context is not associated with an Active Directory domain or forest At line char SystemDirectoryServicesActiveDirectoryDomain GetCurrentDomain CategoryInfo NotSpecified MethodInvocationException FullyQualifiedErrorId ActiveDirectoryOperationException I ran SystemDirectoryServicesActiveDirectoryDomain GetCurrentDomain in powershell and encountered the same error This change restricts access to ADSI object so theyre only writting to the ACL This fixes an issue writting an ACL when you exclusively have WriteDacl permission on a object I have run up against this issue in a pentest where it meant I wasnt able to get to DA but didnt know what was going on I also came up against it in a HtB machine so I had time to debug the tool and see what was going on This was an issue because if you dont set the security mask to Dacl it will attempt to write the whole object back to LDAP instead of just the ACE If you only have WriteDacl on the object this will obviously fail This change has been tested against a HtB machine and successfully wrote DCSync privs where the current master failed GetKeystrokes is kind of broken on windows bit Its not logging every letter I typed test and only t t was logged in the log file I also noticed that the log file does not continue to log where the last logged text left off Instead the log is erased every time you start the script It would also be nice to show in the log which window title and or browser tabs each line of text is being entered with and lastly instead of each letter being entered on a new line could you please make each word be on a new line Or have two versions of getkeystrokes that we can chose from being one with each letter on a new line and the other with each word being on a new line updated mimikatz to latest oct fixed VirtualAlloc issues on Win version build x error info c GetProcAddress Exception calling GetMethod with arguments Ambiguous match found At C tools tps char VirtualAllocAddr GetProcAddress kernel dll VirtualAlloc CategoryInfo NotSpecified GetProcAddress MethodInvocationException FullyQualifiedErrorId AmbiguousMatchExceptionGetProcAddress x GetProcAddress func details c Function written by Matt Graeber Twitter mattifestation Blog Function GetProcAddress Param OutputType IntPtr Parameter Position Mandatory True String Module Parameter Position Mandatory True String Procedure Get a reference to Systemdll in the GAC SystemAssembly AppDomain CurrentDomainGetAssemblies WhereObject GlobalAssemblyCache And LocationSplit EqualsSystemdll UnsafeNativeMethods SystemAssemblyGetTypeMicrosoftWin UnsafeNativeMethods Get a reference to the GetModuleHandle and GetProcAddress methods GetModuleHandle UnsafeNativeMethodsGetMethodGetModuleHandle GetProcAddress UnsafeNativeMethodsGetMethodGetProcAddress Get a handle to the module specified Kern Handle GetModuleHandleInvokenull Module tmpPtr NewObject IntPtr HandleRef NewObject SystemRuntimeInteropServicesHandleReftmpPtr Kern Handle Return the address of the function WriteOutput GetProcAddressInvokenull SystemRuntimeInteropServicesHandleRef HandleRef Procedure x system info c Windows Server Datacenter Hello when the OutEncryptedScriptps script is used from powershell core the parameter Encoding Byte at ligne no longer exist Byte scriptBytes GetContent Encoding Byte ReadCount Path ScriptPath it can be replaced with AsByteStream byte scriptBytes GetContent AsByteStream ReadCount Path ScriptPath For the moment unfortunately the parameter AsByteStream seem not working on a classic windows workstation updated with powershell Regards PS initial message error GetContent Cannot process argument transformation on parameter Encoding Byte is not a supported encoding name For information on defining a custom encoding see the documentation for the EncodingRegisterProvider method Hello this GetNetGroupMember is not working I mean it does not take any Group Name argument again and again it gives the default Domain Admin Group results I want to enumerate the group members of this group VulnerableGroup How can I Please help me in that I have a project pending just because of this Fixed Current version on DEV branch says to use InvokeAllChecks to run all checks In the current version however that functionality is called with InvokePrivescAudit 