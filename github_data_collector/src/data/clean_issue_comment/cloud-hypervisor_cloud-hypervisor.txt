vhostuserblk has it It would be nice to make sure that virtioblk has the same set of features CC slp Using vhostuser gives security improvements over virtio with inprocess with scope of lots more Unify vhostusernet and vhostuserblock binary commandline style so that it does not conflict with cloudhypervisor Pull main functions for vhostuserblock and vhostusernet into cloudhypervisor main binary Spawn procpidexe if no backend specified for vhostusernet and vhostuserblk Unify vhostuserblk into disk might rename to block Unify vhostusernet into net Make vhostuser default for net and block With merged we now support MQ in virtionet and vhostusernet device side but the backend needs to have MQ multithreading enabled Some of the tests in vhostrs fail and are marked with ignore they should be investigated and either fixed or removed sboeuf rbradford bjzhjing When we enable multiplethread for multiplequeue in the vhost device and backend we found we need to change vhostuserbackend crate which will impact among blk net and fs backend Whats more those three virtio devices have different virtqueue definitions So if we want to enable MQ in vhost user device and backend we had better look for a better solution thanks sboeuf sameo This patch set is for MQ support in the vhostuserblk device and backend please help review thanks TBD resourceslinux config is as its name implies based while resourceslinuxvirtiofsvirtioiommuconfig is rc based rc just got released so we should at least switch to for our kernel configs Implement missing DAX support This means we need to add support for VHOSTUSERPROTOCOLFSLAVEREQ to the vhostuserbackend crate as we need to support some slave driven events Currently for reboot we tear down large parts of the VMM in particular DeviceManager and CpuManager This design decision was made to avoid issues with resetting the devices in particular needing to implement VIRTIO device reset However as we look towards implementing hotplug of devices it would be better to be able to just destroy the vCPU threads and preserve the rest of the state