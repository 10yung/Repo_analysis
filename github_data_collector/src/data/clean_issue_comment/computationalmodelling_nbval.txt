Hi from time to time I get an error using nbval because the default startuptimeout of s is too low Can you please make this timeout accessible similar to the option nbvalcelltimeout libpython sitepackagesnbvalkernelpy startuptimeout kernelname nbvalparentenv kwargs cwd build stderr ioTextIOWrapper namedevnull modew encodingUTF km jupyterclientmanagerKernelManager object at x fd d af a kc jupyterclientblockingclientBlockingKernelClient object at x fd d af def startnewkernelstartuptimeout kernelnamepython kwargs Start a new kernel and return its Manager and Client loggerdebugStarting new kernel s kernelname km KernelManagerkernelnamekernelname kernelspecmanagerNbvalKernelspecManager kmstartkernelkwargs kc kmclient kcstartchannels try kcwaitforreadytimeoutstartuptimeout RuntimeError Kernel didnt respond in seconds It seems like nbval does not work with the just released coverage package Im not sure if Im barking up the wrong tree and this is a problem with jupyterclient but Im sure you are more qualified to assess that Description Python version Os Windows windowslatest on github actions If you run nbval with this settings The kernel does not respond and throws RuntimeError Kernel didnt respond in seconds This problem only occurs on Windows MacOx and Linux work fine PS If you are interested to migrate you tests to github actions as well I could make a PR for that Hi all I love your project I just noticed that the IPython reset magic breaks the coverage report generated with pytest v nbvallax cov I observe this even when it is only present in the first line of the first cell of the notebook I made a small example notebook attached where the reported coverage varies between and This is with no reset magic Name Stmts Miss Cover mylibpy and this is with one reset magic in first code cell Name Stmts Miss Cover mylibpy Do you think it would be possible to survive a reset or must they be avoided Though the nbval is used for Jupyter notebook I am not able to implement it in Databricks as it doesnt have ipynb extension Can a feature be introduced to test Databricks notebook too Community version of Databricks can be used for development Hi I wonder whether its possible to use nbval for a jupyter notebook that exploits ipyparallel in combination with MPI mpi py This is the notebook Im talking about Its nothing special you can stop reading at cell Im seeing failures when running with nbval not sure if the fault is mine or what still to be investigated properly the error trace is here starting at around line so for now you might ignore thisI think but how canshould I use things like NBVALIGNOREOUTPUT in combination with ipyparallels magic px both are supposed to appear at the very top of a cell Thanks I have been having inconsistent errors recently however this most recent one seems to have stuck It might be related to the number of collected pytest items because otherwise nothing has impacted the code that it seems to be getting stuck on items on this example failing build It also seems to be dependent on python version but that could be for quite a few reasons Below are py examples Heres an example of failing build which also includes the commands to recreate the env and run the tests It crashes minute timeout on travis CI on a cell that takes seconds to run normally Ive had these inconsistent issues before and I solved it by running the notebooks separately from the main tests This is the command that is getting run that eventually crashes pytest notebooks covmorphs nbvallax currentenv covappend Im going to try to split it up into smaller groups of notebooks here so if this passes that might be a temporary solution Running the following code in a cell python from IPythondisplay import Image Imagesomeimagepng then replacing the content with python from IPythondisplay import Image Imageanotherimagepng and saving the notebook without executing shoud result in an inconsistent state However nbval does not appear to see the difference Steps to reproduce Clone uarray Create a conda env from condaenvironmentyml Install nbval Comment out the addopts line in pytestini Run pytest cov nbval Actual output nbval stalls then errors with a timeout error Expected output nbval should test the notebooks without a timeout OSenvironment macOS detailssummaryconda listsummary p packages in environment at Usershameerabbasianacondaenvsuarray Name Version Build Channel alabaster py appdirs py h b appnope py asn crypto py atomicwrites py attrs py autopep py babel py backcall py blas mkl bleach py cacertificates certifi py cffi py hb b e f chardet py click py coverage py h de cc cryptography py ha b ac decorator py defusedxml py doc py condaforge docutils py entrypoints py flake py gumath dev py gd a xndlabeldev idna py imagesize py intelopenmp ipykernel py h e cac ipython py h e cac ipythongenutils py jedi py jinja py jsonschema py jupyterclient py jupytercore py jupyterlab py hf ae jupyterlabserver py libcxx hcfea d libcxxabi hcfea d libedit hb a libffi h c libgfortran h f libgumath dev py gd a xndlabeldev libndtypes dev py gcb d xndlabeldev libsodium h efe b libxnd dev py g fdc b xndlabeldev markupsafe py h de cc mccabe py mistune py h de cc mkl mklfft py h e d mklrandom py h c d moreitertools py mypy py mypyextensions pypi pypi mypyextensions py nbconvert py nbformat py nbval py condaforge ncurses h a ndtypes dev py gcb d xndlabeldev ninja py h f b a notebook py numpy py hacdab b numpybase py h openssl b h de cc packaging py pandoc pandocfilters py parso py pbr py pexpect py pickleshare py pip py pluggy py prometheusclient py prompttoolkit py psutil py h de cc ptyprocess py py py pycodestyle py pycparser py pyflakes py pygments py pyopenssl py pyparsing py pyrsistent py h de cc pysocks py pytest py pytestcov py pytestflake py condaforge pytestmypy pypi pypi python h d pythondateutil py pytorchcpu py h a condaforge pytz py pyzmq py h a readline h de cc requests py restructuredtextlint py condaforge rope py scipy py h ff send trash py setuptools py six py snowballstemmer py sphinx py sphinxrtdtheme py sphinxcontrib py sphinxcontribwebsupport py sqlite ha bb stevedore py condaforge terminado py testpath py tk ha bb toml py h b tornado py h de cc traitlets py typedast pypi pypi typing py uarray g e e adirty dev develop urllib py wcwidth py webencodings py wheel py xnd dev py g fdc b xndlabeldev xz h de cc zeromq h a zlib h de cc p details