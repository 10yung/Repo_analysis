In the python utilspy file the minimum components to analyze with PCA seems to be Why not use default sklearn setting PCA would use all samples any reason to stick to This would also mean that if you have samplesimages you would always calculate the results only for PCs Any reason for this choice Am I missing something I assume somewhere in the code there is standalone cvPCA function can you help me find it Thanks Dario Hi thanks for making this data and code available for reproducible science In that spirit Ive run into a couple of easily fixable bugs in the code loadproc m calls a function called svdecon that is not included in this repo Ive spotted that a function of that name is in githubcomMouseLandstringerpachitariuetal atreemasterutilities so I can see how this error came about fitGaborRFs calls gpuDevice even if useGPU is set to which gives out an error if cuda isnt installed estimageRFs similarly calls gpuArray without checking if a gpu is available Thats it for now All the best Mat 