 Details of the scenario you tried and the problem that is occurring Sometimes the integration tests fail with the error Most likely a timing issue when running the integration test RemoveHandlerExcludedOptionalParameters Win Exception An instance of the service is already running InvalidOperationException Cannot start service IISADMIN on computer Verbose logs showing the problem T Z Context When using MSFTWebApplicationHandlerRemoveHandlerExcludedOptionalParameters T Z VERBOSE Perform operation Invoke CimMethod with following parameters methodName T Z SendConfigurationApplyclassName MSFTDSCLocalConfigurationManagernamespaceName T Z rootMicrosoftWindowsDesiredStateConfiguration T Z VERBOSE An LCM method call arrived from computer fvaz with user sid S T Z VERBOSE fvaz LCM Start Set T Z VERBOSE fvaz LCM Start Resource WebApplicationHandler WebHandlerTest T Z VERBOSE fvaz LCM Start Test WebApplicationHandler WebHandlerTest T Z VERBOSE fvaz WebApplicationHandler WebHandlerTest Handler is Present T Z AnotherTestWebHandler T Z VERBOSE fvaz LCM End Test WebApplicationHandler WebHandlerTest in seconds T Z VERBOSE fvaz LCM Start Set WebApplicationHandler WebHandlerTest T Z VERBOSE fvaz WebApplicationHandler WebHandlerTest Handler is Present T Z AnotherTestWebHandler T Z VERBOSE fvaz WebApplicationHandler WebHandlerTest Removing handler T Z AnotherTestWebHandler T Z VERBOSE fvaz WebApplicationHandler WebHandlerTest Performing the operation T Z RemoveWebConfigurationProperty on target PSPath MACHINEWEBROOTAPPHOST Name Collection Location Default Web T Z SiteTestDir Filter systemwebServerhandlers At nameAnotherTestWebHandler T Z VERBOSE fvaz LCM End Set WebApplicationHandler WebHandlerTest in seconds T Z VERBOSE fvaz LCM End Resource WebApplicationHandler WebHandlerTest T Z VERBOSE fvaz LCM End Set T Z VERBOSE fvaz LCM End Set in seconds T Z VERBOSE Operation Invoke CimMethod complete T Z VERBOSE Time taken for configuration job to complete is seconds T Z Should compile and apply the MOF without throwing s T Z VERBOSE An LCM method call arrived from computer fvaz with user sid S T Z VERBOSE fvaz LCM Start Get T Z VERBOSE fvaz WebApplicationHandler WebHandlerTest Handler is Absent T Z AnotherTestWebHandler T Z VERBOSE fvaz LCM End Get WebApplicationHandler WebHandlerTest in seconds T Z VERBOSE fvaz LCM End Get in seconds T Z Should be able to call GetDscConfiguration without throwing ms T Z VERBOSE Perform operation Invoke CimMethod with following parameters methodName TestConfigurationclassName T Z MSFTDSCLocalConfigurationManagernamespaceName rootMicrosoftWindowsDesiredStateConfiguration T Z VERBOSE An LCM method call arrived from computer fvaz with user sid S T Z VERBOSE fvaz LCM Start Test T Z VERBOSE fvaz LCM Start Resource WebApplicationHandler WebHandlerTest T Z VERBOSE fvaz LCM Start Test WebApplicationHandler WebHandlerTest T Z VERBOSE fvaz WebApplicationHandler WebHandlerTest Handler is Absent T Z AnotherTestWebHandler T Z VERBOSE fvaz LCM End Test WebApplicationHandler WebHandlerTest True in seconds T Z VERBOSE fvaz LCM End Resource WebApplicationHandler WebHandlerTest T Z VERBOSE fvaz LCM End Test Completed processing test operation The operation returned True T Z VERBOSE fvaz LCM End Test in seconds T Z VERBOSE Operation Invoke CimMethod complete T Z VERBOSE Time taken for configuration job to complete is seconds T Z Should be able to call TestDscConfiguration and return true ms T Z Should remove a handler ms T Z VERBOSE Restoring web configuration attempt T Z Error occurred in test script D a s tests Integration MSFTWebApplicationHandlerIntegrationTestsps ms T Z Win Exception An instance of the service is already running T Z InvalidOperationException Cannot start service IISADMIN on computer T Z at RestoreWebConfigurationWrapper D a s tests TestHelper CommonTestHelperpsm line T Z at ScriptBlock D a s tests Integration MSFTWebApplicationHandlerIntegrationTestsps line T Z at ScriptBlock D a s output RequiredModules Pester Pesterpsm line T Z at InvokePesterEnd D a s output RequiredModules Pester Pesterpsm line T Z at ScriptBlock D a s output RequiredModules Sampler tasks InvokePesterpesterbuildps line T Z at Task D a s output RequiredModules InvokeBuild InvokeBuildps line T Z at Task D a s output RequiredModules InvokeBuild InvokeBuildps line T Z at Task D a s output RequiredModules InvokeBuild InvokeBuildps line T Z at ScriptBlockEnd D a s output RequiredModules InvokeBuild InvokeBuildps line T Z at ScriptBlockBegin D a s buildps line Suggested solution to the issue None The DSC configuration that is used to reproduce the issue as detailed as possible See integration test The operating system the target node is running Windows Server Version and build of PowerShell the target node is running Version of the DSC module that was used From branch master When the new CI pipeline was added PR only one build worker was added Windows Server to run integration tests We should add the other available builds workers as well Windows Server Core and Windows Server Thank you very much for developing and sharing this DSC Module Unfortunately one thing is not quite clear in the GitHub project description you write This module contains DSC resources for deployment and configuration of web servers and components around those Is this Module for IIS Webservers or for Webservers in general It would be great if the GitHub project description could clearly communicate this aspect for example This module contains DSC resources for deployment and configuration of IIS web servers and components around those Or This module contains DSC resources for deployment and configuration of IIS Apache and nginx web servers and components around those This would help a lot to decide if this module is suitable for a project Thanks a lot kind regards Thomas Details of the scenario you tried and the problem that is occurring When you specify an application pool that does not exist in a xWebsite resource the resource does not check if the specified application pool exists This results in a broken website with error UnknownThe object identifier does not represent a valid object Exception from HRESULT x D Verbose logs showing the problem NA Suggested solution to the issue Check if the specified application pool really exists before applying the configuration The DSC configuration that is used to reproduce the issue as detailed as possible powershell xWebsite Website Name Example website ApplicationPool NonExistentApplicationPool BindingInfo MSFTxWebBindingInformation Protocol HTTP Port IPAddress Hostname wwwexamplecom The operating system the target node is running Windows Server Version and build of PowerShell the target node is running v Version of the DSC module that was used dev if using current dev branch dev Pull Request PR description The PHP example was moved from READMEmd into its own example file under the Examples directory This Pull Request PR fixes the following issues Fixes Task list x Added an entry to the change log under the Unreleased section of the CHANGELOGmd Entry should say what was changed and how that affects users if applicable and reference the issue being resolved if applicable Resource documentation addedupdated in READMEmd Resource parameter descriptions addedupdated in READMEmd schemamof and commentbased help x Commentbased help addedupdated Localization strings addedupdated in all localization files as appropriate Examples appropriately addedupdated Unit tests addedupdated See DSC Resource Testing Guidelines Integration tests addedupdated where possible See DSC Resource Testing Guidelines Newchanged code adheres to DSC Resource Style Guidelines and Best Practices Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend Your feedback and support is greatly appreciated thanks for contributing ISSUE TITLE Please prefix the issue title with the resource name eg ResourceName Short description of my issue ISSUE DESCRIPTION this template Please provide information regarding your issue under each header below Write NA under any headers that do not apply to your issue or if the information is not available NOTE Sensitive information should be obfuscated PLEASE KEEP THE HEADERS You may remove this comment block and the other comment blocks but please keep the headers Details of the scenario you tried and the problem that is occurring I am trying to add some entries to the systemftpserversecurityauthorization collection both in the root of an FTPSite and in virtual directories within that site Essentially I am trying to match the output of the script below powershell importmodule webadministration newwebftpsite Name FTPSite Port physicalpath D resources Force setitemproperty IIS Sites FTPSite name ftpServersecurityauthenticationbasicauthenticationenabled Value true setitemproperty IIS Sites FTPSite name ftpServersecuritysslcontrolchannelpolicy value setitemproperty IIS Sites FTPSite name ftpServersecurityssldatachannelpolicy value addwebconfiguration systemftpserversecurityauthorization value accessTypeAllowusersUser User User permissions PSPath IIS Sites FTPSite NewWebVirtualDirectory Site FTPSite Name Config PhysicalPath D Config RemoveWebConfigurationProperty systemftpserversecurityauthorization PSPath IIS Sites FTPSite Config Name addwebconfiguration systemftpserversecurityauthorization value accessTypeAllowusersUser permissions PSPath IIS Sites FTPSite Config NewWebVirtualDirectory Site FTPSite Name AppData PhysicalPath D AppData RemoveWebConfigurationProperty systemftpserversecurityauthorization PSPath IIS Sites FTPSite AppData Name addwebconfiguration systemftpserversecurityauthorization value accessTypeAllowusersUser permissions PSPath IIS Sites FTPSite AppData The problem is that I cant find a way to use the xWebConfigPropertyCollection resource to set an entity in this collection There are properties that need to be set at the same time and the resource doesnt seem to have the functionality to achieve this I am aware that there is a PR open with a new feature for adding FTPSites which will cover most of what I need to do however I dont think it will help with modifying the collections on the Virtual Folders If I have completely missed something and this is really simple please point me in the right direction otherwise I think there may need to be an enhancement to the resource Verbose logs showing the problem I have tried all the permutations I can think of which has produced many different errors far too many to display here Suggested solution to the issue NA The DSC configuration that is used to reproduce the issue as detailed as possible This is as far as I have managed to get I have tried laying this out similar to the examples for this resource without success I have also tried the format suggested in Issue again without success powershell xWebConfigPropertyCollection FTPRootAuthorizationAccessType WebsitePath IIS Sites FTPSite Filter systemftpserversecurityauthorization CollectionName ItemName add ItemKeyName Key ItemKeyValue ItemPropertyName AccessType ItemPropertyValue Allow xWebConfigPropertyCollection FTPRootAuthorizationUsers WebsitePath IIS Sites FTPSite Filter systemftpserversecurityauthorization CollectionName ItemName add ItemKeyName Key ItemKeyValue ItemPropertyName Users ItemPropertyValue User User User xWebConfigPropertyCollection FTPRootAuthorizationPermissions WebsitePath IIS Sites FTPSite Filter systemftpserversecurityauthorization CollectionName ItemName add ItemKeyName Key ItemKeyValue ItemPropertyName Permissions ItemPropertyValue xWebConfigPropertyCollection FTPConfigAuthorization WebsitePath IIS Sites FTPSite Config Filter systemftpserversecurityauthorization CollectionName ItemName add ItemKeyName ItemKeyValue Allow ItemPropertyName AccessType ItemPropertyValue Allow xWebConfigPropertyCollection FTPHiddenAuthorization WebsitePath IIS Sites FTPSite AppData Filter systemftpserversecurityauthorization CollectionName ItemName add ItemKeyName ItemKeyValue Allow ItemPropertyName AccessType ItemPropertyValue Allow The operating system the target node is running This is running on a VM that gets wiped before each run of the configuration powershell OsName Microsoft Windows Enterprise LTSC OsOperatingSystemSKU OsArchitecture bit WindowsVersion WindowsBuildLabEx amd frers release OsLanguage enUS Version and build of PowerShell the target node is running powershell PSVersion PSEdition Desktop PSCompatibleVersions BuildVersion CLRVersion WSManStackVersion PSRemotingProtocolVersion SerializationVersion Version of the DSC module that was used dev if using current dev branch As a proposed solution to the issue I propose to change the way the resource checks Virtual Directory Replace this comment block with a description of your PR Also make sure you have update the CHANGELOGmd see the task list below An entry in the CHANGELOGmd is mandatory for all PRs This Pull Request PR fixes the following issues Fixes Task list To aid community reviewers in reviewing and merging your PR please take the time to run through the below checklist and make sure your PR has everything updated as required Change to x for each task in the task list that applies to your PR For those tasks that dont apply to you PR leave those as is x Added an entry to the change log under the Unreleased section of the CHANGELOGmd Entry should say what was changed and how that affects users if applicable and reference the issue being resolved if applicable Resource documentation addedupdated in READMEmd Resource parameter descriptions addedupdated in READMEmd schemamof and commentbased help Commentbased help addedupdated Localization strings addedupdated in all localization files as appropriate Examples appropriately addedupdated Unit tests addedupdated See DSC Resource Testing Guidelines Integration tests addedupdated where possible See DSC Resource Testing Guidelines Newchanged code adheres to DSC Resource Style Guidelines and Best Practices Reviewablestart This change is img src height alignabsmiddle altReviewable Reviewableend This example should be moved to the Examples folder Preferably in the root of the Examples folder as an endtoend example Please note that examples are tested so they can be compiled We should add at least one example for this resource We should optin to publish wiki content To be able to optin we need to Resolve issue Remove all of the resource documentation from the READMEmd it will be generated automatically effectively closing issue and 