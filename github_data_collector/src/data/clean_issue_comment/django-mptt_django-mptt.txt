Hello Im looking for a help with dropdown menu I asked this question on stackoverflow however no one responed So maybe here someone will be able to help I want to be able to create dropdown menu with subpages using admin panel At this moment in model I can choose if subpage is children of another and in what order it should be displayed But I dont know how to implement all of this together in template For example when I set that page is child of page it looks like this screenshot So page is now double and I dont now how to deal with that Can anyone help please modelspy python class SubpageMPTTModel title modelsCharFieldmaxlength slug modelsSlugFielduniqueTrue displayorder modelsIntegerFielddefault parent TreeForeignKeyself verbosenameis child ondeletemodelsCASCADE nullTrue blankTrue viewspy python def generatedpagerequest slug uniquesubpage getobjector Subpage slugslug homepage Homepageobjectsfirst subpagesorted SubpageobjectsexcludeisactiveFalseorderbydisplayorder context uniquesubpage uniquesubpage subpagesorted subpagesorted homepage homepage if uniquesubpageisactive or uniquesubpageslug admin return renderrequest subpagehtml context else return renderrequest html context in template python recursetree subpagesorted li classnavitem dropdown if not nodeischildnode a classnavlink href url generatedpage nodeslug trans nodetitle a elif nodeischildnode a classnavlink dropdowntoggle href url generatedpage nodeparentslug datatoggledropdown rolebutton ariahaspopuptrue ariaexpandedfalse trans nodeparenttitle a div classdropdownmenu a classdropdownitem href url generatedpage nodeslug trans nodetitle a endif li endrecursetree Created an admin for my model using DraggableMPTTAdmin It worked with normal ids when changed the ids from int to hashid object it started breaking Following is the Stack trace Traceback most recent call last File usrlocallibpython sitepackagesdjangocorehandlersexceptionpy line in inner response getresponserequest File usrlocallibpython sitepackagesdjangocorehandlersbasepy line in getresponse response selfprocessexceptionbymiddlewaree request File usrlocallibpython sitepackagesdjangocorehandlersbasepy line in getresponse response wrappedcallbackrequest callbackargs callbackkwargs File usrlocallibpython sitepackagesdjangocontribadminoptionspy line in wrapper return selfadminsiteadminviewviewargs kwargs File usrlocallibpython sitepackagesdjangoutilsdecoratorspy line in wrappedview response viewfuncrequest args kwargs File usrlocallibpython sitepackagesdjangoviewsdecoratorscachepy line in wrappedviewfunc response viewfuncrequest args kwargs File usrlocallibpython sitepackagesdjangocontribadminsitespy line in inner return viewrequest args kwargs File usrlocallibpython sitepackagesmpttadminpy line in changelistview selftreecontextrequest clsDjangoJSONEncoder File usrlocallibpython jsoninitpy line in dumps kwencodeobj File usrlocallibpython jsonencoderpy line in encode chunks selfiterencodeo oneshotTrue File usrlocallibpython jsonencoderpy line in iterencode return iterencodeo File usrlocallibpython sitepackagesdjangocoreserializersjsonpy line in default return superdefaulto File usrlocallibpython jsonencoderpy line in default raise TypeErrorfObject of type oclassname Currently mptt tests are failing with Django apparently due to this Django commit Suppose I have a mptt tree in my database Is it possible to query all the tree at once using GraphenePython Environment Python Django mysqlconnectorpython djangomptt djangompttadmin Mysql version After adding record in the admin without problems adding another one gives me the error TypeError at adminengineeringdomainadd cant multiply sequence by nonint of type NoneType whe evaluating fieldfield Havent been able to debug fully but it appears that somehow the level attribute of object instance is of NoneType instead of an integer All other attributes fields like lft rghttreeid are integers resp Issue doesnt occur with mysqlconnectorpython versions and Issue does occur with mysqlconnectorpython versions and Hi I have a short question I couldnt find answer to How can I use getancestors from inside of custom save method It most cases it is working fine it only fails when save is called during object creation As per documentation getancestors in this situation raises ValueError with Cannot call getancestors on unsaved instances Is there any way to do so I basically want to store whole branch of ancestors in a db field so it is accessible for tools that interacts with DB directly I created a CategoryForm to display a list of nested categories in a select form using a TreeNodeChoiceField from django import forms from mpttforms import TreeNodeChoiceField from models import class CategoryFormformsModelForm class Meta model Category fields category TreeNodeChoiceFieldquerysetCategoryobjectsall label When I render the form in a template the selected option contains a list of dashes and I so far I could not find a way to change it to a more meaningful name like Category Hi guys Im having trouble with the pagination of a MPTT models ListView It seems my issue boils down to this If the first item on a page is a root node everything is fine If the first item on a page is a child node I get an error Node class mpttquerysetsTreeQuerySet not in depthfirst order I am using a pretty standard ListView and only have items of level or Im under the impression that I am missing something really basic here and would appreciate a nudge in the right direction Cheers Gunnar ps Im using Django and mptt mptt version django version I have added this to my Category model parentcategory TreeForeignKeyself ondeletemodelsCASCADE nullTrue blankTrue relatednamechildren class MPTTMeta orderinsertionby name Now trying to migrate complains You are trying to add a nonnullable field level to category without a default we cant do that the database needs something to populate existing rows Please select a fix Provide a oneoff default now will be set on all existing rows with a null value for this column Quit and let me add a default in modelspy Select an option Since I am inheriting from MPTTModel but not directly using the field level how can I possibly fix this issue with level Eg in function getfamily the normal filter is used instead of the mpttfilter which breaks compatibility with djangopolymorphictree Is there a reason sometimes mpttfilter is used and sometimes the normal filter is used