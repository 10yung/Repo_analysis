I got an error when run FMWithLBFGStrain The message is WARN BLAS Failed to load implementation from comgithubfommilnetlibNativeSystemBLAS WARN BLAS Failed to load implementation from comgithubfommilnetlibNativeRefBLAS INFO StrongWolfeLineSearch Line search t fval rhs cdd INFO LBFGS Step Size INFO LBFGS Val and Grad Norm rel INFO StrongWolfeLineSearch Line search t fval rhs cdd INFO StrongWolfeLineSearch Line search t fval rhs cdd INFO StrongWolfeLineSearch Line search t fval rhs cdd INFO StrongWolfeLineSearch Line search t fval rhs cdd INFO StrongWolfeLineSearch Line search t fval rhs cdd INFO StrongWolfeLineSearch Line search t E fval rhs cdd INFO StrongWolfeLineSearch Line search t E fval rhs cdd INFO StrongWolfeLineSearch Line search t E fval rhs cdd INFO StrongWolfeLineSearch Line search t E fval rhs cdd INFO StrongWolfeLineSearch Line search t E fval rhs cdd ERROR LBFGS Failure Resetting history breezeoptimizeFirstOrderException Line search zoom failed INFO StrongWolfeLineSearch Line search t fval rhs cdd INFO StrongWolfeLineSearch Line search t fval rhs cdd INFO StrongWolfeLineSearch Line search t fval rhs cdd INFO StrongWolfeLineSearch Line search t fval rhs cdd INFO StrongWolfeLineSearch Line search t fval rhs cdd INFO StrongWolfeLineSearch Line search t E fval rhs cdd INFO StrongWolfeLineSearch Line search t E fval rhs cdd INFO StrongWolfeLineSearch Line search t E fval rhs cdd INFO StrongWolfeLineSearch Line search t E fval rhs cdd INFO StrongWolfeLineSearch Line search t E fval rhs cdd ERROR LBFGS Failure again Giving up and returning Maybe the objective is just poorly behaved INFO LBFGS Converged because line search failed But theres no error when I use FMWithSGDtrain with the same data set I dont know why Thanks for your help Idea is to have online learning for Factorization Machine similiar to StreamingLogisticRegressionWithSGD any pointers on the same Hi I am planning to use this library for the movie recommendation However I was wondering if this can library predict movie rating Thanks hello when generate FM model but why cant load the model to predict Error as follow Exception in thread main javalangException FModelload did not recognize model with className format versionorgapachesparkmllibclassificationFMModelSaveLoadV Fixes Issue From the FMWithSGD file scala Construct an object with default parameters task stepSize numIterations dim true true regParam miniBatchFraction def this this true true e e e The comment is inconsistent with the actual values passed It is also worth noting that e may be too small a fraction size to train over all parameters Since the GradientDescent implementation in Scala performs numIterations iterations of mini batch SGD with batch size miniBatchFraction it follows that approximately numIterations miniBatchFraction labeled points are updated For numIterations and miniBatchFraction e this means only a maximum of e labeled points are actually used during training Further implications since the model has a set of parameters per feature this means that if a feature is unseen during training then they will simply be initialized with their default values latent vectors initialized from a Normal distribution and weights initialized to The loss function used in this library for binary classification is a hingeloss function assuming labels or case Mathsignumpred label However the predictions being made are in the range case Mathexppred The used in predictions should be preferred to the expected in the loss function because the negative label is represented by in sparkmllib instead of to be consistent with multiclass labeling The loss function should be changed to be more like the way Spark does it task is currently an int param task for Regression and for Binary Classification Calling it looks like FMWithSGDtraintrainingDatardd numIterations Which is much less clear than something like FMWithSGDtraintrainingDatardd REGRESSION numIterations I would suggest using an enum instead of an int This is exactly the type of case where enums are meant to be used saveAsParquetFile should be replaced by writeparquet And parquetFile should be replaced by readparquet 