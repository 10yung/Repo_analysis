I want to fetch history of messages of chat sessions with two ore people I am using following way to fetch history of One user clientsearchHistory with jid rsm max before true if I do something like this I cant get any response sessionsforEachsession clientsearchHistory with sessionjid rsm max before true I have tried like this as well sessionsforEachsession const msgs thisclientsearchHistory with sessionjid rsm max before true thenresult catcherror What shall be the best way Hi we are using Stanza and the previous Stanzaio library and are very happy with it Thanks for building this great library However we could not find a way to upgrade to version x We tried all of them from beta all the way to Same result Id like to mention that we are no XMPP experts We are connecting a local XMPP Server which is basically used to just send notification events to clients via pub sub This server is not under our control Just the client With Version of stanza everything is working fine and we are able to connect to the server and receive events The sessionstarted event is fired and we are able to send a presence event Stanza However when using one of the x versions it seems that nothing happens after the SASL login Compared to V the bind feature is an empty object and the bind never happens Stanza The source code used for capturing the events is in the screen shots In this example we are using BOSH to connect But the same thing applies for web sockets Sorry if this is just a configuration problem in our code Thanks for any help When i am trying to connect then getting below data in client events presence null null null null sessionstarted null null disconnected null null null sessionbound null null message null null null null null pubsubpublished null null so may i know it work with electron or not Is there a way for stanzaio to use MAM instead of its default MAM Originally posted by CricketLaChica in it would be nice if there were better documentation eg if i were to say want to implement Chat Markers using stanzaio as a stanzaio and general xmpp noob it would be insanely helpful to have an example implementation of that as it stands i have no idea where to even start other than googlestack overflow which has not been terribly fruitful any recommendations on where to start to understand how to use a xep via stanzaio or references to examples EDIT after reading the source i now think i understand how the chatMarkers setting works perhaps a more useful sample would be how to implement a xep that isnt implicitly supported by a client setting such as Message Archive Management i see the exports in srcprotocolxep ts but how do i use them Any full documentation for the API reference It is hard to figure out what param or object is needed for each API When JIDparse is invoked with recent versions of reactnative ie on android ie Android Pie on Pixel XL TypeError is thrown as part of call to parse prepare nodeprep resourcepre nameprep due to the following call For some reason that call results into TypeError I have not checked it on empty project to make sure that its not caused by some of the libs and we use different setup with reactnative than one mentioned in but basically with the following code typescript Stringprototypenormalize normalize return function form NFC NFD NFKC NFKD string try return normalizecallthis form catch error consoleerrorFailed to normalize string this errormessage errorstack return this Stringprototypenormalize once logging is fully functional ie somewhere in react component render function testnormalizeNFKC we get the following output in Logcat ReactNative consoleerror Failed to normalize string test Type error normalize native code Monkeypatching Stringnormalize like this or potentially just returning original string instead of even trying to call original Stringnormalize as a workaround works for our use cases but probably this should be reported to reactnative or otherwise handled differently in stringprep typescript Stringprototypenormalize normalize return function form NFC NFD NFKC NFKD string try return normalizecallthis form catch error return this Stringprototypenormalize Is it possible to make this module compatible with NativeScript Currently I get the following exception when trying to use Stanza on Android with NativeScript Systemerr An uncaught Exception occurred on main thread Systemerr Unable to create application comtnsNativeScriptApplication comtnsNativeScriptException Error calling module function Systemerr TypeError Cannot read property slice of undefined Systemerr File filenodemodules readablestream lib streamwritablejs Systemerr Systemerr StackTrace Systemerr filenodemodules readablestream lib streamwritablejs Systemerr at nodemodulesreadablestreamlibstreamwritablejsfiledatadatacomhuefrontendfilesappvendorjs Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at fnfilesrc webpack bootstrap Systemerr at nodemodulesreadablestreamwritablejsfilenodemodules readablestream writablejs Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at fnfilesrc webpack bootstrap Systemerr at nodemodulesstreambrowserifyindexjsfilenodemodules streambrowserify indexjs Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at fnfilesrc webpack bootstrap Systemerr at nodemodulesreadablestreamreadablejsfilenodemodules readablestream readablejs Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at fnfilesrc webpack bootstrap Systemerr at filenodemodules stanza modulejs Systemerr at nodemodulesstanzamodulejsfiledatadatacomhuefrontendfilesappvendorjs Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at fnfilesrc webpack bootstrap Systemerr at servicesxmppservicetsfilesrc services xmppservicets Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at fnfilesrc webpack bootstrap Systemerr at nodemodulestsloaderindexjsnodemodulesvueloaderlibindexjsnodemodulesstringreplaceloaderindexjscomponentsChatvuevue typescript langts filedatadatacomhuefrontendfilesappbundlejs Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at fnfilesrc webpack bootstrap Systemerr at componentsChatvuevue typescript langts filesrc components Chatvue c Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at fnfilesrc webpack bootstrap Systemerr at componentsChatvuefilesrc components Chatvueac Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at fnfilesrc webpack bootstrap Systemerr at nodemodulestsloaderindexjsnodemodulesvueloaderlibindexjsnodemodulesstringreplaceloaderindexjsAppvuevue typescript langts filedatadatacomhuefrontendfilesappbundlejs Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at fnfilesrc webpack bootstrap Systemerr at Appvuevue typescript langts filesrc Appvue e Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at fnfilesrc webpack bootstrap Systemerr at Appvuefilesrc Appvue Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at fnfilesrc webpack bootstrap Systemerr at filesrc mainnativets Systemerr at mainnativetsfiledatadatacomhuefrontendfilesappbundlejs Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at fnfilesrc webpack bootstrap Systemerr at filedatadatacomhuefrontendfilesappbundlejs Systemerr at webpackrequirefilesrc webpack bootstrap Systemerr at checkDeferredModulesfilesrc webpack bootstrap Systemerr at webpackJsonpCallbackfilesrc webpack bootstrap Systemerr at filedatadatacomhuefrontendfilesappbundlejs Systemerr at require Systemerr Systemerr Systemerr TypeError Cannot read property slice of undefined While trying to upgrade to from Ive noticed that now outofthe box reaction to remote sessionterminate action in jingle is to send explicit sessionterminate back instead of just sending result and silently ending the session Im not sure if it was an intentional change so just wanted to mention it We were hitting some issues with more recent x versions that we did not have time to dig into till now had to stay on older version so Im not sure at what point this change in behavior got introduced Its coming to ICESessionend with silent true in reaction to remote sessionterminate action but due to pcclose on the line just above it ends up calling end in onIceStateChange as reaction to pciceConnectionState switching to closed It seems that this reverse sessionterminate results into error with condition serviceunavailable coming back from the client that originated first sessionterminate because it already removed that session Also Ive noticed that there is no tag v x in the repo PS Thanks a lot for the switch to typescript and plenty of other improvements that went into recent releases Im using a stanza client with the keepalive enable with the next options clientenableKeepAliveinterval timeout But when the connection is lost it is not working as I would expect What Im seeing is Keepalive sent and answer received Connection is lost Keepalive sent Timeout waiting for server answer A new connection is established resuming previous XML stream Where the first number is the number of seconds elapsed since the start I was expecting to see the session reestablished right after the timeout waiting for the server answer but I have to wait additional seconds and that is a lost of time